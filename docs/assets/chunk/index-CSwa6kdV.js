import{r as y,j as s,T as S}from"../../main-BOLlNZH-.js";import{a as T,u as v}from"./react-ixa2QfBG.js";import{A}from"./index-BwMSiSxZ.js";import{S as N}from"./index-DTg1L3bG.js";import{C as f}from"./index-Dk1xyqhL.js";import"./ExclamationCircleFilled-0n3bTMwr.js";import"./InfoCircleFilled-DykvtHdN.js";const b=T({listId:null,index:null,position:null}),{Title:C,Paragraph:u,Text:m}=S;function R(){const[r,p]=y.useState({list1:[1,2,3],list2:[4,5,6]}),[d,l]=v(b),e=(o,x,a,h)=>{p(c=>{const i={...c};if(o===x){const t=[...c[o]],n=t.indexOf(a);t.splice(n,1),t.splice(h,0,a),i[o]=t}else{i[o]=c[o].filter(n=>n!==a);const t=[...c[x]];t.splice(h,0,a),i[x]=t}return i})};return s.jsxs("div",{style:{maxWidth:"800px",margin:"0 auto",padding:"20px"},children:[s.jsx(C,{level:2,children:"拖拽列表演示"}),s.jsx(A,{type:"info",message:"什么是拖拽列表？",description:"拖拽列表是一种允许用户通过拖放操作重新排序或在不同列表间移动项目的交互组件。它提供了直观的用户体验，常用于任务管理、文件组织等场景。",showIcon:!0,style:{marginBottom:"20px"}}),s.jsxs(N,{direction:"vertical",style:{width:"100%"},children:[s.jsx(f,{title:"演示效果",children:s.jsxs("div",{className:"drag-list-container",children:[s.jsx(D,{id:"list1",items:r.list1,onMove:e,setDropPosition:l,dropPosition:d}),s.jsx(D,{id:"list2",items:r.list2,onMove:e,setDropPosition:l,dropPosition:d})]})}),s.jsxs(f,{title:"功能说明",children:[s.jsx(u,{children:s.jsx(m,{strong:!0,children:"实现原理："})}),s.jsxs("ul",{children:[s.jsx("li",{children:"使用 HTML5 原生拖拽 API"}),s.jsx("li",{children:"通过 jotai 状态管理拖拽位置"}),s.jsx("li",{children:"CSS 过渡动画提升用户体验"}),s.jsx("li",{children:"支持列表内排序和跨列表拖拽"})]}),s.jsx(u,{children:s.jsx(m,{strong:!0,children:"关键特性："})}),s.jsxs("ul",{children:[s.jsx("li",{children:"拖拽时显示插入位置指示器"}),s.jsx("li",{children:"平滑的动画过渡效果"}),s.jsx("li",{children:"支持跨列表项目移动"}),s.jsx("li",{children:"自适应列表高度"})]}),s.jsx(u,{children:s.jsx(m,{strong:!0,children:"使用场景："})}),s.jsxs("ul",{children:[s.jsx("li",{children:"任务看板"}),s.jsx("li",{children:"文件管理器"}),s.jsx("li",{children:"优先级排序"}),s.jsx("li",{children:"分类管理"})]})]})]})]})}const D=({id:r,items:p,onMove:d,setDropPosition:l,dropPosition:e})=>{const o=(i,t)=>{i.dataTransfer.setData("application/json",JSON.stringify({listId:r,item:t}))},x=i=>{i.preventDefault();const t=Number(i.currentTarget.getAttribute("data-index")),n=i.currentTarget.getBoundingClientRect(),j=n.top+n.height/2;i.clientY<j?l({listId:r,index:t,position:"top"}):l({listId:r,index:t,position:"bottom"})},a=()=>{l(null)},h=(i,t)=>{try{const n=JSON.parse(i.dataTransfer.getData("application/json")),{listId:j,item:g}=n;e?.position==="top"?d(j,r,g,t-1<0?0:t-1):d(j,r,g,t)}catch(n){console.error("Drop error:",n)}finally{l(null)}},c=()=>{l(null)};return s.jsxs("div",{className:"drag-list",children:[s.jsxs("h3",{children:["列表 ",r]}),p.map((i,t)=>s.jsx("div",{"data-id":r,"data-index":t,className:`drag-list-item ${e?.index===t&&e?.listId===r?`drop-${e.position}`:""}`,draggable:!0,onDragStart:n=>o(n,i),onDragOver:x,onDrop:n=>h(n,t),onDragLeave:a,onDragEnd:c,children:i},i))]})};export{R as default};
