import{l as j,r,C as Z,c as D,n as Ee,g as Ie,m as we,f as x,e as ze,o as Ne,i as Oe,p as Q,S as Le,j as c,T as Be,B as ee}from"../../main-DzykU_cl.js";import{A as _e}from"./index-CF7E4fOl.js";import{S as V}from"./index-048wQVRF.js";import{C as te}from"./index-DyYjffXN.js";import{R as Re}from"./InboxOutlined-ysYOkHtN.js";import{R as Me}from"./UploadOutlined-CL3kQUqk.js";import{e as De,P as Te,R as ie,a as He}from"./FolderOutlined-Cyn-cxjj.js";import{u as We,r as ne}from"./useBreakpoint-w2IjVQaS.js";import{D as Fe}from"./index-DhwBZsB2.js";import{C as Ge,R as Ae}from"./row-COOdU8yd.js";import{P as ke,U as Xe}from"./index-ZVhFORXa.js";import{s as Ve}from"./index-CVnzO72X.js";import"./ExclamationCircleFilled-C864b64l.js";import"./InfoCircleFilled-BJKSyOCY.js";import"./useForceUpdate-CosIKAaA.js";import"./SearchOutlined-BAcjJbDy.js";import"./index-AglA6CMl.js";import"./fade-DoU_FCEA.js";import"./DownloadOutlined-Caee277d.js";import"./EyeOutlined-DxJGTue0.js";const J=j.createContext({});J.Consumer;var re=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(i[n[o]]=t[n[o]]);return i};const Ue=t=>{var{prefixCls:e,className:i,avatar:n,title:o,description:g}=t,u=re(t,["prefixCls","className","avatar","title","description"]);const{getPrefixCls:P}=r.useContext(Z),y=P("list",e),O=D(`${y}-item-meta`,i),I=j.createElement("div",{className:`${y}-item-meta-content`},o&&j.createElement("h4",{className:`${y}-item-meta-title`},o),g&&j.createElement("div",{className:`${y}-item-meta-description`},g));return j.createElement("div",Object.assign({},u,{className:O}),n&&j.createElement("div",{className:`${y}-item-meta-avatar`},n),(o||g)&&I)},Ze=j.forwardRef((t,e)=>{const{prefixCls:i,children:n,actions:o,extra:g,styles:u,className:P,classNames:y,colStyle:O}=t,I=re(t,["prefixCls","children","actions","extra","styles","className","classNames","colStyle"]),{grid:w,itemLayout:$}=r.useContext(J),{getPrefixCls:L,list:S}=r.useContext(Z),z=h=>{var v,B;return D((B=(v=S?.item)===null||v===void 0?void 0:v.classNames)===null||B===void 0?void 0:B[h],y?.[h])},a=h=>{var v,B;return Object.assign(Object.assign({},(B=(v=S?.item)===null||v===void 0?void 0:v.styles)===null||B===void 0?void 0:B[h]),u?.[h])},d=()=>{let h=!1;return r.Children.forEach(n,v=>{typeof v=="string"&&(h=!0)}),h&&r.Children.count(n)>1},s=()=>$==="vertical"?!!g:!d(),l=L("list",i),m=o&&o.length>0&&j.createElement("ul",{className:D(`${l}-item-action`,z("actions")),key:"actions",style:a("actions")},o.map((h,v)=>j.createElement("li",{key:`${l}-item-action-${v}`},h,v!==o.length-1&&j.createElement("em",{className:`${l}-item-action-split`})))),p=w?"div":"li",C=j.createElement(p,Object.assign({},I,w?{}:{ref:e},{className:D(`${l}-item`,{[`${l}-item-no-flex`]:!s()},P)}),$==="vertical"&&g?[j.createElement("div",{className:`${l}-item-main`,key:"content"},n,m),j.createElement("div",{className:D(`${l}-item-extra`,z("extra")),key:"extra",style:a("extra")},g)]:[n,m,Ee(g,{key:"extra"})]);return w?j.createElement(Ge,{ref:e,flex:1,style:O},C):C}),oe=Ze;oe.Meta=Ue;const Je=t=>{const{listBorderedCls:e,componentCls:i,paddingLG:n,margin:o,itemPaddingSM:g,itemPaddingLG:u,marginLG:P,borderRadiusLG:y}=t;return{[e]:{border:`${x(t.lineWidth)} ${t.lineType} ${t.colorBorder}`,borderRadius:y,[`${i}-header,${i}-footer,${i}-item`]:{paddingInline:n},[`${i}-pagination`]:{margin:`${x(o)} ${x(P)}`}},[`${e}${i}-sm`]:{[`${i}-item,${i}-header,${i}-footer`]:{padding:g}},[`${e}${i}-lg`]:{[`${i}-item,${i}-header,${i}-footer`]:{padding:u}}}},Ke=t=>{const{componentCls:e,screenSM:i,screenMD:n,marginLG:o,marginSM:g,margin:u}=t;return{[`@media screen and (max-width:${n}px)`]:{[e]:{[`${e}-item`]:{[`${e}-item-action`]:{marginInlineStart:o}}},[`${e}-vertical`]:{[`${e}-item`]:{[`${e}-item-extra`]:{marginInlineStart:o}}}},[`@media screen and (max-width: ${i}px)`]:{[e]:{[`${e}-item`]:{flexWrap:"wrap",[`${e}-action`]:{marginInlineStart:g}}},[`${e}-vertical`]:{[`${e}-item`]:{flexWrap:"wrap-reverse",[`${e}-item-main`]:{minWidth:t.contentWidth},[`${e}-item-extra`]:{margin:`auto auto ${x(u)}`}}}}}},qe=t=>{const{componentCls:e,antCls:i,controlHeight:n,minHeight:o,paddingSM:g,marginLG:u,padding:P,itemPadding:y,colorPrimary:O,itemPaddingSM:I,itemPaddingLG:w,paddingXS:$,margin:L,colorText:S,colorTextDescription:z,motionDurationSlow:a,lineWidth:d,headerBg:s,footerBg:l,emptyTextPadding:m,metaMarginBottom:p,avatarMarginRight:C,titleMarginBottom:h,descriptionFontSize:v}=t;return{[e]:Object.assign(Object.assign({},ze(t)),{position:"relative","*":{outline:"none"},[`${e}-header`]:{background:s},[`${e}-footer`]:{background:l},[`${e}-header, ${e}-footer`]:{paddingBlock:g},[`${e}-pagination`]:{marginBlockStart:u,[`${i}-pagination-options`]:{textAlign:"start"}},[`${e}-spin`]:{minHeight:o,textAlign:"center"},[`${e}-items`]:{margin:0,padding:0,listStyle:"none"},[`${e}-item`]:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:y,color:S,[`${e}-item-meta`]:{display:"flex",flex:1,alignItems:"flex-start",maxWidth:"100%",[`${e}-item-meta-avatar`]:{marginInlineEnd:C},[`${e}-item-meta-content`]:{flex:"1 0",width:0,color:S},[`${e}-item-meta-title`]:{margin:`0 0 ${x(t.marginXXS)} 0`,color:S,fontSize:t.fontSize,lineHeight:t.lineHeight,"> a":{color:S,transition:`all ${a}`,"&:hover":{color:O}}},[`${e}-item-meta-description`]:{color:z,fontSize:v,lineHeight:t.lineHeight}},[`${e}-item-action`]:{flex:"0 0 auto",marginInlineStart:t.marginXXL,padding:0,fontSize:0,listStyle:"none","& > li":{position:"relative",display:"inline-block",padding:`0 ${x($)}`,color:z,fontSize:t.fontSize,lineHeight:t.lineHeight,textAlign:"center","&:first-child":{paddingInlineStart:0}},[`${e}-item-action-split`]:{position:"absolute",insetBlockStart:"50%",insetInlineEnd:0,width:d,height:t.calc(t.fontHeight).sub(t.calc(t.marginXXS).mul(2)).equal(),transform:"translateY(-50%)",backgroundColor:t.colorSplit}}},[`${e}-empty`]:{padding:`${x(P)} 0`,color:z,fontSize:t.fontSizeSM,textAlign:"center"},[`${e}-empty-text`]:{padding:m,color:t.colorTextDisabled,fontSize:t.fontSize,textAlign:"center"},[`${e}-item-no-flex`]:{display:"block"}}),[`${e}-grid ${i}-col > ${e}-item`]:{display:"block",maxWidth:"100%",marginBlockEnd:L,paddingBlock:0,borderBlockEnd:"none"},[`${e}-vertical ${e}-item`]:{alignItems:"initial",[`${e}-item-main`]:{display:"block",flex:1},[`${e}-item-extra`]:{marginInlineStart:u},[`${e}-item-meta`]:{marginBlockEnd:p,[`${e}-item-meta-title`]:{marginBlockStart:0,marginBlockEnd:h,color:S,fontSize:t.fontSizeLG,lineHeight:t.lineHeightLG}},[`${e}-item-action`]:{marginBlockStart:P,marginInlineStart:"auto","> li":{padding:`0 ${x(P)}`,"&:first-child":{paddingInlineStart:0}}}},[`${e}-split ${e}-item`]:{borderBlockEnd:`${x(t.lineWidth)} ${t.lineType} ${t.colorSplit}`,"&:last-child":{borderBlockEnd:"none"}},[`${e}-split ${e}-header`]:{borderBlockEnd:`${x(t.lineWidth)} ${t.lineType} ${t.colorSplit}`},[`${e}-split${e}-empty ${e}-footer`]:{borderTop:`${x(t.lineWidth)} ${t.lineType} ${t.colorSplit}`},[`${e}-loading ${e}-spin-nested-loading`]:{minHeight:n},[`${e}-split${e}-something-after-last-item ${i}-spin-container > ${e}-items > ${e}-item:last-child`]:{borderBlockEnd:`${x(t.lineWidth)} ${t.lineType} ${t.colorSplit}`},[`${e}-lg ${e}-item`]:{padding:w},[`${e}-sm ${e}-item`]:{padding:I},[`${e}:not(${e}-vertical)`]:{[`${e}-item-no-flex`]:{[`${e}-item-action`]:{float:"right"}}}}},Ye=t=>({contentWidth:220,itemPadding:`${x(t.paddingContentVertical)} 0`,itemPaddingSM:`${x(t.paddingContentVerticalSM)} ${x(t.paddingContentHorizontal)}`,itemPaddingLG:`${x(t.paddingContentVerticalLG)} ${x(t.paddingContentHorizontalLG)}`,headerBg:"transparent",footerBg:"transparent",emptyTextPadding:t.padding,metaMarginBottom:t.padding,avatarMarginRight:t.padding,titleMarginBottom:t.paddingSM,descriptionFontSize:t.fontSize}),Qe=Ie("List",t=>{const e=we(t,{listBorderedCls:`${t.componentCls}-bordered`,minHeight:t.controlHeightLG});return[qe(e),Je(e),Ke(e)]},Ye);var et=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(i[n[o]]=t[n[o]]);return i};function tt(t,e){const{pagination:i=!1,prefixCls:n,bordered:o=!1,split:g=!0,className:u,rootClassName:P,style:y,children:O,itemLayout:I,loadMore:w,grid:$,dataSource:L=[],size:S,header:z,footer:a,loading:d=!1,rowKey:s,renderItem:l,locale:m}=t,p=et(t,["pagination","prefixCls","bordered","split","className","rootClassName","style","children","itemLayout","loadMore","grid","dataSource","size","header","footer","loading","rowKey","renderItem","locale"]),C=i&&typeof i=="object"?i:{},[h,v]=r.useState(C.defaultCurrent||1),[B,se]=r.useState(C.defaultPageSize||10),{getPrefixCls:le,direction:ce,className:de,style:me}=Ne("list"),{renderEmpty:F}=r.useContext(Z),ge={current:1,total:0},K=f=>(E,_)=>{var X;v(E),se(_),i&&((X=i?.[f])===null||X===void 0||X.call(i,E,_))},pe=K("onChange"),fe=K("onShowSizeChange"),ue=(f,E)=>{if(!l)return null;let _;return typeof s=="function"?_=s(f):s?_=f[s]:_=f.key,_||(_=`list-item-${E}`),r.createElement(r.Fragment,{key:_},l(f,E))},$e=!!(w||i||a),b=le("list",n),[he,ye,xe]=Qe(b);let R=d;typeof R=="boolean"&&(R={spinning:R});const G=!!R?.spinning,Se=Oe(S);let T="";switch(Se){case"large":T="lg";break;case"small":T="sm";break}const ve=D(b,{[`${b}-vertical`]:I==="vertical",[`${b}-${T}`]:T,[`${b}-split`]:g,[`${b}-bordered`]:o,[`${b}-loading`]:G,[`${b}-grid`]:!!$,[`${b}-something-after-last-item`]:$e,[`${b}-rtl`]:ce==="rtl"},de,u,P,ye,xe),N=De(ge,{total:L.length,current:h,pageSize:B},i||{}),Ce=Math.ceil(N.total/N.pageSize);N.current=Math.min(N.current,Ce);const q=i&&r.createElement("div",{className:D(`${b}-pagination`)},r.createElement(Te,Object.assign({align:"end"},N,{onChange:pe,onShowSizeChange:fe})));let A=Q(L);i&&L.length>(N.current-1)*N.pageSize&&(A=Q(L).splice((N.current-1)*N.pageSize,N.pageSize));const be=Object.keys($||{}).some(f=>["xs","sm","md","lg","xl","xxl"].includes(f)),Y=We(be),H=r.useMemo(()=>{for(let f=0;f<ne.length;f+=1){const E=ne[f];if(Y[E])return E}},[Y]),je=r.useMemo(()=>{if(!$)return;const f=H&&$[H]?$[H]:$.column;if(f)return{width:`${100/f}%`,maxWidth:`${100/f}%`}},[JSON.stringify($),H]);let k=G&&r.createElement("div",{style:{minHeight:53}});if(A.length>0){const f=A.map(ue);k=$?r.createElement(Ae,{gutter:$.gutter},r.Children.map(f,E=>r.createElement("div",{key:E?.key,style:je},E))):r.createElement("ul",{className:`${b}-items`},f)}else!O&&!G&&(k=r.createElement("div",{className:`${b}-empty-text`},m?.emptyText||F?.("List")||r.createElement(Fe,{componentName:"List"})));const W=N.position||"bottom",Pe=r.useMemo(()=>({grid:$,itemLayout:I}),[JSON.stringify($),I]);return he(r.createElement(J.Provider,{value:Pe},r.createElement("div",Object.assign({ref:e,style:Object.assign(Object.assign({},me),y),className:ve},p),(W==="top"||W==="both")&&q,z&&r.createElement("div",{className:`${b}-header`},z),r.createElement(Le,Object.assign({},R),k,O),a&&r.createElement("div",{className:`${b}-footer`},a),w||(W==="bottom"||W==="both")&&q)))}const it=r.forwardRef(tt),U=it;U.Item=oe;const nt="_dropZone_1lbkh_1",at="_dragging_1lbkh_13",rt="_uploadIcon_1lbkh_17",ot="_fileList_1lbkh_22",st="_fileItem_1lbkh_25",lt="_fileProgress_1lbkh_32",M={dropZone:nt,dragging:at,uploadIcon:rt,fileList:ot,fileItem:st,fileProgress:lt},{Title:ae,Paragraph:ct,Text:dt}=Be,{Dragger:Ot}=Xe,Lt=()=>{const[t,e]=r.useState([]),[i,n]=r.useState(!1),o=r.useRef(null),g=r.useRef(null),u=async(a,d="")=>{const s={name:a.name,size:a.size,type:a.type,path:d?`${d}/${a.name}`:a.name,status:"uploading",progress:0};e(l=>[...l,s]);try{const l=new FormData;l.append("file",a),l.append("path",d);const m=10;for(let p=0;p<=m;p++)await new Promise(C=>setTimeout(C,200)),e(C=>C.map(h=>h.path===s.path?{...h,progress:p/m*100}:h));e(p=>p.map(C=>C.path===s.path?{...C,status:"done",progress:100}:C))}catch{e(m=>m.map(p=>p.path===s.path?{...p,status:"error",progress:0}:p)),Ve.error(`文件 ${a.name} 上传失败`)}},P=async a=>{const d=a.target.files;if(d){for(let s=0;s<d.length;s++){const l=d[s];await u(l)}a.target.value=""}},y=async a=>{const d=a.target.files;if(d){for(let s=0;s<d.length;s++){const l=d[s],m=l.webkitRelativePath.split("/").slice(0,-1).join("/");await u(l,m)}a.target.value=""}},O=()=>{o.current?.click()},I=()=>{g.current?.click()},w=async(a,d="")=>{if(a.isFile){const s=await new Promise(l=>{a.file(l)});await u(s,d)}else if(a.isDirectory){const s=a.createReader(),l=await new Promise(m=>{s.readEntries(p=>m(p))});for(const m of l){const p=d?`${d}/${m.name}`:m.name;await w(m,p)}}},$=r.useCallback(async a=>{a.preventDefault(),n(!1);const d=a.dataTransfer.items;if(d)for(let s=0;s<d.length;s++){const m=d[s].webkitGetAsEntry();m&&await w(m)}},[]),L=r.useCallback(a=>{a.preventDefault(),n(!0)},[]),S=r.useCallback(a=>{a.preventDefault(),n(!1)},[]),z=()=>c.jsx(U,{className:M.fileList,dataSource:t,renderItem:a=>c.jsx(U.Item,{children:c.jsxs("div",{className:M.fileItem,children:[c.jsxs(V,{children:[a.type.includes("directory")?c.jsx(ie,{}):c.jsx(He,{}),c.jsx(dt,{children:a.path})]}),c.jsx("div",{className:M.fileProgress,children:c.jsx(ke,{percent:a.progress,status:a.status==="error"?"exception":void 0,size:"small"})})]})})});return c.jsxs("div",{style:{maxWidth:"800px",margin:"0 auto",padding:"20px"},children:[c.jsx(ae,{level:2,children:"文件上传演示"}),c.jsx(_e,{type:"info",message:"支持多种上传方式",description:"您可以通过拖拽上传、选择文件或选择文件夹的方式上传内容。支持递归上传文件夹中的所有文件。",showIcon:!0,style:{marginBottom:"20px"}}),c.jsxs(V,{direction:"vertical",style:{width:"100%"},children:[c.jsx(te,{children:c.jsxs("div",{className:`${M.dropZone} ${i?M.dragging:""}`,onDrop:$,onDragOver:L,onDragLeave:S,children:[c.jsx(Re,{className:M.uploadIcon}),c.jsx(ae,{level:4,children:"拖拽文件或文件夹到此处上传"}),c.jsx(ct,{type:"secondary",children:"或者使用下方按钮选择文件/文件夹"}),c.jsx("input",{type:"file",ref:o,onChange:P,multiple:!0,style:{display:"none"}}),c.jsx("input",{type:"file",ref:g,onChange:y,webkitdirectory:"",style:{display:"none"}}),c.jsxs(V,{className:M.uploadButtons,children:[c.jsx(ee,{type:"primary",icon:c.jsx(Me,{}),onClick:O,children:"选择文件"}),c.jsx(ee,{icon:c.jsx(ie,{}),onClick:I,children:"选择文件夹"})]})]})}),t.length>0&&c.jsx(te,{title:"上传列表",children:z()})]})]})};export{Lt as default};
