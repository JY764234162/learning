import{r as d,j as e,T as N}from"../../main-BOLlNZH-.js";import{A as U}from"./index-BwMSiSxZ.js";import{S as m}from"./index-DTg1L3bG.js";import{C as h}from"./index-Dk1xyqhL.js";import{U as k,P as A}from"./index-BIssBIGX.js";import{R as M}from"./UploadOutlined-B5_vkMqU.js";import{F as W}from"./Table-DTs4IxHz.js";import{T as D}from"./index-DQS6MMCA.js";import"./ExclamationCircleFilled-0n3bTMwr.js";import"./InfoCircleFilled-DykvtHdN.js";import"./fade-Bf3pKLmL.js";import"./useForceUpdate-DBcsVMr6.js";import"./DownloadOutlined-Cro43qpm.js";import"./EyeOutlined-D4rLQ5k_.js";import"./addEventListener-BHaygDQX.js";import"./index-BpV4LMU8.js";import"./PurePanel-Dfe3XjZZ.js";import"./SearchOutlined-DFpz5n_d.js";import"./index-DE9VrJFo.js";import"./useBubbleLock-Dp_0LHXY.js";import"./index-B6FCVYYZ.js";import"./index-Di9IPSDA.js";import"./useBreakpoint-BZSnWJcL.js";import"./FolderOutlined-DHTYGHVA.js";import"./Input-DdI707FO.js";import"./useClosable-4jgEoneh.js";const q="_canvasWrapper_s3q6z_1",L="_canvas_s3q6z_1",E="_colorPreview_s3q6z_19",x={canvasWrapper:q,canvas:L,colorPreview:E},{Title:K,Paragraph:y,Text:a}=N,ve=()=>{const g=d.useRef(null),[j,I]=d.useState(null),[z,u]=d.useState([]),[C,v]=d.useState(!1),[l,S]=d.useState(null),$=t=>{if(t===0)return"0 B";const s=1024,i=["B","KB","MB","GB"],o=Math.floor(Math.log(t)/Math.log(s));return`${parseFloat((t/Math.pow(s,o)).toFixed(2))} ${i[o]}`},P=t=>{const s=new Image,i=g.current,o=i?.getContext("2d");return!i||!o||(v(!0),u([]),s.onload=()=>{S({width:s.width,height:s.height,aspectRatio:`${s.width}:${s.height}`,size:$(t.size)}),i.width=s.width,i.height=s.height,o.drawImage(s,0,0);const c=o.getImageData(0,0,i.width,i.height).data,p={};let f=0;const _=4;for(let r=0;r<c.length;r+=4*_){const n=c[r],T=c[r+1],b=c[r+2],B=c[r+3],w=`rgba(${n},${T},${b},${B})`;p[w]=(p[w]||0)+1,f++}const F=Object.entries(p).map(([r,n])=>({color:r,count:n,percentage:n/f*100})).sort((r,n)=>n.count-r.count).slice(0,10);u(F),v(!1)},s.src=URL.createObjectURL(t)),!1},R=[{title:"颜色预览",dataIndex:"color",key:"preview",render:t=>e.jsx("div",{className:x.colorPreview,style:{backgroundColor:t}})},{title:"颜色值",dataIndex:"color",key:"color",render:t=>e.jsx(D,{children:t})},{title:"出现频率",dataIndex:"percentage",key:"percentage",render:t=>e.jsx(A,{percent:Number(t.toFixed(2)),size:"small",status:"active"})}];return e.jsxs("div",{style:{maxWidth:"800px",margin:"0 auto",padding:"20px"},children:[e.jsx(K,{level:2,children:"图片颜色分析"}),e.jsx(U,{type:"info",message:"什么是图片颜色分析？",description:"图片颜色分析是一种通过分析图片中每个像素点的颜色信息，统计出现频率最高的颜色的技术。这种技术可以用于提取图片的主色调、生成配色方案等场景。",showIcon:!0,style:{marginBottom:"20px"}}),e.jsxs(m,{direction:"vertical",style:{width:"100%"},children:[e.jsx(h,{title:"上传图片",children:e.jsx(m,{direction:"vertical",style:{width:"100%"},children:e.jsxs(k.Dragger,{accept:"image/*",beforeUpload:P,maxCount:1,fileList:j?[j]:[],onChange:({fileList:t})=>I(t[0]),children:[e.jsx("p",{className:"ant-upload-drag-icon",children:e.jsx(M,{})}),e.jsx("p",{className:"ant-upload-text",children:"点击或拖拽图片到此区域上传"})]})})}),e.jsx(h,{title:"预览",children:e.jsx("div",{className:x.canvasWrapper,children:e.jsx("canvas",{ref:g,className:x.canvas})})}),l&&e.jsx(h,{title:"图片信息",children:e.jsxs(m,{direction:"vertical",style:{width:"100%"},children:[e.jsxs("div",{children:[e.jsx(a,{strong:!0,children:"分辨率："}),e.jsx(a,{children:`${l.width} × ${l.height}`})]}),e.jsxs("div",{children:[e.jsx(a,{strong:!0,children:"宽高比："}),e.jsx(a,{children:l.aspectRatio})]}),e.jsxs("div",{children:[e.jsx(a,{strong:!0,children:"文件大小："}),e.jsx(a,{children:l.size})]})]})}),e.jsx(h,{title:"颜色统计",loading:C,children:e.jsx(W,{dataSource:z,columns:R,pagination:!1,rowKey:"color"})}),e.jsxs(h,{title:"功能说明",children:[e.jsx(y,{children:e.jsx(a,{strong:!0,children:"实现原理："})}),e.jsxs("ul",{children:[e.jsx("li",{children:"使用 Canvas API 获取图片像素数据"}),e.jsx("li",{children:"遍历像素点统计颜色信息"}),e.jsx("li",{children:"对颜色出现频率进行排序"}),e.jsx("li",{children:"展示颜色分布情况"})]}),e.jsx(y,{children:e.jsx(a,{strong:!0,children:"应用场景："})}),e.jsxs("ul",{children:[e.jsx("li",{children:"提取图片主色调"}),e.jsx("li",{children:"生成配色方案"}),e.jsx("li",{children:"图片颜色分析"}),e.jsx("li",{children:"智能取色"})]})]})]})]})};export{ve as default};
