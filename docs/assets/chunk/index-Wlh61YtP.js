import{r as d,j as e,T as N}from"../../index-DgZa82hz.js";import{A as U}from"./index-B-9SwJtV.js";import{S as x}from"./index-CwMPLK97.js";import{C as h}from"./index-BGPQKQBB.js";import{U as k,P as A}from"./index-FuhgbAWP.js";import{R as M}from"./UploadOutlined-AgFG2ruj.js";import{F as W}from"./Table-DuEaNoPc.js";import{T as D}from"./index-B39pcK0j.js";import"./ExclamationCircleFilled-BncIX7fd.js";import"./InfoCircleFilled-FVYNa2Uj.js";import"./fade-D0QD9oKK.js";import"./useForceUpdate-DSf9r1Qg.js";import"./DownloadOutlined-CNkkDCnJ.js";import"./EyeOutlined-BrEA7xoD.js";import"./addEventListener-C03zsCJQ.js";import"./index-VOB_Yt5z.js";import"./SearchOutlined-BdmnL0xx.js";import"./index-BydYGdzA.js";import"./index-BEn8Zlyp.js";import"./useBreakpoint-CtEsIk8T.js";import"./FolderOutlined-vaxQZsJE.js";import"./Input-CoSrNVM6.js";const q="_canvasWrapper_s3q6z_1",L="_canvas_s3q6z_1",E="_colorPreview_s3q6z_19",m={canvasWrapper:q,canvas:L,colorPreview:E},{Title:K,Paragraph:y,Text:a}=N,me=()=>{const g=d.useRef(null),[j,I]=d.useState(null),[z,u]=d.useState([]),[C,f]=d.useState(!1),[l,S]=d.useState(null),$=t=>{if(t===0)return"0 B";const s=1024,r=["B","KB","MB","GB"],o=Math.floor(Math.log(t)/Math.log(s));return`${parseFloat((t/Math.pow(s,o)).toFixed(2))} ${r[o]}`},P=t=>{const s=new Image,r=g.current,o=r==null?void 0:r.getContext("2d");return!r||!o||(f(!0),u([]),s.onload=()=>{S({width:s.width,height:s.height,aspectRatio:`${s.width}:${s.height}`,size:$(t.size)}),r.width=s.width,r.height=s.height,o.drawImage(s,0,0);const c=o.getImageData(0,0,r.width,r.height).data,p={};let v=0;const _=4;for(let i=0;i<c.length;i+=4*_){const n=c[i],T=c[i+1],b=c[i+2],B=c[i+3],w=`rgba(${n},${T},${b},${B})`;p[w]=(p[w]||0)+1,v++}const F=Object.entries(p).map(([i,n])=>({color:i,count:n,percentage:n/v*100})).sort((i,n)=>n.count-i.count).slice(0,10);u(F),f(!1)},s.src=URL.createObjectURL(t)),!1},R=[{title:"颜色预览",dataIndex:"color",key:"preview",render:t=>e.jsx("div",{className:m.colorPreview,style:{backgroundColor:t}})},{title:"颜色值",dataIndex:"color",key:"color",render:t=>e.jsx(D,{children:t})},{title:"出现频率",dataIndex:"percentage",key:"percentage",render:t=>e.jsx(A,{percent:Number(t.toFixed(2)),size:"small",status:"active"})}];return e.jsxs("div",{style:{maxWidth:"800px",margin:"0 auto",padding:"20px"},children:[e.jsx(K,{level:2,children:"图片颜色分析"}),e.jsx(U,{type:"info",message:"什么是图片颜色分析？",description:"图片颜色分析是一种通过分析图片中每个像素点的颜色信息，统计出现频率最高的颜色的技术。这种技术可以用于提取图片的主色调、生成配色方案等场景。",showIcon:!0,style:{marginBottom:"20px"}}),e.jsxs(x,{direction:"vertical",style:{width:"100%"},children:[e.jsx(h,{title:"上传图片",children:e.jsx(x,{direction:"vertical",style:{width:"100%"},children:e.jsxs(k.Dragger,{accept:"image/*",beforeUpload:P,maxCount:1,fileList:j?[j]:[],onChange:({fileList:t})=>I(t[0]),children:[e.jsx("p",{className:"ant-upload-drag-icon",children:e.jsx(M,{})}),e.jsx("p",{className:"ant-upload-text",children:"点击或拖拽图片到此区域上传"})]})})}),e.jsx(h,{title:"预览",children:e.jsx("div",{className:m.canvasWrapper,children:e.jsx("canvas",{ref:g,className:m.canvas})})}),l&&e.jsx(h,{title:"图片信息",children:e.jsxs(x,{direction:"vertical",style:{width:"100%"},children:[e.jsxs("div",{children:[e.jsx(a,{strong:!0,children:"分辨率："}),e.jsx(a,{children:`${l.width} × ${l.height}`})]}),e.jsxs("div",{children:[e.jsx(a,{strong:!0,children:"宽高比："}),e.jsx(a,{children:l.aspectRatio})]}),e.jsxs("div",{children:[e.jsx(a,{strong:!0,children:"文件大小："}),e.jsx(a,{children:l.size})]})]})}),e.jsx(h,{title:"颜色统计",loading:C,children:e.jsx(W,{dataSource:z,columns:R,pagination:!1,rowKey:"color"})}),e.jsxs(h,{title:"功能说明",children:[e.jsx(y,{children:e.jsx(a,{strong:!0,children:"实现原理："})}),e.jsxs("ul",{children:[e.jsx("li",{children:"使用 Canvas API 获取图片像素数据"}),e.jsx("li",{children:"遍历像素点统计颜色信息"}),e.jsx("li",{children:"对颜色出现频率进行排序"}),e.jsx("li",{children:"展示颜色分布情况"})]}),e.jsx(y,{children:e.jsx(a,{strong:!0,children:"应用场景："})}),e.jsxs("ul",{children:[e.jsx("li",{children:"提取图片主色调"}),e.jsx("li",{children:"生成配色方案"}),e.jsx("li",{children:"图片颜色分析"}),e.jsx("li",{children:"智能取色"})]})]})]})]})};export{me as default};
