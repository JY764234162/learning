import{r as d,j as e,T as N}from"../../main-XQ0DTgpi.js";import{A as U}from"./index-CD03xB7u.js";import{S as m}from"./index-Cse7vUrK.js";import{C as h}from"./index-D_sW11Oz.js";import{U as k,P as A}from"./index-C2ghlbXX.js";import{R as M}from"./UploadOutlined-CChG3m7Z.js";import{F as W}from"./Table-guIb_KWb.js";import{T as D}from"./index-9UtVMj-4.js";import"./ExclamationCircleFilled-B59s0iqj.js";import"./InfoCircleFilled-CkKDIIwE.js";import"./fade-CHC6EYfg.js";import"./useForceUpdate-DOQGJc9n.js";import"./DownloadOutlined-DTidZHln.js";import"./EyeOutlined-B2kbRQk7.js";import"./addEventListener-jOEGWgHr.js";import"./index-hdiJc-NV.js";import"./PurePanel-pgjMOInP.js";import"./SearchOutlined-Ds--lQ3b.js";import"./index-B9ZIy19_.js";import"./useBubbleLock-DF2KTOW8.js";import"./index-jc4UuRps.js";import"./index-BnGDp6sy.js";import"./useForm-ByoMhpxd.js";import"./useBreakpoint-zt_EiFiM.js";import"./FolderOutlined-VYlJ4uNm.js";import"./extendsObject-78o_rR5W.js";import"./Input-D3EnKEGe.js";import"./useClosable-qQpRF5oc.js";const q="_canvasWrapper_s3q6z_1",L="_canvas_s3q6z_1",E="_colorPreview_s3q6z_19",x={canvasWrapper:q,canvas:L,colorPreview:E},{Title:K,Paragraph:y,Text:a}=N,we=()=>{const g=d.useRef(null),[j,I]=d.useState(null),[z,u]=d.useState([]),[C,v]=d.useState(!1),[l,S]=d.useState(null),$=t=>{if(t===0)return"0 B";const r=1024,i=["B","KB","MB","GB"],o=Math.floor(Math.log(t)/Math.log(r));return`${parseFloat((t/Math.pow(r,o)).toFixed(2))} ${i[o]}`},P=t=>{const r=new Image,i=g.current,o=i?.getContext("2d");return!i||!o||(v(!0),u([]),r.onload=()=>{S({width:r.width,height:r.height,aspectRatio:`${r.width}:${r.height}`,size:$(t.size)}),i.width=r.width,i.height=r.height,o.drawImage(r,0,0);const c=o.getImageData(0,0,i.width,i.height).data,p={};let f=0;const _=4;for(let s=0;s<c.length;s+=4*_){const n=c[s],T=c[s+1],b=c[s+2],B=c[s+3],w=`rgba(${n},${T},${b},${B})`;p[w]=(p[w]||0)+1,f++}const F=Object.entries(p).map(([s,n])=>({color:s,count:n,percentage:n/f*100})).sort((s,n)=>n.count-s.count).slice(0,10);u(F),v(!1)},r.src=URL.createObjectURL(t)),!1},R=[{title:"颜色预览",dataIndex:"color",key:"preview",render:t=>e.jsx("div",{className:x.colorPreview,style:{backgroundColor:t}})},{title:"颜色值",dataIndex:"color",key:"color",render:t=>e.jsx(D,{children:t})},{title:"出现频率",dataIndex:"percentage",key:"percentage",render:t=>e.jsx(A,{percent:Number(t.toFixed(2)),size:"small",status:"active"})}];return e.jsxs("div",{style:{maxWidth:"800px",margin:"0 auto",padding:"20px"},children:[e.jsx(K,{level:2,children:"图片颜色分析"}),e.jsx(U,{type:"info",message:"什么是图片颜色分析？",description:"图片颜色分析是一种通过分析图片中每个像素点的颜色信息，统计出现频率最高的颜色的技术。这种技术可以用于提取图片的主色调、生成配色方案等场景。",showIcon:!0,style:{marginBottom:"20px"}}),e.jsxs(m,{direction:"vertical",style:{width:"100%"},children:[e.jsx(h,{title:"上传图片",children:e.jsx(m,{direction:"vertical",style:{width:"100%"},children:e.jsxs(k.Dragger,{accept:"image/*",beforeUpload:P,maxCount:1,fileList:j?[j]:[],onChange:({fileList:t})=>I(t[0]),children:[e.jsx("p",{className:"ant-upload-drag-icon",children:e.jsx(M,{})}),e.jsx("p",{className:"ant-upload-text",children:"点击或拖拽图片到此区域上传"})]})})}),e.jsx(h,{title:"预览",children:e.jsx("div",{className:x.canvasWrapper,children:e.jsx("canvas",{ref:g,className:x.canvas})})}),l&&e.jsx(h,{title:"图片信息",children:e.jsxs(m,{direction:"vertical",style:{width:"100%"},children:[e.jsxs("div",{children:[e.jsx(a,{strong:!0,children:"分辨率："}),e.jsx(a,{children:`${l.width} × ${l.height}`})]}),e.jsxs("div",{children:[e.jsx(a,{strong:!0,children:"宽高比："}),e.jsx(a,{children:l.aspectRatio})]}),e.jsxs("div",{children:[e.jsx(a,{strong:!0,children:"文件大小："}),e.jsx(a,{children:l.size})]})]})}),e.jsx(h,{title:"颜色统计",loading:C,children:e.jsx(W,{dataSource:z,columns:R,pagination:!1,rowKey:"color"})}),e.jsxs(h,{title:"功能说明",children:[e.jsx(y,{children:e.jsx(a,{strong:!0,children:"实现原理："})}),e.jsxs("ul",{children:[e.jsx("li",{children:"使用 Canvas API 获取图片像素数据"}),e.jsx("li",{children:"遍历像素点统计颜色信息"}),e.jsx("li",{children:"对颜色出现频率进行排序"}),e.jsx("li",{children:"展示颜色分布情况"})]}),e.jsx(y,{children:e.jsx(a,{strong:!0,children:"应用场景："})}),e.jsxs("ul",{children:[e.jsx("li",{children:"提取图片主色调"}),e.jsx("li",{children:"生成配色方案"}),e.jsx("li",{children:"图片颜色分析"}),e.jsx("li",{children:"智能取色"})]})]})]})]})};export{we as default};
