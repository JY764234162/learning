var _AppOptions,_genericl10n_GenericL10n,_CaretBrowsingMode,_TextLayerBuilder,_document$blockUnbloc2,_document2;function _regeneratorKeys(e){var n=Object(e),r=[];for(var t in n)r.unshift(t);return function e(){for(;r.length;)if((t=r.pop())in n)return e.value=t,e.done=!1,e;return e.done=!0,e;};}function _regeneratorValues(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],r=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function next(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e};}};}throw new TypeError(_typeof(e)+" is not iterable");}function _superPropSet(t,e,o,r,p,f){return _set2(_getPrototypeOf(f?t.prototype:t),e,o,r,p);}function set(e,r,t,o){return set="undefined"!=typeof Reflect&&Reflect.set?Reflect.set:function(e,r,t,o){var f,i=_superPropBase(e,r);if(i){if((f=Object.getOwnPropertyDescriptor(i,r)).set)return f.set.call(o,t),!0;if(!f.writable)return!1;}if(f=Object.getOwnPropertyDescriptor(o,r)){if(!f.writable)return!1;f.value=t,Object.defineProperty(o,r,f);}else _defineProperty(o,r,t);return!0;},set(e,r,t,o);}function _set2(e,r,t,o,f){if(!set(e,r,t,o||e)&&f)throw new TypeError("failed to set property");return t;}function _checkInRHS(e){if(Object(e)!==e)throw TypeError("right-hand side of 'in' should be an object, got "+(null!==e?_typeof(e):"null"));return e;}function _classPrivateGetter(s,r,a){return a(_assertClassBrand(s,r));}function _toSetter(t,e,n){e||(e=[]);var r=e.length++;return Object.defineProperty({},"_",{set:function set(o){e[r]=o,t.apply(n,e);}});}function _classPrivateMethodInitSpec(e,a){_checkPrivateRedeclaration(e,a),a.add(e);}function _superPropGet(t,o,e,r){var p=_get2(_getPrototypeOf(1&r?t.prototype:t),o,e);return 2&r&&"function"==typeof p?function(t){return p.apply(e,t);}:p;}function _get2(){return _get2="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var p=_superPropBase(e,t);if(p){var n=Object.getOwnPropertyDescriptor(p,t);return n.get?n.get.call(arguments.length<3?e:r):n.value;}},_get2.apply(null,arguments);}function _superPropBase(t,o){for(;!{}.hasOwnProperty.call(t,o)&&null!==(t=_getPrototypeOf(t)););return t;}function _toConsumableArray(r){return _arrayWithoutHoles(r)||_iterableToArray(r)||_unsupportedIterableToArray(r)||_nonIterableSpread();}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}function _iterableToArray(r){if("undefined"!=typeof Symbol&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r);}function _arrayWithoutHoles(r){if(Array.isArray(r))return _arrayLikeToArray(r);}function _wrapNativeSuper(t){var r="function"==typeof Map?new Map():void 0;return _wrapNativeSuper=function _wrapNativeSuper(t){if(null===t||!_isNativeFunction(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==r){if(r.has(t))return r.get(t);r.set(t,Wrapper);}function Wrapper(){return _construct(t,arguments,_getPrototypeOf(this).constructor);}return Wrapper.prototype=Object.create(t.prototype,{constructor:{value:Wrapper,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(Wrapper,t);},_wrapNativeSuper(t);}function _construct(t,e,r){if(_isNativeReflectConstruct())return Reflect.construct.apply(null,arguments);var o=[null];o.push.apply(o,e);var p=new(t.bind.apply(t,o))();return r&&_setPrototypeOf(p,r.prototype),p;}function _isNativeFunction(t){try{return-1!==Function.toString.call(t).indexOf("[native code]");}catch(n){return"function"==typeof t;}}function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable;})),t.push.apply(t,o);}return t;}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r){_defineProperty(e,r,t[r]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r));});}return e;}function _callSuper(t,o,e){return o=_getPrototypeOf(o),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(o,e||[],_getPrototypeOf(t).constructor):o.apply(t,e));}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t);}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));}catch(t){}return(_isNativeReflectConstruct=function _isNativeReflectConstruct(){return!!t;})();}function _getPrototypeOf(t){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t);},_getPrototypeOf(t);}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e);}function _setPrototypeOf(t,e){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t;},_setPrototypeOf(t,e);}function _regenerator(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function i(r,n,o,i){var c=n&&n.prototype instanceof Generator?n:Generator,u=Object.create(c.prototype);return _regeneratorDefine2(u,"_invoke",function(r,n,o){var i,c,u,f=0,p=o||[],y=!1,G={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function d(t,r){return i=t,c=0,u=e,G.n=r,a;}};function d(r,n){for(c=r,u=n,t=0;!y&&f&&!o&&t<p.length;t++){var o,i=p[t],d=G.p,l=i[2];r>3?(o=l===n)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=d&&((o=r<2&&d<i[1])?(c=0,G.v=n,G.n=i[1]):d<l&&(o=r<3||i[0]>n||n>l)&&(i[4]=r,i[5]=n,G.n=l,c=0));}if(o||r>1)return a;throw y=!0,n;}return function(o,p,l){if(f>1)throw TypeError("Generator is already running");for(y&&1===p&&d(p,l),c=p,u=l;(t=c<2?e:u)||!y;){i||(c?c<3?(c>1&&(G.n=-1),d(c,u)):G.n=u:G.v=u);try{if(f=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0);}else 1===c&&(t=i["return"])&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e;}else if((t=(y=G.n<0)?u:r.call(n,G))!==a)break;}catch(t){i=e,c=1,u=t;}finally{f=1;}}return{value:t,done:y};};}(r,o,i),!0),u;}var a={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}t=Object.getPrototypeOf;var c=[][n]?t(t([][n]())):(_regeneratorDefine2(t={},n,function(){return this;}),t),u=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(c);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,GeneratorFunctionPrototype):(e.__proto__=GeneratorFunctionPrototype,_regeneratorDefine2(e,o,"GeneratorFunction")),e.prototype=Object.create(u),e;}return GeneratorFunction.prototype=GeneratorFunctionPrototype,_regeneratorDefine2(u,"constructor",GeneratorFunctionPrototype),_regeneratorDefine2(GeneratorFunctionPrototype,"constructor",GeneratorFunction),GeneratorFunction.displayName="GeneratorFunction",_regeneratorDefine2(GeneratorFunctionPrototype,o,"GeneratorFunction"),_regeneratorDefine2(u),_regeneratorDefine2(u,o,"Generator"),_regeneratorDefine2(u,n,function(){return this;}),_regeneratorDefine2(u,"toString",function(){return"[object Generator]";}),(_regenerator=function _regenerator(){return{w:i,m:f};})();}function _regeneratorDefine2(e,r,n,t){var i=Object.defineProperty;try{i({},"",{});}catch(e){i=0;}_regeneratorDefine2=function _regeneratorDefine(e,r,n,t){if(r)i?i(e,r,{value:n,enumerable:!t,configurable:!t,writable:!t}):e[r]=n;else{var o=function o(r,n){_regeneratorDefine2(e,r,function(e){return this._invoke(r,n,e);});};o("next",0),o("throw",1),o("return",2);}},_regeneratorDefine2(e,r,n,t);}function asyncGeneratorStep(n,t,e,r,o,a,c){try{var i=n[a](c),u=i.value;}catch(n){return void e(n);}i.done?t(u):Promise.resolve(u).then(r,o);}function _asyncToGenerator(n){return function(){var t=this,e=arguments;return new Promise(function(r,o){var a=n.apply(t,e);function _next(n){asyncGeneratorStep(a,r,o,_next,_throw,"next",n);}function _throw(n){asyncGeneratorStep(a,r,o,_next,_throw,"throw",n);}_next(void 0);});};}function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o;}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o;},_typeof(o);}function _defineProperty(e,r,t){return(r=_toPropertyKey(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e;}function _classCallCheck(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function");}function _defineProperties(e,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o);}}function _createClass(e,r,t){return r&&_defineProperties(e.prototype,r),t&&_defineProperties(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e;}function _toPropertyKey(t){var i=_toPrimitive(t,"string");return"symbol"==_typeof(i)?i:i+"";}function _toPrimitive(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===r?String:Number)(t);}function _classPrivateFieldInitSpec(e,t,a){_checkPrivateRedeclaration(e,t),t.set(e,a);}function _checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object");}function _classPrivateFieldGet(s,a){return s.get(_assertClassBrand(s,a));}function _classPrivateFieldSet(s,a,r){return s.set(_assertClassBrand(s,a),r),r;}function _assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object");}function _slicedToArray(r,e){return _arrayWithHoles(r)||_iterableToArrayLimit(r,e)||_unsupportedIterableToArray(r,e)||_nonIterableRest();}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}function _iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1;}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r;}finally{try{if(!f&&null!=t["return"]&&(u=t["return"](),Object(u)!==u))return;}finally{if(o)throw n;}}return a;}}function _arrayWithHoles(r){if(Array.isArray(r))return r;}function _createForOfIteratorHelper(r,e){var t="undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(!t){if(Array.isArray(r)||(t=_unsupportedIterableToArray(r))||e&&r&&"number"==typeof r.length){t&&(r=t);var _n=0,F=function F(){};return{s:F,n:function n(){return _n>=r.length?{done:!0}:{done:!1,value:r[_n++]};},e:function e(r){throw r;},f:F};}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}var o,a=!0,u=!1;return{s:function s(){t=t.call(r);},n:function n(){var r=t.next();return a=r.done,r;},e:function e(r){u=!0,o=r;},f:function f(){try{a||null==t["return"]||t["return"]();}finally{if(u)throw o;}}};}function _unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return _arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(r,a):void 0;}}function _arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n;}function _awaitAsyncGenerator(e){return new _OverloadYield(e,0);}function _wrapAsyncGenerator(e){return function(){return new AsyncGenerator(e.apply(this,arguments));};}function AsyncGenerator(e){var r,t;function resume(r,t){try{var n=e[r](t),o=n.value,u=o instanceof _OverloadYield;Promise.resolve(u?o.v:o).then(function(t){if(u){var i="return"===r?"return":"next";if(!o.k||t.done)return resume(i,t);t=e[i](t).value;}settle(n.done?"return":"normal",t);},function(e){resume("throw",e);});}catch(e){settle("throw",e);}}function settle(e,n){switch(e){case"return":r.resolve({value:n,done:!0});break;case"throw":r.reject(n);break;default:r.resolve({value:n,done:!1});}(r=r.next)?resume(r.key,r.arg):t=null;}this._invoke=function(e,n){return new Promise(function(o,u){var i={key:e,arg:n,resolve:o,reject:u,next:null};t?t=t.next=i:(r=t=i,resume(e,n));});},"function"!=typeof e["return"]&&(this["return"]=void 0);}AsyncGenerator.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this;},AsyncGenerator.prototype.next=function(e){return this._invoke("next",e);},AsyncGenerator.prototype["throw"]=function(e){return this._invoke("throw",e);},AsyncGenerator.prototype["return"]=function(e){return this._invoke("return",e);};function _OverloadYield(e,d){this.v=e,this.k=d;}function _asyncIterator(r){var n,t,o,e=2;for("undefined"!=typeof Symbol&&(t=Symbol.asyncIterator,o=Symbol.iterator);e--;){if(t&&null!=(n=r[t]))return n.call(r);if(o&&null!=(n=r[o]))return new AsyncFromSyncIterator(n.call(r));t="@@asyncIterator",o="@@iterator";}throw new TypeError("Object is not async iterable");}function AsyncFromSyncIterator(r){function AsyncFromSyncIteratorContinuation(r){if(Object(r)!==r)return Promise.reject(new TypeError(r+" is not an object."));var n=r.done;return Promise.resolve(r.value).then(function(r){return{value:r,done:n};});}return AsyncFromSyncIterator=function AsyncFromSyncIterator(r){this.s=r,this.n=r.next;},AsyncFromSyncIterator.prototype={s:null,n:null,next:function next(){return AsyncFromSyncIteratorContinuation(this.n.apply(this.s,arguments));},"return":function _return(r){var n=this.s["return"];return void 0===n?Promise.resolve({value:r,done:!0}):AsyncFromSyncIteratorContinuation(n.apply(this.s,arguments));},"throw":function _throw(r){var n=this.s["return"];return void 0===n?Promise.reject(r):AsyncFromSyncIteratorContinuation(n.apply(this.s,arguments));}},new AsyncFromSyncIterator(r);}/**
 * @licstart The following is the entire license notice for the
 * JavaScript code in this page
 *
 * Copyright 2024 Mozilla Foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * @licend The above is the entire license notice for the
 * JavaScript code in this page
 *//******/// The require scope
/******/var __webpack_require__={};/******//************************************************************************//******//* webpack/runtime/define property getters *//******/(function(){/******/// define getter functions for harmony exports
/******/__webpack_require__.d=function(exports,definition){/******/for(var key in definition){/******/if(__webpack_require__.o(definition,key)&&!__webpack_require__.o(exports,key)){/******/Object.defineProperty(exports,key,{enumerable:true,get:definition[key]});/******/}/******/}/******/};/******/})();/******//******//* webpack/runtime/hasOwnProperty shorthand *//******/(function(){/******/__webpack_require__.o=function(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop);};/******/})();/******//************************************************************************/var __webpack_exports__={};// EXPORTS
__webpack_require__.d(__webpack_exports__,{PDFViewerApplication:function PDFViewerApplication(){return/* reexport */_PDFViewerApplication;},PDFViewerApplicationConstants:function PDFViewerApplicationConstants(){return/* binding */AppConstants;},PDFViewerApplicationOptions:function PDFViewerApplicationOptions(){return/* reexport */AppOptions;}});;// ./web/pdfjs.js
var _globalThis$pdfjsLib=globalThis.pdfjsLib,AbortException=_globalThis$pdfjsLib.AbortException,AnnotationEditorLayer=_globalThis$pdfjsLib.AnnotationEditorLayer,AnnotationEditorParamsType=_globalThis$pdfjsLib.AnnotationEditorParamsType,AnnotationEditorType=_globalThis$pdfjsLib.AnnotationEditorType,AnnotationEditorUIManager=_globalThis$pdfjsLib.AnnotationEditorUIManager,AnnotationLayer=_globalThis$pdfjsLib.AnnotationLayer,AnnotationMode=_globalThis$pdfjsLib.AnnotationMode,AnnotationType=_globalThis$pdfjsLib.AnnotationType,build=_globalThis$pdfjsLib.build,ColorPicker=_globalThis$pdfjsLib.ColorPicker,createValidAbsoluteUrl=_globalThis$pdfjsLib.createValidAbsoluteUrl,DOMSVGFactory=_globalThis$pdfjsLib.DOMSVGFactory,DrawLayer=_globalThis$pdfjsLib.DrawLayer,FeatureTest=_globalThis$pdfjsLib.FeatureTest,fetchData=_globalThis$pdfjsLib.fetchData,getDocument=_globalThis$pdfjsLib.getDocument,getFilenameFromUrl=_globalThis$pdfjsLib.getFilenameFromUrl,pdfjs_getPdfFilenameFromUrl=_globalThis$pdfjsLib.getPdfFilenameFromUrl,getUuid=_globalThis$pdfjsLib.getUuid,getXfaPageViewport=_globalThis$pdfjsLib.getXfaPageViewport,GlobalWorkerOptions=_globalThis$pdfjsLib.GlobalWorkerOptions,ImageKind=_globalThis$pdfjsLib.ImageKind,InvalidPDFException=_globalThis$pdfjsLib.InvalidPDFException,isDataScheme=_globalThis$pdfjsLib.isDataScheme,isPdfFile=_globalThis$pdfjsLib.isPdfFile,isValidExplicitDest=_globalThis$pdfjsLib.isValidExplicitDest,MathClamp=_globalThis$pdfjsLib.MathClamp,noContextMenu=_globalThis$pdfjsLib.noContextMenu,normalizeUnicode=_globalThis$pdfjsLib.normalizeUnicode,OPS=_globalThis$pdfjsLib.OPS,OutputScale=_globalThis$pdfjsLib.OutputScale,PasswordResponses=_globalThis$pdfjsLib.PasswordResponses,PDFDataRangeTransport=_globalThis$pdfjsLib.PDFDataRangeTransport,PDFDateString=_globalThis$pdfjsLib.PDFDateString,PDFWorker=_globalThis$pdfjsLib.PDFWorker,PermissionFlag=_globalThis$pdfjsLib.PermissionFlag,PixelsPerInch=_globalThis$pdfjsLib.PixelsPerInch,RenderingCancelledException=_globalThis$pdfjsLib.RenderingCancelledException,ResponseException=_globalThis$pdfjsLib.ResponseException,setLayerDimensions=_globalThis$pdfjsLib.setLayerDimensions,shadow=_globalThis$pdfjsLib.shadow,SignatureExtractor=_globalThis$pdfjsLib.SignatureExtractor,stopEvent=_globalThis$pdfjsLib.stopEvent,SupportedImageMimeTypes=_globalThis$pdfjsLib.SupportedImageMimeTypes,TextLayer=_globalThis$pdfjsLib.TextLayer,TouchManager=_globalThis$pdfjsLib.TouchManager,Util=_globalThis$pdfjsLib.Util,VerbosityLevel=_globalThis$pdfjsLib.VerbosityLevel,version=_globalThis$pdfjsLib.version,XfaLayer=_globalThis$pdfjsLib.XfaLayer;;// ./web/ui_utils.js
var DEFAULT_SCALE_VALUE="auto";var DEFAULT_SCALE=1.0;var DEFAULT_SCALE_DELTA=1.1;var MIN_SCALE=0.1;var MAX_SCALE=10.0;var UNKNOWN_SCALE=0;var MAX_AUTO_SCALE=1.25;var SCROLLBAR_PADDING=40;var VERTICAL_PADDING=5;var RenderingStates={INITIAL:0,RUNNING:1,PAUSED:2,FINISHED:3};var PresentationModeState={UNKNOWN:0,NORMAL:1,CHANGING:2,FULLSCREEN:3};var SidebarView={UNKNOWN:-1,NONE:0,THUMBS:1,OUTLINE:2,ATTACHMENTS:3,LAYERS:4};var TextLayerMode={DISABLE:0,ENABLE:1,ENABLE_PERMISSIONS:2};var ScrollMode={UNKNOWN:-1,VERTICAL:0,HORIZONTAL:1,WRAPPED:2,PAGE:3};var SpreadMode={UNKNOWN:-1,NONE:0,ODD:1,EVEN:2};var CursorTool={SELECT:0,HAND:1,ZOOM:2};var AutoPrintRegExp=/\bprint\s*\(/;function scrollIntoView(element,spot){var scrollMatches=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var parent=element.offsetParent;if(!parent){console.error("offsetParent is not set -- cannot scroll");return;}var offsetY=element.offsetTop+element.clientTop;var offsetX=element.offsetLeft+element.clientLeft;while(parent.clientHeight===parent.scrollHeight&&parent.clientWidth===parent.scrollWidth||scrollMatches&&(parent.classList.contains("markedContent")||getComputedStyle(parent).overflow==="hidden")){offsetY+=parent.offsetTop;offsetX+=parent.offsetLeft;parent=parent.offsetParent;if(!parent){return;}}if(spot){if(spot.top!==undefined){offsetY+=spot.top;}if(spot.left!==undefined){offsetX+=spot.left;parent.scrollLeft=offsetX;}}parent.scrollTop=offsetY;}function watchScroll(viewAreaElement,callback){var abortSignal=arguments.length>2&&arguments[2]!==undefined?arguments[2]:undefined;var debounceScroll=function debounceScroll(evt){if(rAF){return;}rAF=window.requestAnimationFrame(function viewAreaElementScrolled(){rAF=null;var currentX=viewAreaElement.scrollLeft;var lastX=state.lastX;if(currentX!==lastX){state.right=currentX>lastX;}state.lastX=currentX;var currentY=viewAreaElement.scrollTop;var lastY=state.lastY;if(currentY!==lastY){state.down=currentY>lastY;}state.lastY=currentY;callback(state);});};var state={right:true,down:true,lastX:viewAreaElement.scrollLeft,lastY:viewAreaElement.scrollTop,_eventHandler:debounceScroll};var rAF=null;viewAreaElement.addEventListener("scroll",debounceScroll,{useCapture:true,signal:abortSignal});abortSignal===null||abortSignal===void 0||abortSignal.addEventListener("abort",function(){return window.cancelAnimationFrame(rAF);},{once:true});return state;}function parseQueryString(query){var params=new Map();var _iterator2=_createForOfIteratorHelper(new URLSearchParams(query)),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var _step2$value=_slicedToArray(_step2.value,2),key=_step2$value[0],value=_step2$value[1];params.set(key.toLowerCase(),value);}}catch(err){_iterator2.e(err);}finally{_iterator2.f();}return params;}var InvisibleCharsRegExp=/[\x00-\x1F]/g;function removeNullCharacters(str){var replaceInvisible=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(!InvisibleCharsRegExp.test(str)){return str;}if(replaceInvisible){return str.replaceAll(InvisibleCharsRegExp,function(m){return m==="\x00"?"":" ";});}return str.replaceAll("\x00","");}function binarySearchFirstItem(items,condition){var start=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;var minIndex=start;var maxIndex=items.length-1;if(maxIndex<0||!condition(items[maxIndex])){return items.length;}if(condition(items[minIndex])){return minIndex;}while(minIndex<maxIndex){var currentIndex=minIndex+maxIndex>>1;var currentItem=items[currentIndex];if(condition(currentItem)){maxIndex=currentIndex;}else{minIndex=currentIndex+1;}}return minIndex;}function approximateFraction(x){if(Math.floor(x)===x){return[x,1];}var xinv=1/x;var limit=8;if(xinv>limit){return[1,limit];}else if(Math.floor(xinv)===xinv){return[1,xinv];}var x_=x>1?xinv:x;var a=0,b=1,c=1,d=1;while(true){var p=a+c,q=b+d;if(q>limit){break;}if(x_<=p/q){c=p;d=q;}else{a=p;b=q;}}var result;if(x_-a/b<c/d-x_){result=x_===x?[a,b]:[b,a];}else{result=x_===x?[c,d]:[d,c];}return result;}function floorToDivide(x,div){return x-x%div;}function getPageSizeInches(_ref){var view=_ref.view,userUnit=_ref.userUnit,rotate=_ref.rotate;var _view=_slicedToArray(view,4),x1=_view[0],y1=_view[1],x2=_view[2],y2=_view[3];var changeOrientation=rotate%180!==0;var width=(x2-x1)/72*userUnit;var height=(y2-y1)/72*userUnit;return{width:changeOrientation?height:width,height:changeOrientation?width:height};}function backtrackBeforeAllVisibleElements(index,views,top){if(index<2){return index;}var elt=views[index].div;var pageTop=elt.offsetTop+elt.clientTop;if(pageTop>=top){elt=views[index-1].div;pageTop=elt.offsetTop+elt.clientTop;}for(var i=index-2;i>=0;--i){elt=views[i].div;if(elt.offsetTop+elt.clientTop+elt.clientHeight<=pageTop){break;}index=i;}return index;}function getVisibleElements(_ref2){var scrollEl=_ref2.scrollEl,views=_ref2.views,_ref2$sortByVisibilit=_ref2.sortByVisibility,sortByVisibility=_ref2$sortByVisibilit===void 0?false:_ref2$sortByVisibilit,_ref2$horizontal=_ref2.horizontal,horizontal=_ref2$horizontal===void 0?false:_ref2$horizontal,_ref2$rtl=_ref2.rtl,rtl=_ref2$rtl===void 0?false:_ref2$rtl;var top=scrollEl.scrollTop,bottom=top+scrollEl.clientHeight;var left=scrollEl.scrollLeft,right=left+scrollEl.clientWidth;function isElementBottomAfterViewTop(view){var element=view.div;var elementBottom=element.offsetTop+element.clientTop+element.clientHeight;return elementBottom>top;}function isElementNextAfterViewHorizontally(view){var element=view.div;var elementLeft=element.offsetLeft+element.clientLeft;var elementRight=elementLeft+element.clientWidth;return rtl?elementLeft<right:elementRight>left;}var visible=[],ids=new Set(),numViews=views.length;var firstVisibleElementInd=binarySearchFirstItem(views,horizontal?isElementNextAfterViewHorizontally:isElementBottomAfterViewTop);if(firstVisibleElementInd>0&&firstVisibleElementInd<numViews&&!horizontal){firstVisibleElementInd=backtrackBeforeAllVisibleElements(firstVisibleElementInd,views,top);}var lastEdge=horizontal?right:-1;for(var i=firstVisibleElementInd;i<numViews;i++){var view=views[i],element=view.div;var currentWidth=element.offsetLeft+element.clientLeft;var currentHeight=element.offsetTop+element.clientTop;var viewWidth=element.clientWidth,viewHeight=element.clientHeight;var viewRight=currentWidth+viewWidth;var viewBottom=currentHeight+viewHeight;if(lastEdge===-1){if(viewBottom>=bottom){lastEdge=viewBottom;}}else if((horizontal?currentWidth:currentHeight)>lastEdge){break;}if(viewBottom<=top||currentHeight>=bottom||viewRight<=left||currentWidth>=right){continue;}var minY=Math.max(0,top-currentHeight);var minX=Math.max(0,left-currentWidth);var hiddenHeight=minY+Math.max(0,viewBottom-bottom);var hiddenWidth=minX+Math.max(0,viewRight-right);var fractionHeight=(viewHeight-hiddenHeight)/viewHeight,fractionWidth=(viewWidth-hiddenWidth)/viewWidth;var percent=fractionHeight*fractionWidth*100|0;visible.push({id:view.id,x:currentWidth,y:currentHeight,visibleArea:percent===100?null:{minX:minX,minY:minY,maxX:Math.min(viewRight,right)-currentWidth,maxY:Math.min(viewBottom,bottom)-currentHeight},view:view,percent:percent,widthPercent:fractionWidth*100|0});ids.add(view.id);}var first=visible[0],last=visible.at(-1);if(sortByVisibility){visible.sort(function(a,b){var pc=a.percent-b.percent;if(Math.abs(pc)>0.001){return-pc;}return a.id-b.id;});}return{first:first,last:last,views:visible,ids:ids};}function normalizeWheelEventDirection(evt){var delta=Math.hypot(evt.deltaX,evt.deltaY);var angle=Math.atan2(evt.deltaY,evt.deltaX);if(-0.25*Math.PI<angle&&angle<0.75*Math.PI){delta=-delta;}return delta;}function normalizeWheelEventDelta(evt){var deltaMode=evt.deltaMode;var delta=normalizeWheelEventDirection(evt);var MOUSE_PIXELS_PER_LINE=30;var MOUSE_LINES_PER_PAGE=30;if(deltaMode===WheelEvent.DOM_DELTA_PIXEL){delta/=MOUSE_PIXELS_PER_LINE*MOUSE_LINES_PER_PAGE;}else if(deltaMode===WheelEvent.DOM_DELTA_LINE){delta/=MOUSE_LINES_PER_PAGE;}return delta;}function isValidRotation(angle){return Number.isInteger(angle)&&angle%90===0;}function isValidScrollMode(mode){return Number.isInteger(mode)&&Object.values(ScrollMode).includes(mode)&&mode!==ScrollMode.UNKNOWN;}function isValidSpreadMode(mode){return Number.isInteger(mode)&&Object.values(SpreadMode).includes(mode)&&mode!==SpreadMode.UNKNOWN;}function isPortraitOrientation(size){return size.width<=size.height;}var animationStarted=new Promise(function(resolve){window.requestAnimationFrame(resolve);});var docStyle=document.documentElement.style;var _classList=/*#__PURE__*/new WeakMap();var _disableAutoFetchTimeout=/*#__PURE__*/new WeakMap();var _percent=/*#__PURE__*/new WeakMap();var _style=/*#__PURE__*/new WeakMap();var _visible=/*#__PURE__*/new WeakMap();var ProgressBar=/*#__PURE__*/function(){function ProgressBar(bar){_classCallCheck(this,ProgressBar);_classPrivateFieldInitSpec(this,_classList,null);_classPrivateFieldInitSpec(this,_disableAutoFetchTimeout,null);_classPrivateFieldInitSpec(this,_percent,0);_classPrivateFieldInitSpec(this,_style,null);_classPrivateFieldInitSpec(this,_visible,true);_classPrivateFieldSet(_classList,this,bar.classList);_classPrivateFieldSet(_style,this,bar.style);}return _createClass(ProgressBar,[{key:"percent",get:function get(){return _classPrivateFieldGet(_percent,this);},set:function set(val){_classPrivateFieldSet(_percent,this,MathClamp(val,0,100));if(isNaN(val)){_classPrivateFieldGet(_classList,this).add("indeterminate");return;}_classPrivateFieldGet(_classList,this).remove("indeterminate");_classPrivateFieldGet(_style,this).setProperty("--progressBar-percent","".concat(_classPrivateFieldGet(_percent,this),"%"));}},{key:"setWidth",value:function setWidth(viewer){if(!viewer){return;}var container=viewer.parentNode;var scrollbarWidth=container.offsetWidth-viewer.offsetWidth;if(scrollbarWidth>0){_classPrivateFieldGet(_style,this).setProperty("--progressBar-end-offset","".concat(scrollbarWidth,"px"));}}},{key:"setDisableAutoFetch",value:function setDisableAutoFetch(){var _this3=this;var delay=arguments.length>0&&arguments[0]!==undefined?arguments[0]:5000;if(_classPrivateFieldGet(_percent,this)===100||isNaN(_classPrivateFieldGet(_percent,this))){return;}if(_classPrivateFieldGet(_disableAutoFetchTimeout,this)){clearTimeout(_classPrivateFieldGet(_disableAutoFetchTimeout,this));}this.show();_classPrivateFieldSet(_disableAutoFetchTimeout,this,setTimeout(function(){_classPrivateFieldSet(_disableAutoFetchTimeout,_this3,null);_this3.hide();},delay));}},{key:"hide",value:function hide(){if(!_classPrivateFieldGet(_visible,this)){return;}_classPrivateFieldSet(_visible,this,false);_classPrivateFieldGet(_classList,this).add("hidden");}},{key:"show",value:function show(){if(_classPrivateFieldGet(_visible,this)){return;}_classPrivateFieldSet(_visible,this,true);_classPrivateFieldGet(_classList,this).remove("hidden");}}]);}();function getActiveOrFocusedElement(){var curRoot=document;var curActiveOrFocused=curRoot.activeElement||curRoot.querySelector(":focus");while((_curActiveOrFocused=curActiveOrFocused)!==null&&_curActiveOrFocused!==void 0&&_curActiveOrFocused.shadowRoot){var _curActiveOrFocused;curRoot=curActiveOrFocused.shadowRoot;curActiveOrFocused=curRoot.activeElement||curRoot.querySelector(":focus");}return curActiveOrFocused;}function apiPageLayoutToViewerModes(layout){var scrollMode=ScrollMode.VERTICAL,spreadMode=SpreadMode.NONE;switch(layout){case"SinglePage":scrollMode=ScrollMode.PAGE;break;case"OneColumn":break;case"TwoPageLeft":scrollMode=ScrollMode.PAGE;case"TwoColumnLeft":spreadMode=SpreadMode.ODD;break;case"TwoPageRight":scrollMode=ScrollMode.PAGE;case"TwoColumnRight":spreadMode=SpreadMode.EVEN;break;}return{scrollMode:scrollMode,spreadMode:spreadMode};}function apiPageModeToSidebarView(mode){switch(mode){case"UseNone":return SidebarView.NONE;case"UseThumbs":return SidebarView.THUMBS;case"UseOutlines":return SidebarView.OUTLINE;case"UseAttachments":return SidebarView.ATTACHMENTS;case"UseOC":return SidebarView.LAYERS;}return SidebarView.NONE;}function toggleCheckedBtn(button,toggle){var view=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;button.classList.toggle("toggled",toggle);button.setAttribute("aria-checked",toggle);view===null||view===void 0||view.classList.toggle("hidden",!toggle);}function toggleExpandedBtn(button,toggle){var view=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;button.classList.toggle("toggled",toggle);button.setAttribute("aria-expanded",toggle);view===null||view===void 0||view.classList.toggle("hidden",!toggle);}var calcRound=function(){var e=document.createElement("div");e.style.width="round(down, calc(1.6666666666666665 * 792px), 1px)";return e.style.width==="calc(1320px)"?Math.fround:function(x){return x;};}();;// ./web/app_options.js
{var compatParams=new Map();var userAgent=navigator.userAgent||"";var platform=navigator.platform||"";var maxTouchPoints=navigator.maxTouchPoints||1;var isAndroid=/Android/.test(userAgent);var isIOS=/\b(iPad|iPhone|iPod)(?=;)/.test(userAgent)||platform==="MacIntel"&&maxTouchPoints>1;(function(){if(isIOS||isAndroid){compatParams.set("maxCanvasPixels",5242880);}})();(function(){if(isAndroid){compatParams.set("useSystemFonts",false);}})();}var OptionKind={BROWSER:0x01,VIEWER:0x02,API:0x04,WORKER:0x08,EVENT_DISPATCH:0x10,PREFERENCE:0x80};var Type={BOOLEAN:0x01,NUMBER:0x02,OBJECT:0x04,STRING:0x08,UNDEFINED:0x10};var defaultOptions={allowedGlobalEvents:{value:null,kind:OptionKind.BROWSER},canvasMaxAreaInBytes:{value:-1,kind:OptionKind.BROWSER+OptionKind.API},isInAutomation:{value:false,kind:OptionKind.BROWSER},localeProperties:{value:{lang:navigator.language||"en-US"},kind:OptionKind.BROWSER},maxCanvasDim:{value:32767,kind:OptionKind.BROWSER+OptionKind.VIEWER},nimbusDataStr:{value:"",kind:OptionKind.BROWSER},supportsCaretBrowsingMode:{value:false,kind:OptionKind.BROWSER},supportsDocumentFonts:{value:true,kind:OptionKind.BROWSER},supportsIntegratedFind:{value:false,kind:OptionKind.BROWSER},supportsMouseWheelZoomCtrlKey:{value:true,kind:OptionKind.BROWSER},supportsMouseWheelZoomMetaKey:{value:true,kind:OptionKind.BROWSER},supportsPinchToZoom:{value:true,kind:OptionKind.BROWSER},toolbarDensity:{value:0,kind:OptionKind.BROWSER+OptionKind.EVENT_DISPATCH},altTextLearnMoreUrl:{value:"",kind:OptionKind.VIEWER+OptionKind.PREFERENCE},annotationEditorMode:{value:0,kind:OptionKind.VIEWER+OptionKind.PREFERENCE},annotationMode:{value:2,kind:OptionKind.VIEWER+OptionKind.PREFERENCE},cursorToolOnLoad:{value:0,kind:OptionKind.VIEWER+OptionKind.PREFERENCE},debuggerSrc:{value:"./debugger.mjs",kind:OptionKind.VIEWER},defaultZoomDelay:{value:400,kind:OptionKind.VIEWER+OptionKind.PREFERENCE},defaultZoomValue:{value:"",kind:OptionKind.VIEWER+OptionKind.PREFERENCE},disableHistory:{value:false,kind:OptionKind.VIEWER},disablePageLabels:{value:false,kind:OptionKind.VIEWER+OptionKind.PREFERENCE},enableAltText:{value:false,kind:OptionKind.VIEWER+OptionKind.PREFERENCE},enableAltTextModelDownload:{value:true,kind:OptionKind.VIEWER+OptionKind.PREFERENCE+OptionKind.EVENT_DISPATCH},enableAutoLinking:{value:true,kind:OptionKind.VIEWER+OptionKind.PREFERENCE},enableDetailCanvas:{value:true,kind:OptionKind.VIEWER},enableGuessAltText:{value:true,kind:OptionKind.VIEWER+OptionKind.PREFERENCE+OptionKind.EVENT_DISPATCH},enableHighlightFloatingButton:{value:false,kind:OptionKind.VIEWER+OptionKind.PREFERENCE},enableNewAltTextWhenAddingImage:{value:true,kind:OptionKind.VIEWER+OptionKind.PREFERENCE},enablePermissions:{value:false,kind:OptionKind.VIEWER+OptionKind.PREFERENCE},enablePrintAutoRotate:{value:true,kind:OptionKind.VIEWER+OptionKind.PREFERENCE},enableScripting:{value:true,kind:OptionKind.VIEWER+OptionKind.PREFERENCE},enableSignatureEditor:{value:false,kind:OptionKind.VIEWER+OptionKind.PREFERENCE},enableUpdatedAddImage:{value:false,kind:OptionKind.VIEWER+OptionKind.PREFERENCE},externalLinkRel:{value:"noopener noreferrer nofollow",kind:OptionKind.VIEWER},externalLinkTarget:{value:0,kind:OptionKind.VIEWER+OptionKind.PREFERENCE},highlightEditorColors:{value:"yellow=#FFFF98,green=#53FFBC,blue=#80EBFF,pink=#FFCBE6,red=#FF4F5F",kind:OptionKind.VIEWER+OptionKind.PREFERENCE},historyUpdateUrl:{value:false,kind:OptionKind.VIEWER+OptionKind.PREFERENCE},ignoreDestinationZoom:{value:false,kind:OptionKind.VIEWER+OptionKind.PREFERENCE},imageResourcesPath:{value:"./images/",kind:OptionKind.VIEWER},maxCanvasPixels:{value:Math.pow(2,25),kind:OptionKind.VIEWER},forcePageColors:{value:false,kind:OptionKind.VIEWER+OptionKind.PREFERENCE},pageColorsBackground:{value:"Canvas",kind:OptionKind.VIEWER+OptionKind.PREFERENCE},pageColorsForeground:{value:"CanvasText",kind:OptionKind.VIEWER+OptionKind.PREFERENCE},pdfBugEnabled:{value:false,kind:OptionKind.VIEWER+OptionKind.PREFERENCE},printResolution:{value:150,kind:OptionKind.VIEWER},sidebarViewOnLoad:{value:-1,kind:OptionKind.VIEWER+OptionKind.PREFERENCE},scrollModeOnLoad:{value:-1,kind:OptionKind.VIEWER+OptionKind.PREFERENCE},spreadModeOnLoad:{value:-1,kind:OptionKind.VIEWER+OptionKind.PREFERENCE},textLayerMode:{value:1,kind:OptionKind.VIEWER+OptionKind.PREFERENCE},viewerCssTheme:{value:0,kind:OptionKind.VIEWER+OptionKind.PREFERENCE},viewOnLoad:{value:0,kind:OptionKind.VIEWER+OptionKind.PREFERENCE},cMapPacked:{value:true,kind:OptionKind.API},cMapUrl:{value:"../web/cmaps/",kind:OptionKind.API},disableAutoFetch:{value:false,kind:OptionKind.API+OptionKind.PREFERENCE},disableFontFace:{value:false,kind:OptionKind.API+OptionKind.PREFERENCE},disableRange:{value:false,kind:OptionKind.API+OptionKind.PREFERENCE},disableStream:{value:false,kind:OptionKind.API+OptionKind.PREFERENCE},docBaseUrl:{value:"",kind:OptionKind.API},enableHWA:{value:true,kind:OptionKind.API+OptionKind.VIEWER+OptionKind.PREFERENCE},enableXfa:{value:true,kind:OptionKind.API+OptionKind.PREFERENCE},fontExtraProperties:{value:false,kind:OptionKind.API},iccUrl:{value:"../web/iccs/",kind:OptionKind.API},isEvalSupported:{value:true,kind:OptionKind.API},isOffscreenCanvasSupported:{value:true,kind:OptionKind.API},maxImageSize:{value:-1,kind:OptionKind.API},pdfBug:{value:false,kind:OptionKind.API},standardFontDataUrl:{value:"../web/standard_fonts/",kind:OptionKind.API},useSystemFonts:{value:undefined,kind:OptionKind.API,type:Type.BOOLEAN+Type.UNDEFINED},verbosity:{value:1,kind:OptionKind.API},wasmUrl:{value:"../web/wasm/",kind:OptionKind.API},workerPort:{value:null,kind:OptionKind.WORKER},workerSrc:{value:"../build/pdf.worker.mjs",kind:OptionKind.WORKER}};{defaultOptions.defaultUrl={value:"compressed.tracemonkey-pldi-09.pdf",kind:OptionKind.VIEWER};defaultOptions.sandboxBundleSrc={value:"../build/pdf.sandbox.mjs",kind:OptionKind.VIEWER};defaultOptions.enableFakeMLManager={value:true,kind:OptionKind.VIEWER};}{defaultOptions.disablePreferences={value:false,kind:OptionKind.VIEWER};}var AppOptions=/*#__PURE__*/function(){function AppOptions(){_classCallCheck(this,AppOptions);}return _createClass(AppOptions,null,[{key:"get",value:function get(name){return _assertClassBrand(AppOptions,this,_opts)._.get(name);}},{key:"getAll",value:function getAll(){var kind=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;var defaultOnly=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var options=Object.create(null);for(var name in defaultOptions){var defaultOpt=defaultOptions[name];if(kind&&!(kind&defaultOpt.kind)){continue;}options[name]=!defaultOnly?_assertClassBrand(AppOptions,this,_opts)._.get(name):defaultOpt.value;}return options;}},{key:"set",value:function set(name,value){this.setAll(_defineProperty({},name,value));}},{key:"setAll",value:function setAll(options){var prefs=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;this._hasInvokedSet||(this._hasInvokedSet=true);var events;for(var name in options){var defaultOpt=defaultOptions[name],userOpt=options[name];if(!defaultOpt||!(_typeof(userOpt)===_typeof(defaultOpt.value)||Type[_typeof(userOpt).toUpperCase()]&defaultOpt.type)){continue;}var kind=defaultOpt.kind;if(prefs&&!(kind&OptionKind.BROWSER||kind&OptionKind.PREFERENCE)){continue;}if(this.eventBus&&kind&OptionKind.EVENT_DISPATCH){(events||(events=new Map())).set(name,userOpt);}_assertClassBrand(AppOptions,this,_opts)._.set(name,userOpt);}if(events){var _iterator3=_createForOfIteratorHelper(events),_step3;try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var _step3$value=_slicedToArray(_step3.value,2),_name2=_step3$value[0],value=_step3$value[1];this.eventBus.dispatch(_name2.toLowerCase(),{source:this,value:value});}}catch(err){_iterator3.e(err);}finally{_iterator3.f();}}}}]);}();_AppOptions=AppOptions;_defineProperty(AppOptions,"eventBus",void 0);var _opts={_:new Map()};(function(){for(var name in defaultOptions){_assertClassBrand(_AppOptions,_AppOptions,_opts)._.set(name,defaultOptions[name].value);}var _iterator50=_createForOfIteratorHelper(compatParams),_step50;try{for(_iterator50.s();!(_step50=_iterator50.n()).done;){var _step50$value=_slicedToArray(_step50.value,2),_name3=_step50$value[0],value=_step50$value[1];_assertClassBrand(_AppOptions,_AppOptions,_opts)._.set(_name3,value);}}catch(err){_iterator50.e(err);}finally{_iterator50.f();}_AppOptions._hasInvokedSet=false;_AppOptions._checkDisablePreferences=function(){if(_AppOptions.get("disablePreferences")){return true;}if(_AppOptions._hasInvokedSet){console.warn("The Preferences may override manually set AppOptions; "+'please use the "disablePreferences"-option to prevent that.');}return false;};})();;// ./web/pdf_link_service.js
var DEFAULT_LINK_REL="noopener noreferrer nofollow";var LinkTarget={NONE:0,SELF:1,BLANK:2,PARENT:3,TOP:4};var PDFLinkService=/*#__PURE__*/function(){function PDFLinkService(){var _ref3=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},eventBus=_ref3.eventBus,_ref3$externalLinkTar=_ref3.externalLinkTarget,externalLinkTarget=_ref3$externalLinkTar===void 0?null:_ref3$externalLinkTar,_ref3$externalLinkRel=_ref3.externalLinkRel,externalLinkRel=_ref3$externalLinkRel===void 0?null:_ref3$externalLinkRel,_ref3$ignoreDestinati=_ref3.ignoreDestinationZoom,ignoreDestinationZoom=_ref3$ignoreDestinati===void 0?false:_ref3$ignoreDestinati;_classCallCheck(this,PDFLinkService);_defineProperty(this,"externalLinkEnabled",true);this.eventBus=eventBus;this.externalLinkTarget=externalLinkTarget;this.externalLinkRel=externalLinkRel;this._ignoreDestinationZoom=ignoreDestinationZoom;this.baseUrl=null;this.pdfDocument=null;this.pdfViewer=null;this.pdfHistory=null;}return _createClass(PDFLinkService,[{key:"setDocument",value:function setDocument(pdfDocument){var baseUrl=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;this.baseUrl=baseUrl;this.pdfDocument=pdfDocument;}},{key:"setViewer",value:function setViewer(pdfViewer){this.pdfViewer=pdfViewer;}},{key:"setHistory",value:function setHistory(pdfHistory){this.pdfHistory=pdfHistory;}},{key:"pagesCount",get:function get(){return this.pdfDocument?this.pdfDocument.numPages:0;}},{key:"page",get:function get(){return this.pdfDocument?this.pdfViewer.currentPageNumber:1;},set:function set(value){if(this.pdfDocument){this.pdfViewer.currentPageNumber=value;}}},{key:"rotation",get:function get(){return this.pdfDocument?this.pdfViewer.pagesRotation:0;},set:function set(value){if(this.pdfDocument){this.pdfViewer.pagesRotation=value;}}},{key:"isInPresentationMode",get:function get(){return this.pdfDocument?this.pdfViewer.isInPresentationMode:false;}},{key:"goToDestination",value:function(){var _goToDestination=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee(dest){var namedDest,explicitDest,pageNumber,_explicitDest,_explicitDest2,destRef,_t,_t2;return _regenerator().w(function(_context){while(1)switch(_context.n){case 0:if(this.pdfDocument){_context.n=1;break;}return _context.a(2);case 1:if(!(typeof dest==="string")){_context.n=3;break;}namedDest=dest;_context.n=2;return this.pdfDocument.getDestination(dest);case 2:explicitDest=_context.v;_context.n=5;break;case 3:namedDest=null;_context.n=4;return dest;case 4:explicitDest=_context.v;case 5:if(Array.isArray(explicitDest)){_context.n=6;break;}console.error("goToDestination: \"".concat(explicitDest,"\" is not a valid destination array, for dest=\"").concat(dest,"\"."));return _context.a(2);case 6:_explicitDest=explicitDest,_explicitDest2=_slicedToArray(_explicitDest,1),destRef=_explicitDest2[0];if(!(destRef&&_typeof(destRef)==="object")){_context.n=11;break;}pageNumber=this.pdfDocument.cachedPageNumber(destRef);if(pageNumber){_context.n=10;break;}_context.p=7;_context.n=8;return this.pdfDocument.getPageIndex(destRef);case 8:_t=_context.v;pageNumber=_t+1;_context.n=10;break;case 9:_context.p=9;_t2=_context.v;console.error("goToDestination: \"".concat(destRef,"\" is not a valid page reference, for dest=\"").concat(dest,"\"."));return _context.a(2);case 10:_context.n=12;break;case 11:if(Number.isInteger(destRef)){pageNumber=destRef+1;}case 12:if(!(!pageNumber||pageNumber<1||pageNumber>this.pagesCount)){_context.n=13;break;}console.error("goToDestination: \"".concat(pageNumber,"\" is not a valid page number, for dest=\"").concat(dest,"\"."));return _context.a(2);case 13:if(this.pdfHistory){this.pdfHistory.pushCurrentPosition();this.pdfHistory.push({namedDest:namedDest,explicitDest:explicitDest,pageNumber:pageNumber});}this.pdfViewer.scrollPageIntoView({pageNumber:pageNumber,destArray:explicitDest,ignoreDestinationZoom:this._ignoreDestinationZoom});case 14:return _context.a(2);}},_callee,this,[[7,9]]);}));function goToDestination(_x){return _goToDestination.apply(this,arguments);}return goToDestination;}()},{key:"goToPage",value:function goToPage(val){if(!this.pdfDocument){return;}var pageNumber=typeof val==="string"&&this.pdfViewer.pageLabelToPageNumber(val)||val|0;if(!(Number.isInteger(pageNumber)&&pageNumber>0&&pageNumber<=this.pagesCount)){console.error("PDFLinkService.goToPage: \"".concat(val,"\" is not a valid page."));return;}if(this.pdfHistory){this.pdfHistory.pushCurrentPosition();this.pdfHistory.pushPage(pageNumber);}this.pdfViewer.scrollPageIntoView({pageNumber:pageNumber});}},{key:"addLinkAttributes",value:function addLinkAttributes(link,url){var newWindow=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;if(!url||typeof url!=="string"){throw new Error('A valid "url" parameter must provided.');}var target=newWindow?LinkTarget.BLANK:this.externalLinkTarget,rel=this.externalLinkRel;if(this.externalLinkEnabled){link.href=link.title=url;}else{link.href="";link.title="Disabled: ".concat(url);link.onclick=function(){return false;};}var targetStr="";switch(target){case LinkTarget.NONE:break;case LinkTarget.SELF:targetStr="_self";break;case LinkTarget.BLANK:targetStr="_blank";break;case LinkTarget.PARENT:targetStr="_parent";break;case LinkTarget.TOP:targetStr="_top";break;}link.target=targetStr;link.rel=typeof rel==="string"?rel:DEFAULT_LINK_REL;}},{key:"getDestinationHash",value:function getDestinationHash(dest){if(typeof dest==="string"){if(dest.length>0){return this.getAnchorUrl("#"+escape(dest));}}else if(Array.isArray(dest)){var str=JSON.stringify(dest);if(str.length>0){return this.getAnchorUrl("#"+escape(str));}}return this.getAnchorUrl("");}},{key:"getAnchorUrl",value:function getAnchorUrl(anchor){return this.baseUrl?this.baseUrl+anchor:anchor;}},{key:"setHash",value:function setHash(hash){if(!this.pdfDocument){return;}var pageNumber,dest;if(hash.includes("=")){var params=parseQueryString(hash);if(params.has("search")){var query=params.get("search").replaceAll('"',""),phrase=params.get("phrase")==="true";this.eventBus.dispatch("findfromurlhash",{source:this,query:phrase?query:query.match(/\S+/g)});}if(params.has("page")){pageNumber=params.get("page")|0||1;}if(params.has("zoom")){var zoomArgs=params.get("zoom").split(",");var zoomArg=zoomArgs[0];var zoomArgNumber=parseFloat(zoomArg);if(!zoomArg.includes("Fit")){dest=[null,{name:"XYZ"},zoomArgs.length>1?zoomArgs[1]|0:null,zoomArgs.length>2?zoomArgs[2]|0:null,zoomArgNumber?zoomArgNumber/100:zoomArg];}else if(zoomArg==="Fit"||zoomArg==="FitB"){dest=[null,{name:zoomArg}];}else if(zoomArg==="FitH"||zoomArg==="FitBH"||zoomArg==="FitV"||zoomArg==="FitBV"){dest=[null,{name:zoomArg},zoomArgs.length>1?zoomArgs[1]|0:null];}else if(zoomArg==="FitR"){if(zoomArgs.length!==5){console.error('PDFLinkService.setHash: Not enough parameters for "FitR".');}else{dest=[null,{name:zoomArg},zoomArgs[1]|0,zoomArgs[2]|0,zoomArgs[3]|0,zoomArgs[4]|0];}}else{console.error("PDFLinkService.setHash: \"".concat(zoomArg,"\" is not a valid zoom value."));}}if(dest){this.pdfViewer.scrollPageIntoView({pageNumber:pageNumber||this.page,destArray:dest,allowNegativeOffset:true});}else if(pageNumber){this.page=pageNumber;}if(params.has("pagemode")){this.eventBus.dispatch("pagemode",{source:this,mode:params.get("pagemode")});}if(params.has("nameddest")){this.goToDestination(params.get("nameddest"));}return;}dest=unescape(hash);try{dest=JSON.parse(dest);if(!Array.isArray(dest)){dest=dest.toString();}}catch(_unused2){}if(typeof dest==="string"||isValidExplicitDest(dest)){this.goToDestination(dest);return;}console.error("PDFLinkService.setHash: \"".concat(unescape(hash),"\" is not a valid destination."));}},{key:"executeNamedAction",value:function executeNamedAction(action){var _this$pdfHistory,_this$pdfHistory2;if(!this.pdfDocument){return;}switch(action){case"GoBack":(_this$pdfHistory=this.pdfHistory)===null||_this$pdfHistory===void 0||_this$pdfHistory.back();break;case"GoForward":(_this$pdfHistory2=this.pdfHistory)===null||_this$pdfHistory2===void 0||_this$pdfHistory2.forward();break;case"NextPage":this.pdfViewer.nextPage();break;case"PrevPage":this.pdfViewer.previousPage();break;case"LastPage":this.page=this.pagesCount;break;case"FirstPage":this.page=1;break;default:break;}this.eventBus.dispatch("namedaction",{source:this,action:action});}},{key:"executeSetOCGState",value:function(){var _executeSetOCGState=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee2(action){var pdfDocument,optionalContentConfig;return _regenerator().w(function(_context2){while(1)switch(_context2.n){case 0:if(this.pdfDocument){_context2.n=1;break;}return _context2.a(2);case 1:pdfDocument=this.pdfDocument;_context2.n=2;return this.pdfViewer.optionalContentConfigPromise;case 2:optionalContentConfig=_context2.v;if(!(pdfDocument!==this.pdfDocument)){_context2.n=3;break;}return _context2.a(2);case 3:optionalContentConfig.setOCGState(action);this.pdfViewer.optionalContentConfigPromise=Promise.resolve(optionalContentConfig);case 4:return _context2.a(2);}},_callee2,this);}));function executeSetOCGState(_x2){return _executeSetOCGState.apply(this,arguments);}return executeSetOCGState;}()}]);}();var SimpleLinkService=/*#__PURE__*/function(_PDFLinkService2){function SimpleLinkService(){_classCallCheck(this,SimpleLinkService);return _callSuper(this,SimpleLinkService,arguments);}_inherits(SimpleLinkService,_PDFLinkService2);return _createClass(SimpleLinkService,[{key:"setDocument",value:function setDocument(pdfDocument){var baseUrl=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;}}]);}(PDFLinkService);;// ./web/event_utils.js
var WaitOnType={EVENT:"event",TIMEOUT:"timeout"};function waitOnEventOrTimeout(_x3){return _waitOnEventOrTimeout.apply(this,arguments);}function _waitOnEventOrTimeout(){_waitOnEventOrTimeout=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee98(_ref4){var target,name,_ref4$delay,delay,_Promise$withResolver3,promise,resolve,ac,handler,evtMethod,timeout;return _regenerator().w(function(_context99){while(1)switch(_context99.n){case 0:handler=function _handler(type){ac.abort();clearTimeout(timeout);resolve(type);};target=_ref4.target,name=_ref4.name,_ref4$delay=_ref4.delay,delay=_ref4$delay===void 0?0:_ref4$delay;if(!(_typeof(target)!=="object"||!(name&&typeof name==="string")||!(Number.isInteger(delay)&&delay>=0))){_context99.n=1;break;}throw new Error("waitOnEventOrTimeout - invalid parameters.");case 1:_Promise$withResolver3=Promise.withResolvers(),promise=_Promise$withResolver3.promise,resolve=_Promise$withResolver3.resolve;ac=new AbortController();evtMethod=target instanceof EventBus?"_on":"addEventListener";target[evtMethod](name,handler.bind(null,WaitOnType.EVENT),{signal:ac.signal});timeout=setTimeout(handler.bind(null,WaitOnType.TIMEOUT),delay);return _context99.a(2,promise);}},_callee98);}));return _waitOnEventOrTimeout.apply(this,arguments);}var _listeners=/*#__PURE__*/new WeakMap();var EventBus=/*#__PURE__*/function(){function EventBus(){_classCallCheck(this,EventBus);_classPrivateFieldInitSpec(this,_listeners,Object.create(null));}return _createClass(EventBus,[{key:"on",value:function on(eventName,listener){var options=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;this._on(eventName,listener,{external:true,once:options===null||options===void 0?void 0:options.once,signal:options===null||options===void 0?void 0:options.signal});}},{key:"off",value:function off(eventName,listener){var options=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;this._off(eventName,listener);}},{key:"dispatch",value:function dispatch(eventName,data){var eventListeners=_classPrivateFieldGet(_listeners,this)[eventName];if(!eventListeners||eventListeners.length===0){return;}var externalListeners;var _iterator4=_createForOfIteratorHelper(eventListeners.slice(0)),_step4;try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var _step4$value=_step4.value,_listener=_step4$value.listener,external=_step4$value.external,once=_step4$value.once;if(once){this._off(eventName,_listener);}if(external){(externalListeners||(externalListeners=[])).push(_listener);continue;}_listener(data);}}catch(err){_iterator4.e(err);}finally{_iterator4.f();}if(externalListeners){var _iterator5=_createForOfIteratorHelper(externalListeners),_step5;try{for(_iterator5.s();!(_step5=_iterator5.n()).done;){var listener=_step5.value;listener(data);}}catch(err){_iterator5.e(err);}finally{_iterator5.f();}externalListeners=null;}}},{key:"_on",value:function _on(eventName,listener){var _this4=this,_classPrivateFieldGet2;var options=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;var rmAbort=null;if((options===null||options===void 0?void 0:options.signal)instanceof AbortSignal){var signal=options.signal;if(signal.aborted){console.error("Cannot use an `aborted` signal.");return;}var onAbort=function onAbort(){return _this4._off(eventName,listener);};rmAbort=function rmAbort(){return signal.removeEventListener("abort",onAbort);};signal.addEventListener("abort",onAbort);}var eventListeners=(_classPrivateFieldGet2=_classPrivateFieldGet(_listeners,this))[eventName]||(_classPrivateFieldGet2[eventName]=[]);eventListeners.push({listener:listener,external:(options===null||options===void 0?void 0:options.external)===true,once:(options===null||options===void 0?void 0:options.once)===true,rmAbort:rmAbort});}},{key:"_off",value:function _off(eventName,listener){var options=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;var eventListeners=_classPrivateFieldGet(_listeners,this)[eventName];if(!eventListeners){return;}for(var i=0,ii=eventListeners.length;i<ii;i++){var evt=eventListeners[i];if(evt.listener===listener){var _evt$rmAbort;(_evt$rmAbort=evt.rmAbort)===null||_evt$rmAbort===void 0||_evt$rmAbort.call(evt);eventListeners.splice(i,1);return;}}}}]);}();var _externalServices=/*#__PURE__*/new WeakMap();var _globalEventNames=/*#__PURE__*/new WeakMap();var _isInAutomation=/*#__PURE__*/new WeakMap();var FirefoxEventBus=/*#__PURE__*/function(_EventBus2){function FirefoxEventBus(globalEventNames,externalServices,isInAutomation){var _this5;_classCallCheck(this,FirefoxEventBus);_this5=_callSuper(this,FirefoxEventBus);_classPrivateFieldInitSpec(_this5,_externalServices,void 0);_classPrivateFieldInitSpec(_this5,_globalEventNames,void 0);_classPrivateFieldInitSpec(_this5,_isInAutomation,void 0);_classPrivateFieldSet(_globalEventNames,_this5,globalEventNames);_classPrivateFieldSet(_externalServices,_this5,externalServices);_classPrivateFieldSet(_isInAutomation,_this5,isInAutomation);return _this5;}_inherits(FirefoxEventBus,_EventBus2);return _createClass(FirefoxEventBus,[{key:"dispatch",value:function dispatch(eventName,data){throw new Error("Not implemented: FirefoxEventBus.dispatch");}}]);}(EventBus);;// ./web/external_services.js
var BaseExternalServices=/*#__PURE__*/function(){function BaseExternalServices(){_classCallCheck(this,BaseExternalServices);}return _createClass(BaseExternalServices,[{key:"updateFindControlState",value:function updateFindControlState(data){}},{key:"updateFindMatchesCount",value:function updateFindMatchesCount(data){}},{key:"initPassiveLoading",value:function initPassiveLoading(){}},{key:"reportTelemetry",value:function reportTelemetry(data){}},{key:"createL10n",value:function(){var _createL10n=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee3(){return _regenerator().w(function(_context3){while(1)switch(_context3.n){case 0:throw new Error("Not implemented: createL10n");case 1:return _context3.a(2);}},_callee3);}));function createL10n(){return _createL10n.apply(this,arguments);}return createL10n;}()},{key:"createScripting",value:function createScripting(){throw new Error("Not implemented: createScripting");}},{key:"createSignatureStorage",value:function createSignatureStorage(){throw new Error("Not implemented: createSignatureStorage");}},{key:"updateEditorStates",value:function updateEditorStates(data){throw new Error("Not implemented: updateEditorStates");}},{key:"dispatchGlobalEvent",value:function dispatchGlobalEvent(_event){}}]);}();;// ./web/preferences.js
var _defaults=/*#__PURE__*/new WeakMap();var _initializedPromise=/*#__PURE__*/new WeakMap();var BasePreferences=/*#__PURE__*/function(){function BasePreferences(){_classCallCheck(this,BasePreferences);_classPrivateFieldInitSpec(this,_defaults,Object.freeze({altTextLearnMoreUrl:"",annotationEditorMode:0,annotationMode:2,cursorToolOnLoad:0,defaultZoomDelay:400,defaultZoomValue:"",disablePageLabels:false,enableAltText:false,enableAltTextModelDownload:true,enableAutoLinking:true,enableGuessAltText:true,enableHighlightFloatingButton:false,enableNewAltTextWhenAddingImage:true,enablePermissions:false,enablePrintAutoRotate:true,enableScripting:true,enableSignatureEditor:false,enableUpdatedAddImage:false,externalLinkTarget:0,highlightEditorColors:"yellow=#FFFF98,green=#53FFBC,blue=#80EBFF,pink=#FFCBE6,red=#FF4F5F",historyUpdateUrl:false,ignoreDestinationZoom:false,forcePageColors:false,pageColorsBackground:"Canvas",pageColorsForeground:"CanvasText",pdfBugEnabled:false,sidebarViewOnLoad:-1,scrollModeOnLoad:-1,spreadModeOnLoad:-1,textLayerMode:1,viewerCssTheme:0,viewOnLoad:0,disableAutoFetch:false,disableFontFace:false,disableRange:false,disableStream:false,enableHWA:true,enableXfa:true}));_classPrivateFieldInitSpec(this,_initializedPromise,null);_classPrivateFieldSet(_initializedPromise,this,this._readFromStorage(_classPrivateFieldGet(_defaults,this)).then(function(_ref5){var browserPrefs=_ref5.browserPrefs,prefs=_ref5.prefs;if(AppOptions._checkDisablePreferences()){return;}AppOptions.setAll(_objectSpread(_objectSpread({},browserPrefs),prefs),true);}));}return _createClass(BasePreferences,[{key:"_writeToStorage",value:function(){var _writeToStorage2=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee4(prefObj){return _regenerator().w(function(_context4){while(1)switch(_context4.n){case 0:throw new Error("Not implemented: _writeToStorage");case 1:return _context4.a(2);}},_callee4);}));function _writeToStorage(_x4){return _writeToStorage2.apply(this,arguments);}return _writeToStorage;}()},{key:"_readFromStorage",value:function(){var _readFromStorage2=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee5(prefObj){return _regenerator().w(function(_context5){while(1)switch(_context5.n){case 0:throw new Error("Not implemented: _readFromStorage");case 1:return _context5.a(2);}},_callee5);}));function _readFromStorage(_x5){return _readFromStorage2.apply(this,arguments);}return _readFromStorage;}()},{key:"reset",value:function(){var _reset=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee6(){return _regenerator().w(function(_context6){while(1)switch(_context6.n){case 0:_context6.n=1;return _classPrivateFieldGet(_initializedPromise,this);case 1:AppOptions.setAll(_classPrivateFieldGet(_defaults,this),true);_context6.n=2;return this._writeToStorage(_classPrivateFieldGet(_defaults,this));case 2:return _context6.a(2);}},_callee6,this);}));function reset(){return _reset.apply(this,arguments);}return reset;}()},{key:"set",value:function(){var _set=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee7(name,value){return _regenerator().w(function(_context7){while(1)switch(_context7.n){case 0:_context7.n=1;return _classPrivateFieldGet(_initializedPromise,this);case 1:AppOptions.setAll(_defineProperty({},name,value),true);_context7.n=2;return this._writeToStorage(AppOptions.getAll(OptionKind.PREFERENCE));case 2:return _context7.a(2);}},_callee7,this);}));function set(_x6,_x7){return _set.apply(this,arguments);}return set;}()},{key:"get",value:function(){var _get=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee8(name){return _regenerator().w(function(_context8){while(1)switch(_context8.n){case 0:_context8.n=1;return _classPrivateFieldGet(_initializedPromise,this);case 1:return _context8.a(2,AppOptions.get(name));}},_callee8,this);}));function get(_x8){return _get.apply(this,arguments);}return get;}()},{key:"initializedPromise",get:function get(){return _classPrivateFieldGet(_initializedPromise,this);}}]);}();;// ./node_modules/@fluent/bundle/esm/types.js
var FluentType=/*#__PURE__*/function(){function FluentType(value){_classCallCheck(this,FluentType);this.value=value;}return _createClass(FluentType,[{key:"valueOf",value:function valueOf(){return this.value;}}]);}();var FluentNone=/*#__PURE__*/function(_FluentType){function FluentNone(){var value=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"???";_classCallCheck(this,FluentNone);return _callSuper(this,FluentNone,[value]);}_inherits(FluentNone,_FluentType);return _createClass(FluentNone,[{key:"toString",value:function toString(scope){return"{".concat(this.value,"}");}}]);}(FluentType);var FluentNumber=/*#__PURE__*/function(_FluentType2){function FluentNumber(value){var _this6;var opts=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};_classCallCheck(this,FluentNumber);_this6=_callSuper(this,FluentNumber,[value]);_this6.opts=opts;return _this6;}_inherits(FluentNumber,_FluentType2);return _createClass(FluentNumber,[{key:"toString",value:function toString(scope){try{var nf=scope.memoizeIntlObject(Intl.NumberFormat,this.opts);return nf.format(this.value);}catch(err){scope.reportError(err);return this.value.toString(10);}}}]);}(FluentType);var FluentDateTime=/*#__PURE__*/function(_FluentType3){function FluentDateTime(value){var _this7;var opts=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};_classCallCheck(this,FluentDateTime);_this7=_callSuper(this,FluentDateTime,[value]);_this7.opts=opts;return _this7;}_inherits(FluentDateTime,_FluentType3);return _createClass(FluentDateTime,[{key:"toString",value:function toString(scope){try{var dtf=scope.memoizeIntlObject(Intl.DateTimeFormat,this.opts);return dtf.format(this.value);}catch(err){scope.reportError(err);return new Date(this.value).toISOString();}}}]);}(FluentType);;// ./node_modules/@fluent/bundle/esm/resolver.js
var MAX_PLACEABLES=100;var FSI="\u2068";var PDI="\u2069";function match(scope,selector,key){if(key===selector){return true;}if(key instanceof FluentNumber&&selector instanceof FluentNumber&&key.value===selector.value){return true;}if(selector instanceof FluentNumber&&typeof key==="string"){var category=scope.memoizeIntlObject(Intl.PluralRules,selector.opts).select(selector.value);if(key===category){return true;}}return false;}function getDefault(scope,variants,star){if(variants[star]){return resolvePattern(scope,variants[star].value);}scope.reportError(new RangeError("No default"));return new FluentNone();}function getArguments(scope,args){var positional=[];var named=Object.create(null);var _iterator6=_createForOfIteratorHelper(args),_step6;try{for(_iterator6.s();!(_step6=_iterator6.n()).done;){var arg=_step6.value;if(arg.type==="narg"){named[arg.name]=resolveExpression(scope,arg.value);}else{positional.push(resolveExpression(scope,arg));}}}catch(err){_iterator6.e(err);}finally{_iterator6.f();}return{positional:positional,named:named};}function resolveExpression(scope,expr){switch(expr.type){case"str":return expr.value;case"num":return new FluentNumber(expr.value,{minimumFractionDigits:expr.precision});case"var":return resolveVariableReference(scope,expr);case"mesg":return resolveMessageReference(scope,expr);case"term":return resolveTermReference(scope,expr);case"func":return resolveFunctionReference(scope,expr);case"select":return resolveSelectExpression(scope,expr);default:return new FluentNone();}}function resolveVariableReference(scope,_ref6){var name=_ref6.name;var arg;if(scope.params){if(Object.prototype.hasOwnProperty.call(scope.params,name)){arg=scope.params[name];}else{return new FluentNone("$".concat(name));}}else if(scope.args&&Object.prototype.hasOwnProperty.call(scope.args,name)){arg=scope.args[name];}else{scope.reportError(new ReferenceError("Unknown variable: $".concat(name)));return new FluentNone("$".concat(name));}if(arg instanceof FluentType){return arg;}switch(_typeof(arg)){case"string":return arg;case"number":return new FluentNumber(arg);case"object":if(arg instanceof Date){return new FluentDateTime(arg.getTime());}default:scope.reportError(new TypeError("Variable type not supported: $".concat(name,", ").concat(_typeof(arg))));return new FluentNone("$".concat(name));}}function resolveMessageReference(scope,_ref7){var name=_ref7.name,attr=_ref7.attr;var message=scope.bundle._messages.get(name);if(!message){scope.reportError(new ReferenceError("Unknown message: ".concat(name)));return new FluentNone(name);}if(attr){var attribute=message.attributes[attr];if(attribute){return resolvePattern(scope,attribute);}scope.reportError(new ReferenceError("Unknown attribute: ".concat(attr)));return new FluentNone("".concat(name,".").concat(attr));}if(message.value){return resolvePattern(scope,message.value);}scope.reportError(new ReferenceError("No value: ".concat(name)));return new FluentNone(name);}function resolveTermReference(scope,_ref8){var name=_ref8.name,attr=_ref8.attr,args=_ref8.args;var id="-".concat(name);var term=scope.bundle._terms.get(id);if(!term){scope.reportError(new ReferenceError("Unknown term: ".concat(id)));return new FluentNone(id);}if(attr){var attribute=term.attributes[attr];if(attribute){scope.params=getArguments(scope,args).named;var _resolved=resolvePattern(scope,attribute);scope.params=null;return _resolved;}scope.reportError(new ReferenceError("Unknown attribute: ".concat(attr)));return new FluentNone("".concat(id,".").concat(attr));}scope.params=getArguments(scope,args).named;var resolved=resolvePattern(scope,term.value);scope.params=null;return resolved;}function resolveFunctionReference(scope,_ref9){var name=_ref9.name,args=_ref9.args;var func=scope.bundle._functions[name];if(!func){scope.reportError(new ReferenceError("Unknown function: ".concat(name,"()")));return new FluentNone("".concat(name,"()"));}if(typeof func!=="function"){scope.reportError(new TypeError("Function ".concat(name,"() is not callable")));return new FluentNone("".concat(name,"()"));}try{var resolved=getArguments(scope,args);return func(resolved.positional,resolved.named);}catch(err){scope.reportError(err);return new FluentNone("".concat(name,"()"));}}function resolveSelectExpression(scope,_ref0){var selector=_ref0.selector,variants=_ref0.variants,star=_ref0.star;var sel=resolveExpression(scope,selector);if(sel instanceof FluentNone){return getDefault(scope,variants,star);}var _iterator7=_createForOfIteratorHelper(variants),_step7;try{for(_iterator7.s();!(_step7=_iterator7.n()).done;){var variant=_step7.value;var key=resolveExpression(scope,variant.key);if(match(scope,sel,key)){return resolvePattern(scope,variant.value);}}}catch(err){_iterator7.e(err);}finally{_iterator7.f();}return getDefault(scope,variants,star);}function resolveComplexPattern(scope,ptn){if(scope.dirty.has(ptn)){scope.reportError(new RangeError("Cyclic reference"));return new FluentNone();}scope.dirty.add(ptn);var result=[];var useIsolating=scope.bundle._useIsolating&&ptn.length>1;var _iterator8=_createForOfIteratorHelper(ptn),_step8;try{for(_iterator8.s();!(_step8=_iterator8.n()).done;){var elem=_step8.value;if(typeof elem==="string"){result.push(scope.bundle._transform(elem));continue;}scope.placeables++;if(scope.placeables>MAX_PLACEABLES){scope.dirty["delete"](ptn);throw new RangeError("Too many placeables expanded: ".concat(scope.placeables,", ")+"max allowed is ".concat(MAX_PLACEABLES));}if(useIsolating){result.push(FSI);}result.push(resolveExpression(scope,elem).toString(scope));if(useIsolating){result.push(PDI);}}}catch(err){_iterator8.e(err);}finally{_iterator8.f();}scope.dirty["delete"](ptn);return result.join("");}function resolvePattern(scope,value){if(typeof value==="string"){return scope.bundle._transform(value);}return resolveComplexPattern(scope,value);};// ./node_modules/@fluent/bundle/esm/scope.js
var Scope=/*#__PURE__*/function(){function Scope(bundle,errors,args){_classCallCheck(this,Scope);this.dirty=new WeakSet();this.params=null;this.placeables=0;this.bundle=bundle;this.errors=errors;this.args=args;}return _createClass(Scope,[{key:"reportError",value:function reportError(error){if(!this.errors||!(error instanceof Error)){throw error;}this.errors.push(error);}},{key:"memoizeIntlObject",value:function memoizeIntlObject(ctor,opts){var cache=this.bundle._intls.get(ctor);if(!cache){cache={};this.bundle._intls.set(ctor,cache);}var id=JSON.stringify(opts);if(!cache[id]){cache[id]=new ctor(this.bundle.locales,opts);}return cache[id];}}]);}();;// ./node_modules/@fluent/bundle/esm/builtins.js
function values(opts,allowed){var unwrapped=Object.create(null);for(var _i=0,_Object$entries=Object.entries(opts);_i<_Object$entries.length;_i++){var _Object$entries$_i=_slicedToArray(_Object$entries[_i],2),name=_Object$entries$_i[0],opt=_Object$entries$_i[1];if(allowed.includes(name)){unwrapped[name]=opt.valueOf();}}return unwrapped;}var NUMBER_ALLOWED=["unitDisplay","currencyDisplay","useGrouping","minimumIntegerDigits","minimumFractionDigits","maximumFractionDigits","minimumSignificantDigits","maximumSignificantDigits"];function NUMBER(args,opts){var arg=args[0];if(arg instanceof FluentNone){return new FluentNone("NUMBER(".concat(arg.valueOf(),")"));}if(arg instanceof FluentNumber){return new FluentNumber(arg.valueOf(),_objectSpread(_objectSpread({},arg.opts),values(opts,NUMBER_ALLOWED)));}if(arg instanceof FluentDateTime){return new FluentNumber(arg.valueOf(),_objectSpread({},values(opts,NUMBER_ALLOWED)));}throw new TypeError("Invalid argument to NUMBER");}var DATETIME_ALLOWED=["dateStyle","timeStyle","fractionalSecondDigits","dayPeriod","hour12","weekday","era","year","month","day","hour","minute","second","timeZoneName"];function DATETIME(args,opts){var arg=args[0];if(arg instanceof FluentNone){return new FluentNone("DATETIME(".concat(arg.valueOf(),")"));}if(arg instanceof FluentDateTime){return new FluentDateTime(arg.valueOf(),_objectSpread(_objectSpread({},arg.opts),values(opts,DATETIME_ALLOWED)));}if(arg instanceof FluentNumber){return new FluentDateTime(arg.valueOf(),_objectSpread({},values(opts,DATETIME_ALLOWED)));}throw new TypeError("Invalid argument to DATETIME");};// ./node_modules/@fluent/bundle/esm/memoizer.js
var cache=new Map();function getMemoizerForLocale(locales){var stringLocale=Array.isArray(locales)?locales.join(" "):locales;var memoizer=cache.get(stringLocale);if(memoizer===undefined){memoizer=new Map();cache.set(stringLocale,memoizer);}return memoizer;};// ./node_modules/@fluent/bundle/esm/bundle.js
var FluentBundle=/*#__PURE__*/function(){function FluentBundle(locales){var _ref1=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{},functions=_ref1.functions,_ref1$useIsolating=_ref1.useIsolating,useIsolating=_ref1$useIsolating===void 0?true:_ref1$useIsolating,_ref1$transform=_ref1.transform,transform=_ref1$transform===void 0?function(v){return v;}:_ref1$transform;_classCallCheck(this,FluentBundle);this._terms=new Map();this._messages=new Map();this.locales=Array.isArray(locales)?locales:[locales];this._functions=_objectSpread({NUMBER:NUMBER,DATETIME:DATETIME},functions);this._useIsolating=useIsolating;this._transform=transform;this._intls=getMemoizerForLocale(locales);}return _createClass(FluentBundle,[{key:"hasMessage",value:function hasMessage(id){return this._messages.has(id);}},{key:"getMessage",value:function getMessage(id){return this._messages.get(id);}},{key:"addResource",value:function addResource(res){var _ref10=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{},_ref10$allowOverrides=_ref10.allowOverrides,allowOverrides=_ref10$allowOverrides===void 0?false:_ref10$allowOverrides;var errors=[];for(var i=0;i<res.body.length;i++){var entry=res.body[i];if(entry.id.startsWith("-")){if(allowOverrides===false&&this._terms.has(entry.id)){errors.push(new Error("Attempt to override an existing term: \"".concat(entry.id,"\"")));continue;}this._terms.set(entry.id,entry);}else{if(allowOverrides===false&&this._messages.has(entry.id)){errors.push(new Error("Attempt to override an existing message: \"".concat(entry.id,"\"")));continue;}this._messages.set(entry.id,entry);}}return errors;}},{key:"formatPattern",value:function formatPattern(pattern){var args=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var errors=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;if(typeof pattern==="string"){return this._transform(pattern);}var scope=new Scope(this,errors,args);try{var value=resolveComplexPattern(scope,pattern);return value.toString(scope);}catch(err){if(scope.errors&&err instanceof Error){scope.errors.push(err);return new FluentNone().toString(scope);}throw err;}}}]);}();;// ./node_modules/@fluent/bundle/esm/resource.js
var RE_MESSAGE_START=/^(-?[a-zA-Z][\w-]*) *= */gm;var RE_ATTRIBUTE_START=new RegExp("\\.([a-zA-Z][\\w-]*) *= *","y");var RE_VARIANT_START=new RegExp("\\*?\\[","y");var RE_NUMBER_LITERAL=new RegExp("(-?[0-9]+(?:\\.([0-9]+))?)","y");var RE_IDENTIFIER=new RegExp("([a-zA-Z][\\w-]*)","y");var RE_REFERENCE=new RegExp("([$-])?([a-zA-Z][\\w-]*)(?:\\.([a-zA-Z][\\w-]*))?","y");var RE_FUNCTION_NAME=/^[A-Z][A-Z0-9_-]*$/;var RE_TEXT_RUN=new RegExp("([^{}\\n\\r]+)","y");var RE_STRING_RUN=new RegExp("([^\\\\\"\\n\\r]*)","y");var RE_STRING_ESCAPE=new RegExp("\\\\([\\\\\"])","y");var RE_UNICODE_ESCAPE=new RegExp("\\\\u([a-fA-F0-9]{4})|\\\\U([a-fA-F0-9]{6})","y");var RE_LEADING_NEWLINES=/^\n+/;var RE_TRAILING_SPACES=/ +$/;var RE_BLANK_LINES=/ *\r?\n/g;var RE_INDENT=/( *)$/;var TOKEN_BRACE_OPEN=new RegExp("{\\s*","y");var TOKEN_BRACE_CLOSE=new RegExp("\\s*}","y");var TOKEN_BRACKET_OPEN=new RegExp("\\[\\s*","y");var TOKEN_BRACKET_CLOSE=new RegExp("\\s*] *","y");var TOKEN_PAREN_OPEN=new RegExp("\\s*\\(\\s*","y");var TOKEN_ARROW=new RegExp("\\s*->\\s*","y");var TOKEN_COLON=new RegExp("\\s*:\\s*","y");var TOKEN_COMMA=new RegExp("\\s*,?\\s*","y");var TOKEN_BLANK=new RegExp("\\s+","y");var FluentResource=/*#__PURE__*/_createClass(function FluentResource(source){_classCallCheck(this,FluentResource);this.body=[];RE_MESSAGE_START.lastIndex=0;var cursor=0;while(true){var next=RE_MESSAGE_START.exec(source);if(next===null){break;}cursor=RE_MESSAGE_START.lastIndex;try{this.body.push(parseMessage(next[1]));}catch(err){if(err instanceof SyntaxError){continue;}throw err;}}function test(re){re.lastIndex=cursor;return re.test(source);}function consumeChar(_char,errorClass){if(source[cursor]===_char){cursor++;return true;}if(errorClass){throw new errorClass("Expected ".concat(_char));}return false;}function consumeToken(re,errorClass){if(test(re)){cursor=re.lastIndex;return true;}if(errorClass){throw new errorClass("Expected ".concat(re.toString()));}return false;}function match(re){re.lastIndex=cursor;var result=re.exec(source);if(result===null){throw new SyntaxError("Expected ".concat(re.toString()));}cursor=re.lastIndex;return result;}function match1(re){return match(re)[1];}function parseMessage(id){var value=parsePattern();var attributes=parseAttributes();if(value===null&&Object.keys(attributes).length===0){throw new SyntaxError("Expected message value or attributes");}return{id:id,value:value,attributes:attributes};}function parseAttributes(){var attrs=Object.create(null);while(test(RE_ATTRIBUTE_START)){var name=match1(RE_ATTRIBUTE_START);var value=parsePattern();if(value===null){throw new SyntaxError("Expected attribute value");}attrs[name]=value;}return attrs;}function parsePattern(){var first;if(test(RE_TEXT_RUN)){first=match1(RE_TEXT_RUN);}if(source[cursor]==="{"||source[cursor]==="}"){return parsePatternElements(first?[first]:[],Infinity);}var indent=parseIndent();if(indent){if(first){return parsePatternElements([first,indent],indent.length);}indent.value=trim(indent.value,RE_LEADING_NEWLINES);return parsePatternElements([indent],indent.length);}if(first){return trim(first,RE_TRAILING_SPACES);}return null;}function parsePatternElements(){var elements=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];var commonIndent=arguments.length>1?arguments[1]:undefined;while(true){if(test(RE_TEXT_RUN)){elements.push(match1(RE_TEXT_RUN));continue;}if(source[cursor]==="{"){elements.push(parsePlaceable());continue;}if(source[cursor]==="}"){throw new SyntaxError("Unbalanced closing brace");}var indent=parseIndent();if(indent){elements.push(indent);commonIndent=Math.min(commonIndent,indent.length);continue;}break;}var lastIndex=elements.length-1;var lastElement=elements[lastIndex];if(typeof lastElement==="string"){elements[lastIndex]=trim(lastElement,RE_TRAILING_SPACES);}var baked=[];var _iterator9=_createForOfIteratorHelper(elements),_step9;try{for(_iterator9.s();!(_step9=_iterator9.n()).done;){var element=_step9.value;if(element instanceof Indent){element=element.value.slice(0,element.value.length-commonIndent);}if(element){baked.push(element);}}}catch(err){_iterator9.e(err);}finally{_iterator9.f();}return baked;}function parsePlaceable(){consumeToken(TOKEN_BRACE_OPEN,SyntaxError);var selector=parseInlineExpression();if(consumeToken(TOKEN_BRACE_CLOSE)){return selector;}if(consumeToken(TOKEN_ARROW)){var variants=parseVariants();consumeToken(TOKEN_BRACE_CLOSE,SyntaxError);return _objectSpread({type:"select",selector:selector},variants);}throw new SyntaxError("Unclosed placeable");}function parseInlineExpression(){if(source[cursor]==="{"){return parsePlaceable();}if(test(RE_REFERENCE)){var _match=match(RE_REFERENCE),_match2=_slicedToArray(_match,4),sigil=_match2[1],name=_match2[2],_match2$=_match2[3],attr=_match2$===void 0?null:_match2$;if(sigil==="$"){return{type:"var",name:name};}if(consumeToken(TOKEN_PAREN_OPEN)){var args=parseArguments();if(sigil==="-"){return{type:"term",name:name,attr:attr,args:args};}if(RE_FUNCTION_NAME.test(name)){return{type:"func",name:name,args:args};}throw new SyntaxError("Function names must be all upper-case");}if(sigil==="-"){return{type:"term",name:name,attr:attr,args:[]};}return{type:"mesg",name:name,attr:attr};}return parseLiteral();}function parseArguments(){var args=[];while(true){switch(source[cursor]){case")":cursor++;return args;case undefined:throw new SyntaxError("Unclosed argument list");}args.push(parseArgument());consumeToken(TOKEN_COMMA);}}function parseArgument(){var expr=parseInlineExpression();if(expr.type!=="mesg"){return expr;}if(consumeToken(TOKEN_COLON)){return{type:"narg",name:expr.name,value:parseLiteral()};}return expr;}function parseVariants(){var variants=[];var count=0;var star;while(test(RE_VARIANT_START)){if(consumeChar("*")){star=count;}var key=parseVariantKey();var value=parsePattern();if(value===null){throw new SyntaxError("Expected variant value");}variants[count++]={key:key,value:value};}if(count===0){return null;}if(star===undefined){throw new SyntaxError("Expected default variant");}return{variants:variants,star:star};}function parseVariantKey(){consumeToken(TOKEN_BRACKET_OPEN,SyntaxError);var key;if(test(RE_NUMBER_LITERAL)){key=parseNumberLiteral();}else{key={type:"str",value:match1(RE_IDENTIFIER)};}consumeToken(TOKEN_BRACKET_CLOSE,SyntaxError);return key;}function parseLiteral(){if(test(RE_NUMBER_LITERAL)){return parseNumberLiteral();}if(source[cursor]==='"'){return parseStringLiteral();}throw new SyntaxError("Invalid expression");}function parseNumberLiteral(){var _match3=match(RE_NUMBER_LITERAL),_match4=_slicedToArray(_match3,3),value=_match4[1],_match4$=_match4[2],fraction=_match4$===void 0?"":_match4$;var precision=fraction.length;return{type:"num",value:parseFloat(value),precision:precision};}function parseStringLiteral(){consumeChar('"',SyntaxError);var value="";while(true){value+=match1(RE_STRING_RUN);if(source[cursor]==="\\"){value+=parseEscapeSequence();continue;}if(consumeChar('"')){return{type:"str",value:value};}throw new SyntaxError("Unclosed string literal");}}function parseEscapeSequence(){if(test(RE_STRING_ESCAPE)){return match1(RE_STRING_ESCAPE);}if(test(RE_UNICODE_ESCAPE)){var _match5=match(RE_UNICODE_ESCAPE),_match6=_slicedToArray(_match5,3),codepoint4=_match6[1],codepoint6=_match6[2];var codepoint=parseInt(codepoint4||codepoint6,16);return codepoint<=0xd7ff||0xe000<=codepoint?String.fromCodePoint(codepoint):"�";}throw new SyntaxError("Unknown escape sequence");}function parseIndent(){var start=cursor;consumeToken(TOKEN_BLANK);switch(source[cursor]){case".":case"[":case"*":case"}":case undefined:return false;case"{":return makeIndent(source.slice(start,cursor));}if(source[cursor-1]===" "){return makeIndent(source.slice(start,cursor));}return false;}function trim(text,re){return text.replace(re,"");}function makeIndent(blank){var value=blank.replace(RE_BLANK_LINES,"\n");var length=RE_INDENT.exec(blank)[1].length;return new Indent(value,length);}});var Indent=/*#__PURE__*/_createClass(function Indent(value,length){_classCallCheck(this,Indent);this.value=value;this.length=length;});;// ./node_modules/@fluent/bundle/esm/index.js
;// ./node_modules/@fluent/dom/esm/overlay.js
var reOverlay=/<|&#?\w+;/;var TEXT_LEVEL_ELEMENTS={"http://www.w3.org/1999/xhtml":["em","strong","small","s","cite","q","dfn","abbr","data","time","code","var","samp","kbd","sub","sup","i","b","u","mark","bdi","bdo","span","br","wbr"]};var LOCALIZABLE_ATTRIBUTES={"http://www.w3.org/1999/xhtml":{global:["title","aria-description","aria-label","aria-valuetext"],a:["download"],area:["download","alt"],input:["alt","placeholder"],menuitem:["label"],menu:["label"],optgroup:["label"],option:["label"],track:["label"],img:["alt"],textarea:["placeholder"],th:["abbr"]},"http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul":{global:["accesskey","aria-label","aria-valuetext","label","title","tooltiptext"],description:["value"],key:["key","keycode"],label:["value"],textbox:["placeholder","value"]}};function translateElement(element,translation){var value=translation.value;if(typeof value==="string"){if(element.localName==="title"&&element.namespaceURI==="http://www.w3.org/1999/xhtml"){element.textContent=value;}else if(!reOverlay.test(value)){element.textContent=value;}else{var templateElement=element.ownerDocument.createElementNS("http://www.w3.org/1999/xhtml","template");templateElement.innerHTML=value;overlayChildNodes(templateElement.content,element);}}overlayAttributes(translation,element);}function overlayChildNodes(fromFragment,toElement){var _iterator0=_createForOfIteratorHelper(fromFragment.childNodes),_step0;try{for(_iterator0.s();!(_step0=_iterator0.n()).done;){var childNode=_step0.value;if(childNode.nodeType===childNode.TEXT_NODE){continue;}if(childNode.hasAttribute("data-l10n-name")){var sanitized=getNodeForNamedElement(toElement,childNode);fromFragment.replaceChild(sanitized,childNode);continue;}if(isElementAllowed(childNode)){var _sanitized=createSanitizedElement(childNode);fromFragment.replaceChild(_sanitized,childNode);continue;}console.warn("An element of forbidden type \"".concat(childNode.localName,"\" was found in ")+"the translation. Only safe text-level elements and elements with "+"data-l10n-name are allowed.");fromFragment.replaceChild(createTextNodeFromTextContent(childNode),childNode);}}catch(err){_iterator0.e(err);}finally{_iterator0.f();}toElement.textContent="";toElement.appendChild(fromFragment);}function hasAttribute(attributes,name){if(!attributes){return false;}var _iterator1=_createForOfIteratorHelper(attributes),_step1;try{for(_iterator1.s();!(_step1=_iterator1.n()).done;){var attr=_step1.value;if(attr.name===name){return true;}}}catch(err){_iterator1.e(err);}finally{_iterator1.f();}return false;}function overlayAttributes(fromElement,toElement){var explicitlyAllowed=toElement.hasAttribute("data-l10n-attrs")?toElement.getAttribute("data-l10n-attrs").split(",").map(function(i){return i.trim();}):null;for(var _i2=0,_Array$from=Array.from(toElement.attributes);_i2<_Array$from.length;_i2++){var attr=_Array$from[_i2];if(isAttrNameLocalizable(attr.name,toElement,explicitlyAllowed)&&!hasAttribute(fromElement.attributes,attr.name)){toElement.removeAttribute(attr.name);}}if(!fromElement.attributes){return;}for(var _i3=0,_Array$from2=Array.from(fromElement.attributes);_i3<_Array$from2.length;_i3++){var _attr=_Array$from2[_i3];if(isAttrNameLocalizable(_attr.name,toElement,explicitlyAllowed)&&toElement.getAttribute(_attr.name)!==_attr.value){toElement.setAttribute(_attr.name,_attr.value);}}}function getNodeForNamedElement(sourceElement,translatedChild){var childName=translatedChild.getAttribute("data-l10n-name");var sourceChild=sourceElement.querySelector("[data-l10n-name=\"".concat(childName,"\"]"));if(!sourceChild){console.warn("An element named \"".concat(childName,"\" wasn't found in the source."));return createTextNodeFromTextContent(translatedChild);}if(sourceChild.localName!==translatedChild.localName){console.warn("An element named \"".concat(childName,"\" was found in the translation ")+"but its type ".concat(translatedChild.localName," didn't match the ")+"element found in the source (".concat(sourceChild.localName,")."));return createTextNodeFromTextContent(translatedChild);}sourceElement.removeChild(sourceChild);var clone=sourceChild.cloneNode(false);return shallowPopulateUsing(translatedChild,clone);}function createSanitizedElement(element){var clone=element.ownerDocument.createElement(element.localName);return shallowPopulateUsing(element,clone);}function createTextNodeFromTextContent(element){return element.ownerDocument.createTextNode(element.textContent);}function isElementAllowed(element){var allowed=TEXT_LEVEL_ELEMENTS[element.namespaceURI];return allowed&&allowed.includes(element.localName);}function isAttrNameLocalizable(name,element){var explicitlyAllowed=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;if(explicitlyAllowed&&explicitlyAllowed.includes(name)){return true;}var allowed=LOCALIZABLE_ATTRIBUTES[element.namespaceURI];if(!allowed){return false;}var attrName=name.toLowerCase();var elemName=element.localName;if(allowed.global.includes(attrName)){return true;}if(!allowed[elemName]){return false;}if(allowed[elemName].includes(attrName)){return true;}if(element.namespaceURI==="http://www.w3.org/1999/xhtml"&&elemName==="input"&&attrName==="value"){var type=element.type.toLowerCase();if(type==="submit"||type==="button"||type==="reset"){return true;}}return false;}function shallowPopulateUsing(fromElement,toElement){toElement.textContent=fromElement.textContent;overlayAttributes(fromElement,toElement);return toElement;};// ./node_modules/cached-iterable/src/cached_iterable.mjs
var CachedIterable=/*#__PURE__*/function(_Array){function CachedIterable(){_classCallCheck(this,CachedIterable);return _callSuper(this,CachedIterable,arguments);}_inherits(CachedIterable,_Array);return _createClass(CachedIterable,null,[{key:"from",value:function from(iterable){if(iterable instanceof this){return iterable;}return new this(iterable);}}]);}(/*#__PURE__*/_wrapNativeSuper(Array));;// ./node_modules/cached-iterable/src/cached_sync_iterable.mjs
var CachedSyncIterable=/*#__PURE__*/function(_CachedIterable){function CachedSyncIterable(iterable){var _this8;_classCallCheck(this,CachedSyncIterable);_this8=_callSuper(this,CachedSyncIterable);if(Symbol.iterator in Object(iterable)){_this8.iterator=iterable[Symbol.iterator]();}else{throw new TypeError("Argument must implement the iteration protocol.");}return _this8;}_inherits(CachedSyncIterable,_CachedIterable);return _createClass(CachedSyncIterable,[{key:Symbol.iterator,value:function value(){var cached=this;var cur=0;return{next:function next(){if(cached.length<=cur){cached.push(cached.iterator.next());}return cached[cur++];}};}},{key:"touchNext",value:function touchNext(){var count=arguments.length>0&&arguments[0]!==undefined?arguments[0]:1;var idx=0;while(idx++<count){var last=this[this.length-1];if(last&&last.done){break;}this.push(this.iterator.next());}return this[this.length-1];}}]);}(CachedIterable);;// ./node_modules/cached-iterable/src/cached_async_iterable.mjs
var CachedAsyncIterable=/*#__PURE__*/function(_CachedIterable2){function CachedAsyncIterable(iterable){var _this9;_classCallCheck(this,CachedAsyncIterable);_this9=_callSuper(this,CachedAsyncIterable);if(Symbol.asyncIterator in Object(iterable)){_this9.iterator=iterable[Symbol.asyncIterator]();}else if(Symbol.iterator in Object(iterable)){_this9.iterator=iterable[Symbol.iterator]();}else{throw new TypeError("Argument must implement the iteration protocol.");}return _this9;}_inherits(CachedAsyncIterable,_CachedIterable2);return _createClass(CachedAsyncIterable,[{key:Symbol.asyncIterator,value:function value(){var cached=this;var cur=0;return{next:function next(){return _asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee9(){return _regenerator().w(function(_context9){while(1)switch(_context9.n){case 0:if(cached.length<=cur){cached.push(cached.iterator.next());}return _context9.a(2,cached[cur++]);}},_callee9);}))();}};}},{key:"touchNext",value:function(){var _touchNext=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee0(){var count,idx,last,_args0=arguments,_t3;return _regenerator().w(function(_context0){while(1)switch(_context0.n){case 0:count=_args0.length>0&&_args0[0]!==undefined?_args0[0]:1;idx=0;case 1:if(!(idx++<count)){_context0.n=5;break;}last=this[this.length-1];_t3=last;if(!_t3){_context0.n=3;break;}_context0.n=2;return last;case 2:_t3=_context0.v.done;case 3:if(!_t3){_context0.n=4;break;}return _context0.a(3,5);case 4:this.push(this.iterator.next());_context0.n=1;break;case 5:return _context0.a(2,this[this.length-1]);}},_callee0,this);}));function touchNext(){return _touchNext.apply(this,arguments);}return touchNext;}()}]);}(CachedIterable);;// ./node_modules/cached-iterable/src/index.mjs
;// ./node_modules/@fluent/dom/esm/localization.js
var Localization=/*#__PURE__*/function(){function Localization(){var resourceIds=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];var generateBundles=arguments.length>1?arguments[1]:undefined;_classCallCheck(this,Localization);this.resourceIds=resourceIds;this.generateBundles=generateBundles;this.onChange(true);}return _createClass(Localization,[{key:"addResourceIds",value:function addResourceIds(resourceIds){var _this$resourceIds;var eager=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;(_this$resourceIds=this.resourceIds).push.apply(_this$resourceIds,_toConsumableArray(resourceIds));this.onChange(eager);return this.resourceIds.length;}},{key:"removeResourceIds",value:function removeResourceIds(resourceIds){this.resourceIds=this.resourceIds.filter(function(r){return!resourceIds.includes(r);});this.onChange();return this.resourceIds.length;}},{key:"formatWithFallback",value:function(){var _formatWithFallback=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee1(keys,method){var translations,hasAtLeastOneBundle,_iteratorAbruptCompletion,_didIteratorError,_iteratorError,_iterator,_step,bundle,missingIds,locale,ids,_t4;return _regenerator().w(function(_context1){while(1)switch(_context1.n){case 0:translations=[];hasAtLeastOneBundle=false;_iteratorAbruptCompletion=false;_didIteratorError=false;_context1.p=1;_iterator=_asyncIterator(this.bundles);case 2:_context1.n=3;return _iterator.next();case 3:if(!(_iteratorAbruptCompletion=!(_step=_context1.v).done)){_context1.n=6;break;}bundle=_step.value;hasAtLeastOneBundle=true;missingIds=keysFromBundle(method,bundle,keys,translations);if(!(missingIds.size===0)){_context1.n=4;break;}return _context1.a(3,6);case 4:if(typeof console!=="undefined"){locale=bundle.locales[0];ids=Array.from(missingIds).join(", ");console.warn("[fluent] Missing translations in ".concat(locale,": ").concat(ids));}case 5:_iteratorAbruptCompletion=false;_context1.n=2;break;case 6:_context1.n=8;break;case 7:_context1.p=7;_t4=_context1.v;_didIteratorError=true;_iteratorError=_t4;case 8:_context1.p=8;_context1.p=9;if(!(_iteratorAbruptCompletion&&_iterator["return"]!=null)){_context1.n=10;break;}_context1.n=10;return _iterator["return"]();case 10:_context1.p=10;if(!_didIteratorError){_context1.n=11;break;}throw _iteratorError;case 11:return _context1.f(10);case 12:return _context1.f(8);case 13:if(!hasAtLeastOneBundle&&typeof console!=="undefined"){console.warn("[fluent] Request for keys failed because no resource bundles got generated.\n  keys: ".concat(JSON.stringify(keys),".\n  resourceIds: ").concat(JSON.stringify(this.resourceIds),"."));}return _context1.a(2,translations);}},_callee1,this,[[9,,10,12],[1,7,8,13]]);}));function formatWithFallback(_x9,_x0){return _formatWithFallback.apply(this,arguments);}return formatWithFallback;}()},{key:"formatMessages",value:function formatMessages(keys){return this.formatWithFallback(keys,messageFromBundle);}},{key:"formatValues",value:function formatValues(keys){return this.formatWithFallback(keys,valueFromBundle);}},{key:"formatValue",value:function(){var _formatValue=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee10(id,args){var _yield$this$formatVal,_yield$this$formatVal2,val;return _regenerator().w(function(_context10){while(1)switch(_context10.n){case 0:_context10.n=1;return this.formatValues([{id:id,args:args}]);case 1:_yield$this$formatVal=_context10.v;_yield$this$formatVal2=_slicedToArray(_yield$this$formatVal,1);val=_yield$this$formatVal2[0];return _context10.a(2,val);}},_callee10,this);}));function formatValue(_x1,_x10){return _formatValue.apply(this,arguments);}return formatValue;}()},{key:"handleEvent",value:function handleEvent(){this.onChange();}},{key:"onChange",value:function onChange(){var eager=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;this.bundles=CachedAsyncIterable.from(this.generateBundles(this.resourceIds));if(eager){this.bundles.touchNext(2);}}}]);}();function valueFromBundle(bundle,errors,message,args){if(message.value){return bundle.formatPattern(message.value,args,errors);}return null;}function messageFromBundle(bundle,errors,message,args){var formatted={value:null,attributes:null};if(message.value){formatted.value=bundle.formatPattern(message.value,args,errors);}var attrNames=Object.keys(message.attributes);if(attrNames.length>0){formatted.attributes=new Array(attrNames.length);var _iterator10=_createForOfIteratorHelper(attrNames.entries()),_step10;try{for(_iterator10.s();!(_step10=_iterator10.n()).done;){var _step10$value=_slicedToArray(_step10.value,2),i=_step10$value[0],name=_step10$value[1];var value=bundle.formatPattern(message.attributes[name],args,errors);formatted.attributes[i]={name:name,value:value};}}catch(err){_iterator10.e(err);}finally{_iterator10.f();}}return formatted;}function keysFromBundle(method,bundle,keys,translations){var messageErrors=[];var missingIds=new Set();keys.forEach(function(_ref11,i){var id=_ref11.id,args=_ref11.args;if(translations[i]!==undefined){return;}var message=bundle.getMessage(id);if(message){messageErrors.length=0;translations[i]=method(bundle,messageErrors,message,args);if(messageErrors.length>0&&typeof console!=="undefined"){var locale=bundle.locales[0];var errors=messageErrors.join(", ");console.warn("[fluent][resolver] errors in ".concat(locale,"/").concat(id,": ").concat(errors,"."));}}else{missingIds.add(id);}});return missingIds;};// ./node_modules/@fluent/dom/esm/dom_localization.js
var L10NID_ATTR_NAME="data-l10n-id";var L10NARGS_ATTR_NAME="data-l10n-args";var L10N_ELEMENT_QUERY="[".concat(L10NID_ATTR_NAME,"]");var DOMLocalization=/*#__PURE__*/function(_Localization){function DOMLocalization(resourceIds,generateBundles){var _this0;_classCallCheck(this,DOMLocalization);_this0=_callSuper(this,DOMLocalization,[resourceIds,generateBundles]);_this0.roots=new Set();_this0.pendingrAF=null;_this0.pendingElements=new Set();_this0.windowElement=null;_this0.mutationObserver=null;_this0.observerConfig={attributes:true,characterData:false,childList:true,subtree:true,attributeFilter:[L10NID_ATTR_NAME,L10NARGS_ATTR_NAME]};return _this0;}_inherits(DOMLocalization,_Localization);return _createClass(DOMLocalization,[{key:"onChange",value:function onChange(){var eager=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;_superPropGet(DOMLocalization,"onChange",this,3)([eager]);if(this.roots){this.translateRoots();}}},{key:"setAttributes",value:function setAttributes(element,id,args){element.setAttribute(L10NID_ATTR_NAME,id);if(args){element.setAttribute(L10NARGS_ATTR_NAME,JSON.stringify(args));}else{element.removeAttribute(L10NARGS_ATTR_NAME);}return element;}},{key:"getAttributes",value:function getAttributes(element){return{id:element.getAttribute(L10NID_ATTR_NAME),args:JSON.parse(element.getAttribute(L10NARGS_ATTR_NAME)||null)};}},{key:"connectRoot",value:function connectRoot(newRoot){var _this1=this;var _iterator11=_createForOfIteratorHelper(this.roots),_step11;try{for(_iterator11.s();!(_step11=_iterator11.n()).done;){var root=_step11.value;if(root===newRoot||root.contains(newRoot)||newRoot.contains(root)){throw new Error("Cannot add a root that overlaps with existing root.");}}}catch(err){_iterator11.e(err);}finally{_iterator11.f();}if(this.windowElement){if(this.windowElement!==newRoot.ownerDocument.defaultView){throw new Error("Cannot connect a root:\n          DOMLocalization already has a root from a different window.");}}else{this.windowElement=newRoot.ownerDocument.defaultView;this.mutationObserver=new this.windowElement.MutationObserver(function(mutations){return _this1.translateMutations(mutations);});}this.roots.add(newRoot);this.mutationObserver.observe(newRoot,this.observerConfig);}},{key:"disconnectRoot",value:function disconnectRoot(root){this.roots["delete"](root);this.pauseObserving();if(this.roots.size===0){this.mutationObserver=null;if(this.windowElement&&this.pendingrAF){this.windowElement.cancelAnimationFrame(this.pendingrAF);}this.windowElement=null;this.pendingrAF=null;this.pendingElements.clear();return true;}this.resumeObserving();return false;}},{key:"translateRoots",value:function translateRoots(){var _this10=this;var roots=Array.from(this.roots);return Promise.all(roots.map(function(root){return _this10.translateFragment(root);}));}},{key:"pauseObserving",value:function pauseObserving(){if(!this.mutationObserver){return;}this.translateMutations(this.mutationObserver.takeRecords());this.mutationObserver.disconnect();}},{key:"resumeObserving",value:function resumeObserving(){if(!this.mutationObserver){return;}var _iterator12=_createForOfIteratorHelper(this.roots),_step12;try{for(_iterator12.s();!(_step12=_iterator12.n()).done;){var root=_step12.value;this.mutationObserver.observe(root,this.observerConfig);}}catch(err){_iterator12.e(err);}finally{_iterator12.f();}}},{key:"translateMutations",value:function translateMutations(mutations){var _this11=this;var _iterator13=_createForOfIteratorHelper(mutations),_step13;try{for(_iterator13.s();!(_step13=_iterator13.n()).done;){var mutation=_step13.value;switch(mutation.type){case"attributes":if(mutation.target.hasAttribute("data-l10n-id")){this.pendingElements.add(mutation.target);}break;case"childList":var _iterator14=_createForOfIteratorHelper(mutation.addedNodes),_step14;try{for(_iterator14.s();!(_step14=_iterator14.n()).done;){var addedNode=_step14.value;if(addedNode.nodeType===addedNode.ELEMENT_NODE){if(addedNode.childElementCount){var _iterator15=_createForOfIteratorHelper(this.getTranslatables(addedNode)),_step15;try{for(_iterator15.s();!(_step15=_iterator15.n()).done;){var element=_step15.value;this.pendingElements.add(element);}}catch(err){_iterator15.e(err);}finally{_iterator15.f();}}else if(addedNode.hasAttribute(L10NID_ATTR_NAME)){this.pendingElements.add(addedNode);}}}}catch(err){_iterator14.e(err);}finally{_iterator14.f();}break;}}}catch(err){_iterator13.e(err);}finally{_iterator13.f();}if(this.pendingElements.size>0){if(this.pendingrAF===null){this.pendingrAF=this.windowElement.requestAnimationFrame(function(){_this11.translateElements(Array.from(_this11.pendingElements));_this11.pendingElements.clear();_this11.pendingrAF=null;});}}}},{key:"translateFragment",value:function translateFragment(frag){return this.translateElements(this.getTranslatables(frag));}},{key:"translateElements",value:function(){var _translateElements=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee11(elements){var keys,translations;return _regenerator().w(function(_context11){while(1)switch(_context11.n){case 0:if(elements.length){_context11.n=1;break;}return _context11.a(2,undefined);case 1:keys=elements.map(this.getKeysForElement);_context11.n=2;return this.formatMessages(keys);case 2:translations=_context11.v;return _context11.a(2,this.applyTranslations(elements,translations));}},_callee11,this);}));function translateElements(_x11){return _translateElements.apply(this,arguments);}return translateElements;}()},{key:"applyTranslations",value:function applyTranslations(elements,translations){this.pauseObserving();for(var i=0;i<elements.length;i++){if(translations[i]!==undefined){translateElement(elements[i],translations[i]);}}this.resumeObserving();}},{key:"getTranslatables",value:function getTranslatables(element){var nodes=Array.from(element.querySelectorAll(L10N_ELEMENT_QUERY));if(typeof element.hasAttribute==="function"&&element.hasAttribute(L10NID_ATTR_NAME)){nodes.push(element);}return nodes;}},{key:"getKeysForElement",value:function getKeysForElement(element){return{id:element.getAttribute(L10NID_ATTR_NAME),args:JSON.parse(element.getAttribute(L10NARGS_ATTR_NAME)||null)};}}]);}(Localization);;// ./node_modules/@fluent/dom/esm/index.js
;// ./web/l10n.js
var _dir=/*#__PURE__*/new WeakMap();var _elements=/*#__PURE__*/new WeakMap();var _lang=/*#__PURE__*/new WeakMap();var _l10n=/*#__PURE__*/new WeakMap();var L10n=/*#__PURE__*/function(){function L10n(_ref12){var lang=_ref12.lang,isRTL=_ref12.isRTL;var l10n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;_classCallCheck(this,L10n);_classPrivateFieldInitSpec(this,_dir,void 0);_classPrivateFieldInitSpec(this,_elements,void 0);_classPrivateFieldInitSpec(this,_lang,void 0);_classPrivateFieldInitSpec(this,_l10n,void 0);_classPrivateFieldSet(_lang,this,_fixupLangCode.call(L10n,lang));_classPrivateFieldSet(_l10n,this,l10n);_classPrivateFieldSet(_dir,this,(isRTL!==null&&isRTL!==void 0?isRTL:_isRTL.call(L10n,_classPrivateFieldGet(_lang,this)))?"rtl":"ltr");}return _createClass(L10n,[{key:"_setL10n",value:function _setL10n(l10n){_classPrivateFieldSet(_l10n,this,l10n);}},{key:"getLanguage",value:function getLanguage(){return _classPrivateFieldGet(_lang,this);}},{key:"getDirection",value:function getDirection(){return _classPrivateFieldGet(_dir,this);}},{key:"get",value:function(){var _get3=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee12(ids){var _messages$;var args,fallback,_messages,messages,_args12=arguments;return _regenerator().w(function(_context12){while(1)switch(_context12.n){case 0:args=_args12.length>1&&_args12[1]!==undefined?_args12[1]:null;fallback=_args12.length>2?_args12[2]:undefined;if(!Array.isArray(ids)){_context12.n=2;break;}ids=ids.map(function(id){return{id:id};});_context12.n=1;return _classPrivateFieldGet(_l10n,this).formatMessages(ids);case 1:_messages=_context12.v;return _context12.a(2,_messages.map(function(message){return message.value;}));case 2:_context12.n=3;return _classPrivateFieldGet(_l10n,this).formatMessages([{id:ids,args:args}]);case 3:messages=_context12.v;return _context12.a(2,((_messages$=messages[0])===null||_messages$===void 0?void 0:_messages$.value)||fallback);}},_callee12,this);}));function get(_x12){return _get3.apply(this,arguments);}return get;}()},{key:"translate",value:function(){var _translate=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee13(element){var _t5;return _regenerator().w(function(_context13){while(1)switch(_context13.n){case 0:(_classPrivateFieldGet(_elements,this)||_classPrivateFieldSet(_elements,this,new Set())).add(element);_context13.p=1;_classPrivateFieldGet(_l10n,this).connectRoot(element);_context13.n=2;return _classPrivateFieldGet(_l10n,this).translateRoots();case 2:_context13.n=4;break;case 3:_context13.p=3;_t5=_context13.v;case 4:return _context13.a(2);}},_callee13,this,[[1,3]]);}));function translate(_x13){return _translate.apply(this,arguments);}return translate;}()},{key:"translateOnce",value:function(){var _translateOnce=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee14(element){var _t6;return _regenerator().w(function(_context14){while(1)switch(_context14.n){case 0:_context14.p=0;_context14.n=1;return _classPrivateFieldGet(_l10n,this).translateElements([element]);case 1:_context14.n=3;break;case 2:_context14.p=2;_t6=_context14.v;console.error("translateOnce:",_t6);case 3:return _context14.a(2);}},_callee14,this,[[0,2]]);}));function translateOnce(_x14){return _translateOnce.apply(this,arguments);}return translateOnce;}()},{key:"destroy",value:function(){var _destroy=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee15(){var _iterator16,_step16,element;return _regenerator().w(function(_context15){while(1)switch(_context15.n){case 0:if(_classPrivateFieldGet(_elements,this)){_iterator16=_createForOfIteratorHelper(_classPrivateFieldGet(_elements,this));try{for(_iterator16.s();!(_step16=_iterator16.n()).done;){element=_step16.value;_classPrivateFieldGet(_l10n,this).disconnectRoot(element);}}catch(err){_iterator16.e(err);}finally{_iterator16.f();}_classPrivateFieldGet(_elements,this).clear();_classPrivateFieldSet(_elements,this,null);}_classPrivateFieldGet(_l10n,this).pauseObserving();case 1:return _context15.a(2);}},_callee15,this);}));function destroy(){return _destroy.apply(this,arguments);}return destroy;}()},{key:"pause",value:function pause(){_classPrivateFieldGet(_l10n,this).pauseObserving();}},{key:"resume",value:function resume(){_classPrivateFieldGet(_l10n,this).resumeObserving();}}]);}();function _fixupLangCode(langCode){var _langCode;langCode=((_langCode=langCode)===null||_langCode===void 0?void 0:_langCode.toLowerCase())||"en-us";var PARTIAL_LANG_CODES={en:"en-us",es:"es-es",fy:"fy-nl",ga:"ga-ie",gu:"gu-in",hi:"hi-in",hy:"hy-am",nb:"nb-no",ne:"ne-np",nn:"nn-no",pa:"pa-in",pt:"pt-pt",sv:"sv-se",zh:"zh-cn"};return PARTIAL_LANG_CODES[langCode]||langCode;}function _isRTL(lang){var shortCode=lang.split("-",1)[0];return["ar","he","fa","ps","ur"].includes(shortCode);}var GenericL10n=null;;// ./web/genericl10n.js
function PLATFORM(){var _FeatureTest$platform=FeatureTest.platform,isAndroid=_FeatureTest$platform.isAndroid,isLinux=_FeatureTest$platform.isLinux,isMac=_FeatureTest$platform.isMac,isWindows=_FeatureTest$platform.isWindows;if(isLinux){return"linux";}if(isWindows){return"windows";}if(isMac){return"macos";}if(isAndroid){return"android";}return"other";}function createBundle(lang,text){var resource=new FluentResource(text);var bundle=new FluentBundle(lang,{functions:{PLATFORM:PLATFORM}});var errors=bundle.addResource(resource);if(errors.length){console.error("L10n errors",errors);}return bundle;}var genericl10n_GenericL10n=/*#__PURE__*/function(_L10n2){function genericl10n_GenericL10n(lang){var _this12;_classCallCheck(this,genericl10n_GenericL10n);_this12=_callSuper(this,genericl10n_GenericL10n,[{lang:lang}]);var generateBundles=!lang?_generateBundlesFallback.bind(genericl10n_GenericL10n,_this12.getLanguage()):_generateBundles.bind(genericl10n_GenericL10n,"en-us",_this12.getLanguage());_this12._setL10n(new DOMLocalization([],generateBundles));return _this12;}_inherits(genericl10n_GenericL10n,_L10n2);return _createClass(genericl10n_GenericL10n);}(L10n);_genericl10n_GenericL10n=genericl10n_GenericL10n;function _generateBundles(defaultLang,baseLang){var _this=this;return _wrapAsyncGenerator(/*#__PURE__*/_regenerator().m(function _callee99(){var _yield$_awaitAsyncGen,baseURL,paths,langs,shortLang,bundles,_iterator51,_step51,_step51$value,lang,bundlePromise,bundle,_t43;return _regenerator().w(function(_context100){while(1)switch(_context100.n){case 0:_context100.n=1;return _awaitAsyncGenerator(_assertClassBrand(_genericl10n_GenericL10n,_this,_getPaths).call(_this));case 1:_yield$_awaitAsyncGen=_context100.v;baseURL=_yield$_awaitAsyncGen.baseURL;paths=_yield$_awaitAsyncGen.paths;langs=[baseLang];if(defaultLang!==baseLang){shortLang=baseLang.split("-",1)[0];if(shortLang!==baseLang){langs.push(shortLang);}langs.push(defaultLang);}bundles=langs.map(function(lang){return[lang,_assertClassBrand(_genericl10n_GenericL10n,_this,_createBundle).call(_this,lang,baseURL,paths)];});_iterator51=_createForOfIteratorHelper(bundles);_context100.p=2;_iterator51.s();case 3:if((_step51=_iterator51.n()).done){_context100.n=8;break;}_step51$value=_slicedToArray(_step51.value,2),lang=_step51$value[0],bundlePromise=_step51$value[1];_context100.n=4;return _awaitAsyncGenerator(bundlePromise);case 4:bundle=_context100.v;if(!bundle){_context100.n=6;break;}_context100.n=5;return bundle;case 5:_context100.n=7;break;case 6:if(!(lang==="en-us")){_context100.n=7;break;}_context100.n=7;return _assertClassBrand(_genericl10n_GenericL10n,_this,_createBundleFallback).call(_this,lang);case 7:_context100.n=3;break;case 8:_context100.n=10;break;case 9:_context100.p=9;_t43=_context100.v;_iterator51.e(_t43);case 10:_context100.p=10;_iterator51.f();return _context100.f(10);case 11:return _context100.a(2);}},_callee99,null,[[2,9,10,11]]);}))();}function _createBundle(_x60,_x61,_x62){return _createBundle3.apply(this,arguments);}function _createBundle3(){_createBundle3=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee106(lang,baseURL,paths){var path,url,text;return _regenerator().w(function(_context107){while(1)switch(_context107.n){case 0:path=paths[lang];if(path){_context107.n=1;break;}return _context107.a(2,null);case 1:url=new URL(path,baseURL);_context107.n=2;return fetchData(url,"text");case 2:text=_context107.v;return _context107.a(2,createBundle(lang,text));}},_callee106);}));return _createBundle3.apply(this,arguments);}function _getPaths(){return _getPaths3.apply(this,arguments);}function _getPaths3(){_getPaths3=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee107(){var _document$querySelect,href,paths,_t64;return _regenerator().w(function(_context108){while(1)switch(_context108.n){case 0:_context108.p=0;_document$querySelect=document.querySelector("link[type=\"application/l10n\"]"),href=_document$querySelect.href;_context108.n=1;return fetchData(href,"json");case 1:paths=_context108.v;return _context108.a(2,{baseURL:href.substring(0,href.lastIndexOf("/")+1)||"./",paths:paths});case 2:_context108.p=2;_t64=_context108.v;return _context108.a(2,{baseURL:"./",paths:Object.create(null)});}},_callee107,null,[[0,2]]);}));return _getPaths3.apply(this,arguments);}function _generateBundlesFallback(lang){var _this2=this;return _wrapAsyncGenerator(/*#__PURE__*/_regenerator().m(function _callee100(){return _regenerator().w(function(_context101){while(1)switch(_context101.n){case 0:_context101.n=1;return _assertClassBrand(_genericl10n_GenericL10n,_this2,_createBundleFallback).call(_this2,lang);case 1:return _context101.a(2);}},_callee100);}))();}function _createBundleFallback(_x63){return _createBundleFallback3.apply(this,arguments);}function _createBundleFallback3(){_createBundleFallback3=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee108(lang){var text;return _regenerator().w(function(_context109){while(1)switch(_context109.n){case 0:text="pdfjs-previous-button =\n    .title = Previous Page\npdfjs-previous-button-label = Previous\npdfjs-next-button =\n    .title = Next Page\npdfjs-next-button-label = Next\npdfjs-page-input =\n    .title = Page\npdfjs-of-pages = of { $pagesCount }\npdfjs-page-of-pages = ({ $pageNumber } of { $pagesCount })\npdfjs-zoom-out-button =\n    .title = Zoom Out\npdfjs-zoom-out-button-label = Zoom Out\npdfjs-zoom-in-button =\n    .title = Zoom In\npdfjs-zoom-in-button-label = Zoom In\npdfjs-zoom-select =\n    .title = Zoom\npdfjs-presentation-mode-button =\n    .title = Switch to Presentation Mode\npdfjs-presentation-mode-button-label = Presentation Mode\npdfjs-open-file-button =\n    .title = Open File\npdfjs-open-file-button-label = Open\npdfjs-print-button =\n    .title = Print\npdfjs-print-button-label = Print\npdfjs-save-button =\n    .title = Save\npdfjs-save-button-label = Save\npdfjs-download-button =\n    .title = Download\npdfjs-download-button-label = Download\npdfjs-bookmark-button =\n    .title = Current Page (View URL from Current Page)\npdfjs-bookmark-button-label = Current Page\npdfjs-tools-button =\n    .title = Tools\npdfjs-tools-button-label = Tools\npdfjs-first-page-button =\n    .title = Go to First Page\npdfjs-first-page-button-label = Go to First Page\npdfjs-last-page-button =\n    .title = Go to Last Page\npdfjs-last-page-button-label = Go to Last Page\npdfjs-page-rotate-cw-button =\n    .title = Rotate Clockwise\npdfjs-page-rotate-cw-button-label = Rotate Clockwise\npdfjs-page-rotate-ccw-button =\n    .title = Rotate Counterclockwise\npdfjs-page-rotate-ccw-button-label = Rotate Counterclockwise\npdfjs-cursor-text-select-tool-button =\n    .title = Enable Text Selection Tool\npdfjs-cursor-text-select-tool-button-label = Text Selection Tool\npdfjs-cursor-hand-tool-button =\n    .title = Enable Hand Tool\npdfjs-cursor-hand-tool-button-label = Hand Tool\npdfjs-scroll-page-button =\n    .title = Use Page Scrolling\npdfjs-scroll-page-button-label = Page Scrolling\npdfjs-scroll-vertical-button =\n    .title = Use Vertical Scrolling\npdfjs-scroll-vertical-button-label = Vertical Scrolling\npdfjs-scroll-horizontal-button =\n    .title = Use Horizontal Scrolling\npdfjs-scroll-horizontal-button-label = Horizontal Scrolling\npdfjs-scroll-wrapped-button =\n    .title = Use Wrapped Scrolling\npdfjs-scroll-wrapped-button-label = Wrapped Scrolling\npdfjs-spread-none-button =\n    .title = Do not join page spreads\npdfjs-spread-none-button-label = No Spreads\npdfjs-spread-odd-button =\n    .title = Join page spreads starting with odd-numbered pages\npdfjs-spread-odd-button-label = Odd Spreads\npdfjs-spread-even-button =\n    .title = Join page spreads starting with even-numbered pages\npdfjs-spread-even-button-label = Even Spreads\npdfjs-document-properties-button =\n    .title = Document Properties\u2026\npdfjs-document-properties-button-label = Document Properties\u2026\npdfjs-document-properties-file-name = File name:\npdfjs-document-properties-file-size = File size:\npdfjs-document-properties-size-kb = { NUMBER($kb, maximumSignificantDigits: 3) } KB ({ $b } bytes)\npdfjs-document-properties-size-mb = { NUMBER($mb, maximumSignificantDigits: 3) } MB ({ $b } bytes)\npdfjs-document-properties-title = Title:\npdfjs-document-properties-author = Author:\npdfjs-document-properties-subject = Subject:\npdfjs-document-properties-keywords = Keywords:\npdfjs-document-properties-creation-date = Creation Date:\npdfjs-document-properties-modification-date = Modification Date:\npdfjs-document-properties-date-time-string = { DATETIME($dateObj, dateStyle: \"short\", timeStyle: \"medium\") }\npdfjs-document-properties-creator = Creator:\npdfjs-document-properties-producer = PDF Producer:\npdfjs-document-properties-version = PDF Version:\npdfjs-document-properties-page-count = Page Count:\npdfjs-document-properties-page-size = Page Size:\npdfjs-document-properties-page-size-unit-inches = in\npdfjs-document-properties-page-size-unit-millimeters = mm\npdfjs-document-properties-page-size-orientation-portrait = portrait\npdfjs-document-properties-page-size-orientation-landscape = landscape\npdfjs-document-properties-page-size-name-a-three = A3\npdfjs-document-properties-page-size-name-a-four = A4\npdfjs-document-properties-page-size-name-letter = Letter\npdfjs-document-properties-page-size-name-legal = Legal\npdfjs-document-properties-page-size-dimension-string = { $width } \xD7 { $height } { $unit } ({ $orientation })\npdfjs-document-properties-page-size-dimension-name-string = { $width } \xD7 { $height } { $unit } ({ $name }, { $orientation })\npdfjs-document-properties-linearized = Fast Web View:\npdfjs-document-properties-linearized-yes = Yes\npdfjs-document-properties-linearized-no = No\npdfjs-document-properties-close-button = Close\npdfjs-print-progress-message = Preparing document for printing\u2026\npdfjs-print-progress-percent = { $progress }%\npdfjs-print-progress-close-button = Cancel\npdfjs-printing-not-supported = Warning: Printing is not fully supported by this browser.\npdfjs-printing-not-ready = Warning: The PDF is not fully loaded for printing.\npdfjs-toggle-sidebar-button =\n    .title = Toggle Sidebar\npdfjs-toggle-sidebar-notification-button =\n    .title = Toggle Sidebar (document contains outline/attachments/layers)\npdfjs-toggle-sidebar-button-label = Toggle Sidebar\npdfjs-document-outline-button =\n    .title = Show Document Outline (double-click to expand/collapse all items)\npdfjs-document-outline-button-label = Document Outline\npdfjs-attachments-button =\n    .title = Show Attachments\npdfjs-attachments-button-label = Attachments\npdfjs-layers-button =\n    .title = Show Layers (double-click to reset all layers to the default state)\npdfjs-layers-button-label = Layers\npdfjs-thumbs-button =\n    .title = Show Thumbnails\npdfjs-thumbs-button-label = Thumbnails\npdfjs-current-outline-item-button =\n    .title = Find Current Outline Item\npdfjs-current-outline-item-button-label = Current Outline Item\npdfjs-findbar-button =\n    .title = Find in Document\npdfjs-findbar-button-label = Find\npdfjs-additional-layers = Additional Layers\npdfjs-thumb-page-title =\n    .title = Page { $page }\npdfjs-thumb-page-canvas =\n    .aria-label = Thumbnail of Page { $page }\npdfjs-find-input =\n    .title = Find\n    .placeholder = Find in document\u2026\npdfjs-find-previous-button =\n    .title = Find the previous occurrence of the phrase\npdfjs-find-previous-button-label = Previous\npdfjs-find-next-button =\n    .title = Find the next occurrence of the phrase\npdfjs-find-next-button-label = Next\npdfjs-find-highlight-checkbox = Highlight All\npdfjs-find-match-case-checkbox-label = Match Case\npdfjs-find-match-diacritics-checkbox-label = Match Diacritics\npdfjs-find-entire-word-checkbox-label = Whole Words\npdfjs-find-reached-top = Reached top of document, continued from bottom\npdfjs-find-reached-bottom = Reached end of document, continued from top\npdfjs-find-match-count =\n    { $total ->\n        [one] { $current } of { $total } match\n       *[other] { $current } of { $total } matches\n    }\npdfjs-find-match-count-limit =\n    { $limit ->\n        [one] More than { $limit } match\n       *[other] More than { $limit } matches\n    }\npdfjs-find-not-found = Phrase not found\npdfjs-page-scale-width = Page Width\npdfjs-page-scale-fit = Page Fit\npdfjs-page-scale-auto = Automatic Zoom\npdfjs-page-scale-actual = Actual Size\npdfjs-page-scale-percent = { $scale }%\npdfjs-page-landmark =\n    .aria-label = Page { $page }\npdfjs-loading-error = An error occurred while loading the PDF.\npdfjs-invalid-file-error = Invalid or corrupted PDF file.\npdfjs-missing-file-error = Missing PDF file.\npdfjs-unexpected-response-error = Unexpected server response.\npdfjs-rendering-error = An error occurred while rendering the page.\npdfjs-annotation-date-time-string = { DATETIME($dateObj, dateStyle: \"short\", timeStyle: \"medium\") }\npdfjs-text-annotation-type =\n    .alt = [{ $type } Annotation]\npdfjs-password-label = Enter the password to open this PDF file.\npdfjs-password-invalid = Invalid password. Please try again.\npdfjs-password-ok-button = OK\npdfjs-password-cancel-button = Cancel\npdfjs-web-fonts-disabled = Web fonts are disabled: unable to use embedded PDF fonts.\npdfjs-editor-free-text-button =\n    .title = Text\npdfjs-editor-free-text-button-label = Text\npdfjs-editor-ink-button =\n    .title = Draw\npdfjs-editor-ink-button-label = Draw\npdfjs-editor-stamp-button =\n    .title = Add or edit images\npdfjs-editor-stamp-button-label = Add or edit images\npdfjs-editor-highlight-button =\n    .title = Highlight\npdfjs-editor-highlight-button-label = Highlight\npdfjs-highlight-floating-button1 =\n    .title = Highlight\n    .aria-label = Highlight\npdfjs-highlight-floating-button-label = Highlight\npdfjs-editor-signature-button =\n    .title = Add signature\npdfjs-editor-signature-button-label = Add signature\npdfjs-editor-highlight-editor =\n    .aria-label = Highlight editor\npdfjs-editor-ink-editor =\n    .aria-label = Drawing editor\npdfjs-editor-signature-editor1 =\n    .aria-description = Signature editor: { $description }\npdfjs-editor-stamp-editor =\n    .aria-label = Image editor\npdfjs-editor-remove-ink-button =\n    .title = Remove drawing\npdfjs-editor-remove-freetext-button =\n    .title = Remove text\npdfjs-editor-remove-stamp-button =\n    .title = Remove image\npdfjs-editor-remove-highlight-button =\n    .title = Remove highlight\npdfjs-editor-remove-signature-button =\n    .title = Remove signature\npdfjs-editor-free-text-color-input = Color\npdfjs-editor-free-text-size-input = Size\npdfjs-editor-ink-color-input = Color\npdfjs-editor-ink-thickness-input = Thickness\npdfjs-editor-ink-opacity-input = Opacity\npdfjs-editor-stamp-add-image-button =\n    .title = Add image\npdfjs-editor-stamp-add-image-button-label = Add image\npdfjs-editor-free-highlight-thickness-input = Thickness\npdfjs-editor-free-highlight-thickness-title =\n    .title = Change thickness when highlighting items other than text\npdfjs-editor-add-signature-container =\n    .aria-label = Signature controls and saved signatures\npdfjs-editor-signature-add-signature-button =\n    .title = Add new signature\npdfjs-editor-signature-add-signature-button-label = Add new signature\npdfjs-editor-add-saved-signature-button =\n    .title = Saved signature: { $description }\npdfjs-free-text2 =\n    .aria-label = Text Editor\n    .default-content = Start typing\u2026\npdfjs-editor-alt-text-button =\n    .aria-label = Alt text\npdfjs-editor-alt-text-button-label = Alt text\npdfjs-editor-alt-text-edit-button =\n    .aria-label = Edit alt text\npdfjs-editor-alt-text-dialog-label = Choose an option\npdfjs-editor-alt-text-dialog-description = Alt text (alternative text) helps when people can\u2019t see the image or when it doesn\u2019t load.\npdfjs-editor-alt-text-add-description-label = Add a description\npdfjs-editor-alt-text-add-description-description = Aim for 1-2 sentences that describe the subject, setting, or actions.\npdfjs-editor-alt-text-mark-decorative-label = Mark as decorative\npdfjs-editor-alt-text-mark-decorative-description = This is used for ornamental images, like borders or watermarks.\npdfjs-editor-alt-text-cancel-button = Cancel\npdfjs-editor-alt-text-save-button = Save\npdfjs-editor-alt-text-decorative-tooltip = Marked as decorative\npdfjs-editor-alt-text-textarea =\n    .placeholder = For example, \u201CA young man sits down at a table to eat a meal\u201D\npdfjs-editor-resizer-top-left =\n    .aria-label = Top left corner \u2014 resize\npdfjs-editor-resizer-top-middle =\n    .aria-label = Top middle \u2014 resize\npdfjs-editor-resizer-top-right =\n    .aria-label = Top right corner \u2014 resize\npdfjs-editor-resizer-middle-right =\n    .aria-label = Middle right \u2014 resize\npdfjs-editor-resizer-bottom-right =\n    .aria-label = Bottom right corner \u2014 resize\npdfjs-editor-resizer-bottom-middle =\n    .aria-label = Bottom middle \u2014 resize\npdfjs-editor-resizer-bottom-left =\n    .aria-label = Bottom left corner \u2014 resize\npdfjs-editor-resizer-middle-left =\n    .aria-label = Middle left \u2014 resize\npdfjs-editor-highlight-colorpicker-label = Highlight color\npdfjs-editor-colorpicker-button =\n    .title = Change color\npdfjs-editor-colorpicker-dropdown =\n    .aria-label = Color choices\npdfjs-editor-colorpicker-yellow =\n    .title = Yellow\npdfjs-editor-colorpicker-green =\n    .title = Green\npdfjs-editor-colorpicker-blue =\n    .title = Blue\npdfjs-editor-colorpicker-pink =\n    .title = Pink\npdfjs-editor-colorpicker-red =\n    .title = Red\npdfjs-editor-highlight-show-all-button-label = Show all\npdfjs-editor-highlight-show-all-button =\n    .title = Show all\npdfjs-editor-new-alt-text-dialog-edit-label = Edit alt text (image description)\npdfjs-editor-new-alt-text-dialog-add-label = Add alt text (image description)\npdfjs-editor-new-alt-text-textarea =\n    .placeholder = Write your description here\u2026\npdfjs-editor-new-alt-text-description = Short description for people who can\u2019t see the image or when the image doesn\u2019t load.\npdfjs-editor-new-alt-text-disclaimer1 = This alt text was created automatically and may be inaccurate.\npdfjs-editor-new-alt-text-disclaimer-learn-more-url = Learn more\npdfjs-editor-new-alt-text-create-automatically-button-label = Create alt text automatically\npdfjs-editor-new-alt-text-not-now-button = Not now\npdfjs-editor-new-alt-text-error-title = Couldn\u2019t create alt text automatically\npdfjs-editor-new-alt-text-error-description = Please write your own alt text or try again later.\npdfjs-editor-new-alt-text-error-close-button = Close\npdfjs-editor-new-alt-text-ai-model-downloading-progress = Downloading alt text AI model ({ $downloadedSize } of { $totalSize } MB)\n    .aria-valuetext = Downloading alt text AI model ({ $downloadedSize } of { $totalSize } MB)\npdfjs-editor-new-alt-text-added-button =\n    .aria-label = Alt text added\npdfjs-editor-new-alt-text-added-button-label = Alt text added\npdfjs-editor-new-alt-text-missing-button =\n    .aria-label = Missing alt text\npdfjs-editor-new-alt-text-missing-button-label = Missing alt text\npdfjs-editor-new-alt-text-to-review-button =\n    .aria-label = Review alt text\npdfjs-editor-new-alt-text-to-review-button-label = Review alt text\npdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer = Created automatically: { $generatedAltText }\npdfjs-image-alt-text-settings-button =\n    .title = Image alt text settings\npdfjs-image-alt-text-settings-button-label = Image alt text settings\npdfjs-editor-alt-text-settings-dialog-label = Image alt text settings\npdfjs-editor-alt-text-settings-automatic-title = Automatic alt text\npdfjs-editor-alt-text-settings-create-model-button-label = Create alt text automatically\npdfjs-editor-alt-text-settings-create-model-description = Suggests descriptions to help people who can\u2019t see the image or when the image doesn\u2019t load.\npdfjs-editor-alt-text-settings-download-model-label = Alt text AI model ({ $totalSize } MB)\npdfjs-editor-alt-text-settings-ai-model-description = Runs locally on your device so your data stays private. Required for automatic alt text.\npdfjs-editor-alt-text-settings-delete-model-button = Delete\npdfjs-editor-alt-text-settings-download-model-button = Download\npdfjs-editor-alt-text-settings-downloading-model-button = Downloading\u2026\npdfjs-editor-alt-text-settings-editor-title = Alt text editor\npdfjs-editor-alt-text-settings-show-dialog-button-label = Show alt text editor right away when adding an image\npdfjs-editor-alt-text-settings-show-dialog-description = Helps you make sure all your images have alt text.\npdfjs-editor-alt-text-settings-close-button = Close\npdfjs-editor-undo-bar-message-highlight = Highlight removed\npdfjs-editor-undo-bar-message-freetext = Text removed\npdfjs-editor-undo-bar-message-ink = Drawing removed\npdfjs-editor-undo-bar-message-stamp = Image removed\npdfjs-editor-undo-bar-message-signature = Signature removed\npdfjs-editor-undo-bar-message-multiple =\n    { $count ->\n        [one] { $count } annotation removed\n       *[other] { $count } annotations removed\n    }\npdfjs-editor-undo-bar-undo-button =\n    .title = Undo\npdfjs-editor-undo-bar-undo-button-label = Undo\npdfjs-editor-undo-bar-close-button =\n    .title = Close\npdfjs-editor-undo-bar-close-button-label = Close\npdfjs-editor-add-signature-dialog-label = This modal allows the user to create a signature to add to a PDF document. The user can edit the name (which also serves as the alt text), and optionally save the signature for repeated use.\npdfjs-editor-add-signature-dialog-title = Add a signature\npdfjs-editor-add-signature-type-button = Type\n    .title = Type\npdfjs-editor-add-signature-draw-button = Draw\n    .title = Draw\npdfjs-editor-add-signature-image-button = Image\n    .title = Image\npdfjs-editor-add-signature-type-input =\n    .aria-label = Type your signature\n    .placeholder = Type your signature\npdfjs-editor-add-signature-draw-placeholder = Draw your signature\npdfjs-editor-add-signature-draw-thickness-range-label = Thickness\npdfjs-editor-add-signature-draw-thickness-range =\n    .title = Drawing thickness: { $thickness }\npdfjs-editor-add-signature-image-placeholder = Drag a file here to upload\npdfjs-editor-add-signature-image-browse-link =\n    { PLATFORM() ->\n        [macos] Or choose image files\n       *[other] Or browse image files\n    }\npdfjs-editor-add-signature-description-label = Description (alt text)\npdfjs-editor-add-signature-description-input =\n    .title = Description (alt text)\npdfjs-editor-add-signature-description-default-when-drawing = Signature\npdfjs-editor-add-signature-clear-button-label = Clear signature\npdfjs-editor-add-signature-clear-button =\n    .title = Clear signature\npdfjs-editor-add-signature-save-checkbox = Save signature\npdfjs-editor-add-signature-save-warning-message = You\u2019ve reached the limit of 5 saved signatures. Remove one to save more.\npdfjs-editor-add-signature-image-upload-error-title = Couldn\u2019t upload image\npdfjs-editor-add-signature-image-upload-error-description = Check your network connection or try another image.\npdfjs-editor-add-signature-error-close-button = Close\npdfjs-editor-add-signature-cancel-button = Cancel\npdfjs-editor-add-signature-add-button = Add\npdfjs-editor-delete-signature-button1 =\n    .title = Remove saved signature\npdfjs-editor-delete-signature-button-label1 = Remove saved signature\npdfjs-editor-add-signature-edit-button-label = Edit description\npdfjs-editor-edit-signature-dialog-title = Edit description\npdfjs-editor-edit-signature-update-button = Update";return _context109.a(2,createBundle(lang,text));}},_callee108);}));return _createBundleFallback3.apply(this,arguments);};// ./web/generic_scripting.js
function docProperties(_x15){return _docProperties.apply(this,arguments);}function _docProperties(){_docProperties=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee101(pdfDocument){var url,baseUrl,_yield$pdfDocument$ge2,info,metadata,contentDispositionFilename,contentLength,_t44,_t45,_t46,_t47,_t48,_t49,_t50,_t51,_t52,_t53,_t54,_t55;return _regenerator().w(function(_context102){while(1)switch(_context102.n){case 0:url="",baseUrl=url.split("#",1)[0];_context102.n=1;return pdfDocument.getMetadata();case 1:_yield$pdfDocument$ge2=_context102.v;info=_yield$pdfDocument$ge2.info;metadata=_yield$pdfDocument$ge2.metadata;contentDispositionFilename=_yield$pdfDocument$ge2.contentDispositionFilename;contentLength=_yield$pdfDocument$ge2.contentLength;_t44=_objectSpread;_t45=_objectSpread({},info);_t46={};_t47=baseUrl;_t48=contentLength;if(_t48){_context102.n=3;break;}_context102.n=2;return pdfDocument.getDownloadInfo();case 2:_t48=_context102.v.length;case 3:_t49=_t48;_t50=contentDispositionFilename||getPdfFilenameFromUrl(url);_t51=metadata===null||metadata===void 0?void 0:metadata.getRaw();_t52=metadata===null||metadata===void 0?void 0:metadata.get("dc:creator");_t53=pdfDocument.numPages;_t54=url;_t55={baseURL:_t47,filesize:_t49,filename:_t50,metadata:_t51,authors:_t52,numPages:_t53,URL:_t54};return _context102.a(2,_t44(_t45,_t46,_t55));}},_callee101);}));return _docProperties.apply(this,arguments);}var GenericScripting=/*#__PURE__*/function(){function GenericScripting(sandboxBundleSrc){_classCallCheck(this,GenericScripting);this._ready=new Promise(function(resolve,reject){var sandbox=import(/*webpackIgnore: true*//*@vite-ignore*/sandboxBundleSrc);sandbox.then(function(pdfjsSandbox){resolve(pdfjsSandbox.QuickJSSandbox());})["catch"](reject);});}return _createClass(GenericScripting,[{key:"createSandbox",value:function(){var _createSandbox=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee16(data){var sandbox;return _regenerator().w(function(_context16){while(1)switch(_context16.n){case 0:_context16.n=1;return this._ready;case 1:sandbox=_context16.v;sandbox.create(data);case 2:return _context16.a(2);}},_callee16,this);}));function createSandbox(_x16){return _createSandbox.apply(this,arguments);}return createSandbox;}()},{key:"dispatchEventInSandbox",value:function(){var _dispatchEventInSandbox=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee17(event){var sandbox;return _regenerator().w(function(_context17){while(1)switch(_context17.n){case 0:_context17.n=1;return this._ready;case 1:sandbox=_context17.v;setTimeout(function(){return sandbox.dispatchEvent(event);},0);case 2:return _context17.a(2);}},_callee17,this);}));function dispatchEventInSandbox(_x17){return _dispatchEventInSandbox.apply(this,arguments);}return dispatchEventInSandbox;}()},{key:"destroySandbox",value:function(){var _destroySandbox=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee18(){var sandbox;return _regenerator().w(function(_context18){while(1)switch(_context18.n){case 0:_context18.n=1;return this._ready;case 1:sandbox=_context18.v;sandbox.nukeSandbox();case 2:return _context18.a(2);}},_callee18,this);}));function destroySandbox(){return _destroySandbox.apply(this,arguments);}return destroySandbox;}()}]);}();;// ./web/generic_signature_storage.js
var KEY_STORAGE="pdfjs.signature";var _eventBus=/*#__PURE__*/new WeakMap();var _signatures=/*#__PURE__*/new WeakMap();var _signal=/*#__PURE__*/new WeakMap();var _SignatureStorage_brand=/*#__PURE__*/new WeakSet();var SignatureStorage=/*#__PURE__*/function(){function SignatureStorage(eventBus,signal){_classCallCheck(this,SignatureStorage);_classPrivateMethodInitSpec(this,_SignatureStorage_brand);_classPrivateFieldInitSpec(this,_eventBus,void 0);_classPrivateFieldInitSpec(this,_signatures,null);_classPrivateFieldInitSpec(this,_signal,null);_classPrivateFieldSet(_eventBus,this,eventBus);_classPrivateFieldSet(_signal,this,signal);}return _createClass(SignatureStorage,[{key:"getAll",value:function(){var _getAll=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee19(){var _this13=this;var data,_i4,_Object$entries2,_Object$entries2$_i,key,value;return _regenerator().w(function(_context19){while(1)switch(_context19.n){case 0:if(_classPrivateFieldGet(_signal,this)){window.addEventListener("storage",function(_ref13){var key=_ref13.key;if(key===KEY_STORAGE){var _classPrivateFieldGet3;_classPrivateFieldSet(_signatures,_this13,null);(_classPrivateFieldGet3=_classPrivateFieldGet(_eventBus,_this13))===null||_classPrivateFieldGet3===void 0||_classPrivateFieldGet3.dispatch("storedsignatureschanged",{source:_this13});}},{signal:_classPrivateFieldGet(_signal,this)});_classPrivateFieldSet(_signal,this,null);}if(!_classPrivateFieldGet(_signatures,this)){_classPrivateFieldSet(_signatures,this,new Map());data=localStorage.getItem(KEY_STORAGE);if(data){for(_i4=0,_Object$entries2=Object.entries(JSON.parse(data));_i4<_Object$entries2.length;_i4++){_Object$entries2$_i=_slicedToArray(_Object$entries2[_i4],2),key=_Object$entries2$_i[0],value=_Object$entries2$_i[1];_classPrivateFieldGet(_signatures,this).set(key,value);}}}return _context19.a(2,_classPrivateFieldGet(_signatures,this));}},_callee19,this);}));function getAll(){return _getAll.apply(this,arguments);}return getAll;}()},{key:"isFull",value:function(){var _isFull=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee20(){var _t7;return _regenerator().w(function(_context20){while(1)switch(_context20.n){case 0:_context20.n=1;return this.size();case 1:_t7=_context20.v;return _context20.a(2,_t7===5);}},_callee20,this);}));function isFull(){return _isFull.apply(this,arguments);}return isFull;}()},{key:"size",value:function(){var _size=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee21(){return _regenerator().w(function(_context21){while(1)switch(_context21.n){case 0:_context21.n=1;return this.getAll();case 1:return _context21.a(2,_context21.v.size);}},_callee21,this);}));function size(){return _size.apply(this,arguments);}return size;}()},{key:"create",value:function(){var _create=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee22(data){var uuid;return _regenerator().w(function(_context22){while(1)switch(_context22.n){case 0:_context22.n=1;return this.isFull();case 1:if(!_context22.v){_context22.n=2;break;}return _context22.a(2,null);case 2:uuid=getUuid();_classPrivateFieldGet(_signatures,this).set(uuid,data);_assertClassBrand(_SignatureStorage_brand,this,_save).call(this);return _context22.a(2,uuid);}},_callee22,this);}));function create(_x18){return _create.apply(this,arguments);}return create;}()},{key:"delete",value:function(){var _delete2=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee23(uuid){var signatures;return _regenerator().w(function(_context23){while(1)switch(_context23.n){case 0:_context23.n=1;return this.getAll();case 1:signatures=_context23.v;if(signatures.has(uuid)){_context23.n=2;break;}return _context23.a(2,false);case 2:signatures["delete"](uuid);_assertClassBrand(_SignatureStorage_brand,this,_save).call(this);return _context23.a(2,true);}},_callee23,this);}));function _delete(_x19){return _delete2.apply(this,arguments);}return _delete;}()}]);}();function _save(){localStorage.setItem(KEY_STORAGE,JSON.stringify(Object.fromEntries(_classPrivateFieldGet(_signatures,this).entries())));};// ./web/genericcom.js
function initCom(app){}var Preferences=/*#__PURE__*/function(_BasePreferences2){function Preferences(){_classCallCheck(this,Preferences);return _callSuper(this,Preferences,arguments);}_inherits(Preferences,_BasePreferences2);return _createClass(Preferences,[{key:"_writeToStorage",value:function(){var _writeToStorage3=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee24(prefObj){return _regenerator().w(function(_context24){while(1)switch(_context24.n){case 0:localStorage.setItem("pdfjs.preferences",JSON.stringify(prefObj));case 1:return _context24.a(2);}},_callee24);}));function _writeToStorage(_x20){return _writeToStorage3.apply(this,arguments);}return _writeToStorage;}()},{key:"_readFromStorage",value:function(){var _readFromStorage3=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee25(prefObj){return _regenerator().w(function(_context25){while(1)switch(_context25.n){case 0:return _context25.a(2,{prefs:JSON.parse(localStorage.getItem("pdfjs.preferences"))});}},_callee25);}));function _readFromStorage(_x21){return _readFromStorage3.apply(this,arguments);}return _readFromStorage;}()}]);}(BasePreferences);var ExternalServices=/*#__PURE__*/function(_BaseExternalServices){function ExternalServices(){_classCallCheck(this,ExternalServices);return _callSuper(this,ExternalServices,arguments);}_inherits(ExternalServices,_BaseExternalServices);return _createClass(ExternalServices,[{key:"createL10n",value:function(){var _createL10n2=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee26(){var _AppOptions$get;return _regenerator().w(function(_context26){while(1)switch(_context26.n){case 0:return _context26.a(2,new genericl10n_GenericL10n((_AppOptions$get=AppOptions.get("localeProperties"))===null||_AppOptions$get===void 0?void 0:_AppOptions$get.lang));}},_callee26);}));function createL10n(){return _createL10n2.apply(this,arguments);}return createL10n;}()},{key:"createScripting",value:function createScripting(){return new GenericScripting(AppOptions.get("sandboxBundleSrc"));}},{key:"createSignatureStorage",value:function createSignatureStorage(eventBus,signal){return new SignatureStorage(eventBus,signal);}}]);}(BaseExternalServices);var MLManager=/*#__PURE__*/function(){function MLManager(){_classCallCheck(this,MLManager);}return _createClass(MLManager,[{key:"isEnabledFor",value:function(){var _isEnabledFor=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee27(_name){return _regenerator().w(function(_context27){while(1)switch(_context27.n){case 0:return _context27.a(2,false);}},_callee27);}));function isEnabledFor(_x22){return _isEnabledFor.apply(this,arguments);}return isEnabledFor;}()},{key:"deleteModel",value:function(){var _deleteModel=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee28(_service){return _regenerator().w(function(_context28){while(1)switch(_context28.n){case 0:return _context28.a(2,null);}},_callee28);}));function deleteModel(_x23){return _deleteModel.apply(this,arguments);}return deleteModel;}()},{key:"isReady",value:function isReady(_name){return false;}},{key:"guess",value:function guess(_data){}},{key:"toggleService",value:function toggleService(_name,_enabled){}}]);}();;// ./web/new_alt_text_manager.js
var _boundCancel=/*#__PURE__*/new WeakMap();var _createAutomaticallyButton=/*#__PURE__*/new WeakMap();var _currentEditor=/*#__PURE__*/new WeakMap();var _cancelButton=/*#__PURE__*/new WeakMap();var _descriptionContainer=/*#__PURE__*/new WeakMap();var _dialog=/*#__PURE__*/new WeakMap();var _disclaimer=/*#__PURE__*/new WeakMap();var _downloadModel=/*#__PURE__*/new WeakMap();var _downloadModelDescription=/*#__PURE__*/new WeakMap();var _eventBus2=/*#__PURE__*/new WeakMap();var _firstTime=/*#__PURE__*/new WeakMap();var _guessedAltText=/*#__PURE__*/new WeakMap();var _hasAI=/*#__PURE__*/new WeakMap();var _isEditing=/*#__PURE__*/new WeakMap();var _imagePreview=/*#__PURE__*/new WeakMap();var _imageData=/*#__PURE__*/new WeakMap();var _isAILoading=/*#__PURE__*/new WeakMap();var _wasAILoading=/*#__PURE__*/new WeakMap();var _learnMore=/*#__PURE__*/new WeakMap();var _notNowButton=/*#__PURE__*/new WeakMap();var _overlayManager=/*#__PURE__*/new WeakMap();var _textarea=/*#__PURE__*/new WeakMap();var _title=/*#__PURE__*/new WeakMap();var _uiManager=/*#__PURE__*/new WeakMap();var _previousAltText=/*#__PURE__*/new WeakMap();var _NewAltTextManager_brand=/*#__PURE__*/new WeakSet();var NewAltTextManager=/*#__PURE__*/function(){function NewAltTextManager(_ref14,overlayManager,eventBus){var _this14=this;var descriptionContainer=_ref14.descriptionContainer,dialog=_ref14.dialog,imagePreview=_ref14.imagePreview,cancelButton=_ref14.cancelButton,disclaimer=_ref14.disclaimer,notNowButton=_ref14.notNowButton,saveButton=_ref14.saveButton,textarea=_ref14.textarea,learnMore=_ref14.learnMore,errorCloseButton=_ref14.errorCloseButton,createAutomaticallyButton=_ref14.createAutomaticallyButton,downloadModel=_ref14.downloadModel,downloadModelDescription=_ref14.downloadModelDescription,title=_ref14.title;_classCallCheck(this,NewAltTextManager);_classPrivateMethodInitSpec(this,_NewAltTextManager_brand);_classPrivateFieldInitSpec(this,_boundCancel,_assertClassBrand(_NewAltTextManager_brand,this,_cancel).bind(this));_classPrivateFieldInitSpec(this,_createAutomaticallyButton,void 0);_classPrivateFieldInitSpec(this,_currentEditor,null);_classPrivateFieldInitSpec(this,_cancelButton,void 0);_classPrivateFieldInitSpec(this,_descriptionContainer,void 0);_classPrivateFieldInitSpec(this,_dialog,void 0);_classPrivateFieldInitSpec(this,_disclaimer,void 0);_classPrivateFieldInitSpec(this,_downloadModel,void 0);_classPrivateFieldInitSpec(this,_downloadModelDescription,void 0);_classPrivateFieldInitSpec(this,_eventBus2,void 0);_classPrivateFieldInitSpec(this,_firstTime,false);_classPrivateFieldInitSpec(this,_guessedAltText,void 0);_classPrivateFieldInitSpec(this,_hasAI,null);_classPrivateFieldInitSpec(this,_isEditing,null);_classPrivateFieldInitSpec(this,_imagePreview,void 0);_classPrivateFieldInitSpec(this,_imageData,void 0);_classPrivateFieldInitSpec(this,_isAILoading,false);_classPrivateFieldInitSpec(this,_wasAILoading,false);_classPrivateFieldInitSpec(this,_learnMore,void 0);_classPrivateFieldInitSpec(this,_notNowButton,void 0);_classPrivateFieldInitSpec(this,_overlayManager,void 0);_classPrivateFieldInitSpec(this,_textarea,void 0);_classPrivateFieldInitSpec(this,_title,void 0);_classPrivateFieldInitSpec(this,_uiManager,void 0);_classPrivateFieldInitSpec(this,_previousAltText,null);_classPrivateFieldSet(_cancelButton,this,cancelButton);_classPrivateFieldSet(_createAutomaticallyButton,this,createAutomaticallyButton);_classPrivateFieldSet(_descriptionContainer,this,descriptionContainer);_classPrivateFieldSet(_dialog,this,dialog);_classPrivateFieldSet(_disclaimer,this,disclaimer);_classPrivateFieldSet(_notNowButton,this,notNowButton);_classPrivateFieldSet(_imagePreview,this,imagePreview);_classPrivateFieldSet(_textarea,this,textarea);_classPrivateFieldSet(_learnMore,this,learnMore);_classPrivateFieldSet(_title,this,title);_classPrivateFieldSet(_downloadModel,this,downloadModel);_classPrivateFieldSet(_downloadModelDescription,this,downloadModelDescription);_classPrivateFieldSet(_overlayManager,this,overlayManager);_classPrivateFieldSet(_eventBus2,this,eventBus);dialog.addEventListener("close",_assertClassBrand(_NewAltTextManager_brand,this,_close).bind(this));dialog.addEventListener("contextmenu",function(event){if(event.target!==_classPrivateFieldGet(_textarea,_this14)){event.preventDefault();}});cancelButton.addEventListener("click",_classPrivateFieldGet(_boundCancel,this));notNowButton.addEventListener("click",_classPrivateFieldGet(_boundCancel,this));saveButton.addEventListener("click",_assertClassBrand(_NewAltTextManager_brand,this,_save2).bind(this));errorCloseButton.addEventListener("click",function(){_assertClassBrand(_NewAltTextManager_brand,_this14,_toggleError).call(_this14,false);});createAutomaticallyButton.addEventListener("click",/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee29(){var checked;return _regenerator().w(function(_context29){while(1)switch(_context29.n){case 0:checked=createAutomaticallyButton.getAttribute("aria-pressed")!=="true";_classPrivateFieldGet(_currentEditor,_this14)._reportTelemetry({action:"pdfjs.image.alt_text.ai_generation_check",data:{status:checked}});if(!_classPrivateFieldGet(_uiManager,_this14)){_context29.n=1;break;}_classPrivateFieldGet(_uiManager,_this14).setPreference("enableGuessAltText",checked);_context29.n=1;return _classPrivateFieldGet(_uiManager,_this14).mlManager.toggleService("altText",checked);case 1:_assertClassBrand(_NewAltTextManager_brand,_this14,_toggleGuessAltText).call(_this14,checked,false);case 2:return _context29.a(2);}},_callee29);})));textarea.addEventListener("focus",function(){_classPrivateFieldSet(_wasAILoading,_this14,_classPrivateFieldGet(_isAILoading,_this14));_assertClassBrand(_NewAltTextManager_brand,_this14,_toggleLoading).call(_this14,false);_assertClassBrand(_NewAltTextManager_brand,_this14,_toggleTitleAndDisclaimer).call(_this14);});textarea.addEventListener("blur",function(){if(!textarea.value){_assertClassBrand(_NewAltTextManager_brand,_this14,_toggleLoading).call(_this14,_classPrivateFieldGet(_wasAILoading,_this14));}_assertClassBrand(_NewAltTextManager_brand,_this14,_toggleTitleAndDisclaimer).call(_this14);});textarea.addEventListener("input",function(){_assertClassBrand(_NewAltTextManager_brand,_this14,_toggleTitleAndDisclaimer).call(_this14);});eventBus._on("enableguessalttext",function(_ref16){var value=_ref16.value;_assertClassBrand(_NewAltTextManager_brand,_this14,_toggleGuessAltText).call(_this14,value,false);});_classPrivateFieldGet(_overlayManager,this).register(dialog);_classPrivateFieldGet(_learnMore,this).addEventListener("click",function(){_classPrivateFieldGet(_currentEditor,_this14)._reportTelemetry({action:"pdfjs.image.alt_text.info",data:{topic:"alt_text"}});});}return _createClass(NewAltTextManager,[{key:"editAltText",value:function(){var _editAltText=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee30(uiManager,editor,firstTime){var _mlManager,_classPrivateFieldGet4;var mlManager,hasAI,isAltTextEnabledPromise,AI_MAX_IMAGE_DIMENSION,MAX_PREVIEW_DIMENSION,canvas,width,height,_editor$copyCanvas,_editor$copyCanvas2,_canvas,style,_t8,_t9,_t0,_t1;return _regenerator().w(function(_context30){while(1)switch(_context30.n){case 0:if(!(_classPrivateFieldGet(_currentEditor,this)||!editor)){_context30.n=1;break;}return _context30.a(2);case 1:if(!(firstTime&&editor.hasAltTextData())){_context30.n=2;break;}editor.altTextFinish();return _context30.a(2);case 2:_classPrivateFieldSet(_firstTime,this,firstTime);mlManager=uiManager.mlManager;hasAI=!!mlManager;_assertClassBrand(_NewAltTextManager_brand,this,_toggleTitleAndDisclaimer).call(this);if(mlManager&&!mlManager.isReady("altText")){hasAI=false;if(mlManager.hasProgress){_assertClassBrand(_NewAltTextManager_brand,this,_setProgress).call(this);}else{mlManager=null;}}else{_classPrivateFieldGet(_downloadModel,this).classList.toggle("hidden",true);}isAltTextEnabledPromise=(_mlManager=mlManager)===null||_mlManager===void 0?void 0:_mlManager.isEnabledFor("altText");_classPrivateFieldSet(_currentEditor,this,editor);_classPrivateFieldSet(_uiManager,this,uiManager);_classPrivateFieldGet(_uiManager,this).removeEditListeners();_toSetter(_classPrivateFieldSet,[_previousAltText,this])._=editor.altTextData.altText;_classPrivateFieldGet(_textarea,this).value=(_classPrivateFieldGet4=_classPrivateFieldGet(_previousAltText,this))!==null&&_classPrivateFieldGet4!==void 0?_classPrivateFieldGet4:"";AI_MAX_IMAGE_DIMENSION=224;MAX_PREVIEW_DIMENSION=180;if(!mlManager){_context30.n=5;break;}_editor$copyCanvas=editor.copyCanvas(AI_MAX_IMAGE_DIMENSION,MAX_PREVIEW_DIMENSION,true);canvas=_editor$copyCanvas.canvas;width=_editor$copyCanvas.width;height=_editor$copyCanvas.height;_toSetter(_classPrivateFieldSet,[_imageData,this])._=_editor$copyCanvas.imageData;if(!hasAI){_context30.n=4;break;}_t8=_assertClassBrand(_NewAltTextManager_brand,this,_toggleGuessAltText);_t9=this;_context30.n=3;return isAltTextEnabledPromise;case 3:_t0=_context30.v;_t8.call.call(_t8,_t9,_t0,true);case 4:_context30.n=6;break;case 5:_editor$copyCanvas2=editor.copyCanvas(AI_MAX_IMAGE_DIMENSION,MAX_PREVIEW_DIMENSION,false);canvas=_editor$copyCanvas2.canvas;width=_editor$copyCanvas2.width;height=_editor$copyCanvas2.height;case 6:canvas.setAttribute("role","presentation");_canvas=canvas,style=_canvas.style;style.width="".concat(width,"px");style.height="".concat(height,"px");_classPrivateFieldGet(_imagePreview,this).append(canvas);_assertClassBrand(_NewAltTextManager_brand,this,_toggleNotNow).call(this);_assertClassBrand(_NewAltTextManager_brand,this,_toggleAI).call(this,hasAI);_assertClassBrand(_NewAltTextManager_brand,this,_toggleError).call(this,false);_context30.p=7;_context30.n=8;return _classPrivateFieldGet(_overlayManager,this).open(_classPrivateFieldGet(_dialog,this));case 8:_context30.n=10;break;case 9:_context30.p=9;_t1=_context30.v;_assertClassBrand(_NewAltTextManager_brand,this,_close).call(this);throw _t1;case 10:return _context30.a(2);}},_callee30,this,[[7,9]]);}));function editAltText(_x24,_x25,_x26){return _editAltText.apply(this,arguments);}return editAltText;}()},{key:"destroy",value:function destroy(){_classPrivateFieldSet(_uiManager,this,null);_assertClassBrand(_NewAltTextManager_brand,this,_finish).call(this);}}]);}();function _toggleLoading(value){if(!_classPrivateFieldGet(_uiManager,this)||_classPrivateFieldGet(_isAILoading,this)===value){return;}_classPrivateFieldSet(_isAILoading,this,value);_classPrivateFieldGet(_descriptionContainer,this).classList.toggle("loading",value);}function _toggleError(value){if(!_classPrivateFieldGet(_uiManager,this)){return;}_classPrivateFieldGet(_dialog,this).classList.toggle("error",value);}function _toggleGuessAltText(_x64){return _toggleGuessAltText2.apply(this,arguments);}function _toggleGuessAltText2(){_toggleGuessAltText2=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee109(value){var isInitial,altTextLearnMoreUrl,_args111=arguments;return _regenerator().w(function(_context110){while(1)switch(_context110.n){case 0:isInitial=_args111.length>1&&_args111[1]!==undefined?_args111[1]:false;if(_classPrivateFieldGet(_uiManager,this)){_context110.n=1;break;}return _context110.a(2);case 1:_classPrivateFieldGet(_dialog,this).classList.toggle("aiDisabled",!value);_classPrivateFieldGet(_createAutomaticallyButton,this).setAttribute("aria-pressed",value);if(value){altTextLearnMoreUrl=_classPrivateFieldGet(_uiManager,this).mlManager.altTextLearnMoreUrl;if(altTextLearnMoreUrl){_classPrivateFieldGet(_learnMore,this).href=altTextLearnMoreUrl;}_assertClassBrand(_NewAltTextManager_brand,this,_mlGuessAltText).call(this,isInitial);}else{_assertClassBrand(_NewAltTextManager_brand,this,_toggleLoading).call(this,false);_classPrivateFieldSet(_isAILoading,this,false);_assertClassBrand(_NewAltTextManager_brand,this,_toggleTitleAndDisclaimer).call(this);}case 2:return _context110.a(2);}},_callee109,this);}));return _toggleGuessAltText2.apply(this,arguments);}function _toggleNotNow(){_classPrivateFieldGet(_notNowButton,this).classList.toggle("hidden",!_classPrivateFieldGet(_firstTime,this));_classPrivateFieldGet(_cancelButton,this).classList.toggle("hidden",_classPrivateFieldGet(_firstTime,this));}function _toggleAI(value){if(!_classPrivateFieldGet(_uiManager,this)||_classPrivateFieldGet(_hasAI,this)===value){return;}_classPrivateFieldSet(_hasAI,this,value);_classPrivateFieldGet(_dialog,this).classList.toggle("noAi",!value);_assertClassBrand(_NewAltTextManager_brand,this,_toggleTitleAndDisclaimer).call(this);}function _toggleTitleAndDisclaimer(){var visible=_classPrivateFieldGet(_isAILoading,this)||_classPrivateFieldGet(_guessedAltText,this)&&_classPrivateFieldGet(_guessedAltText,this)===_classPrivateFieldGet(_textarea,this).value;_classPrivateFieldGet(_disclaimer,this).hidden=!visible;var isEditing=_classPrivateFieldGet(_isAILoading,this)||!!_classPrivateFieldGet(_textarea,this).value;if(_classPrivateFieldGet(_isEditing,this)===isEditing){return;}_classPrivateFieldSet(_isEditing,this,isEditing);_classPrivateFieldGet(_title,this).setAttribute("data-l10n-id",isEditing?"pdfjs-editor-new-alt-text-dialog-edit-label":"pdfjs-editor-new-alt-text-dialog-add-label");}function _mlGuessAltText(_x65){return _mlGuessAltText2.apply(this,arguments);}function _mlGuessAltText2(){_mlGuessAltText2=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee110(isInitial){var hasError,altText,_t65;return _regenerator().w(function(_context111){while(1)switch(_context111.n){case 0:if(!_classPrivateFieldGet(_isAILoading,this)){_context111.n=1;break;}return _context111.a(2);case 1:if(!_classPrivateFieldGet(_textarea,this).value){_context111.n=2;break;}return _context111.a(2);case 2:if(!(isInitial&&_classPrivateFieldGet(_previousAltText,this)!==null)){_context111.n=3;break;}return _context111.a(2);case 3:_classPrivateFieldSet(_guessedAltText,this,_classPrivateFieldGet(_currentEditor,this).guessedAltText);if(!(_classPrivateFieldGet(_previousAltText,this)===null&&_classPrivateFieldGet(_guessedAltText,this))){_context111.n=4;break;}_assertClassBrand(_NewAltTextManager_brand,this,_addAltText).call(this,_classPrivateFieldGet(_guessedAltText,this));return _context111.a(2);case 4:_assertClassBrand(_NewAltTextManager_brand,this,_toggleLoading).call(this,true);_assertClassBrand(_NewAltTextManager_brand,this,_toggleTitleAndDisclaimer).call(this);hasError=false;_context111.p=5;_context111.n=6;return _classPrivateFieldGet(_currentEditor,this).mlGuessAltText(_classPrivateFieldGet(_imageData,this),false);case 6:altText=_context111.v;if(altText){_classPrivateFieldSet(_guessedAltText,this,altText);_classPrivateFieldSet(_wasAILoading,this,_classPrivateFieldGet(_isAILoading,this));if(_classPrivateFieldGet(_isAILoading,this)){_assertClassBrand(_NewAltTextManager_brand,this,_addAltText).call(this,altText);}}_context111.n=8;break;case 7:_context111.p=7;_t65=_context111.v;console.error(_t65);hasError=true;case 8:_assertClassBrand(_NewAltTextManager_brand,this,_toggleLoading).call(this,false);_assertClassBrand(_NewAltTextManager_brand,this,_toggleTitleAndDisclaimer).call(this);if(hasError&&_classPrivateFieldGet(_uiManager,this)){_assertClassBrand(_NewAltTextManager_brand,this,_toggleError).call(this,true);}case 9:return _context111.a(2);}},_callee110,this,[[5,7]]);}));return _mlGuessAltText2.apply(this,arguments);}function _addAltText(altText){if(!_classPrivateFieldGet(_uiManager,this)||_classPrivateFieldGet(_textarea,this).value){return;}_classPrivateFieldGet(_textarea,this).value=altText;_assertClassBrand(_NewAltTextManager_brand,this,_toggleTitleAndDisclaimer).call(this);}function _setProgress(){var _this93=this;_classPrivateFieldGet(_downloadModel,this).classList.toggle("hidden",false);var _callback=/*#__PURE__*/function(){var _ref110=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee102(_ref109){var _ref109$detail,finished,total,totalLoaded,ONE_MEGA_BYTES,totalSize,downloadedSize,_classPrivateFieldGet43,mlManager,_t56,_t57,_t58;return _regenerator().w(function(_context103){while(1)switch(_context103.n){case 0:_ref109$detail=_ref109.detail,finished=_ref109$detail.finished,total=_ref109$detail.total,totalLoaded=_ref109$detail.totalLoaded;ONE_MEGA_BYTES=1e6;totalLoaded=Math.min(0.99*total,totalLoaded);totalSize=_classPrivateFieldGet(_downloadModelDescription,_this93).ariaValueMax=Math.round(total/ONE_MEGA_BYTES);downloadedSize=_classPrivateFieldGet(_downloadModelDescription,_this93).ariaValueNow=Math.round(totalLoaded/ONE_MEGA_BYTES);_classPrivateFieldGet(_downloadModelDescription,_this93).setAttribute("data-l10n-args",JSON.stringify({totalSize:totalSize,downloadedSize:downloadedSize}));if(finished){_context103.n=1;break;}return _context103.a(2);case 1:_classPrivateFieldGet(_eventBus2,_this93)._off("loadaiengineprogress",_callback);_classPrivateFieldGet(_downloadModel,_this93).classList.toggle("hidden",true);_assertClassBrand(_NewAltTextManager_brand,_this93,_toggleAI).call(_this93,true);if(_classPrivateFieldGet(_uiManager,_this93)){_context103.n=2;break;}return _context103.a(2);case 2:_classPrivateFieldGet43=_classPrivateFieldGet(_uiManager,_this93),mlManager=_classPrivateFieldGet43.mlManager;mlManager.toggleService("altText",true);_t56=_assertClassBrand(_NewAltTextManager_brand,_this93,_toggleGuessAltText);_t57=_this93;_context103.n=3;return mlManager.isEnabledFor("altText");case 3:_t58=_context103.v;_t56.call.call(_t56,_t57,_t58,true);case 4:return _context103.a(2);}},_callee102);}));return function callback(_x66){return _ref110.apply(this,arguments);};}();_classPrivateFieldGet(_eventBus2,this)._on("loadaiengineprogress",_callback);}function _cancel(){_classPrivateFieldGet(_currentEditor,this).altTextData={cancel:true};var altText=_classPrivateFieldGet(_textarea,this).value.trim();_classPrivateFieldGet(_currentEditor,this)._reportTelemetry({action:"pdfjs.image.alt_text.dismiss",data:{alt_text_type:altText?"present":"empty",flow:_classPrivateFieldGet(_firstTime,this)?"image_add":"alt_text_edit"}});_classPrivateFieldGet(_currentEditor,this)._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:true,alt_text_type:"skipped"}});_assertClassBrand(_NewAltTextManager_brand,this,_finish).call(this);}function _finish(){_classPrivateFieldGet(_overlayManager,this).closeIfActive(_classPrivateFieldGet(_dialog,this));}function _close(){var _classPrivateFieldGet44,_classPrivateFieldGet45;var canvas=_classPrivateFieldGet(_imagePreview,this).firstChild;canvas.remove();canvas.width=canvas.height=0;_classPrivateFieldSet(_imageData,this,null);_assertClassBrand(_NewAltTextManager_brand,this,_toggleLoading).call(this,false);(_classPrivateFieldGet44=_classPrivateFieldGet(_uiManager,this))===null||_classPrivateFieldGet44===void 0||_classPrivateFieldGet44.addEditListeners();_classPrivateFieldGet(_currentEditor,this).altTextFinish();(_classPrivateFieldGet45=_classPrivateFieldGet(_uiManager,this))===null||_classPrivateFieldGet45===void 0||_classPrivateFieldGet45.setSelected(_classPrivateFieldGet(_currentEditor,this));_classPrivateFieldSet(_currentEditor,this,null);_classPrivateFieldSet(_uiManager,this,null);}function _extractWords(text){return new Set(text.toLowerCase().split(/(?:[\0-\/:-@\[-`\{-\xA9\xAB-\xB1\xB4\xB6-\xB8\xBB\xBF\xD7\xF7\u02C2-\u02C5\u02D2-\u02DF\u02E5-\u02EB\u02ED\u02EF-\u036F\u0375\u0378\u0379\u037E\u0380-\u0385\u0387\u038B\u038D\u03A2\u03F6\u0482-\u0489\u0530\u0557\u0558\u055A-\u055F\u0589-\u05CF\u05EB-\u05EE\u05F3-\u061F\u064B-\u065F\u066A-\u066D\u0670\u06D4\u06D6-\u06E4\u06E7-\u06ED\u06FD\u06FE\u0700-\u070F\u0711\u0730-\u074C\u07A6-\u07B0\u07B2-\u07BF\u07EB-\u07F3\u07F6-\u07F9\u07FB-\u07FF\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u083F\u0859-\u085F\u086B-\u086F\u0888\u088F-\u089F\u08CA-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962-\u0965\u0970\u0981-\u0984\u098D\u098E\u0991\u0992\u09A9\u09B1\u09B3-\u09B5\u09BA-\u09BC\u09BE-\u09CD\u09CF-\u09DB\u09DE\u09E2-\u09E5\u09F2\u09F3\u09FA\u09FB\u09FD-\u0A04\u0A0B-\u0A0E\u0A11\u0A12\u0A29\u0A31\u0A34\u0A37\u0A3A-\u0A58\u0A5D\u0A5F-\u0A65\u0A70\u0A71\u0A75-\u0A84\u0A8E\u0A92\u0AA9\u0AB1\u0AB4\u0ABA-\u0ABC\u0ABE-\u0ACF\u0AD1-\u0ADF\u0AE2-\u0AE5\u0AF0-\u0AF8\u0AFA-\u0B04\u0B0D\u0B0E\u0B11\u0B12\u0B29\u0B31\u0B34\u0B3A-\u0B3C\u0B3E-\u0B5B\u0B5E\u0B62-\u0B65\u0B70\u0B78-\u0B82\u0B84\u0B8B-\u0B8D\u0B91\u0B96-\u0B98\u0B9B\u0B9D\u0BA0-\u0BA2\u0BA5-\u0BA7\u0BAB-\u0BAD\u0BBA-\u0BCF\u0BD1-\u0BE5\u0BF3-\u0C04\u0C0D\u0C11\u0C29\u0C3A-\u0C3C\u0C3E-\u0C57\u0C5B\u0C5C\u0C5E\u0C5F\u0C62-\u0C65\u0C70-\u0C77\u0C7F\u0C81-\u0C84\u0C8D\u0C91\u0CA9\u0CB4\u0CBA-\u0CBC\u0CBE-\u0CDC\u0CDF\u0CE2-\u0CE5\u0CF0\u0CF3-\u0D03\u0D0D\u0D11\u0D3B\u0D3C\u0D3E-\u0D4D\u0D4F-\u0D53\u0D57\u0D62-\u0D65\u0D79\u0D80-\u0D84\u0D97-\u0D99\u0DB2\u0DBC\u0DBE\u0DBF\u0DC7-\u0DE5\u0DF0-\u0E00\u0E31\u0E34-\u0E3F\u0E47-\u0E4F\u0E5A-\u0E80\u0E83\u0E85\u0E8B\u0EA4\u0EA6\u0EB1\u0EB4-\u0EBC\u0EBE\u0EBF\u0EC5\u0EC7-\u0ECF\u0EDA\u0EDB\u0EE0-\u0EFF\u0F01-\u0F1F\u0F34-\u0F3F\u0F48\u0F6D-\u0F87\u0F8D-\u0FFF\u102B-\u103E\u104A-\u104F\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109F\u10C6\u10C8-\u10CC\u10CE\u10CF\u10FB\u1249\u124E\u124F\u1257\u1259\u125E\u125F\u1289\u128E\u128F\u12B1\u12B6\u12B7\u12BF\u12C1\u12C6\u12C7\u12D7\u1311\u1316\u1317\u135B-\u1368\u137D-\u137F\u1390-\u139F\u13F6\u13F7\u13FE-\u1400\u166D\u166E\u1680\u169B-\u169F\u16EB-\u16ED\u16F9-\u16FF\u1712-\u171E\u1732-\u173F\u1752-\u175F\u176D\u1771-\u177F\u17B4-\u17D6\u17D8-\u17DB\u17DD-\u17DF\u17EA-\u17EF\u17FA-\u180F\u181A-\u181F\u1879-\u187F\u1885\u1886\u18A9\u18AB-\u18AF\u18F6-\u18FF\u191F-\u1945\u196E\u196F\u1975-\u197F\u19AC-\u19AF\u19CA-\u19CF\u19DB-\u19FF\u1A17-\u1A1F\u1A55-\u1A7F\u1A8A-\u1A8F\u1A9A-\u1AA6\u1AA8-\u1B04\u1B34-\u1B44\u1B4D-\u1B4F\u1B5A-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BFF\u1C24-\u1C3F\u1C4A-\u1C4C\u1C7E\u1C7F\u1C8B-\u1C8F\u1CBB\u1CBC\u1CC0-\u1CE8\u1CED\u1CF4\u1CF7-\u1CF9\u1CFB-\u1CFF\u1DC0-\u1DFF\u1F16\u1F17\u1F1E\u1F1F\u1F46\u1F47\u1F4E\u1F4F\u1F58\u1F5A\u1F5C\u1F5E\u1F7E\u1F7F\u1FB5\u1FBD\u1FBF-\u1FC1\u1FC5\u1FCD-\u1FCF\u1FD4\u1FD5\u1FDC-\u1FDF\u1FED-\u1FF1\u1FF5\u1FFD-\u206F\u2072\u2073\u207A-\u207E\u208A-\u208F\u209D-\u2101\u2103-\u2106\u2108\u2109\u2114\u2116-\u2118\u211E-\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u2140-\u2144\u214A-\u214D\u214F\u218A-\u245F\u249C-\u24E9\u2500-\u2775\u2794-\u2BFF\u2CE5-\u2CEA\u2CEF-\u2CF1\u2CF4-\u2CFC\u2CFE\u2CFF\u2D26\u2D28-\u2D2C\u2D2E\u2D2F\u2D68-\u2D6E\u2D70-\u2D7F\u2D97-\u2D9F\u2DA7\u2DAF\u2DB7\u2DBF\u2DC7\u2DCF\u2DD7\u2DDF-\u2E2E\u2E30-\u3004\u3008-\u3020\u302A-\u3030\u3036\u3037\u303D-\u3040\u3097-\u309C\u30A0\u30FB\u3100-\u3104\u3130\u318F-\u3191\u3196-\u319F\u31C0-\u31EF\u3200-\u321F\u322A-\u3247\u3250\u3260-\u327F\u328A-\u32B0\u32C0-\u33FF\u4DC0-\u4DFF\uA48D-\uA4CF\uA4FE\uA4FF\uA60D-\uA60F\uA62C-\uA63F\uA66F-\uA67E\uA69E\uA69F\uA6F0-\uA716\uA720\uA721\uA789\uA78A\uA7CE\uA7CF\uA7D2\uA7D4\uA7DD-\uA7F1\uA802\uA806\uA80B\uA823-\uA82F\uA836-\uA83F\uA874-\uA881\uA8B4-\uA8CF\uA8DA-\uA8F1\uA8F8-\uA8FA\uA8FC\uA8FF\uA926-\uA92F\uA947-\uA95F\uA97D-\uA983\uA9B3-\uA9CE\uA9DA-\uA9DF\uA9E5\uA9FF\uAA29-\uAA3F\uAA43\uAA4C-\uAA4F\uAA5A-\uAA5F\uAA77-\uAA79\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAC3-\uAADA\uAADE\uAADF\uAAEB-\uAAF1\uAAF5-\uAB00\uAB07\uAB08\uAB0F\uAB10\uAB17-\uAB1F\uAB27\uAB2F\uAB5B\uAB6A-\uAB6F\uABE3-\uABEF\uABFA-\uABFF\uD7A4-\uD7AF\uD7C7-\uD7CA\uD7FC-\uD7FF\uE000-\uF8FF\uFA6E\uFA6F\uFADA-\uFAFF\uFB07-\uFB12\uFB18-\uFB1C\uFB1E\uFB29\uFB37\uFB3D\uFB3F\uFB42\uFB45\uFBB2-\uFBD2\uFD3E-\uFD4F\uFD90\uFD91\uFDC8-\uFDEF\uFDFC-\uFE6F\uFE75\uFEFD-\uFF0F\uFF1A-\uFF20\uFF3B-\uFF40\uFF5B-\uFF65\uFFBF-\uFFC1\uFFC8\uFFC9\uFFD0\uFFD1\uFFD8\uFFD9\uFFDD-\uFFFF]|\uD800[\uDC0C\uDC27\uDC3B\uDC3E\uDC4E\uDC4F\uDC5E-\uDC7F\uDCFB-\uDD06\uDD34-\uDD3F\uDD79-\uDD89\uDD8C-\uDE7F\uDE9D-\uDE9F\uDED1-\uDEE0\uDEFC-\uDEFF\uDF24-\uDF2C\uDF4B-\uDF4F\uDF76-\uDF7F\uDF9E\uDF9F\uDFC4-\uDFC7\uDFD0\uDFD6-\uDFFF]|\uD801[\uDC9E\uDC9F\uDCAA-\uDCAF\uDCD4-\uDCD7\uDCFC-\uDCFF\uDD28-\uDD2F\uDD64-\uDD6F\uDD7B\uDD8B\uDD93\uDD96\uDDA2\uDDB2\uDDBA\uDDBD-\uDDBF\uDDF4-\uDDFF\uDF37-\uDF3F\uDF56-\uDF5F\uDF68-\uDF7F\uDF86\uDFB1\uDFBB-\uDFFF]|\uD802[\uDC06\uDC07\uDC09\uDC36\uDC39-\uDC3B\uDC3D\uDC3E\uDC56\uDC57\uDC77\uDC78\uDC9F-\uDCA6\uDCB0-\uDCDF\uDCF3\uDCF6-\uDCFA\uDD1C-\uDD1F\uDD3A-\uDD7F\uDDB8-\uDDBB\uDDD0\uDDD1\uDE01-\uDE0F\uDE14\uDE18\uDE36-\uDE3F\uDE49-\uDE5F\uDE7F\uDEA0-\uDEBF\uDEC8\uDEE5-\uDEEA\uDEF0-\uDEFF\uDF36-\uDF3F\uDF56\uDF57\uDF73-\uDF77\uDF92-\uDFA8\uDFB0-\uDFFF]|\uD803[\uDC49-\uDC7F\uDCB3-\uDCBF\uDCF3-\uDCF9\uDD24-\uDD2F\uDD3A-\uDD3F\uDD66-\uDD6E\uDD86-\uDE5F\uDE7F\uDEAA-\uDEAF\uDEB2-\uDEC1\uDEC5-\uDEFF\uDF28-\uDF2F\uDF46-\uDF50\uDF55-\uDF6F\uDF82-\uDFAF\uDFCC-\uDFDF\uDFF7-\uDFFF]|\uD804[\uDC00-\uDC02\uDC38-\uDC51\uDC70\uDC73\uDC74\uDC76-\uDC82\uDCB0-\uDCCF\uDCE9-\uDCEF\uDCFA-\uDD02\uDD27-\uDD35\uDD40-\uDD43\uDD45\uDD46\uDD48-\uDD4F\uDD73-\uDD75\uDD77-\uDD82\uDDB3-\uDDC0\uDDC5-\uDDCF\uDDDB\uDDDD-\uDDE0\uDDF5-\uDDFF\uDE12\uDE2C-\uDE3E\uDE41-\uDE7F\uDE87\uDE89\uDE8E\uDE9E\uDEA9-\uDEAF\uDEDF-\uDEEF\uDEFA-\uDF04\uDF0D\uDF0E\uDF11\uDF12\uDF29\uDF31\uDF34\uDF3A-\uDF3C\uDF3E-\uDF4F\uDF51-\uDF5C\uDF62-\uDF7F\uDF8A\uDF8C\uDF8D\uDF8F\uDFB6\uDFB8-\uDFD0\uDFD2\uDFD4-\uDFFF]|\uD805[\uDC35-\uDC46\uDC4B-\uDC4F\uDC5A-\uDC5E\uDC62-\uDC7F\uDCB0-\uDCC3\uDCC6\uDCC8-\uDCCF\uDCDA-\uDD7F\uDDAF-\uDDD7\uDDDC-\uDDFF\uDE30-\uDE43\uDE45-\uDE4F\uDE5A-\uDE7F\uDEAB-\uDEB7\uDEB9-\uDEBF\uDECA-\uDECF\uDEE4-\uDEFF\uDF1B-\uDF2F\uDF3C-\uDF3F\uDF47-\uDFFF]|\uD806[\uDC2C-\uDC9F\uDCF3-\uDCFE\uDD07\uDD08\uDD0A\uDD0B\uDD14\uDD17\uDD30-\uDD3E\uDD40\uDD42-\uDD4F\uDD5A-\uDD9F\uDDA8\uDDA9\uDDD1-\uDDE0\uDDE2\uDDE4-\uDDFF\uDE01-\uDE0A\uDE33-\uDE39\uDE3B-\uDE4F\uDE51-\uDE5B\uDE8A-\uDE9C\uDE9E-\uDEAF\uDEF9-\uDFBF\uDFE1-\uDFEF\uDFFA-\uDFFF]|\uD807[\uDC09\uDC2F-\uDC3F\uDC41-\uDC4F\uDC6D-\uDC71\uDC90-\uDCFF\uDD07\uDD0A\uDD31-\uDD45\uDD47-\uDD4F\uDD5A-\uDD5F\uDD66\uDD69\uDD8A-\uDD97\uDD99-\uDD9F\uDDAA-\uDEDF\uDEF3-\uDF01\uDF03\uDF11\uDF34-\uDF4F\uDF5A-\uDFAF\uDFB1-\uDFBF\uDFD5-\uDFFF]|\uD808[\uDF9A-\uDFFF]|\uD809[\uDC6F-\uDC7F\uDD44-\uDFFF]|[\uD80A\uD812-\uD817\uD819\uD824-\uD82A\uD82D\uD82E\uD830-\uD832\uD836\uD83D\uD83F\uD87C\uD87D\uD87F\uD889-\uDBFF][\uDC00-\uDFFF]|\uD80B[\uDC00-\uDF8F\uDFF1-\uDFFF]|\uD80D[\uDC30-\uDC40\uDC47-\uDC5F]|\uD810[\uDFFB-\uDFFF]|\uD811[\uDE47-\uDFFF]|\uD818[\uDC00-\uDCFF\uDD1E-\uDD2F\uDD3A-\uDFFF]|\uD81A[\uDE39-\uDE3F\uDE5F\uDE6A-\uDE6F\uDEBF\uDECA-\uDECF\uDEEE-\uDEFF\uDF30-\uDF3F\uDF44-\uDF4F\uDF5A\uDF62\uDF78-\uDF7C\uDF90-\uDFFF]|\uD81B[\uDC00-\uDD3F\uDD6D-\uDD6F\uDD7A-\uDE3F\uDE97-\uDEFF\uDF4B-\uDF4F\uDF51-\uDF92\uDFA0-\uDFDF\uDFE2\uDFE4-\uDFFF]|\uD821[\uDFF8-\uDFFF]|\uD823[\uDCD6-\uDCFE\uDD09-\uDFFF]|\uD82B[\uDC00-\uDFEF\uDFF4\uDFFC\uDFFF]|\uD82C[\uDD23-\uDD31\uDD33-\uDD4F\uDD53\uDD54\uDD56-\uDD63\uDD68-\uDD6F\uDEFC-\uDFFF]|\uD82F[\uDC6B-\uDC6F\uDC7D-\uDC7F\uDC89-\uDC8F\uDC9A-\uDFFF]|\uD833[\uDC00-\uDCEF\uDCFA-\uDFFF]|\uD834[\uDC00-\uDEBF\uDED4-\uDEDF\uDEF4-\uDF5F\uDF79-\uDFFF]|\uD835[\uDC55\uDC9D\uDCA0\uDCA1\uDCA3\uDCA4\uDCA7\uDCA8\uDCAD\uDCBA\uDCBC\uDCC4\uDD06\uDD0B\uDD0C\uDD15\uDD1D\uDD3A\uDD3F\uDD45\uDD47-\uDD49\uDD51\uDEA6\uDEA7\uDEC1\uDEDB\uDEFB\uDF15\uDF35\uDF4F\uDF6F\uDF89\uDFA9\uDFC3\uDFCC\uDFCD]|\uD837[\uDC00-\uDEFF\uDF1F-\uDF24\uDF2B-\uDFFF]|\uD838[\uDC00-\uDC2F\uDC6E-\uDCFF\uDD2D-\uDD36\uDD3E\uDD3F\uDD4A-\uDD4D\uDD4F-\uDE8F\uDEAE-\uDEBF\uDEEC-\uDEEF\uDEFA-\uDFFF]|\uD839[\uDC00-\uDCCF\uDCEC-\uDCEF\uDCFA-\uDDCF\uDDEE\uDDEF\uDDFB-\uDFDF\uDFE7\uDFEC\uDFEF\uDFFF]|\uD83A[\uDCC5\uDCC6\uDCD0-\uDCFF\uDD44-\uDD4A\uDD4C-\uDD4F\uDD5A-\uDFFF]|\uD83B[\uDC00-\uDC70\uDCAC\uDCB0\uDCB5-\uDD00\uDD2E\uDD3E-\uDDFF\uDE04\uDE20\uDE23\uDE25\uDE26\uDE28\uDE33\uDE38\uDE3A\uDE3C-\uDE41\uDE43-\uDE46\uDE48\uDE4A\uDE4C\uDE50\uDE53\uDE55\uDE56\uDE58\uDE5A\uDE5C\uDE5E\uDE60\uDE63\uDE65\uDE66\uDE6B\uDE73\uDE78\uDE7D\uDE7F\uDE8A\uDE9C-\uDEA0\uDEA4\uDEAA\uDEBC-\uDFFF]|\uD83C[\uDC00-\uDCFF\uDD0D-\uDFFF]|\uD83E[\uDC00-\uDFEF\uDFFA-\uDFFF]|\uD869[\uDEE0-\uDEFF]|\uD86D[\uDF3A-\uDF3F]|\uD86E[\uDC1E\uDC1F]|\uD873[\uDEA2-\uDEAF]|\uD87A[\uDFE1-\uDFEF]|\uD87B[\uDE5E-\uDFFF]|\uD87E[\uDE1E-\uDFFF]|\uD884[\uDF4B-\uDF4F]|\uD888[\uDFB0-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+/g).filter(function(x){return!!x;}));}function _save2(){var altText=_classPrivateFieldGet(_textarea,this).value.trim();_classPrivateFieldGet(_currentEditor,this).altTextData={altText:altText,decorative:false};_classPrivateFieldGet(_currentEditor,this).altTextData.guessedAltText=_classPrivateFieldGet(_guessedAltText,this);if(_classPrivateFieldGet(_guessedAltText,this)&&_classPrivateFieldGet(_guessedAltText,this)!==altText){var guessedWords=_assertClassBrand(_NewAltTextManager_brand,this,_extractWords).call(this,_classPrivateFieldGet(_guessedAltText,this));var words=_assertClassBrand(_NewAltTextManager_brand,this,_extractWords).call(this,altText);_classPrivateFieldGet(_currentEditor,this)._reportTelemetry({action:"pdfjs.image.alt_text.user_edit",data:{total_words:guessedWords.size,words_removed:guessedWords.difference(words).size,words_added:words.difference(guessedWords).size}});}_classPrivateFieldGet(_currentEditor,this)._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:true,alt_text_type:altText?"present":"empty"}});_classPrivateFieldGet(_currentEditor,this)._reportTelemetry({action:"pdfjs.image.alt_text.save",data:{alt_text_type:altText?"present":"empty",flow:_classPrivateFieldGet(_firstTime,this)?"image_add":"alt_text_edit"}});_assertClassBrand(_NewAltTextManager_brand,this,_finish).call(this);}var _aiModelSettings=/*#__PURE__*/new WeakMap();var _createModelButton=/*#__PURE__*/new WeakMap();var _downloadModelButton=/*#__PURE__*/new WeakMap();var _dialog2=/*#__PURE__*/new WeakMap();var _eventBus3=/*#__PURE__*/new WeakMap();var _mlManager2=/*#__PURE__*/new WeakMap();var _overlayManager2=/*#__PURE__*/new WeakMap();var _showAltTextDialogButton=/*#__PURE__*/new WeakMap();var _ImageAltTextSettings_brand=/*#__PURE__*/new WeakSet();var ImageAltTextSettings=/*#__PURE__*/function(){function ImageAltTextSettings(_ref17,overlayManager,eventBus,mlManager){var _this15=this;var dialog=_ref17.dialog,createModelButton=_ref17.createModelButton,aiModelSettings=_ref17.aiModelSettings,learnMore=_ref17.learnMore,closeButton=_ref17.closeButton,deleteModelButton=_ref17.deleteModelButton,downloadModelButton=_ref17.downloadModelButton,showAltTextDialogButton=_ref17.showAltTextDialogButton;_classCallCheck(this,ImageAltTextSettings);_classPrivateMethodInitSpec(this,_ImageAltTextSettings_brand);_classPrivateFieldInitSpec(this,_aiModelSettings,void 0);_classPrivateFieldInitSpec(this,_createModelButton,void 0);_classPrivateFieldInitSpec(this,_downloadModelButton,void 0);_classPrivateFieldInitSpec(this,_dialog2,void 0);_classPrivateFieldInitSpec(this,_eventBus3,void 0);_classPrivateFieldInitSpec(this,_mlManager2,void 0);_classPrivateFieldInitSpec(this,_overlayManager2,void 0);_classPrivateFieldInitSpec(this,_showAltTextDialogButton,void 0);_classPrivateFieldSet(_dialog2,this,dialog);_classPrivateFieldSet(_aiModelSettings,this,aiModelSettings);_classPrivateFieldSet(_createModelButton,this,createModelButton);_classPrivateFieldSet(_downloadModelButton,this,downloadModelButton);_classPrivateFieldSet(_showAltTextDialogButton,this,showAltTextDialogButton);_classPrivateFieldSet(_overlayManager2,this,overlayManager);_classPrivateFieldSet(_eventBus3,this,eventBus);_classPrivateFieldSet(_mlManager2,this,mlManager);var altTextLearnMoreUrl=mlManager.altTextLearnMoreUrl;if(altTextLearnMoreUrl){learnMore.href=altTextLearnMoreUrl;}dialog.addEventListener("contextmenu",noContextMenu);createModelButton.addEventListener("click",/*#__PURE__*/function(){var _ref18=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee31(e){var checked;return _regenerator().w(function(_context31){while(1)switch(_context31.n){case 0:checked=_assertClassBrand(_ImageAltTextSettings_brand,_this15,_togglePref).call(_this15,"enableGuessAltText",e);_context31.n=1;return mlManager.toggleService("altText",checked);case 1:_assertClassBrand(_ImageAltTextSettings_brand,_this15,_reportTelemetry).call(_this15,{type:"stamp",action:"pdfjs.image.alt_text.settings_ai_generation_check",data:{status:checked}});case 2:return _context31.a(2);}},_callee31);}));return function(_x27){return _ref18.apply(this,arguments);};}());showAltTextDialogButton.addEventListener("click",function(e){var checked=_assertClassBrand(_ImageAltTextSettings_brand,_this15,_togglePref).call(_this15,"enableNewAltTextWhenAddingImage",e);_assertClassBrand(_ImageAltTextSettings_brand,_this15,_reportTelemetry).call(_this15,{type:"stamp",action:"pdfjs.image.alt_text.settings_edit_alt_text_check",data:{status:checked}});});deleteModelButton.addEventListener("click",_assertClassBrand(_ImageAltTextSettings_brand,this,_delete3).bind(this,true));downloadModelButton.addEventListener("click",_assertClassBrand(_ImageAltTextSettings_brand,this,_download).bind(this,true));closeButton.addEventListener("click",_assertClassBrand(_ImageAltTextSettings_brand,this,_finish2).bind(this));learnMore.addEventListener("click",function(){_assertClassBrand(_ImageAltTextSettings_brand,_this15,_reportTelemetry).call(_this15,{type:"stamp",action:"pdfjs.image.alt_text.info",data:{topic:"ai_generation"}});});eventBus._on("enablealttextmodeldownload",function(_ref19){var value=_ref19.value;if(value){_assertClassBrand(_ImageAltTextSettings_brand,_this15,_download).call(_this15,false);}else{_assertClassBrand(_ImageAltTextSettings_brand,_this15,_delete3).call(_this15,false);}});_classPrivateFieldGet(_overlayManager2,this).register(dialog);}return _createClass(ImageAltTextSettings,[{key:"open",value:function(){var _open=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee32(_ref20){var enableGuessAltText,enableNewAltTextWhenAddingImage,_classPrivateFieldGet5,enableAltTextModelDownload;return _regenerator().w(function(_context32){while(1)switch(_context32.n){case 0:enableGuessAltText=_ref20.enableGuessAltText,enableNewAltTextWhenAddingImage=_ref20.enableNewAltTextWhenAddingImage;_classPrivateFieldGet5=_classPrivateFieldGet(_mlManager2,this),enableAltTextModelDownload=_classPrivateFieldGet5.enableAltTextModelDownload;_classPrivateFieldGet(_createModelButton,this).disabled=!enableAltTextModelDownload;_classPrivateFieldGet(_createModelButton,this).setAttribute("aria-pressed",enableAltTextModelDownload&&enableGuessAltText);_classPrivateFieldGet(_showAltTextDialogButton,this).setAttribute("aria-pressed",enableNewAltTextWhenAddingImage);_classPrivateFieldGet(_aiModelSettings,this).classList.toggle("download",!enableAltTextModelDownload);_context32.n=1;return _classPrivateFieldGet(_overlayManager2,this).open(_classPrivateFieldGet(_dialog2,this));case 1:_assertClassBrand(_ImageAltTextSettings_brand,this,_reportTelemetry).call(this,{type:"stamp",action:"pdfjs.image.alt_text.settings_displayed"});case 2:return _context32.a(2);}},_callee32,this);}));function open(_x28){return _open.apply(this,arguments);}return open;}()}]);}();function _reportTelemetry(data){_classPrivateFieldGet(_eventBus3,this).dispatch("reporttelemetry",{source:this,details:{type:"editing",data:data}});}function _download(){return _download3.apply(this,arguments);}function _download3(){_download3=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee111(){var isFromUI,span,_args113=arguments;return _regenerator().w(function(_context112){while(1)switch(_context112.n){case 0:isFromUI=_args113.length>0&&_args113[0]!==undefined?_args113[0]:false;if(!isFromUI){_context112.n=2;break;}_classPrivateFieldGet(_downloadModelButton,this).disabled=true;span=_classPrivateFieldGet(_downloadModelButton,this).firstChild;span.setAttribute("data-l10n-id","pdfjs-editor-alt-text-settings-downloading-model-button");_context112.n=1;return _classPrivateFieldGet(_mlManager2,this).downloadModel("altText");case 1:span.setAttribute("data-l10n-id","pdfjs-editor-alt-text-settings-download-model-button");_classPrivateFieldGet(_createModelButton,this).disabled=false;_assertClassBrand(_ImageAltTextSettings_brand,this,_setPref).call(this,"enableGuessAltText",true);_classPrivateFieldGet(_mlManager2,this).toggleService("altText",true);_assertClassBrand(_ImageAltTextSettings_brand,this,_setPref).call(this,"enableAltTextModelDownload",true);_classPrivateFieldGet(_downloadModelButton,this).disabled=false;case 2:_classPrivateFieldGet(_aiModelSettings,this).classList.toggle("download",false);_classPrivateFieldGet(_createModelButton,this).setAttribute("aria-pressed",true);case 3:return _context112.a(2);}},_callee111,this);}));return _download3.apply(this,arguments);}function _delete3(){return _delete4.apply(this,arguments);}function _delete4(){_delete4=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee112(){var isFromUI,_args114=arguments;return _regenerator().w(function(_context113){while(1)switch(_context113.n){case 0:isFromUI=_args114.length>0&&_args114[0]!==undefined?_args114[0]:false;if(!isFromUI){_context113.n=2;break;}_context113.n=1;return _classPrivateFieldGet(_mlManager2,this).deleteModel("altText");case 1:_assertClassBrand(_ImageAltTextSettings_brand,this,_setPref).call(this,"enableGuessAltText",false);_assertClassBrand(_ImageAltTextSettings_brand,this,_setPref).call(this,"enableAltTextModelDownload",false);case 2:_classPrivateFieldGet(_aiModelSettings,this).classList.toggle("download",true);_classPrivateFieldGet(_createModelButton,this).disabled=true;_classPrivateFieldGet(_createModelButton,this).setAttribute("aria-pressed",false);case 3:return _context113.a(2);}},_callee112,this);}));return _delete4.apply(this,arguments);}function _togglePref(name,_ref111){var target=_ref111.target;var checked=target.getAttribute("aria-pressed")!=="true";_assertClassBrand(_ImageAltTextSettings_brand,this,_setPref).call(this,name,checked);target.setAttribute("aria-pressed",checked);return checked;}function _setPref(name,value){_classPrivateFieldGet(_eventBus3,this).dispatch("setpreference",{source:this,name:name,value:value});}function _finish2(){_classPrivateFieldGet(_overlayManager2,this).closeIfActive(_classPrivateFieldGet(_dialog2,this));};// ./web/alt_text_manager.js
var _clickAC=/*#__PURE__*/new WeakMap();var _currentEditor2=/*#__PURE__*/new WeakMap();var _cancelButton2=/*#__PURE__*/new WeakMap();var _dialog3=/*#__PURE__*/new WeakMap();var _eventBus4=/*#__PURE__*/new WeakMap();var _hasUsedPointer=/*#__PURE__*/new WeakMap();var _optionDescription=/*#__PURE__*/new WeakMap();var _optionDecorative=/*#__PURE__*/new WeakMap();var _overlayManager3=/*#__PURE__*/new WeakMap();var _saveButton=/*#__PURE__*/new WeakMap();var _textarea2=/*#__PURE__*/new WeakMap();var _uiManager2=/*#__PURE__*/new WeakMap();var _previousAltText2=/*#__PURE__*/new WeakMap();var _resizeAC=/*#__PURE__*/new WeakMap();var _svgElement=/*#__PURE__*/new WeakMap();var _rectElement=/*#__PURE__*/new WeakMap();var _container=/*#__PURE__*/new WeakMap();var _telemetryData=/*#__PURE__*/new WeakMap();var _AltTextManager_brand=/*#__PURE__*/new WeakSet();var AltTextManager=/*#__PURE__*/function(){function AltTextManager(_ref21,container,overlayManager,eventBus){var _this16=this;var _dialog4=_ref21.dialog,optionDescription=_ref21.optionDescription,optionDecorative=_ref21.optionDecorative,textarea=_ref21.textarea,cancelButton=_ref21.cancelButton,saveButton=_ref21.saveButton;_classCallCheck(this,AltTextManager);_classPrivateMethodInitSpec(this,_AltTextManager_brand);_classPrivateFieldInitSpec(this,_clickAC,null);_classPrivateFieldInitSpec(this,_currentEditor2,null);_classPrivateFieldInitSpec(this,_cancelButton2,void 0);_classPrivateFieldInitSpec(this,_dialog3,void 0);_classPrivateFieldInitSpec(this,_eventBus4,void 0);_classPrivateFieldInitSpec(this,_hasUsedPointer,false);_classPrivateFieldInitSpec(this,_optionDescription,void 0);_classPrivateFieldInitSpec(this,_optionDecorative,void 0);_classPrivateFieldInitSpec(this,_overlayManager3,void 0);_classPrivateFieldInitSpec(this,_saveButton,void 0);_classPrivateFieldInitSpec(this,_textarea2,void 0);_classPrivateFieldInitSpec(this,_uiManager2,void 0);_classPrivateFieldInitSpec(this,_previousAltText2,null);_classPrivateFieldInitSpec(this,_resizeAC,null);_classPrivateFieldInitSpec(this,_svgElement,null);_classPrivateFieldInitSpec(this,_rectElement,null);_classPrivateFieldInitSpec(this,_container,void 0);_classPrivateFieldInitSpec(this,_telemetryData,null);_classPrivateFieldSet(_dialog3,this,_dialog4);_classPrivateFieldSet(_optionDescription,this,optionDescription);_classPrivateFieldSet(_optionDecorative,this,optionDecorative);_classPrivateFieldSet(_textarea2,this,textarea);_classPrivateFieldSet(_cancelButton2,this,cancelButton);_classPrivateFieldSet(_saveButton,this,saveButton);_classPrivateFieldSet(_overlayManager3,this,overlayManager);_classPrivateFieldSet(_eventBus4,this,eventBus);_classPrivateFieldSet(_container,this,container);var onUpdateUIState=_assertClassBrand(_AltTextManager_brand,this,_updateUIState).bind(this);_dialog4.addEventListener("close",_assertClassBrand(_AltTextManager_brand,this,_close2).bind(this));_dialog4.addEventListener("contextmenu",function(event){if(event.target!==_classPrivateFieldGet(_textarea2,_this16)){event.preventDefault();}});cancelButton.addEventListener("click",_assertClassBrand(_AltTextManager_brand,this,_finish3).bind(this));saveButton.addEventListener("click",_assertClassBrand(_AltTextManager_brand,this,_save3).bind(this));optionDescription.addEventListener("change",onUpdateUIState);optionDecorative.addEventListener("change",onUpdateUIState);_classPrivateFieldGet(_overlayManager3,this).register(_dialog4);}return _createClass(AltTextManager,[{key:"editAltText",value:function(){var _editAltText2=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee33(uiManager,editor){var clickOpts,onClick,_i5,_arr,element,_editor$altTextData,altText,decorative,_t10;return _regenerator().w(function(_context33){while(1)switch(_context33.n){case 0:if(!(_classPrivateFieldGet(_currentEditor2,this)||!editor)){_context33.n=1;break;}return _context33.a(2);case 1:_assertClassBrand(_AltTextManager_brand,this,_createSVGElement).call(this);_classPrivateFieldSet(_hasUsedPointer,this,false);_classPrivateFieldSet(_clickAC,this,new AbortController());clickOpts={signal:_classPrivateFieldGet(_clickAC,this).signal},onClick=_assertClassBrand(_AltTextManager_brand,this,_onClick).bind(this);for(_i5=0,_arr=[_classPrivateFieldGet(_optionDescription,this),_classPrivateFieldGet(_optionDecorative,this),_classPrivateFieldGet(_textarea2,this),_classPrivateFieldGet(_saveButton,this),_classPrivateFieldGet(_cancelButton2,this)];_i5<_arr.length;_i5++){element=_arr[_i5];element.addEventListener("click",onClick,clickOpts);}_editor$altTextData=editor.altTextData,altText=_editor$altTextData.altText,decorative=_editor$altTextData.decorative;if(decorative===true){_classPrivateFieldGet(_optionDecorative,this).checked=true;_classPrivateFieldGet(_optionDescription,this).checked=false;}else{_classPrivateFieldGet(_optionDecorative,this).checked=false;_classPrivateFieldGet(_optionDescription,this).checked=true;}_classPrivateFieldSet(_previousAltText2,this,_classPrivateFieldGet(_textarea2,this).value=(altText===null||altText===void 0?void 0:altText.trim())||"");_assertClassBrand(_AltTextManager_brand,this,_updateUIState).call(this);_classPrivateFieldSet(_currentEditor2,this,editor);_classPrivateFieldSet(_uiManager2,this,uiManager);_classPrivateFieldGet(_uiManager2,this).removeEditListeners();_classPrivateFieldSet(_resizeAC,this,new AbortController());_classPrivateFieldGet(_eventBus4,this)._on("resize",_assertClassBrand(_AltTextManager_brand,this,_setPosition).bind(this),{signal:_classPrivateFieldGet(_resizeAC,this).signal});_context33.p=2;_context33.n=3;return _classPrivateFieldGet(_overlayManager3,this).open(_classPrivateFieldGet(_dialog3,this));case 3:_assertClassBrand(_AltTextManager_brand,this,_setPosition).call(this);_context33.n=5;break;case 4:_context33.p=4;_t10=_context33.v;_assertClassBrand(_AltTextManager_brand,this,_close2).call(this);throw _t10;case 5:return _context33.a(2);}},_callee33,this,[[2,4]]);}));function editAltText(_x29,_x30){return _editAltText2.apply(this,arguments);}return editAltText;}()},{key:"destroy",value:function destroy(){var _classPrivateFieldGet6;_classPrivateFieldSet(_uiManager2,this,null);_assertClassBrand(_AltTextManager_brand,this,_finish3).call(this);(_classPrivateFieldGet6=_classPrivateFieldGet(_svgElement,this))===null||_classPrivateFieldGet6===void 0||_classPrivateFieldGet6.remove();_classPrivateFieldSet(_svgElement,this,_classPrivateFieldSet(_rectElement,this,null));}}]);}();function _createSVGElement(){if(_classPrivateFieldGet(_svgElement,this)){return;}var svgFactory=new DOMSVGFactory();var svg=_classPrivateFieldSet(_svgElement,this,svgFactory.createElement("svg"));svg.setAttribute("width","0");svg.setAttribute("height","0");var defs=svgFactory.createElement("defs");svg.append(defs);var mask=svgFactory.createElement("mask");defs.append(mask);mask.setAttribute("id","alttext-manager-mask");mask.setAttribute("maskContentUnits","objectBoundingBox");var rect=svgFactory.createElement("rect");mask.append(rect);rect.setAttribute("fill","white");rect.setAttribute("width","1");rect.setAttribute("height","1");rect.setAttribute("x","0");rect.setAttribute("y","0");rect=_classPrivateFieldSet(_rectElement,this,svgFactory.createElement("rect"));mask.append(rect);rect.setAttribute("fill","black");_classPrivateFieldGet(_dialog3,this).append(svg);}function _setPosition(){if(!_classPrivateFieldGet(_currentEditor2,this)){return;}var dialog=_classPrivateFieldGet(_dialog3,this);var style=dialog.style;var _classPrivateFieldGet46=_classPrivateFieldGet(_container,this).getBoundingClientRect(),containerX=_classPrivateFieldGet46.x,containerY=_classPrivateFieldGet46.y,containerW=_classPrivateFieldGet46.width,containerH=_classPrivateFieldGet46.height;var _window=window,windowW=_window.innerWidth,windowH=_window.innerHeight;var _dialog$getBoundingCl=dialog.getBoundingClientRect(),dialogW=_dialog$getBoundingCl.width,dialogH=_dialog$getBoundingCl.height;var _classPrivateFieldGet47=_classPrivateFieldGet(_currentEditor2,this).getClientDimensions(),x=_classPrivateFieldGet47.x,y=_classPrivateFieldGet47.y,width=_classPrivateFieldGet47.width,height=_classPrivateFieldGet47.height;var MARGIN=10;var isLTR=_classPrivateFieldGet(_uiManager2,this).direction==="ltr";var xs=Math.max(x,containerX);var xe=Math.min(x+width,containerX+containerW);var ys=Math.max(y,containerY);var ye=Math.min(y+height,containerY+containerH);_classPrivateFieldGet(_rectElement,this).setAttribute("width","".concat((xe-xs)/windowW));_classPrivateFieldGet(_rectElement,this).setAttribute("height","".concat((ye-ys)/windowH));_classPrivateFieldGet(_rectElement,this).setAttribute("x","".concat(xs/windowW));_classPrivateFieldGet(_rectElement,this).setAttribute("y","".concat(ys/windowH));var left=null;var top=Math.max(y,0);top+=Math.min(windowH-(top+dialogH),0);if(isLTR){if(x+width+MARGIN+dialogW<windowW){left=x+width+MARGIN;}else if(x>dialogW+MARGIN){left=x-dialogW-MARGIN;}}else if(x>dialogW+MARGIN){left=x-dialogW-MARGIN;}else if(x+width+MARGIN+dialogW<windowW){left=x+width+MARGIN;}if(left===null){top=null;left=Math.max(x,0);left+=Math.min(windowW-(left+dialogW),0);if(y>dialogH+MARGIN){top=y-dialogH-MARGIN;}else if(y+height+MARGIN+dialogH<windowH){top=y+height+MARGIN;}}if(top!==null){dialog.classList.add("positioned");if(isLTR){style.left="".concat(left,"px");}else{style.right="".concat(windowW-left-dialogW,"px");}style.top="".concat(top,"px");}else{dialog.classList.remove("positioned");style.left="";style.top="";}}function _finish3(){_classPrivateFieldGet(_overlayManager3,this).closeIfActive(_classPrivateFieldGet(_dialog3,this));}function _close2(){var _classPrivateFieldGet48,_classPrivateFieldGet49;_classPrivateFieldGet(_currentEditor2,this)._reportTelemetry(_classPrivateFieldGet(_telemetryData,this)||{action:"alt_text_cancel",alt_text_keyboard:!_classPrivateFieldGet(_hasUsedPointer,this)});_classPrivateFieldSet(_telemetryData,this,null);_assertClassBrand(_AltTextManager_brand,this,_removeOnClickListeners).call(this);(_classPrivateFieldGet48=_classPrivateFieldGet(_uiManager2,this))===null||_classPrivateFieldGet48===void 0||_classPrivateFieldGet48.addEditListeners();(_classPrivateFieldGet49=_classPrivateFieldGet(_resizeAC,this))===null||_classPrivateFieldGet49===void 0||_classPrivateFieldGet49.abort();_classPrivateFieldSet(_resizeAC,this,null);_classPrivateFieldGet(_currentEditor2,this).altTextFinish();_classPrivateFieldSet(_currentEditor2,this,null);_classPrivateFieldSet(_uiManager2,this,null);}function _updateUIState(){_classPrivateFieldGet(_textarea2,this).disabled=_classPrivateFieldGet(_optionDecorative,this).checked;}function _save3(){var altText=_classPrivateFieldGet(_textarea2,this).value.trim();var decorative=_classPrivateFieldGet(_optionDecorative,this).checked;_classPrivateFieldGet(_currentEditor2,this).altTextData={altText:altText,decorative:decorative};_classPrivateFieldSet(_telemetryData,this,{action:"alt_text_save",alt_text_description:!!altText,alt_text_edit:!!_classPrivateFieldGet(_previousAltText2,this)&&_classPrivateFieldGet(_previousAltText2,this)!==altText,alt_text_decorative:decorative,alt_text_keyboard:!_classPrivateFieldGet(_hasUsedPointer,this)});_assertClassBrand(_AltTextManager_brand,this,_finish3).call(this);}function _onClick(evt){if(evt.detail===0){return;}_classPrivateFieldSet(_hasUsedPointer,this,true);_assertClassBrand(_AltTextManager_brand,this,_removeOnClickListeners).call(this);}function _removeOnClickListeners(){var _classPrivateFieldGet50;(_classPrivateFieldGet50=_classPrivateFieldGet(_clickAC,this))===null||_classPrivateFieldGet50===void 0||_classPrivateFieldGet50.abort();_classPrivateFieldSet(_clickAC,this,null);};// ./web/annotation_editor_params.js
var _AnnotationEditorParams_brand=/*#__PURE__*/new WeakSet();var AnnotationEditorParams=/*#__PURE__*/_createClass(function AnnotationEditorParams(options,_eventBus5){_classCallCheck(this,AnnotationEditorParams);_classPrivateMethodInitSpec(this,_AnnotationEditorParams_brand);this.eventBus=_eventBus5;_assertClassBrand(_AnnotationEditorParams_brand,this,_bindListeners).call(this,options);});function _bindListeners(_ref112){var _this94=this;var editorFreeTextFontSize=_ref112.editorFreeTextFontSize,editorFreeTextColor=_ref112.editorFreeTextColor,editorInkColor=_ref112.editorInkColor,editorInkThickness=_ref112.editorInkThickness,editorInkOpacity=_ref112.editorInkOpacity,editorStampAddImage=_ref112.editorStampAddImage,editorFreeHighlightThickness=_ref112.editorFreeHighlightThickness,editorHighlightShowAll=_ref112.editorHighlightShowAll,editorSignatureAddSignature=_ref112.editorSignatureAddSignature;var eventBus=this.eventBus;var dispatchEvent=function dispatchEvent(typeStr,value){eventBus.dispatch("switchannotationeditorparams",{source:_this94,type:AnnotationEditorParamsType[typeStr],value:value});};editorFreeTextFontSize.addEventListener("input",function(){dispatchEvent("FREETEXT_SIZE",this.valueAsNumber);});editorFreeTextColor.addEventListener("input",function(){dispatchEvent("FREETEXT_COLOR",this.value);});editorInkColor.addEventListener("input",function(){dispatchEvent("INK_COLOR",this.value);});editorInkThickness.addEventListener("input",function(){dispatchEvent("INK_THICKNESS",this.valueAsNumber);});editorInkOpacity.addEventListener("input",function(){dispatchEvent("INK_OPACITY",this.valueAsNumber);});editorStampAddImage.addEventListener("click",function(){eventBus.dispatch("reporttelemetry",{source:_this94,details:{type:"editing",data:{action:"pdfjs.image.add_image_click"}}});dispatchEvent("CREATE");});editorFreeHighlightThickness.addEventListener("input",function(){dispatchEvent("HIGHLIGHT_THICKNESS",this.valueAsNumber);});editorHighlightShowAll.addEventListener("click",function(){var checked=this.getAttribute("aria-pressed")==="true";this.setAttribute("aria-pressed",!checked);dispatchEvent("HIGHLIGHT_SHOW_ALL",!checked);});editorSignatureAddSignature.addEventListener("click",function(){dispatchEvent("CREATE");});eventBus._on("annotationeditorparamschanged",function(evt){var _iterator52=_createForOfIteratorHelper(evt.details),_step52;try{for(_iterator52.s();!(_step52=_iterator52.n()).done;){var _step52$value=_slicedToArray(_step52.value,2),type=_step52$value[0],value=_step52$value[1];switch(type){case AnnotationEditorParamsType.FREETEXT_SIZE:editorFreeTextFontSize.value=value;break;case AnnotationEditorParamsType.FREETEXT_COLOR:editorFreeTextColor.value=value;break;case AnnotationEditorParamsType.INK_COLOR:editorInkColor.value=value;break;case AnnotationEditorParamsType.INK_THICKNESS:editorInkThickness.value=value;break;case AnnotationEditorParamsType.INK_OPACITY:editorInkOpacity.value=value;break;case AnnotationEditorParamsType.HIGHLIGHT_DEFAULT_COLOR:eventBus.dispatch("mainhighlightcolorpickerupdatecolor",{source:_this94,value:value});break;case AnnotationEditorParamsType.HIGHLIGHT_THICKNESS:editorFreeHighlightThickness.value=value;break;case AnnotationEditorParamsType.HIGHLIGHT_FREE:editorFreeHighlightThickness.disabled=!value;break;case AnnotationEditorParamsType.HIGHLIGHT_SHOW_ALL:editorHighlightShowAll.setAttribute("aria-pressed",value);break;}}}catch(err){_iterator52.e(err);}finally{_iterator52.f();}});};// ./web/caret_browsing.js
var PRECISION=1e-1;var _mainContainer=/*#__PURE__*/new WeakMap();var _toolBarHeight=/*#__PURE__*/new WeakMap();var _viewerContainer=/*#__PURE__*/new WeakMap();var _CaretBrowsingMode_brand=/*#__PURE__*/new WeakSet();var CaretBrowsingMode=/*#__PURE__*/function(){function CaretBrowsingMode(abortSignal,mainContainer,viewerContainer,toolbarContainer){var _this17=this;_classCallCheck(this,CaretBrowsingMode);_classPrivateMethodInitSpec(this,_CaretBrowsingMode_brand);_classPrivateFieldInitSpec(this,_mainContainer,void 0);_classPrivateFieldInitSpec(this,_toolBarHeight,0);_classPrivateFieldInitSpec(this,_viewerContainer,void 0);_classPrivateFieldSet(_mainContainer,this,mainContainer);_classPrivateFieldSet(_viewerContainer,this,viewerContainer);if(!toolbarContainer){return;}_classPrivateFieldSet(_toolBarHeight,this,toolbarContainer.getBoundingClientRect().height);var toolbarObserver=new ResizeObserver(function(entries){var _iterator17=_createForOfIteratorHelper(entries),_step17;try{for(_iterator17.s();!(_step17=_iterator17.n()).done;){var entry=_step17.value;if(entry.target===toolbarContainer){_classPrivateFieldSet(_toolBarHeight,_this17,Math.floor(entry.borderBoxSize[0].blockSize));break;}}}catch(err){_iterator17.e(err);}finally{_iterator17.f();}});toolbarObserver.observe(toolbarContainer);abortSignal.addEventListener("abort",function(){return toolbarObserver.disconnect();},{once:true});}return _createClass(CaretBrowsingMode,[{key:"moveCaret",value:function moveCaret(isUp,select){var selection=document.getSelection();if(selection.rangeCount===0){return;}var focusNode=selection.focusNode;var focusElement=focusNode.nodeType!==Node.ELEMENT_NODE?focusNode.parentElement:focusNode;var root=focusElement.closest(".textLayer");if(!root){return;}var walker=document.createTreeWalker(root,NodeFilter.SHOW_TEXT);walker.currentNode=focusNode;var focusRect=focusElement.getBoundingClientRect();var newLineElement=null;var nodeIterator=(isUp?walker.previousSibling:walker.nextSibling).bind(walker);while(nodeIterator()){var element=walker.currentNode.parentElement;if(!_assertClassBrand(_CaretBrowsingMode_brand,this,_isOnSameLine).call(this,focusRect,element.getBoundingClientRect())){newLineElement=element;break;}}if(!newLineElement){var node=_assertClassBrand(_CaretBrowsingMode_brand,this,_getNodeOnNextPage).call(this,root,isUp);if(!node){return;}if(select){var lastNode=(isUp?walker.firstChild():walker.lastChild())||focusNode;selection.extend(lastNode,isUp?0:lastNode.length);var range=document.createRange();range.setStart(node,isUp?node.length:0);range.setEnd(node,isUp?node.length:0);selection.addRange(range);return;}var _assertClassBrand$cal=_assertClassBrand(_CaretBrowsingMode_brand,this,_getCaretPosition).call(this,selection,isUp),_assertClassBrand$cal2=_slicedToArray(_assertClassBrand$cal,1),_caretX=_assertClassBrand$cal2[0];var parentElement=node.parentElement;_assertClassBrand(_CaretBrowsingMode_brand,this,_setCaretPosition).call(this,select,selection,parentElement,parentElement.getBoundingClientRect(),_caretX);return;}var _assertClassBrand$cal3=_assertClassBrand(_CaretBrowsingMode_brand,this,_getCaretPosition).call(this,selection,isUp),_assertClassBrand$cal4=_slicedToArray(_assertClassBrand$cal3,2),caretX=_assertClassBrand$cal4[0],caretY=_assertClassBrand$cal4[1];var newLineElementRect=newLineElement.getBoundingClientRect();if(_assertClassBrand(_CaretBrowsingMode_brand,this,_isUnderOver).call(this,newLineElementRect,caretX,caretY,isUp)){_assertClassBrand(_CaretBrowsingMode_brand,this,_setCaretPosition).call(this,select,selection,newLineElement,newLineElementRect,caretX);return;}while(nodeIterator()){var _element=walker.currentNode.parentElement;var elementRect=_element.getBoundingClientRect();if(!_assertClassBrand(_CaretBrowsingMode_brand,this,_isOnSameLine).call(this,newLineElementRect,elementRect)){break;}if(_assertClassBrand(_CaretBrowsingMode_brand,this,_isUnderOver).call(this,elementRect,caretX,caretY,isUp)){_assertClassBrand(_CaretBrowsingMode_brand,this,_setCaretPosition).call(this,select,selection,_element,elementRect,caretX);return;}}_assertClassBrand(_CaretBrowsingMode_brand,this,_setCaretPosition).call(this,select,selection,newLineElement,newLineElementRect,caretX);}}]);}();_CaretBrowsingMode=CaretBrowsingMode;function _isOnSameLine(rect1,rect2){var top1=rect1.y;var bot1=rect1.bottom;var mid1=rect1.y+rect1.height/2;var top2=rect2.y;var bot2=rect2.bottom;var mid2=rect2.y+rect2.height/2;return top1<=mid2&&mid2<=bot1||top2<=mid1&&mid1<=bot2;}function _isUnderOver(rect,x,y,isUp){var midY=rect.y+rect.height/2;return(isUp?y>=midY:y<=midY)&&rect.x-PRECISION<=x&&x<=rect.right+PRECISION;}function _isVisible(rect){return rect.top>=_classPrivateFieldGet(_toolBarHeight,this)&&rect.left>=0&&rect.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&rect.right<=(window.innerWidth||document.documentElement.clientWidth);}function _getCaretPosition(selection,isUp){var focusNode=selection.focusNode,focusOffset=selection.focusOffset;var range=document.createRange();range.setStart(focusNode,focusOffset);range.setEnd(focusNode,focusOffset);var rect=range.getBoundingClientRect();return[rect.x,isUp?rect.top:rect.bottom];}function _caretPositionFromPoint(x,y){if(!document.caretPositionFromPoint){var _document$caretRangeF=document.caretRangeFromPoint(x,y),offsetNode=_document$caretRangeF.startContainer,offset=_document$caretRangeF.startOffset;return{offsetNode:offsetNode,offset:offset};}return document.caretPositionFromPoint(x,y);}function _setCaretPositionHelper(selection,caretX,select,element,rect){var _caretPosition$offset;rect||(rect=element.getBoundingClientRect());if(caretX<=rect.x+PRECISION){if(select){selection.extend(element.firstChild,0);}else{selection.setPosition(element.firstChild,0);}return;}if(rect.right-PRECISION<=caretX){var lastChild=element.lastChild;if(select){selection.extend(lastChild,lastChild.length);}else{selection.setPosition(lastChild,lastChild.length);}return;}var midY=rect.y+rect.height/2;var caretPosition=_caretPositionFromPoint.call(_CaretBrowsingMode,caretX,midY);var parentElement=(_caretPosition$offset=caretPosition.offsetNode)===null||_caretPosition$offset===void 0?void 0:_caretPosition$offset.parentElement;if(parentElement&&parentElement!==element){var _caretPosition$offset2;var elementsAtPoint=document.elementsFromPoint(caretX,midY);var savedVisibilities=[];var _iterator53=_createForOfIteratorHelper(elementsAtPoint),_step53;try{for(_iterator53.s();!(_step53=_iterator53.n()).done;){var _el=_step53.value;if(_el===element){break;}var style=_el.style;savedVisibilities.push([_el,style.visibility]);style.visibility="hidden";}}catch(err){_iterator53.e(err);}finally{_iterator53.f();}caretPosition=_caretPositionFromPoint.call(_CaretBrowsingMode,caretX,midY);parentElement=(_caretPosition$offset2=caretPosition.offsetNode)===null||_caretPosition$offset2===void 0?void 0:_caretPosition$offset2.parentElement;for(var _i0=0,_savedVisibilities=savedVisibilities;_i0<_savedVisibilities.length;_i0++){var _savedVisibilities$_i=_slicedToArray(_savedVisibilities[_i0],2),el=_savedVisibilities$_i[0],visibility=_savedVisibilities$_i[1];el.style.visibility=visibility;}}if(parentElement!==element){if(select){selection.extend(element.firstChild,0);}else{selection.setPosition(element.firstChild,0);}return;}if(select){selection.extend(caretPosition.offsetNode,caretPosition.offset);}else{selection.setPosition(caretPosition.offsetNode,caretPosition.offset);}}function _setCaretPosition(select,selection,newLineElement,newLineElementRect,caretX){if(_assertClassBrand(_CaretBrowsingMode_brand,this,_isVisible).call(this,newLineElementRect)){_assertClassBrand(_CaretBrowsingMode_brand,this,_setCaretPositionHelper).call(this,selection,caretX,select,newLineElement,newLineElementRect);return;}_classPrivateFieldGet(_mainContainer,this).addEventListener("scrollend",_assertClassBrand(_CaretBrowsingMode_brand,this,_setCaretPositionHelper).bind(this,selection,caretX,select,newLineElement,null),{once:true});newLineElement.scrollIntoView();}function _getNodeOnNextPage(textLayer,isUp){while(true){var page=textLayer.closest(".page");var pageNumber=parseInt(page.getAttribute("data-page-number"));var nextPage=isUp?pageNumber-1:pageNumber+1;textLayer=_classPrivateFieldGet(_viewerContainer,this).querySelector(".page[data-page-number=\"".concat(nextPage,"\"] .textLayer"));if(!textLayer){return null;}var walker=document.createTreeWalker(textLayer,NodeFilter.SHOW_TEXT);var node=isUp?walker.lastChild():walker.firstChild();if(node){return node;}}};// ./web/download_manager.js
function _download2(blobUrl,filename){var a=document.createElement("a");if(!a.click){throw new Error('DownloadManager: "a.click()" is not supported.');}a.href=blobUrl;a.target="_parent";if("download"in a){a.download=filename;}(document.body||document.documentElement).append(a);a.click();a.remove();}var _openBlobUrls=/*#__PURE__*/new WeakMap();var DownloadManager=/*#__PURE__*/function(){function DownloadManager(){_classCallCheck(this,DownloadManager);_classPrivateFieldInitSpec(this,_openBlobUrls,new WeakMap());}return _createClass(DownloadManager,[{key:"downloadData",value:function downloadData(data,filename,contentType){var blobUrl=URL.createObjectURL(new Blob([data],{type:contentType}));_download2(blobUrl,filename);}},{key:"openOrDownloadData",value:function openOrDownloadData(data,filename){var dest=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;var isPdfData=isPdfFile(filename);var contentType=isPdfData?"application/pdf":"";if(isPdfData){var blobUrl=_classPrivateFieldGet(_openBlobUrls,this).get(data);if(!blobUrl){blobUrl=URL.createObjectURL(new Blob([data],{type:contentType}));_classPrivateFieldGet(_openBlobUrls,this).set(data,blobUrl);}var viewerUrl;viewerUrl="?file="+encodeURIComponent(blobUrl+"#"+filename);if(dest){viewerUrl+="#".concat(escape(dest));}try{window.open(viewerUrl);return true;}catch(ex){console.error("openOrDownloadData:",ex);URL.revokeObjectURL(blobUrl);_classPrivateFieldGet(_openBlobUrls,this)["delete"](data);}}this.downloadData(data,filename,contentType);return false;}},{key:"download",value:function download(data,url,filename){var blobUrl;if(data){blobUrl=URL.createObjectURL(new Blob([data],{type:"application/pdf"}));}else{if(!createValidAbsoluteUrl(url,"http://example.com")){console.error("download - not a valid URL: ".concat(url));return;}blobUrl=url+"#pdfjs.action=download";}_download2(blobUrl,filename);}}]);}();;// ./web/editor_undo_bar.js
var _closeButton=/*#__PURE__*/new WeakMap();var _container2=/*#__PURE__*/new WeakMap();var _eventBus6=/*#__PURE__*/new WeakMap();var _focusTimeout=/*#__PURE__*/new WeakMap();var _initController=/*#__PURE__*/new WeakMap();var _message=/*#__PURE__*/new WeakMap();var _showController=/*#__PURE__*/new WeakMap();var _undoButton=/*#__PURE__*/new WeakMap();var EditorUndoBar=/*#__PURE__*/function(){function EditorUndoBar(_ref22,eventBus){var container=_ref22.container,message=_ref22.message,undoButton=_ref22.undoButton,closeButton=_ref22.closeButton;_classCallCheck(this,EditorUndoBar);_classPrivateFieldInitSpec(this,_closeButton,null);_classPrivateFieldInitSpec(this,_container2,void 0);_classPrivateFieldInitSpec(this,_eventBus6,null);_classPrivateFieldInitSpec(this,_focusTimeout,null);_classPrivateFieldInitSpec(this,_initController,null);_defineProperty(this,"isOpen",false);_classPrivateFieldInitSpec(this,_message,void 0);_classPrivateFieldInitSpec(this,_showController,null);_classPrivateFieldInitSpec(this,_undoButton,void 0);_classPrivateFieldSet(_container2,this,container);_classPrivateFieldSet(_message,this,message);_classPrivateFieldSet(_undoButton,this,undoButton);_classPrivateFieldSet(_closeButton,this,closeButton);_classPrivateFieldSet(_eventBus6,this,eventBus);}return _createClass(EditorUndoBar,[{key:"destroy",value:function destroy(){var _classPrivateFieldGet7;(_classPrivateFieldGet7=_classPrivateFieldGet(_initController,this))===null||_classPrivateFieldGet7===void 0||_classPrivateFieldGet7.abort();_classPrivateFieldSet(_initController,this,null);this.hide();}},{key:"show",value:function show(undoAction,messageData){var _this18=this;if(!_classPrivateFieldGet(_initController,this)){_classPrivateFieldSet(_initController,this,new AbortController());var opts={signal:_classPrivateFieldGet(_initController,this).signal};var boundHide=this.hide.bind(this);_classPrivateFieldGet(_container2,this).addEventListener("contextmenu",noContextMenu,opts);_classPrivateFieldGet(_closeButton,this).addEventListener("click",boundHide,opts);_classPrivateFieldGet(_eventBus6,this)._on("beforeprint",boundHide,opts);_classPrivateFieldGet(_eventBus6,this)._on("download",boundHide,opts);}this.hide();if(typeof messageData==="string"){_classPrivateFieldGet(_message,this).setAttribute("data-l10n-id",_l10nMessages._[messageData]);}else{_classPrivateFieldGet(_message,this).setAttribute("data-l10n-id",_l10nMessages._._multiple);_classPrivateFieldGet(_message,this).setAttribute("data-l10n-args",JSON.stringify({count:messageData}));}this.isOpen=true;_classPrivateFieldGet(_container2,this).hidden=false;_classPrivateFieldSet(_showController,this,new AbortController());_classPrivateFieldGet(_undoButton,this).addEventListener("click",function(){undoAction();_this18.hide();},{signal:_classPrivateFieldGet(_showController,this).signal});_classPrivateFieldSet(_focusTimeout,this,setTimeout(function(){_classPrivateFieldGet(_container2,_this18).focus();_classPrivateFieldSet(_focusTimeout,_this18,null);},100));}},{key:"hide",value:function hide(){var _classPrivateFieldGet8;if(!this.isOpen){return;}this.isOpen=false;_classPrivateFieldGet(_container2,this).hidden=true;(_classPrivateFieldGet8=_classPrivateFieldGet(_showController,this))===null||_classPrivateFieldGet8===void 0||_classPrivateFieldGet8.abort();_classPrivateFieldSet(_showController,this,null);if(_classPrivateFieldGet(_focusTimeout,this)){clearTimeout(_classPrivateFieldGet(_focusTimeout,this));_classPrivateFieldSet(_focusTimeout,this,null);}}}]);}();var _l10nMessages={_:Object.freeze({highlight:"pdfjs-editor-undo-bar-message-highlight",freetext:"pdfjs-editor-undo-bar-message-freetext",stamp:"pdfjs-editor-undo-bar-message-stamp",ink:"pdfjs-editor-undo-bar-message-ink",signature:"pdfjs-editor-undo-bar-message-signature",_multiple:"pdfjs-editor-undo-bar-message-multiple"})};;// ./web/overlay_manager.js
var _overlays=/*#__PURE__*/new WeakMap();var _active=/*#__PURE__*/new WeakMap();var OverlayManager=/*#__PURE__*/function(){function OverlayManager(){_classCallCheck(this,OverlayManager);_classPrivateFieldInitSpec(this,_overlays,new WeakMap());_classPrivateFieldInitSpec(this,_active,null);}return _createClass(OverlayManager,[{key:"active",get:function get(){return _classPrivateFieldGet(_active,this);}},{key:"register",value:function(){var _register=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee34(dialog){var _this19=this;var canForceClose,_args34=arguments;return _regenerator().w(function(_context34){while(1)switch(_context34.n){case 0:canForceClose=_args34.length>1&&_args34[1]!==undefined?_args34[1]:false;if(!(_typeof(dialog)!=="object")){_context34.n=1;break;}throw new Error("Not enough parameters.");case 1:if(!_classPrivateFieldGet(_overlays,this).has(dialog)){_context34.n=2;break;}throw new Error("The overlay is already registered.");case 2:_classPrivateFieldGet(_overlays,this).set(dialog,{canForceClose:canForceClose});dialog.addEventListener("cancel",function(_ref23){var target=_ref23.target;if(_classPrivateFieldGet(_active,_this19)===target){_classPrivateFieldSet(_active,_this19,null);}});case 3:return _context34.a(2);}},_callee34,this);}));function register(_x31){return _register.apply(this,arguments);}return register;}()},{key:"open",value:function(){var _open2=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee35(dialog){return _regenerator().w(function(_context35){while(1)switch(_context35.n){case 0:if(_classPrivateFieldGet(_overlays,this).has(dialog)){_context35.n=1;break;}throw new Error("The overlay does not exist.");case 1:if(!_classPrivateFieldGet(_active,this)){_context35.n=5;break;}if(!(_classPrivateFieldGet(_active,this)===dialog)){_context35.n=2;break;}throw new Error("The overlay is already active.");case 2:if(!_classPrivateFieldGet(_overlays,this).get(dialog).canForceClose){_context35.n=4;break;}_context35.n=3;return this.close();case 3:_context35.n=5;break;case 4:throw new Error("Another overlay is currently active.");case 5:_classPrivateFieldSet(_active,this,dialog);dialog.showModal();case 6:return _context35.a(2);}},_callee35,this);}));function open(_x32){return _open2.apply(this,arguments);}return open;}()},{key:"close",value:function(){var _close3=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee36(){var dialog,_args36=arguments;return _regenerator().w(function(_context36){while(1)switch(_context36.n){case 0:dialog=_args36.length>0&&_args36[0]!==undefined?_args36[0]:_classPrivateFieldGet(_active,this);if(_classPrivateFieldGet(_overlays,this).has(dialog)){_context36.n=1;break;}throw new Error("The overlay does not exist.");case 1:if(_classPrivateFieldGet(_active,this)){_context36.n=2;break;}throw new Error("The overlay is currently not active.");case 2:if(!(_classPrivateFieldGet(_active,this)!==dialog)){_context36.n=3;break;}throw new Error("Another overlay is currently active.");case 3:dialog.close();_classPrivateFieldSet(_active,this,null);case 4:return _context36.a(2);}},_callee36,this);}));function close(){return _close3.apply(this,arguments);}return close;}()},{key:"closeIfActive",value:function(){var _closeIfActive=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee37(dialog){return _regenerator().w(function(_context37){while(1)switch(_context37.n){case 0:if(!(_classPrivateFieldGet(_active,this)===dialog)){_context37.n=1;break;}_context37.n=1;return this.close(dialog);case 1:return _context37.a(2);}},_callee37,this);}));function closeIfActive(_x33){return _closeIfActive.apply(this,arguments);}return closeIfActive;}()}]);}();;// ./web/password_prompt.js
var _activeCapability=/*#__PURE__*/new WeakMap();var _updateCallback=/*#__PURE__*/new WeakMap();var _reason=/*#__PURE__*/new WeakMap();var _PasswordPrompt_brand=/*#__PURE__*/new WeakSet();var PasswordPrompt=/*#__PURE__*/function(){function PasswordPrompt(options,overlayManager){var _this20=this;var isViewerEmbedded=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;_classCallCheck(this,PasswordPrompt);_classPrivateMethodInitSpec(this,_PasswordPrompt_brand);_classPrivateFieldInitSpec(this,_activeCapability,null);_classPrivateFieldInitSpec(this,_updateCallback,null);_classPrivateFieldInitSpec(this,_reason,null);this.dialog=options.dialog;this.label=options.label;this.input=options.input;this.submitButton=options.submitButton;this.cancelButton=options.cancelButton;this.overlayManager=overlayManager;this._isViewerEmbedded=isViewerEmbedded;this.submitButton.addEventListener("click",_assertClassBrand(_PasswordPrompt_brand,this,_verify).bind(this));this.cancelButton.addEventListener("click",this.close.bind(this));this.input.addEventListener("keydown",function(e){if(e.keyCode===13){_assertClassBrand(_PasswordPrompt_brand,_this20,_verify).call(_this20);}});this.overlayManager.register(this.dialog,true);this.dialog.addEventListener("close",_assertClassBrand(_PasswordPrompt_brand,this,_cancel2).bind(this));}return _createClass(PasswordPrompt,[{key:"open",value:function(){var _open3=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee38(){var _classPrivateFieldGet9;var passwordIncorrect,_t11;return _regenerator().w(function(_context38){while(1)switch(_context38.n){case 0:_context38.n=1;return(_classPrivateFieldGet9=_classPrivateFieldGet(_activeCapability,this))===null||_classPrivateFieldGet9===void 0?void 0:_classPrivateFieldGet9.promise;case 1:_classPrivateFieldSet(_activeCapability,this,Promise.withResolvers());_context38.p=2;_context38.n=3;return this.overlayManager.open(this.dialog);case 3:_context38.n=5;break;case 4:_context38.p=4;_t11=_context38.v;_classPrivateFieldGet(_activeCapability,this).resolve();throw _t11;case 5:passwordIncorrect=_classPrivateFieldGet(_reason,this)===PasswordResponses.INCORRECT_PASSWORD;if(!this._isViewerEmbedded||passwordIncorrect){this.input.focus();}this.label.setAttribute("data-l10n-id",passwordIncorrect?"pdfjs-password-invalid":"pdfjs-password-label");case 6:return _context38.a(2);}},_callee38,this,[[2,4]]);}));function open(){return _open3.apply(this,arguments);}return open;}()},{key:"close",value:function(){var _close4=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee39(){return _regenerator().w(function(_context39){while(1)switch(_context39.n){case 0:this.overlayManager.closeIfActive(this.dialog);case 1:return _context39.a(2);}},_callee39,this);}));function close(){return _close4.apply(this,arguments);}return close;}()},{key:"setUpdateCallback",value:function(){var _setUpdateCallback=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee40(updateCallback,reason){return _regenerator().w(function(_context40){while(1)switch(_context40.n){case 0:if(!_classPrivateFieldGet(_activeCapability,this)){_context40.n=1;break;}_context40.n=1;return _classPrivateFieldGet(_activeCapability,this).promise;case 1:_classPrivateFieldSet(_updateCallback,this,updateCallback);_classPrivateFieldSet(_reason,this,reason);case 2:return _context40.a(2);}},_callee40,this);}));function setUpdateCallback(_x34,_x35){return _setUpdateCallback.apply(this,arguments);}return setUpdateCallback;}()}]);}();function _verify(){var password=this.input.value;if((password===null||password===void 0?void 0:password.length)>0){_assertClassBrand(_PasswordPrompt_brand,this,_invokeCallback).call(this,password);}}function _cancel2(){_assertClassBrand(_PasswordPrompt_brand,this,_invokeCallback).call(this,new Error("PasswordPrompt cancelled."));_classPrivateFieldGet(_activeCapability,this).resolve();}function _invokeCallback(password){if(!_classPrivateFieldGet(_updateCallback,this)){return;}this.close();this.input.value="";_classPrivateFieldGet(_updateCallback,this).call(this,password);_classPrivateFieldSet(_updateCallback,this,null);};// ./web/base_tree_viewer.js
var TREEITEM_OFFSET_TOP=-100;var TREEITEM_SELECTED_CLASS="selected";var BaseTreeViewer=/*#__PURE__*/function(){function BaseTreeViewer(options){_classCallCheck(this,BaseTreeViewer);this.container=options.container;this.eventBus=options.eventBus;this._l10n=options.l10n;this.reset();}return _createClass(BaseTreeViewer,[{key:"reset",value:function reset(){this._pdfDocument=null;this._lastToggleIsShow=true;this._currentTreeItem=null;this.container.textContent="";this.container.classList.remove("treeWithDeepNesting");}},{key:"_dispatchEvent",value:function _dispatchEvent(count){throw new Error("Not implemented: _dispatchEvent");}},{key:"_bindLink",value:function _bindLink(element,params){throw new Error("Not implemented: _bindLink");}},{key:"_normalizeTextContent",value:function _normalizeTextContent(str){return removeNullCharacters(str,true)||"\u2013";}},{key:"_addToggleButton",value:function _addToggleButton(div){var _this21=this;var hidden=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var toggler=document.createElement("div");toggler.className="treeItemToggler";if(hidden){toggler.classList.add("treeItemsHidden");}toggler.onclick=function(evt){evt.stopPropagation();toggler.classList.toggle("treeItemsHidden");if(evt.shiftKey){var shouldShowAll=!toggler.classList.contains("treeItemsHidden");_this21._toggleTreeItem(div,shouldShowAll);}};div.prepend(toggler);}},{key:"_toggleTreeItem",value:function _toggleTreeItem(root){var show=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;this._l10n.pause();this._lastToggleIsShow=show;var _iterator18=_createForOfIteratorHelper(root.querySelectorAll(".treeItemToggler")),_step18;try{for(_iterator18.s();!(_step18=_iterator18.n()).done;){var toggler=_step18.value;toggler.classList.toggle("treeItemsHidden",!show);}}catch(err){_iterator18.e(err);}finally{_iterator18.f();}this._l10n.resume();}},{key:"_toggleAllTreeItems",value:function _toggleAllTreeItems(){this._toggleTreeItem(this.container,!this._lastToggleIsShow);}},{key:"_finishRendering",value:function _finishRendering(fragment,count){var hasAnyNesting=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;if(hasAnyNesting){this.container.classList.add("treeWithDeepNesting");this._lastToggleIsShow=!fragment.querySelector(".treeItemsHidden");}this._l10n.pause();this.container.append(fragment);this._l10n.resume();this._dispatchEvent(count);}},{key:"render",value:function render(params){throw new Error("Not implemented: render");}},{key:"_updateCurrentTreeItem",value:function _updateCurrentTreeItem(){var treeItem=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;if(this._currentTreeItem){this._currentTreeItem.classList.remove(TREEITEM_SELECTED_CLASS);this._currentTreeItem=null;}if(treeItem){treeItem.classList.add(TREEITEM_SELECTED_CLASS);this._currentTreeItem=treeItem;}}},{key:"_scrollToCurrentTreeItem",value:function _scrollToCurrentTreeItem(treeItem){if(!treeItem){return;}this._l10n.pause();var currentNode=treeItem.parentNode;while(currentNode&&currentNode!==this.container){if(currentNode.classList.contains("treeItem")){var toggler=currentNode.firstElementChild;toggler===null||toggler===void 0||toggler.classList.remove("treeItemsHidden");}currentNode=currentNode.parentNode;}this._l10n.resume();this._updateCurrentTreeItem(treeItem);this.container.scrollTo(treeItem.offsetLeft,treeItem.offsetTop+TREEITEM_OFFSET_TOP);}}]);}();;// ./web/pdf_attachment_viewer.js
var _PDFAttachmentViewer_brand=/*#__PURE__*/new WeakSet();var PDFAttachmentViewer=/*#__PURE__*/function(_BaseTreeViewer){function PDFAttachmentViewer(options){var _this22;_classCallCheck(this,PDFAttachmentViewer);_this22=_callSuper(this,PDFAttachmentViewer,[options]);_classPrivateMethodInitSpec(_this22,_PDFAttachmentViewer_brand);_this22.downloadManager=options.downloadManager;_this22.eventBus._on("fileattachmentannotation",_assertClassBrand(_PDFAttachmentViewer_brand,_this22,_appendAttachment).bind(_this22));return _this22;}_inherits(PDFAttachmentViewer,_BaseTreeViewer);return _createClass(PDFAttachmentViewer,[{key:"reset",value:function reset(){var keepRenderedCapability=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;_superPropGet(PDFAttachmentViewer,"reset",this,3)([]);this._attachments=null;if(!keepRenderedCapability){this._renderedCapability=Promise.withResolvers();}this._pendingDispatchEvent=false;}},{key:"_dispatchEvent",value:function(){var _dispatchEvent2=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee41(attachmentsCount){return _regenerator().w(function(_context41){while(1)switch(_context41.n){case 0:this._renderedCapability.resolve();if(!(attachmentsCount===0&&!this._pendingDispatchEvent)){_context41.n=2;break;}this._pendingDispatchEvent=true;_context41.n=1;return waitOnEventOrTimeout({target:this.eventBus,name:"annotationlayerrendered",delay:1000});case 1:if(this._pendingDispatchEvent){_context41.n=2;break;}return _context41.a(2);case 2:this._pendingDispatchEvent=false;this.eventBus.dispatch("attachmentsloaded",{source:this,attachmentsCount:attachmentsCount});case 3:return _context41.a(2);}},_callee41,this);}));function _dispatchEvent(_x36){return _dispatchEvent2.apply(this,arguments);}return _dispatchEvent;}()},{key:"_bindLink",value:function _bindLink(element,_ref24){var _this23=this;var content=_ref24.content,description=_ref24.description,filename=_ref24.filename;if(description){element.title=description;}element.onclick=function(){_this23.downloadManager.openOrDownloadData(content,filename);return false;};}},{key:"render",value:function render(_ref25){var attachments=_ref25.attachments,_ref25$keepRenderedCa=_ref25.keepRenderedCapability,keepRenderedCapability=_ref25$keepRenderedCa===void 0?false:_ref25$keepRenderedCa;if(this._attachments){this.reset(keepRenderedCapability);}this._attachments=attachments||null;if(!attachments){this._dispatchEvent(0);return;}var fragment=document.createDocumentFragment();var attachmentsCount=0;for(var name in attachments){var item=attachments[name];var div=document.createElement("div");div.className="treeItem";var element=document.createElement("a");this._bindLink(element,item);element.textContent=this._normalizeTextContent(item.filename);div.append(element);fragment.append(div);attachmentsCount++;}this._finishRendering(fragment,attachmentsCount);}}]);}(BaseTreeViewer);function _appendAttachment(item){var _this95=this;var renderedPromise=this._renderedCapability.promise;renderedPromise.then(function(){if(renderedPromise!==_this95._renderedCapability.promise){return;}var attachments=_this95._attachments||Object.create(null);for(var name in attachments){if(item.filename===name){return;}}attachments[item.filename]=item;_this95.render({attachments:attachments,keepRenderedCapability:true});});};// ./web/grab_to_pan.js
var CSS_CLASS_GRAB="grab-to-pan-grab";var _activateAC=/*#__PURE__*/new WeakMap();var _mouseDownAC=/*#__PURE__*/new WeakMap();var _scrollAC=/*#__PURE__*/new WeakMap();var _GrabToPan_brand=/*#__PURE__*/new WeakSet();var GrabToPan=/*#__PURE__*/function(){function GrabToPan(_ref26){var element=_ref26.element;_classCallCheck(this,GrabToPan);_classPrivateMethodInitSpec(this,_GrabToPan_brand);_classPrivateFieldInitSpec(this,_activateAC,null);_classPrivateFieldInitSpec(this,_mouseDownAC,null);_classPrivateFieldInitSpec(this,_scrollAC,null);this.element=element;this.document=element.ownerDocument;var overlay=this.overlay=document.createElement("div");overlay.className="grab-to-pan-grabbing";}return _createClass(GrabToPan,[{key:"activate",value:function activate(){if(!_classPrivateFieldGet(_activateAC,this)){_classPrivateFieldSet(_activateAC,this,new AbortController());this.element.addEventListener("mousedown",_assertClassBrand(_GrabToPan_brand,this,_onMouseDown).bind(this),{capture:true,signal:_classPrivateFieldGet(_activateAC,this).signal});this.element.classList.add(CSS_CLASS_GRAB);}}},{key:"deactivate",value:function deactivate(){if(_classPrivateFieldGet(_activateAC,this)){_classPrivateFieldGet(_activateAC,this).abort();_classPrivateFieldSet(_activateAC,this,null);_assertClassBrand(_GrabToPan_brand,this,_endPan).call(this);this.element.classList.remove(CSS_CLASS_GRAB);}}},{key:"toggle",value:function toggle(){if(_classPrivateFieldGet(_activateAC,this)){this.deactivate();}else{this.activate();}}},{key:"ignoreTarget",value:function ignoreTarget(node){return node.matches("a[href], a[href] *, input, textarea, button, button *, select, option");}}]);}();function _onMouseDown(event){if(event.button!==0||this.ignoreTarget(event.target)){return;}if(event.originalTarget){try{event.originalTarget.tagName;}catch(_unused9){return;}}this.scrollLeftStart=this.element.scrollLeft;this.scrollTopStart=this.element.scrollTop;this.clientXStart=event.clientX;this.clientYStart=event.clientY;_classPrivateFieldSet(_mouseDownAC,this,new AbortController());var boundEndPan=_assertClassBrand(_GrabToPan_brand,this,_endPan).bind(this),mouseOpts={capture:true,signal:_classPrivateFieldGet(_mouseDownAC,this).signal};this.document.addEventListener("mousemove",_assertClassBrand(_GrabToPan_brand,this,_onMouseMove).bind(this),mouseOpts);this.document.addEventListener("mouseup",boundEndPan,mouseOpts);_classPrivateFieldSet(_scrollAC,this,new AbortController());this.element.addEventListener("scroll",boundEndPan,{capture:true,signal:_classPrivateFieldGet(_scrollAC,this).signal});stopEvent(event);var focusedElement=document.activeElement;if(focusedElement&&!focusedElement.contains(event.target)){focusedElement.blur();}}function _onMouseMove(event){var _classPrivateFieldGet51;(_classPrivateFieldGet51=_classPrivateFieldGet(_scrollAC,this))===null||_classPrivateFieldGet51===void 0||_classPrivateFieldGet51.abort();_classPrivateFieldSet(_scrollAC,this,null);if(!(event.buttons&1)){_assertClassBrand(_GrabToPan_brand,this,_endPan).call(this);return;}var xDiff=event.clientX-this.clientXStart;var yDiff=event.clientY-this.clientYStart;this.element.scrollTo({top:this.scrollTopStart-yDiff,left:this.scrollLeftStart-xDiff,behavior:"instant"});if(!this.overlay.parentNode){document.body.append(this.overlay);}}function _endPan(){var _classPrivateFieldGet52,_classPrivateFieldGet53;(_classPrivateFieldGet52=_classPrivateFieldGet(_mouseDownAC,this))===null||_classPrivateFieldGet52===void 0||_classPrivateFieldGet52.abort();_classPrivateFieldSet(_mouseDownAC,this,null);(_classPrivateFieldGet53=_classPrivateFieldGet(_scrollAC,this))===null||_classPrivateFieldGet53===void 0||_classPrivateFieldGet53.abort();_classPrivateFieldSet(_scrollAC,this,null);this.overlay.remove();};// ./web/pdf_cursor_tools.js
var _active2=/*#__PURE__*/new WeakMap();var _prevActive=/*#__PURE__*/new WeakMap();var _PDFCursorTools_brand=/*#__PURE__*/new WeakSet();var PDFCursorTools=/*#__PURE__*/function(){function PDFCursorTools(_ref27){var _this24=this;var container=_ref27.container,eventBus=_ref27.eventBus,_ref27$cursorToolOnLo=_ref27.cursorToolOnLoad,cursorToolOnLoad=_ref27$cursorToolOnLo===void 0?CursorTool.SELECT:_ref27$cursorToolOnLo;_classCallCheck(this,PDFCursorTools);_classPrivateMethodInitSpec(this,_PDFCursorTools_brand);_classPrivateFieldInitSpec(this,_active2,CursorTool.SELECT);_classPrivateFieldInitSpec(this,_prevActive,null);this.container=container;this.eventBus=eventBus;_assertClassBrand(_PDFCursorTools_brand,this,_addEventListeners).call(this);Promise.resolve().then(function(){_this24.switchTool(cursorToolOnLoad);});}return _createClass(PDFCursorTools,[{key:"activeTool",get:function get(){return _classPrivateFieldGet(_active2,this);}},{key:"switchTool",value:function switchTool(tool){if(_classPrivateFieldGet(_prevActive,this)!==null){return;}_assertClassBrand(_PDFCursorTools_brand,this,_switchTool).call(this,tool);}},{key:"_handTool",get:function get(){return shadow(this,"_handTool",new GrabToPan({element:this.container}));}}]);}();function _switchTool(tool){var _this96=this;var disabled=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(tool===_classPrivateFieldGet(_active2,this)){if(_classPrivateFieldGet(_prevActive,this)!==null){this.eventBus.dispatch("cursortoolchanged",{source:this,tool:tool,disabled:disabled});}return;}var disableActiveTool=function disableActiveTool(){switch(_classPrivateFieldGet(_active2,_this96)){case CursorTool.SELECT:break;case CursorTool.HAND:_this96._handTool.deactivate();break;case CursorTool.ZOOM:}};switch(tool){case CursorTool.SELECT:disableActiveTool();break;case CursorTool.HAND:disableActiveTool();this._handTool.activate();break;case CursorTool.ZOOM:default:console.error("switchTool: \"".concat(tool,"\" is an unsupported value."));return;}_classPrivateFieldSet(_active2,this,tool);this.eventBus.dispatch("cursortoolchanged",{source:this,tool:tool,disabled:disabled});}function _addEventListeners(){var _this97=this;this.eventBus._on("switchcursortool",function(evt){if(!evt.reset){_this97.switchTool(evt.tool);}else if(_classPrivateFieldGet(_prevActive,_this97)!==null){annotationEditorMode=AnnotationEditorType.NONE;presentationModeState=PresentationModeState.NORMAL;enableActive();}});var annotationEditorMode=AnnotationEditorType.NONE,presentationModeState=PresentationModeState.NORMAL;var disableActive=function disableActive(){var _classPrivateFieldGet54;(_classPrivateFieldGet54=_classPrivateFieldGet(_prevActive,_this97))!==null&&_classPrivateFieldGet54!==void 0?_classPrivateFieldGet54:_classPrivateFieldSet(_prevActive,_this97,_classPrivateFieldGet(_active2,_this97));_assertClassBrand(_PDFCursorTools_brand,_this97,_switchTool).call(_this97,CursorTool.SELECT,true);};var enableActive=function enableActive(){if(_classPrivateFieldGet(_prevActive,_this97)!==null&&annotationEditorMode===AnnotationEditorType.NONE&&presentationModeState===PresentationModeState.NORMAL){_assertClassBrand(_PDFCursorTools_brand,_this97,_switchTool).call(_this97,_classPrivateFieldGet(_prevActive,_this97));_classPrivateFieldSet(_prevActive,_this97,null);}};this.eventBus._on("annotationeditormodechanged",function(_ref113){var mode=_ref113.mode;annotationEditorMode=mode;if(mode===AnnotationEditorType.NONE){enableActive();}else{disableActive();}});this.eventBus._on("presentationmodechanged",function(_ref114){var state=_ref114.state;presentationModeState=state;if(state===PresentationModeState.NORMAL){enableActive();}else if(state===PresentationModeState.FULLSCREEN){disableActive();}});};// ./web/pdf_document_properties.js
var NON_METRIC_LOCALES=["en-us","en-lr","my"];var US_PAGE_NAMES={"8.5x11":"pdfjs-document-properties-page-size-name-letter","8.5x14":"pdfjs-document-properties-page-size-name-legal"};var METRIC_PAGE_NAMES={"297x420":"pdfjs-document-properties-page-size-name-a-three","210x297":"pdfjs-document-properties-page-size-name-a-four"};function getPageName(size,isPortrait,pageNames){var width=isPortrait?size.width:size.height;var height=isPortrait?size.height:size.width;return pageNames["".concat(width,"x").concat(height)];}var _fieldData=/*#__PURE__*/new WeakMap();var _PDFDocumentProperties_brand=/*#__PURE__*/new WeakSet();var PDFDocumentProperties=/*#__PURE__*/function(){function PDFDocumentProperties(_ref28,overlayManager,eventBus,l10n,fileNameLookup){var _this25=this;var dialog=_ref28.dialog,fields=_ref28.fields,closeButton=_ref28.closeButton;_classCallCheck(this,PDFDocumentProperties);_classPrivateMethodInitSpec(this,_PDFDocumentProperties_brand);_classPrivateFieldInitSpec(this,_fieldData,null);this.dialog=dialog;this.fields=fields;this.overlayManager=overlayManager;this.l10n=l10n;this._fileNameLookup=fileNameLookup;_assertClassBrand(_PDFDocumentProperties_brand,this,_reset2).call(this);closeButton.addEventListener("click",this.close.bind(this));this.overlayManager.register(this.dialog);eventBus._on("pagechanging",function(evt){_this25._currentPageNumber=evt.pageNumber;});eventBus._on("rotationchanging",function(evt){_this25._pagesRotation=evt.pagesRotation;});}return _createClass(PDFDocumentProperties,[{key:"open",value:function(){var _open4=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee42(){var currentPageNumber,pagesRotation,_yield$Promise$all,_yield$Promise$all2,_yield$Promise$all2$,info,contentLength,pdfPage,_yield$Promise$all3,_yield$Promise$all4,fileName,fileSize,creationDate,modificationDate,pageSize,isLinearized,_yield$this$pdfDocume,length,data;return _regenerator().w(function(_context42){while(1)switch(_context42.n){case 0:_context42.n=1;return Promise.all([this.overlayManager.open(this.dialog),this._dataAvailableCapability.promise]);case 1:currentPageNumber=this._currentPageNumber;pagesRotation=this._pagesRotation;if(!(_classPrivateFieldGet(_fieldData,this)&&currentPageNumber===_classPrivateFieldGet(_fieldData,this)._currentPageNumber&&pagesRotation===_classPrivateFieldGet(_fieldData,this)._pagesRotation)){_context42.n=2;break;}_assertClassBrand(_PDFDocumentProperties_brand,this,_updateUI).call(this);return _context42.a(2);case 2:_context42.n=3;return Promise.all([this.pdfDocument.getMetadata(),this.pdfDocument.getPage(currentPageNumber)]);case 3:_yield$Promise$all=_context42.v;_yield$Promise$all2=_slicedToArray(_yield$Promise$all,2);_yield$Promise$all2$=_yield$Promise$all2[0];info=_yield$Promise$all2$.info;contentLength=_yield$Promise$all2$.contentLength;pdfPage=_yield$Promise$all2[1];_context42.n=4;return Promise.all([this._fileNameLookup(),_assertClassBrand(_PDFDocumentProperties_brand,this,_parseFileSize).call(this,contentLength),_assertClassBrand(_PDFDocumentProperties_brand,this,_parseDate).call(this,info.CreationDate),_assertClassBrand(_PDFDocumentProperties_brand,this,_parseDate).call(this,info.ModDate),_assertClassBrand(_PDFDocumentProperties_brand,this,_parsePageSize).call(this,getPageSizeInches(pdfPage),pagesRotation),_assertClassBrand(_PDFDocumentProperties_brand,this,_parseLinearization).call(this,info.IsLinearized)]);case 4:_yield$Promise$all3=_context42.v;_yield$Promise$all4=_slicedToArray(_yield$Promise$all3,6);fileName=_yield$Promise$all4[0];fileSize=_yield$Promise$all4[1];creationDate=_yield$Promise$all4[2];modificationDate=_yield$Promise$all4[3];pageSize=_yield$Promise$all4[4];isLinearized=_yield$Promise$all4[5];_classPrivateFieldSet(_fieldData,this,Object.freeze({fileName:fileName,fileSize:fileSize,title:info.Title,author:info.Author,subject:info.Subject,keywords:info.Keywords,creationDate:creationDate,modificationDate:modificationDate,creator:info.Creator,producer:info.Producer,version:info.PDFFormatVersion,pageCount:this.pdfDocument.numPages,pageSize:pageSize,linearized:isLinearized,_currentPageNumber:currentPageNumber,_pagesRotation:pagesRotation}));_assertClassBrand(_PDFDocumentProperties_brand,this,_updateUI).call(this);_context42.n=5;return this.pdfDocument.getDownloadInfo();case 5:_yield$this$pdfDocume=_context42.v;length=_yield$this$pdfDocume.length;if(!(contentLength===length)){_context42.n=6;break;}return _context42.a(2);case 6:data=Object.assign(Object.create(null),_classPrivateFieldGet(_fieldData,this));_context42.n=7;return _assertClassBrand(_PDFDocumentProperties_brand,this,_parseFileSize).call(this,length);case 7:data.fileSize=_context42.v;_classPrivateFieldSet(_fieldData,this,Object.freeze(data));_assertClassBrand(_PDFDocumentProperties_brand,this,_updateUI).call(this);case 8:return _context42.a(2);}},_callee42,this);}));function open(){return _open4.apply(this,arguments);}return open;}()},{key:"close",value:function(){var _close5=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee43(){return _regenerator().w(function(_context43){while(1)switch(_context43.n){case 0:this.overlayManager.close(this.dialog);case 1:return _context43.a(2);}},_callee43,this);}));function close(){return _close5.apply(this,arguments);}return close;}()},{key:"setDocument",value:function setDocument(pdfDocument){if(this.pdfDocument){_assertClassBrand(_PDFDocumentProperties_brand,this,_reset2).call(this);_assertClassBrand(_PDFDocumentProperties_brand,this,_updateUI).call(this);}if(!pdfDocument){return;}this.pdfDocument=pdfDocument;this._dataAvailableCapability.resolve();}}]);}();function _reset2(){this.pdfDocument=null;_classPrivateFieldSet(_fieldData,this,null);this._dataAvailableCapability=Promise.withResolvers();this._currentPageNumber=1;this._pagesRotation=0;}function _updateUI(){if(_classPrivateFieldGet(_fieldData,this)&&this.overlayManager.active!==this.dialog){return;}for(var id in this.fields){var _classPrivateFieldGet55;var content=(_classPrivateFieldGet55=_classPrivateFieldGet(_fieldData,this))===null||_classPrivateFieldGet55===void 0?void 0:_classPrivateFieldGet55[id];this.fields[id].textContent=content||content===0?content:"-";}}function _parseFileSize(){return _parseFileSize2.apply(this,arguments);}function _parseFileSize2(){_parseFileSize2=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee113(){var b,kb,mb,_args115=arguments;return _regenerator().w(function(_context114){while(1)switch(_context114.n){case 0:b=_args115.length>0&&_args115[0]!==undefined?_args115[0]:0;kb=b/1024,mb=kb/1024;return _context114.a(2,kb?this.l10n.get(mb>=1?"pdfjs-document-properties-size-mb":"pdfjs-document-properties-size-kb",{mb:mb,kb:kb,b:b}):undefined);}},_callee113,this);}));return _parseFileSize2.apply(this,arguments);}function _parsePageSize(_x67,_x68){return _parsePageSize2.apply(this,arguments);}function _parsePageSize2(){_parsePageSize2=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee114(pageSizeInches,pagesRotation){var isPortrait,nonMetric,sizeInches,sizeMillimeters,nameId,exactMillimeters,intMillimeters,_yield$Promise$all1,_yield$Promise$all10,_yield$Promise$all10$,width,height,unit,name,orientation;return _regenerator().w(function(_context115){while(1)switch(_context115.n){case 0:if(pageSizeInches){_context115.n=1;break;}return _context115.a(2,undefined);case 1:if(pagesRotation%180!==0){pageSizeInches={width:pageSizeInches.height,height:pageSizeInches.width};}isPortrait=isPortraitOrientation(pageSizeInches),nonMetric=NON_METRIC_LOCALES.includes(this.l10n.getLanguage());sizeInches={width:Math.round(pageSizeInches.width*100)/100,height:Math.round(pageSizeInches.height*100)/100};sizeMillimeters={width:Math.round(pageSizeInches.width*25.4*10)/10,height:Math.round(pageSizeInches.height*25.4*10)/10};nameId=getPageName(sizeInches,isPortrait,US_PAGE_NAMES)||getPageName(sizeMillimeters,isPortrait,METRIC_PAGE_NAMES);if(!nameId&&!(Number.isInteger(sizeMillimeters.width)&&Number.isInteger(sizeMillimeters.height))){exactMillimeters={width:pageSizeInches.width*25.4,height:pageSizeInches.height*25.4};intMillimeters={width:Math.round(sizeMillimeters.width),height:Math.round(sizeMillimeters.height)};if(Math.abs(exactMillimeters.width-intMillimeters.width)<0.1&&Math.abs(exactMillimeters.height-intMillimeters.height)<0.1){nameId=getPageName(intMillimeters,isPortrait,METRIC_PAGE_NAMES);if(nameId){sizeInches={width:Math.round(intMillimeters.width/25.4*100)/100,height:Math.round(intMillimeters.height/25.4*100)/100};sizeMillimeters=intMillimeters;}}}_context115.n=2;return Promise.all([nonMetric?sizeInches:sizeMillimeters,this.l10n.get(nonMetric?"pdfjs-document-properties-page-size-unit-inches":"pdfjs-document-properties-page-size-unit-millimeters"),nameId&&this.l10n.get(nameId),this.l10n.get(isPortrait?"pdfjs-document-properties-page-size-orientation-portrait":"pdfjs-document-properties-page-size-orientation-landscape")]);case 2:_yield$Promise$all1=_context115.v;_yield$Promise$all10=_slicedToArray(_yield$Promise$all1,4);_yield$Promise$all10$=_yield$Promise$all10[0];width=_yield$Promise$all10$.width;height=_yield$Promise$all10$.height;unit=_yield$Promise$all10[1];name=_yield$Promise$all10[2];orientation=_yield$Promise$all10[3];return _context115.a(2,this.l10n.get(name?"pdfjs-document-properties-page-size-dimension-name-string":"pdfjs-document-properties-page-size-dimension-string",{width:width,height:height,unit:unit,name:name,orientation:orientation}));}},_callee114,this);}));return _parsePageSize2.apply(this,arguments);}function _parseDate(_x69){return _parseDate2.apply(this,arguments);}function _parseDate2(){_parseDate2=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee115(inputDate){var dateObj;return _regenerator().w(function(_context116){while(1)switch(_context116.n){case 0:dateObj=PDFDateString.toDateObject(inputDate);return _context116.a(2,dateObj?this.l10n.get("pdfjs-document-properties-date-time-string",{dateObj:dateObj.valueOf()}):undefined);}},_callee115,this);}));return _parseDate2.apply(this,arguments);}function _parseLinearization(isLinearized){return this.l10n.get(isLinearized?"pdfjs-document-properties-linearized-yes":"pdfjs-document-properties-linearized-no");};// ./web/pdf_find_utils.js
var CharacterType={SPACE:0,ALPHA_LETTER:1,PUNCT:2,HAN_LETTER:3,KATAKANA_LETTER:4,HIRAGANA_LETTER:5,HALFWIDTH_KATAKANA_LETTER:6,THAI_LETTER:7};function isAlphabeticalScript(charCode){return charCode<0x2e80;}function isAscii(charCode){return(charCode&0xff80)===0;}function isAsciiAlpha(charCode){return charCode>=0x61&&charCode<=0x7a||charCode>=0x41&&charCode<=0x5a;}function isAsciiDigit(charCode){return charCode>=0x30&&charCode<=0x39;}function isAsciiSpace(charCode){return charCode===0x20||charCode===0x09||charCode===0x0d||charCode===0x0a;}function isHan(charCode){return charCode>=0x3400&&charCode<=0x9fff||charCode>=0xf900&&charCode<=0xfaff;}function isKatakana(charCode){return charCode>=0x30a0&&charCode<=0x30ff;}function isHiragana(charCode){return charCode>=0x3040&&charCode<=0x309f;}function isHalfwidthKatakana(charCode){return charCode>=0xff60&&charCode<=0xff9f;}function isThai(charCode){return(charCode&0xff80)===0x0e00;}function getCharacterType(charCode){if(isAlphabeticalScript(charCode)){if(isAscii(charCode)){if(isAsciiSpace(charCode)){return CharacterType.SPACE;}else if(isAsciiAlpha(charCode)||isAsciiDigit(charCode)||charCode===0x5f){return CharacterType.ALPHA_LETTER;}return CharacterType.PUNCT;}else if(isThai(charCode)){return CharacterType.THAI_LETTER;}else if(charCode===0xa0){return CharacterType.SPACE;}return CharacterType.ALPHA_LETTER;}if(isHan(charCode)){return CharacterType.HAN_LETTER;}else if(isKatakana(charCode)){return CharacterType.KATAKANA_LETTER;}else if(isHiragana(charCode)){return CharacterType.HIRAGANA_LETTER;}else if(isHalfwidthKatakana(charCode)){return CharacterType.HALFWIDTH_KATAKANA_LETTER;}return CharacterType.ALPHA_LETTER;}var NormalizeWithNFKC;function getNormalizeWithNFKC(){NormalizeWithNFKC||(NormalizeWithNFKC="\xA0\xA8\xAA\xAF\xB2-\xB5\xB8-\xBA\xBC-\xBE\u0132-\u0133\u013F-\u0140\u0149\u017F\u01C4-\u01CC\u01F1-\u01F3\u02B0-\u02B8\u02D8-\u02DD\u02E0-\u02E4\u0374\u037A\u037E\u0384-\u0385\u0387\u03D0-\u03D6\u03F0-\u03F2\u03F4-\u03F5\u03F9\u0587\u0675-\u0678\u0958-\u095F\u09DC-\u09DD\u09DF\u0A33\u0A36\u0A59-\u0A5B\u0A5E\u0B5C-\u0B5D\u0E33\u0EB3\u0EDC-\u0EDD\u0F0C\u0F43\u0F4D\u0F52\u0F57\u0F5C\u0F69\u10FC\u1D2C-\u1D2E\u1D30-\u1D3A\u1D3C-\u1D4D\u1D4F-\u1D6A\u1D78\u1D9B-\u1DBF\u1E9A-\u1E9B\u1F71\u1F73\u1F75\u1F77\u1F79\u1F7B\u1F7D\u1FBB\u1FBD-\u1FC1\u1FC9\u1FCB\u1FCD-\u1FCF\u1FD3\u1FDB\u1FDD-\u1FDF\u1FE3\u1FEB\u1FED-\u1FEF\u1FF9\u1FFB\u1FFD-\u1FFE\u2000-\u200A\u2011\u2017\u2024-\u2026\u202F\u2033-\u2034\u2036-\u2037\u203C\u203E\u2047-\u2049\u2057\u205F\u2070-\u2071\u2074-\u208E\u2090-\u209C\u20A8\u2100-\u2103\u2105-\u2107\u2109-\u2113\u2115-\u2116\u2119-\u211D\u2120-\u2122\u2124\u2126\u2128\u212A-\u212D\u212F-\u2131\u2133-\u2139\u213B-\u2140\u2145-\u2149\u2150-\u217F\u2189\u222C-\u222D\u222F-\u2230\u2329-\u232A\u2460-\u24EA\u2A0C\u2A74-\u2A76\u2ADC\u2C7C-\u2C7D\u2D6F\u2E9F\u2EF3\u2F00-\u2FD5\u3000\u3036\u3038-\u303A\u309B-\u309C\u309F\u30FF\u3131-\u318E\u3192-\u319F\u3200-\u321E\u3220-\u3247\u3250-\u327E\u3280-\u33FF\uA69C-\uA69D\uA770\uA7F2-\uA7F4\uA7F8-\uA7F9\uAB5C-\uAB5F\uAB69\uF900-\uFA0D\uFA10\uFA12\uFA15-\uFA1E\uFA20\uFA22\uFA25-\uFA26\uFA2A-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB36\uFB38-\uFB3C\uFB3E\uFB40-\uFB41\uFB43-\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFC\uFE10-\uFE19\uFE30-\uFE44\uFE47-\uFE52\uFE54-\uFE66\uFE68-\uFE6B\uFE70-\uFE72\uFE74\uFE76-\uFEFC\uFF01-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC\uFFE0-\uFFE6");return NormalizeWithNFKC;};// ./web/pdf_find_controller.js
var FindState={FOUND:0,NOT_FOUND:1,WRAPPED:2,PENDING:3};var FIND_TIMEOUT=250;var MATCH_SCROLL_OFFSET_TOP=-50;var MATCH_SCROLL_OFFSET_LEFT=-400;var CHARACTERS_TO_NORMALIZE={"\u2010":"-","\u2018":"'","\u2019":"'","\u201A":"'","\u201B":"'","\u201C":'"',"\u201D":'"',"\u201E":'"',"\u201F":'"',"\xBC":"1/4","\xBD":"1/2","\xBE":"3/4"};var DIACRITICS_EXCEPTION=new Set([0x3099,0x309a,0x094d,0x09cd,0x0a4d,0x0acd,0x0b4d,0x0bcd,0x0c4d,0x0ccd,0x0d3b,0x0d3c,0x0d4d,0x0dca,0x0e3a,0x0eba,0x0f84,0x1039,0x103a,0x1714,0x1734,0x17d2,0x1a60,0x1b44,0x1baa,0x1bab,0x1bf2,0x1bf3,0x2d7f,0xa806,0xa82c,0xa8c4,0xa953,0xa9c0,0xaaf6,0xabed,0x0c56,0x0f71,0x0f72,0x0f7a,0x0f7b,0x0f7c,0x0f7d,0x0f80,0x0f74]);var DIACRITICS_EXCEPTION_STR;var DIACRITICS_REG_EXP=/(?:[\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u07FD\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u0897-\u089F\u08CA-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u09FE\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0AFA-\u0AFF\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B55-\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C00-\u0C04\u0C3C\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0CF3\u0D00-\u0D03\u0D3B\u0D3C\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D81-\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EBC\u0EC8-\u0ECE\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u135D-\u135F\u1712-\u1715\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u180B-\u180D\u180F\u1885\u1886\u18A9\u1920-\u192B\u1930-\u193B\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F\u1AB0-\u1ACE\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BF3\u1C24-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF4\u1CF7-\u1CF9\u1DC0-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA82C\uA880\uA881\uA8B4-\uA8C5\uA8E0-\uA8F1\uA8FF\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9E5\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F]|\uD800[\uDDFD\uDEE0\uDF76-\uDF7A]|\uD802[\uDE01-\uDE03\uDE05\uDE06\uDE0C-\uDE0F\uDE38-\uDE3A\uDE3F\uDEE5\uDEE6]|\uD803[\uDD24-\uDD27\uDD69-\uDD6D\uDEAB\uDEAC\uDEFC-\uDEFF\uDF46-\uDF50\uDF82-\uDF85]|\uD804[\uDC00-\uDC02\uDC38-\uDC46\uDC70\uDC73\uDC74\uDC7F-\uDC82\uDCB0-\uDCBA\uDCC2\uDD00-\uDD02\uDD27-\uDD34\uDD45\uDD46\uDD73\uDD80-\uDD82\uDDB3-\uDDC0\uDDC9-\uDDCC\uDDCE\uDDCF\uDE2C-\uDE37\uDE3E\uDE41\uDEDF-\uDEEA\uDF00-\uDF03\uDF3B\uDF3C\uDF3E-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF57\uDF62\uDF63\uDF66-\uDF6C\uDF70-\uDF74\uDFB8-\uDFC0\uDFC2\uDFC5\uDFC7-\uDFCA\uDFCC-\uDFD0\uDFD2\uDFE1\uDFE2]|\uD805[\uDC35-\uDC46\uDC5E\uDCB0-\uDCC3\uDDAF-\uDDB5\uDDB8-\uDDC0\uDDDC\uDDDD\uDE30-\uDE40\uDEAB-\uDEB7\uDF1D-\uDF2B]|\uD806[\uDC2C-\uDC3A\uDD30-\uDD35\uDD37\uDD38\uDD3B-\uDD3E\uDD40\uDD42\uDD43\uDDD1-\uDDD7\uDDDA-\uDDE0\uDDE4\uDE01-\uDE0A\uDE33-\uDE39\uDE3B-\uDE3E\uDE47\uDE51-\uDE5B\uDE8A-\uDE99]|\uD807[\uDC2F-\uDC36\uDC38-\uDC3F\uDC92-\uDCA7\uDCA9-\uDCB6\uDD31-\uDD36\uDD3A\uDD3C\uDD3D\uDD3F-\uDD45\uDD47\uDD8A-\uDD8E\uDD90\uDD91\uDD93-\uDD97\uDEF3-\uDEF6\uDF00\uDF01\uDF03\uDF34-\uDF3A\uDF3E-\uDF42\uDF5A]|\uD80D[\uDC40\uDC47-\uDC55]|\uD818[\uDD1E-\uDD2F]|\uD81A[\uDEF0-\uDEF4\uDF30-\uDF36]|\uD81B[\uDF4F\uDF51-\uDF87\uDF8F-\uDF92\uDFE4\uDFF0\uDFF1]|\uD82F[\uDC9D\uDC9E]|\uD833[\uDF00-\uDF2D\uDF30-\uDF46]|\uD834[\uDD65-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD838[\uDC00-\uDC06\uDC08-\uDC18\uDC1B-\uDC21\uDC23\uDC24\uDC26-\uDC2A\uDC8F\uDD30-\uDD36\uDEAE\uDEEC-\uDEEF]|\uD839[\uDCEC-\uDCEF\uDDEE\uDDEF]|\uD83A[\uDCD0-\uDCD6\uDD44-\uDD4A]|\uDB40[\uDD00-\uDDEF])+/g;var SPECIAL_CHARS_REG_EXP=/([\$\(-\+\.\?\[-\^\{-\}])|((?:[!-#%-\*,-\/:;\?@\[-\]_\{\}\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061D-\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B4E\u1B4F\u1B5A-\u1B60\u1B7D-\u1B7F\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u2E52-\u2E5D\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]|\uD800[\uDD00-\uDD02\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDD6E\uDEAD\uDF55-\uDF59\uDF86-\uDF89]|\uD804[\uDC47-\uDC4D\uDCBB\uDCBC\uDCBE-\uDCC1\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9\uDFD4\uDFD5\uDFD7\uDFD8]|\uD805[\uDC4B-\uDC4F\uDC5A\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDEB9\uDF3C-\uDF3E]|\uD806[\uDC3B\uDD44-\uDD46\uDDE2\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2\uDF00-\uDF09\uDFE1]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8\uDF43-\uDF4F\uDFFF]|\uD809[\uDC70-\uDC74]|\uD80B[\uDFF1\uDFF2]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3B\uDF44]|\uD81B[\uDD6D-\uDD6F\uDE97-\uDE9A\uDFE2]|\uD82F\uDC9F|\uD836[\uDE87-\uDE8B]|\uD839\uDDFF|\uD83A[\uDD5E\uDD5F]))|([\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+)|((?:[\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u07FD\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u0897-\u089F\u08CA-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u09FE\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0AFA-\u0AFF\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B55-\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C00-\u0C04\u0C3C\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0CF3\u0D00-\u0D03\u0D3B\u0D3C\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D81-\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EBC\u0EC8-\u0ECE\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u135D-\u135F\u1712-\u1715\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u180B-\u180D\u180F\u1885\u1886\u18A9\u1920-\u192B\u1930-\u193B\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F\u1AB0-\u1ACE\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BF3\u1C24-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF4\u1CF7-\u1CF9\u1DC0-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA82C\uA880\uA881\uA8B4-\uA8C5\uA8E0-\uA8F1\uA8FF\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9E5\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F]|\uD800[\uDDFD\uDEE0\uDF76-\uDF7A]|\uD802[\uDE01-\uDE03\uDE05\uDE06\uDE0C-\uDE0F\uDE38-\uDE3A\uDE3F\uDEE5\uDEE6]|\uD803[\uDD24-\uDD27\uDD69-\uDD6D\uDEAB\uDEAC\uDEFC-\uDEFF\uDF46-\uDF50\uDF82-\uDF85]|\uD804[\uDC00-\uDC02\uDC38-\uDC46\uDC70\uDC73\uDC74\uDC7F-\uDC82\uDCB0-\uDCBA\uDCC2\uDD00-\uDD02\uDD27-\uDD34\uDD45\uDD46\uDD73\uDD80-\uDD82\uDDB3-\uDDC0\uDDC9-\uDDCC\uDDCE\uDDCF\uDE2C-\uDE37\uDE3E\uDE41\uDEDF-\uDEEA\uDF00-\uDF03\uDF3B\uDF3C\uDF3E-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF57\uDF62\uDF63\uDF66-\uDF6C\uDF70-\uDF74\uDFB8-\uDFC0\uDFC2\uDFC5\uDFC7-\uDFCA\uDFCC-\uDFD0\uDFD2\uDFE1\uDFE2]|\uD805[\uDC35-\uDC46\uDC5E\uDCB0-\uDCC3\uDDAF-\uDDB5\uDDB8-\uDDC0\uDDDC\uDDDD\uDE30-\uDE40\uDEAB-\uDEB7\uDF1D-\uDF2B]|\uD806[\uDC2C-\uDC3A\uDD30-\uDD35\uDD37\uDD38\uDD3B-\uDD3E\uDD40\uDD42\uDD43\uDDD1-\uDDD7\uDDDA-\uDDE0\uDDE4\uDE01-\uDE0A\uDE33-\uDE39\uDE3B-\uDE3E\uDE47\uDE51-\uDE5B\uDE8A-\uDE99]|\uD807[\uDC2F-\uDC36\uDC38-\uDC3F\uDC92-\uDCA7\uDCA9-\uDCB6\uDD31-\uDD36\uDD3A\uDD3C\uDD3D\uDD3F-\uDD45\uDD47\uDD8A-\uDD8E\uDD90\uDD91\uDD93-\uDD97\uDEF3-\uDEF6\uDF00\uDF01\uDF03\uDF34-\uDF3A\uDF3E-\uDF42\uDF5A]|\uD80D[\uDC40\uDC47-\uDC55]|\uD818[\uDD1E-\uDD2F]|\uD81A[\uDEF0-\uDEF4\uDF30-\uDF36]|\uD81B[\uDF4F\uDF51-\uDF87\uDF8F-\uDF92\uDFE4\uDFF0\uDFF1]|\uD82F[\uDC9D\uDC9E]|\uD833[\uDF00-\uDF2D\uDF30-\uDF46]|\uD834[\uDD65-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD838[\uDC00-\uDC06\uDC08-\uDC18\uDC1B-\uDC21\uDC23\uDC24\uDC26-\uDC2A\uDC8F\uDD30-\uDD36\uDEAE\uDEEC-\uDEEF]|\uD839[\uDCEC-\uDCEF\uDDEE\uDDEF]|\uD83A[\uDCD0-\uDCD6\uDD44-\uDD4A]|\uDB40[\uDD00-\uDDEF]))|((?:[A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C8A\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CD\uA7D0\uA7D1\uA7D3\uA7D5-\uA7DC\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDDC0-\uDDF3\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDD4A-\uDD65\uDD6F-\uDD85\uDE80-\uDEA9\uDEB0\uDEB1\uDEC2-\uDEC4\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE3F\uDE40\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61\uDF80-\uDF89\uDF8B\uDF8E\uDF90-\uDFB5\uDFB7\uDFD1\uDFD3]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8\uDFC0-\uDFE0]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDF02\uDF04-\uDF10\uDF12-\uDF33\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD80E\uD80F\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD887][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC41-\uDC46\uDC60-\uDFFF]|\uD810[\uDC00-\uDFFA]|\uD811[\uDC00-\uDE46]|\uD818[\uDD00-\uDD1D]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDD40-\uDD6C\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC30-\uDC6D\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDCD0-\uDCEB\uDDD0-\uDDED\uDDF0\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF39\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD888[\uDC00-\uDFAF]))/g;var NOT_DIACRITIC_FROM_END_REG_EXP=/((?:[\0-\u02FF\u0370-\u0482\u048A-\u0590\u05BE\u05C0\u05C3\u05C6\u05C8-\u060F\u061B-\u064A\u0660-\u066F\u0671-\u06D5\u06DD\u06DE\u06E5\u06E6\u06E9\u06EE-\u0710\u0712-\u072F\u074B-\u07A5\u07B1-\u07EA\u07F4-\u07FC\u07FE-\u0815\u081A\u0824\u0828\u082E-\u0858\u085C-\u0896\u08A0-\u08C9\u08E2\u0904-\u0939\u093D\u0950\u0958-\u0961\u0964-\u0980\u0984-\u09BB\u09BD\u09C5\u09C6\u09C9\u09CA\u09CE-\u09D6\u09D8-\u09E1\u09E4-\u09FD\u09FF\u0A00\u0A04-\u0A3B\u0A3D\u0A43-\u0A46\u0A49\u0A4A\u0A4E-\u0A50\u0A52-\u0A6F\u0A72-\u0A74\u0A76-\u0A80\u0A84-\u0ABB\u0ABD\u0AC6\u0ACA\u0ACE-\u0AE1\u0AE4-\u0AF9\u0B00\u0B04-\u0B3B\u0B3D\u0B45\u0B46\u0B49\u0B4A\u0B4E-\u0B54\u0B58-\u0B61\u0B64-\u0B81\u0B83-\u0BBD\u0BC3-\u0BC5\u0BC9\u0BCE-\u0BD6\u0BD8-\u0BFF\u0C05-\u0C3B\u0C3D\u0C45\u0C49\u0C4E-\u0C54\u0C57-\u0C61\u0C64-\u0C80\u0C84-\u0CBB\u0CBD\u0CC5\u0CC9\u0CCE-\u0CD4\u0CD7-\u0CE1\u0CE4-\u0CF2\u0CF4-\u0CFF\u0D04-\u0D3A\u0D3D\u0D45\u0D49\u0D4E-\u0D56\u0D58-\u0D61\u0D64-\u0D80\u0D84-\u0DC9\u0DCB-\u0DCE\u0DD5\u0DD7\u0DE0-\u0DF1\u0DF4-\u0E30\u0E32\u0E33\u0E3B-\u0E46\u0E4F-\u0EB0\u0EB2\u0EB3\u0EBD-\u0EC7\u0ECF-\u0F17\u0F1A-\u0F34\u0F36\u0F38\u0F3A-\u0F3D\u0F40-\u0F70\u0F85\u0F88-\u0F8C\u0F98\u0FBD-\u0FC5\u0FC7-\u102A\u103F-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u1090-\u1099\u109E-\u135C\u1360-\u1711\u1716-\u1731\u1735-\u1751\u1754-\u1771\u1774-\u17B3\u17D4-\u17DC\u17DE-\u180A\u180E\u1810-\u1884\u1887-\u18A8\u18AA-\u191F\u192C-\u192F\u193C-\u1A16\u1A1C-\u1A54\u1A5F\u1A7D\u1A7E\u1A80-\u1AAF\u1ACF-\u1AFF\u1B05-\u1B33\u1B45-\u1B6A\u1B74-\u1B7F\u1B83-\u1BA0\u1BAE-\u1BE5\u1BF4-\u1C23\u1C38-\u1CCF\u1CD3\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA-\u1DBF\u1E00-\u20CF\u20F1-\u2CEE\u2CF2-\u2D7E\u2D80-\u2DDF\u2E00-\u3029\u3030-\u3098\u309B-\uA66E\uA673\uA67E-\uA69D\uA6A0-\uA6EF\uA6F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA828-\uA82B\uA82D-\uA87F\uA882-\uA8B3\uA8C6-\uA8DF\uA8F2-\uA8FE\uA900-\uA925\uA92E-\uA946\uA954-\uA97F\uA984-\uA9B2\uA9C1-\uA9E4\uA9E6-\uAA28\uAA37-\uAA42\uAA44-\uAA4B\uAA4E-\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2-\uAAEA\uAAF0-\uAAF4\uAAF7-\uABE2\uABEB\uABEE-\uD7FF\uE000-\uFB1D\uFB1F-\uFDFF\uFE10-\uFE1F\uFE30-\uFFFF]|\uD800[\uDC00-\uDDFC\uDDFE-\uDEDF\uDEE1-\uDF75\uDF7B-\uDFFF]|[\uD801\uD808-\uD80C\uD80E-\uD817\uD819\uD81C-\uD82E\uD830-\uD832\uD835\uD837\uD83B-\uDB3F\uDB41-\uDBFF][\uDC00-\uDFFF]|\uD802[\uDC00-\uDE00\uDE04\uDE07-\uDE0B\uDE10-\uDE37\uDE3B-\uDE3E\uDE40-\uDEE4\uDEE7-\uDFFF]|\uD803[\uDC00-\uDD23\uDD28-\uDD68\uDD6E-\uDEAA\uDEAD-\uDEFB\uDF00-\uDF45\uDF51-\uDF81\uDF86-\uDFFF]|\uD804[\uDC03-\uDC37\uDC47-\uDC6F\uDC71\uDC72\uDC75-\uDC7E\uDC83-\uDCAF\uDCBB-\uDCC1\uDCC3-\uDCFF\uDD03-\uDD26\uDD35-\uDD44\uDD47-\uDD72\uDD74-\uDD7F\uDD83-\uDDB2\uDDC1-\uDDC8\uDDCD\uDDD0-\uDE2B\uDE38-\uDE3D\uDE3F\uDE40\uDE42-\uDEDE\uDEEB-\uDEFF\uDF04-\uDF3A\uDF3D\uDF45\uDF46\uDF49\uDF4A\uDF4E-\uDF56\uDF58-\uDF61\uDF64\uDF65\uDF6D-\uDF6F\uDF75-\uDFB7\uDFC1\uDFC3\uDFC4\uDFC6\uDFCB\uDFD1\uDFD3-\uDFE0\uDFE3-\uDFFF]|\uD805[\uDC00-\uDC34\uDC47-\uDC5D\uDC5F-\uDCAF\uDCC4-\uDDAE\uDDB6\uDDB7\uDDC1-\uDDDB\uDDDE-\uDE2F\uDE41-\uDEAA\uDEB8-\uDF1C\uDF2C-\uDFFF]|\uD806[\uDC00-\uDC2B\uDC3B-\uDD2F\uDD36\uDD39\uDD3A\uDD3F\uDD41\uDD44-\uDDD0\uDDD8\uDDD9\uDDE1-\uDDE3\uDDE5-\uDE00\uDE0B-\uDE32\uDE3A\uDE3F-\uDE46\uDE48-\uDE50\uDE5C-\uDE89\uDE9A-\uDFFF]|\uD807[\uDC00-\uDC2E\uDC37\uDC40-\uDC91\uDCA8\uDCB7-\uDD30\uDD37-\uDD39\uDD3B\uDD3E\uDD46\uDD48-\uDD89\uDD8F\uDD92\uDD98-\uDEF2\uDEF7-\uDEFF\uDF02\uDF04-\uDF33\uDF3B-\uDF3D\uDF43-\uDF59\uDF5B-\uDFFF]|\uD80D[\uDC00-\uDC3F\uDC41-\uDC46\uDC56-\uDFFF]|\uD818[\uDC00-\uDD1D\uDD30-\uDFFF]|\uD81A[\uDC00-\uDEEF\uDEF5-\uDF2F\uDF37-\uDFFF]|\uD81B[\uDC00-\uDF4E\uDF50\uDF88-\uDF8E\uDF93-\uDFE3\uDFE5-\uDFEF\uDFF2-\uDFFF]|\uD82F[\uDC00-\uDC9C\uDC9F-\uDFFF]|\uD833[\uDC00-\uDEFF\uDF2E\uDF2F\uDF47-\uDFFF]|\uD834[\uDC00-\uDD64\uDD6A-\uDD6C\uDD73-\uDD7A\uDD83\uDD84\uDD8C-\uDDA9\uDDAE-\uDE41\uDE45-\uDFFF]|\uD836[\uDC00-\uDDFF\uDE37-\uDE3A\uDE6D-\uDE74\uDE76-\uDE83\uDE85-\uDE9A\uDEA0\uDEB0-\uDFFF]|\uD838[\uDC07\uDC19\uDC1A\uDC22\uDC25\uDC2B-\uDC8E\uDC90-\uDD2F\uDD37-\uDEAD\uDEAF-\uDEEB\uDEF0-\uDFFF]|\uD839[\uDC00-\uDCEB\uDCF0-\uDDED\uDDF0-\uDFFF]|\uD83A[\uDC00-\uDCCF\uDCD7-\uDD43\uDD4B-\uDFFF]|\uDB40[\uDC00-\uDCFF\uDDF0-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]))(?:[\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u07FD\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u0897-\u089F\u08CA-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u09FE\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0AFA-\u0AFF\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B55-\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C00-\u0C04\u0C3C\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0CF3\u0D00-\u0D03\u0D3B\u0D3C\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D81-\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EBC\u0EC8-\u0ECE\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u135D-\u135F\u1712-\u1715\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u180B-\u180D\u180F\u1885\u1886\u18A9\u1920-\u192B\u1930-\u193B\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F\u1AB0-\u1ACE\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BF3\u1C24-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF4\u1CF7-\u1CF9\u1DC0-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA82C\uA880\uA881\uA8B4-\uA8C5\uA8E0-\uA8F1\uA8FF\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9E5\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F]|\uD800[\uDDFD\uDEE0\uDF76-\uDF7A]|\uD802[\uDE01-\uDE03\uDE05\uDE06\uDE0C-\uDE0F\uDE38-\uDE3A\uDE3F\uDEE5\uDEE6]|\uD803[\uDD24-\uDD27\uDD69-\uDD6D\uDEAB\uDEAC\uDEFC-\uDEFF\uDF46-\uDF50\uDF82-\uDF85]|\uD804[\uDC00-\uDC02\uDC38-\uDC46\uDC70\uDC73\uDC74\uDC7F-\uDC82\uDCB0-\uDCBA\uDCC2\uDD00-\uDD02\uDD27-\uDD34\uDD45\uDD46\uDD73\uDD80-\uDD82\uDDB3-\uDDC0\uDDC9-\uDDCC\uDDCE\uDDCF\uDE2C-\uDE37\uDE3E\uDE41\uDEDF-\uDEEA\uDF00-\uDF03\uDF3B\uDF3C\uDF3E-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF57\uDF62\uDF63\uDF66-\uDF6C\uDF70-\uDF74\uDFB8-\uDFC0\uDFC2\uDFC5\uDFC7-\uDFCA\uDFCC-\uDFD0\uDFD2\uDFE1\uDFE2]|\uD805[\uDC35-\uDC46\uDC5E\uDCB0-\uDCC3\uDDAF-\uDDB5\uDDB8-\uDDC0\uDDDC\uDDDD\uDE30-\uDE40\uDEAB-\uDEB7\uDF1D-\uDF2B]|\uD806[\uDC2C-\uDC3A\uDD30-\uDD35\uDD37\uDD38\uDD3B-\uDD3E\uDD40\uDD42\uDD43\uDDD1-\uDDD7\uDDDA-\uDDE0\uDDE4\uDE01-\uDE0A\uDE33-\uDE39\uDE3B-\uDE3E\uDE47\uDE51-\uDE5B\uDE8A-\uDE99]|\uD807[\uDC2F-\uDC36\uDC38-\uDC3F\uDC92-\uDCA7\uDCA9-\uDCB6\uDD31-\uDD36\uDD3A\uDD3C\uDD3D\uDD3F-\uDD45\uDD47\uDD8A-\uDD8E\uDD90\uDD91\uDD93-\uDD97\uDEF3-\uDEF6\uDF00\uDF01\uDF03\uDF34-\uDF3A\uDF3E-\uDF42\uDF5A]|\uD80D[\uDC40\uDC47-\uDC55]|\uD818[\uDD1E-\uDD2F]|\uD81A[\uDEF0-\uDEF4\uDF30-\uDF36]|\uD81B[\uDF4F\uDF51-\uDF87\uDF8F-\uDF92\uDFE4\uDFF0\uDFF1]|\uD82F[\uDC9D\uDC9E]|\uD833[\uDF00-\uDF2D\uDF30-\uDF46]|\uD834[\uDD65-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD838[\uDC00-\uDC06\uDC08-\uDC18\uDC1B-\uDC21\uDC23\uDC24\uDC26-\uDC2A\uDC8F\uDD30-\uDD36\uDEAE\uDEEC-\uDEEF]|\uD839[\uDCEC-\uDCEF\uDDEE\uDDEF]|\uD83A[\uDCD0-\uDCD6\uDD44-\uDD4A]|\uDB40[\uDD00-\uDDEF])*$/;var NOT_DIACRITIC_FROM_START_REG_EXP=/^(?:[\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u07FD\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u0897-\u089F\u08CA-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u09FE\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0AFA-\u0AFF\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B55-\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C00-\u0C04\u0C3C\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0CF3\u0D00-\u0D03\u0D3B\u0D3C\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D81-\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EBC\u0EC8-\u0ECE\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u135D-\u135F\u1712-\u1715\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u180B-\u180D\u180F\u1885\u1886\u18A9\u1920-\u192B\u1930-\u193B\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F\u1AB0-\u1ACE\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BF3\u1C24-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF4\u1CF7-\u1CF9\u1DC0-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA82C\uA880\uA881\uA8B4-\uA8C5\uA8E0-\uA8F1\uA8FF\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9E5\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F]|\uD800[\uDDFD\uDEE0\uDF76-\uDF7A]|\uD802[\uDE01-\uDE03\uDE05\uDE06\uDE0C-\uDE0F\uDE38-\uDE3A\uDE3F\uDEE5\uDEE6]|\uD803[\uDD24-\uDD27\uDD69-\uDD6D\uDEAB\uDEAC\uDEFC-\uDEFF\uDF46-\uDF50\uDF82-\uDF85]|\uD804[\uDC00-\uDC02\uDC38-\uDC46\uDC70\uDC73\uDC74\uDC7F-\uDC82\uDCB0-\uDCBA\uDCC2\uDD00-\uDD02\uDD27-\uDD34\uDD45\uDD46\uDD73\uDD80-\uDD82\uDDB3-\uDDC0\uDDC9-\uDDCC\uDDCE\uDDCF\uDE2C-\uDE37\uDE3E\uDE41\uDEDF-\uDEEA\uDF00-\uDF03\uDF3B\uDF3C\uDF3E-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF57\uDF62\uDF63\uDF66-\uDF6C\uDF70-\uDF74\uDFB8-\uDFC0\uDFC2\uDFC5\uDFC7-\uDFCA\uDFCC-\uDFD0\uDFD2\uDFE1\uDFE2]|\uD805[\uDC35-\uDC46\uDC5E\uDCB0-\uDCC3\uDDAF-\uDDB5\uDDB8-\uDDC0\uDDDC\uDDDD\uDE30-\uDE40\uDEAB-\uDEB7\uDF1D-\uDF2B]|\uD806[\uDC2C-\uDC3A\uDD30-\uDD35\uDD37\uDD38\uDD3B-\uDD3E\uDD40\uDD42\uDD43\uDDD1-\uDDD7\uDDDA-\uDDE0\uDDE4\uDE01-\uDE0A\uDE33-\uDE39\uDE3B-\uDE3E\uDE47\uDE51-\uDE5B\uDE8A-\uDE99]|\uD807[\uDC2F-\uDC36\uDC38-\uDC3F\uDC92-\uDCA7\uDCA9-\uDCB6\uDD31-\uDD36\uDD3A\uDD3C\uDD3D\uDD3F-\uDD45\uDD47\uDD8A-\uDD8E\uDD90\uDD91\uDD93-\uDD97\uDEF3-\uDEF6\uDF00\uDF01\uDF03\uDF34-\uDF3A\uDF3E-\uDF42\uDF5A]|\uD80D[\uDC40\uDC47-\uDC55]|\uD818[\uDD1E-\uDD2F]|\uD81A[\uDEF0-\uDEF4\uDF30-\uDF36]|\uD81B[\uDF4F\uDF51-\uDF87\uDF8F-\uDF92\uDFE4\uDFF0\uDFF1]|\uD82F[\uDC9D\uDC9E]|\uD833[\uDF00-\uDF2D\uDF30-\uDF46]|\uD834[\uDD65-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD838[\uDC00-\uDC06\uDC08-\uDC18\uDC1B-\uDC21\uDC23\uDC24\uDC26-\uDC2A\uDC8F\uDD30-\uDD36\uDEAE\uDEEC-\uDEEF]|\uD839[\uDCEC-\uDCEF\uDDEE\uDDEF]|\uD83A[\uDCD0-\uDCD6\uDD44-\uDD4A]|\uDB40[\uDD00-\uDDEF])*((?:[\0-\u02FF\u0370-\u0482\u048A-\u0590\u05BE\u05C0\u05C3\u05C6\u05C8-\u060F\u061B-\u064A\u0660-\u066F\u0671-\u06D5\u06DD\u06DE\u06E5\u06E6\u06E9\u06EE-\u0710\u0712-\u072F\u074B-\u07A5\u07B1-\u07EA\u07F4-\u07FC\u07FE-\u0815\u081A\u0824\u0828\u082E-\u0858\u085C-\u0896\u08A0-\u08C9\u08E2\u0904-\u0939\u093D\u0950\u0958-\u0961\u0964-\u0980\u0984-\u09BB\u09BD\u09C5\u09C6\u09C9\u09CA\u09CE-\u09D6\u09D8-\u09E1\u09E4-\u09FD\u09FF\u0A00\u0A04-\u0A3B\u0A3D\u0A43-\u0A46\u0A49\u0A4A\u0A4E-\u0A50\u0A52-\u0A6F\u0A72-\u0A74\u0A76-\u0A80\u0A84-\u0ABB\u0ABD\u0AC6\u0ACA\u0ACE-\u0AE1\u0AE4-\u0AF9\u0B00\u0B04-\u0B3B\u0B3D\u0B45\u0B46\u0B49\u0B4A\u0B4E-\u0B54\u0B58-\u0B61\u0B64-\u0B81\u0B83-\u0BBD\u0BC3-\u0BC5\u0BC9\u0BCE-\u0BD6\u0BD8-\u0BFF\u0C05-\u0C3B\u0C3D\u0C45\u0C49\u0C4E-\u0C54\u0C57-\u0C61\u0C64-\u0C80\u0C84-\u0CBB\u0CBD\u0CC5\u0CC9\u0CCE-\u0CD4\u0CD7-\u0CE1\u0CE4-\u0CF2\u0CF4-\u0CFF\u0D04-\u0D3A\u0D3D\u0D45\u0D49\u0D4E-\u0D56\u0D58-\u0D61\u0D64-\u0D80\u0D84-\u0DC9\u0DCB-\u0DCE\u0DD5\u0DD7\u0DE0-\u0DF1\u0DF4-\u0E30\u0E32\u0E33\u0E3B-\u0E46\u0E4F-\u0EB0\u0EB2\u0EB3\u0EBD-\u0EC7\u0ECF-\u0F17\u0F1A-\u0F34\u0F36\u0F38\u0F3A-\u0F3D\u0F40-\u0F70\u0F85\u0F88-\u0F8C\u0F98\u0FBD-\u0FC5\u0FC7-\u102A\u103F-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u1090-\u1099\u109E-\u135C\u1360-\u1711\u1716-\u1731\u1735-\u1751\u1754-\u1771\u1774-\u17B3\u17D4-\u17DC\u17DE-\u180A\u180E\u1810-\u1884\u1887-\u18A8\u18AA-\u191F\u192C-\u192F\u193C-\u1A16\u1A1C-\u1A54\u1A5F\u1A7D\u1A7E\u1A80-\u1AAF\u1ACF-\u1AFF\u1B05-\u1B33\u1B45-\u1B6A\u1B74-\u1B7F\u1B83-\u1BA0\u1BAE-\u1BE5\u1BF4-\u1C23\u1C38-\u1CCF\u1CD3\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA-\u1DBF\u1E00-\u20CF\u20F1-\u2CEE\u2CF2-\u2D7E\u2D80-\u2DDF\u2E00-\u3029\u3030-\u3098\u309B-\uA66E\uA673\uA67E-\uA69D\uA6A0-\uA6EF\uA6F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA828-\uA82B\uA82D-\uA87F\uA882-\uA8B3\uA8C6-\uA8DF\uA8F2-\uA8FE\uA900-\uA925\uA92E-\uA946\uA954-\uA97F\uA984-\uA9B2\uA9C1-\uA9E4\uA9E6-\uAA28\uAA37-\uAA42\uAA44-\uAA4B\uAA4E-\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2-\uAAEA\uAAF0-\uAAF4\uAAF7-\uABE2\uABEB\uABEE-\uD7FF\uE000-\uFB1D\uFB1F-\uFDFF\uFE10-\uFE1F\uFE30-\uFFFF]|\uD800[\uDC00-\uDDFC\uDDFE-\uDEDF\uDEE1-\uDF75\uDF7B-\uDFFF]|[\uD801\uD808-\uD80C\uD80E-\uD817\uD819\uD81C-\uD82E\uD830-\uD832\uD835\uD837\uD83B-\uDB3F\uDB41-\uDBFF][\uDC00-\uDFFF]|\uD802[\uDC00-\uDE00\uDE04\uDE07-\uDE0B\uDE10-\uDE37\uDE3B-\uDE3E\uDE40-\uDEE4\uDEE7-\uDFFF]|\uD803[\uDC00-\uDD23\uDD28-\uDD68\uDD6E-\uDEAA\uDEAD-\uDEFB\uDF00-\uDF45\uDF51-\uDF81\uDF86-\uDFFF]|\uD804[\uDC03-\uDC37\uDC47-\uDC6F\uDC71\uDC72\uDC75-\uDC7E\uDC83-\uDCAF\uDCBB-\uDCC1\uDCC3-\uDCFF\uDD03-\uDD26\uDD35-\uDD44\uDD47-\uDD72\uDD74-\uDD7F\uDD83-\uDDB2\uDDC1-\uDDC8\uDDCD\uDDD0-\uDE2B\uDE38-\uDE3D\uDE3F\uDE40\uDE42-\uDEDE\uDEEB-\uDEFF\uDF04-\uDF3A\uDF3D\uDF45\uDF46\uDF49\uDF4A\uDF4E-\uDF56\uDF58-\uDF61\uDF64\uDF65\uDF6D-\uDF6F\uDF75-\uDFB7\uDFC1\uDFC3\uDFC4\uDFC6\uDFCB\uDFD1\uDFD3-\uDFE0\uDFE3-\uDFFF]|\uD805[\uDC00-\uDC34\uDC47-\uDC5D\uDC5F-\uDCAF\uDCC4-\uDDAE\uDDB6\uDDB7\uDDC1-\uDDDB\uDDDE-\uDE2F\uDE41-\uDEAA\uDEB8-\uDF1C\uDF2C-\uDFFF]|\uD806[\uDC00-\uDC2B\uDC3B-\uDD2F\uDD36\uDD39\uDD3A\uDD3F\uDD41\uDD44-\uDDD0\uDDD8\uDDD9\uDDE1-\uDDE3\uDDE5-\uDE00\uDE0B-\uDE32\uDE3A\uDE3F-\uDE46\uDE48-\uDE50\uDE5C-\uDE89\uDE9A-\uDFFF]|\uD807[\uDC00-\uDC2E\uDC37\uDC40-\uDC91\uDCA8\uDCB7-\uDD30\uDD37-\uDD39\uDD3B\uDD3E\uDD46\uDD48-\uDD89\uDD8F\uDD92\uDD98-\uDEF2\uDEF7-\uDEFF\uDF02\uDF04-\uDF33\uDF3B-\uDF3D\uDF43-\uDF59\uDF5B-\uDFFF]|\uD80D[\uDC00-\uDC3F\uDC41-\uDC46\uDC56-\uDFFF]|\uD818[\uDC00-\uDD1D\uDD30-\uDFFF]|\uD81A[\uDC00-\uDEEF\uDEF5-\uDF2F\uDF37-\uDFFF]|\uD81B[\uDC00-\uDF4E\uDF50\uDF88-\uDF8E\uDF93-\uDFE3\uDFE5-\uDFEF\uDFF2-\uDFFF]|\uD82F[\uDC00-\uDC9C\uDC9F-\uDFFF]|\uD833[\uDC00-\uDEFF\uDF2E\uDF2F\uDF47-\uDFFF]|\uD834[\uDC00-\uDD64\uDD6A-\uDD6C\uDD73-\uDD7A\uDD83\uDD84\uDD8C-\uDDA9\uDDAE-\uDE41\uDE45-\uDFFF]|\uD836[\uDC00-\uDDFF\uDE37-\uDE3A\uDE6D-\uDE74\uDE76-\uDE83\uDE85-\uDE9A\uDEA0\uDEB0-\uDFFF]|\uD838[\uDC07\uDC19\uDC1A\uDC22\uDC25\uDC2B-\uDC8E\uDC90-\uDD2F\uDD37-\uDEAD\uDEAF-\uDEEB\uDEF0-\uDFFF]|\uD839[\uDC00-\uDCEB\uDCF0-\uDDED\uDDF0-\uDFFF]|\uD83A[\uDC00-\uDCCF\uDCD7-\uDD43\uDD4B-\uDFFF]|\uDB40[\uDC00-\uDCFF\uDDF0-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]))/;var SYLLABLES_REG_EXP=/[\uAC00-\uD7AF\uFA6C\uFACF-\uFAD1\uFAD5-\uFAD7]+/g;var SYLLABLES_LENGTHS=new Map();var FIRST_CHAR_SYLLABLES_REG_EXP="[\\u1100-\\u1112\\ud7a4-\\ud7af\\ud84a\\ud84c\\ud850\\ud854\\ud857\\ud85f]";var NFKC_CHARS_TO_NORMALIZE=new Map();var noSyllablesRegExp=null;var withSyllablesRegExp=null;function normalize(text){var syllablePositions=[];var m;while((m=SYLLABLES_REG_EXP.exec(text))!==null){var _m=m,index=_m.index;var _iterator19=_createForOfIteratorHelper(m[0]),_step19;try{for(_iterator19.s();!(_step19=_iterator19.n()).done;){var _char2=_step19.value;var len=SYLLABLES_LENGTHS.get(_char2);if(!len){len=_char2.normalize("NFD").length;SYLLABLES_LENGTHS.set(_char2,len);}syllablePositions.push([len,index++]);}}catch(err){_iterator19.e(err);}finally{_iterator19.f();}}var hasSyllables=syllablePositions.length>0;var normalizationRegex;if(!hasSyllables&&noSyllablesRegExp){normalizationRegex=noSyllablesRegExp;}else if(hasSyllables&&withSyllablesRegExp){normalizationRegex=withSyllablesRegExp;}else{var replace=Object.keys(CHARACTERS_TO_NORMALIZE).join("");var toNormalizeWithNFKC=getNormalizeWithNFKC();var CJK="(?:\\p{Ideographic}|[\u3040-\u30FF])";var HKDiacritics="(?:\u3099|\u309A)";var BrokenWord="\\p{Ll}-\\n(?=\\p{Ll})|\\p{Lu}-\\n(?=\\p{L})";var regexps=["[".concat(replace,"]"),"[".concat(toNormalizeWithNFKC,"]"),"".concat(HKDiacritics,"\\n"),"\\p{M}+(?:-\\n)?","".concat(BrokenWord),"\\S-\\n","".concat(CJK,"\\n"),"\\n",hasSyllables?FIRST_CHAR_SYLLABLES_REG_EXP:"\\u0000"];normalizationRegex=new RegExp(regexps.map(function(r){return"(".concat(r,")");}).join("|"),"gum");if(hasSyllables){withSyllablesRegExp=normalizationRegex;}else{noSyllablesRegExp=normalizationRegex;}}var rawDiacriticsPositions=[];while((m=DIACRITICS_REG_EXP.exec(text))!==null){rawDiacriticsPositions.push([m[0].length,m.index]);}var normalized=text.normalize("NFD");var positions=[0,0];var rawDiacriticsIndex=0;var syllableIndex=0;var shift=0;var shiftOrigin=0;var eol=0;var hasDiacritics=false;normalized=normalized.replace(normalizationRegex,function(match,p1,p2,p3,p4,p5,p6,p7,p8,p9,i){var _syllablePositions$sy;i-=shiftOrigin;if(p1){var replacement=CHARACTERS_TO_NORMALIZE[p1];var jj=replacement.length;for(var j=1;j<jj;j++){positions.push(i-shift+j,shift-j);}shift-=jj-1;return replacement;}if(p2){var _replacement=NFKC_CHARS_TO_NORMALIZE.get(p2);if(!_replacement){_replacement=p2.normalize("NFKC");NFKC_CHARS_TO_NORMALIZE.set(p2,_replacement);}var _jj=_replacement.length;for(var _j=1;_j<_jj;_j++){positions.push(i-shift+_j,shift-_j);}shift-=_jj-1;return _replacement;}if(p3){var _rawDiacriticsPositio;hasDiacritics=true;if(i+eol===((_rawDiacriticsPositio=rawDiacriticsPositions[rawDiacriticsIndex])===null||_rawDiacriticsPositio===void 0?void 0:_rawDiacriticsPositio[1])){++rawDiacriticsIndex;}else{positions.push(i-1-shift+1,shift-1);shift-=1;shiftOrigin+=1;}positions.push(i-shift+1,shift);shiftOrigin+=1;eol+=1;return p3.charAt(0);}if(p4){var _rawDiacriticsPositio2;var hasTrailingDashEOL=p4.endsWith("\n");var _len=hasTrailingDashEOL?p4.length-2:p4.length;hasDiacritics=true;var _jj2=_len;if(i+eol===((_rawDiacriticsPositio2=rawDiacriticsPositions[rawDiacriticsIndex])===null||_rawDiacriticsPositio2===void 0?void 0:_rawDiacriticsPositio2[1])){_jj2-=rawDiacriticsPositions[rawDiacriticsIndex][0];++rawDiacriticsIndex;}for(var _j2=1;_j2<=_jj2;_j2++){positions.push(i-1-shift+_j2,shift-_j2);}shift-=_jj2;shiftOrigin+=_jj2;if(hasTrailingDashEOL){i+=_len-1;positions.push(i-shift+1,1+shift);shift+=1;shiftOrigin+=1;eol+=1;return p4.slice(0,_len);}return p4;}if(p5){var _len2=p5.length-2;positions.push(i-shift+_len2,1+shift);shift+=1;shiftOrigin+=1;eol+=1;return p5.slice(0,-2);}if(p6){shiftOrigin+=1;eol+=1;return p6.slice(0,-1);}if(p7){var _len3=p7.length-1;positions.push(i-shift+_len3,shift);shiftOrigin+=1;eol+=1;return p7.slice(0,-1);}if(p8){positions.push(i-shift+1,shift-1);shift-=1;shiftOrigin+=1;eol+=1;return" ";}if(i+eol===((_syllablePositions$sy=syllablePositions[syllableIndex])===null||_syllablePositions$sy===void 0?void 0:_syllablePositions$sy[1])){var newCharLen=syllablePositions[syllableIndex][0]-1;++syllableIndex;for(var _j3=1;_j3<=newCharLen;_j3++){positions.push(i-(shift-_j3),shift-_j3);}shift-=newCharLen;shiftOrigin+=newCharLen;}return p9;});positions.push(normalized.length,shift);var starts=new Uint32Array(positions.length>>1);var shifts=new Int32Array(positions.length>>1);for(var i=0,ii=positions.length;i<ii;i+=2){starts[i>>1]=positions[i];shifts[i>>1]=positions[i+1];}return[normalized,[starts,shifts],hasDiacritics];}function getOriginalIndex(diffs,pos,len){if(!diffs){return[pos,len];}var _diffs=_slicedToArray(diffs,2),starts=_diffs[0],shifts=_diffs[1];var start=pos;var end=pos+len-1;var i=binarySearchFirstItem(starts,function(x){return x>=start;});if(starts[i]>start){--i;}var j=binarySearchFirstItem(starts,function(x){return x>=end;},i);if(starts[j]>end){--j;}var oldStart=start+shifts[i];var oldEnd=end+shifts[j];var oldLen=oldEnd+1-oldStart;return[oldStart,oldLen];}var _state=/*#__PURE__*/new WeakMap();var _updateMatchesCountOnProgress=/*#__PURE__*/new WeakMap();var _visitedPagesCount=/*#__PURE__*/new WeakMap();var _PDFFindController_brand=/*#__PURE__*/new WeakSet();var PDFFindController=/*#__PURE__*/function(){function PDFFindController(_ref29){var _linkService=_ref29.linkService,eventBus=_ref29.eventBus,_ref29$updateMatchesC=_ref29.updateMatchesCountOnProgress,updateMatchesCountOnProgress=_ref29$updateMatchesC===void 0?true:_ref29$updateMatchesC;_classCallCheck(this,PDFFindController);_classPrivateMethodInitSpec(this,_PDFFindController_brand);_classPrivateFieldInitSpec(this,_state,null);_classPrivateFieldInitSpec(this,_updateMatchesCountOnProgress,true);_classPrivateFieldInitSpec(this,_visitedPagesCount,0);this._linkService=_linkService;this._eventBus=eventBus;_classPrivateFieldSet(_updateMatchesCountOnProgress,this,updateMatchesCountOnProgress);this.onIsPageVisible=null;_assertClassBrand(_PDFFindController_brand,this,_reset3).call(this);eventBus._on("find",_assertClassBrand(_PDFFindController_brand,this,_onFind).bind(this));eventBus._on("findbarclose",_assertClassBrand(_PDFFindController_brand,this,_onFindBarClose).bind(this));}return _createClass(PDFFindController,[{key:"highlightMatches",get:function get(){return this._highlightMatches;}},{key:"pageMatches",get:function get(){return this._pageMatches;}},{key:"pageMatchesLength",get:function get(){return this._pageMatchesLength;}},{key:"selected",get:function get(){return this._selected;}},{key:"state",get:function get(){return _classPrivateFieldGet(_state,this);}},{key:"setDocument",value:function setDocument(pdfDocument){if(this._pdfDocument){_assertClassBrand(_PDFFindController_brand,this,_reset3).call(this);}if(!pdfDocument){return;}this._pdfDocument=pdfDocument;this._firstPageCapability.resolve();}},{key:"scrollMatchIntoView",value:function scrollMatchIntoView(_ref30){var _ref30$element=_ref30.element,element=_ref30$element===void 0?null:_ref30$element,_ref30$selectedLeft=_ref30.selectedLeft,selectedLeft=_ref30$selectedLeft===void 0?0:_ref30$selectedLeft,_ref30$pageIndex=_ref30.pageIndex,pageIndex=_ref30$pageIndex===void 0?-1:_ref30$pageIndex,_ref30$matchIndex=_ref30.matchIndex,matchIndex=_ref30$matchIndex===void 0?-1:_ref30$matchIndex;if(!this._scrollMatches||!element){return;}else if(matchIndex===-1||matchIndex!==this._selected.matchIdx){return;}else if(pageIndex===-1||pageIndex!==this._selected.pageIdx){return;}this._scrollMatches=false;var spot={top:MATCH_SCROLL_OFFSET_TOP,left:selectedLeft+MATCH_SCROLL_OFFSET_LEFT};scrollIntoView(element,spot,true);}},{key:"match",value:function match(query,pageContent,pageIndex){var _this27=this;var hasDiacritics=this._hasDiacritics[pageIndex];var isUnicode=false;if(typeof query==="string"){var _assertClassBrand$cal5=_assertClassBrand(_PDFFindController_brand,this,_convertToRegExpString).call(this,query,hasDiacritics);var _assertClassBrand$cal6=_slicedToArray(_assertClassBrand$cal5,2);isUnicode=_assertClassBrand$cal6[0];query=_assertClassBrand$cal6[1];}else{query=query.sort().reverse().map(function(q){var _assertClassBrand$cal7=_assertClassBrand(_PDFFindController_brand,_this27,_convertToRegExpString).call(_this27,q,hasDiacritics),_assertClassBrand$cal8=_slicedToArray(_assertClassBrand$cal7,2),isUnicodePart=_assertClassBrand$cal8[0],queryPart=_assertClassBrand$cal8[1];isUnicode||(isUnicode=isUnicodePart);return"(".concat(queryPart,")");}).join("|");}if(!query){return undefined;}var _classPrivateFieldGet0=_classPrivateFieldGet(_state,this),caseSensitive=_classPrivateFieldGet0.caseSensitive,entireWord=_classPrivateFieldGet0.entireWord;var flags="g".concat(isUnicode?"u":"").concat(caseSensitive?"":"i");query=new RegExp(query,flags);var matches=[];var match;while((match=query.exec(pageContent))!==null){if(entireWord&&!_assertClassBrand(_PDFFindController_brand,this,_isEntireWord).call(this,pageContent,match.index,match[0].length)){continue;}matches.push({index:match.index,length:match[0].length});}return matches;}}]);}();function _onFind(state){var _this98=this;if(!state){return;}var pdfDocument=this._pdfDocument;var type=state.type;if(_classPrivateFieldGet(_state,this)===null||_assertClassBrand(_PDFFindController_brand,this,_shouldDirtyMatch).call(this,state)){this._dirtyMatch=true;}_classPrivateFieldSet(_state,this,state);if(type!=="highlightallchange"){_assertClassBrand(_PDFFindController_brand,this,_updateUIState2).call(this,FindState.PENDING);}this._firstPageCapability.promise.then(function(){if(!_this98._pdfDocument||pdfDocument&&_this98._pdfDocument!==pdfDocument){return;}_assertClassBrand(_PDFFindController_brand,_this98,_extractText).call(_this98);var findbarClosed=!_this98._highlightMatches;var pendingTimeout=!!_this98._findTimeout;if(_this98._findTimeout){clearTimeout(_this98._findTimeout);_this98._findTimeout=null;}if(!type){_this98._findTimeout=setTimeout(function(){_assertClassBrand(_PDFFindController_brand,_this98,_nextMatch).call(_this98);_this98._findTimeout=null;},FIND_TIMEOUT);}else if(_this98._dirtyMatch){_assertClassBrand(_PDFFindController_brand,_this98,_nextMatch).call(_this98);}else if(type==="again"){_assertClassBrand(_PDFFindController_brand,_this98,_nextMatch).call(_this98);if(findbarClosed&&_classPrivateFieldGet(_state,_this98).highlightAll){_assertClassBrand(_PDFFindController_brand,_this98,_updateAllPages).call(_this98);}}else if(type==="highlightallchange"){if(pendingTimeout){_assertClassBrand(_PDFFindController_brand,_this98,_nextMatch).call(_this98);}else{_this98._highlightMatches=true;}_assertClassBrand(_PDFFindController_brand,_this98,_updateAllPages).call(_this98);}else{_assertClassBrand(_PDFFindController_brand,_this98,_nextMatch).call(_this98);}});}function _reset3(){this._highlightMatches=false;this._scrollMatches=false;this._pdfDocument=null;this._pageMatches=[];this._pageMatchesLength=[];_classPrivateFieldSet(_visitedPagesCount,this,0);_classPrivateFieldSet(_state,this,null);this._selected={pageIdx:-1,matchIdx:-1};this._offset={pageIdx:null,matchIdx:null,wrapped:false};this._extractTextPromises=[];this._pageContents=[];this._pageDiffs=[];this._hasDiacritics=[];this._matchesCountTotal=0;this._pagesToSearch=null;this._pendingFindMatches=new Set();this._resumePageIdx=null;this._dirtyMatch=false;clearTimeout(this._findTimeout);this._findTimeout=null;this._firstPageCapability=Promise.withResolvers();}function _get_query(_this26){var _classPrivateFieldGet56=_classPrivateFieldGet(_state,_this26),query=_classPrivateFieldGet56.query;if(typeof query==="string"){if(query!==_this26._rawQuery){_this26._rawQuery=query;var _normalize3=normalize(query);var _normalize4=_slicedToArray(_normalize3,1);_this26._normalizedQuery=_normalize4[0];}return _this26._normalizedQuery;}return(query||[]).filter(function(q){return!!q;}).map(function(q){return normalize(q)[0];});}function _shouldDirtyMatch(state){var _this$onIsPageVisible,_this$onIsPageVisible2;var newQuery=state.query,prevQuery=_classPrivateFieldGet(_state,this).query;var newType=_typeof(newQuery),prevType=_typeof(prevQuery);if(newType!==prevType){return true;}if(newType==="string"){if(newQuery!==prevQuery){return true;}}else if(JSON.stringify(newQuery)!==JSON.stringify(prevQuery)){return true;}switch(state.type){case"again":var pageNumber=this._selected.pageIdx+1;var linkService=this._linkService;return pageNumber>=1&&pageNumber<=linkService.pagesCount&&pageNumber!==linkService.page&&!((_this$onIsPageVisible=(_this$onIsPageVisible2=this.onIsPageVisible)===null||_this$onIsPageVisible2===void 0?void 0:_this$onIsPageVisible2.call(this,pageNumber))!==null&&_this$onIsPageVisible!==void 0?_this$onIsPageVisible:true);case"highlightallchange":return false;}return true;}function _isEntireWord(content,startIdx,length){var match=content.slice(0,startIdx).match(NOT_DIACRITIC_FROM_END_REG_EXP);if(match){var first=content.charCodeAt(startIdx);var limit=match[1].charCodeAt(0);if(getCharacterType(first)===getCharacterType(limit)){return false;}}match=content.slice(startIdx+length).match(NOT_DIACRITIC_FROM_START_REG_EXP);if(match){var last=content.charCodeAt(startIdx+length-1);var _limit=match[1].charCodeAt(0);if(getCharacterType(last)===getCharacterType(_limit)){return false;}}return true;}function _convertToRegExpString(query,hasDiacritics){var _classPrivateFieldGet57=_classPrivateFieldGet(_state,this),matchDiacritics=_classPrivateFieldGet57.matchDiacritics;var isUnicode=false;query=query.replaceAll(SPECIAL_CHARS_REG_EXP,function(match,p1,p2,p3,p4,p5){if(p1){return"[ ]*\\".concat(p1,"[ ]*");}if(p2){return"[ ]*".concat(p2,"[ ]*");}if(p3){return"[ ]+";}if(matchDiacritics){return p4||p5;}if(p4){return DIACRITICS_EXCEPTION.has(p4.charCodeAt(0))?p4:"";}if(hasDiacritics){isUnicode=true;return"".concat(p5,"\\p{M}*");}return p5;});var trailingSpaces="[ ]*";// 兼容一下搜索的字符串中可能存在空格的情况，单实际上是不应该存在的情况
query=query.split(trailingSpaces).map(function(item){return item.split("[ ]+").map(function(subItem){return /^\\[.*+?^${}()|[\]\\]/.test(subItem)?subItem:subItem.replace(/.(?=.)/g,'$&[ ]*');}).join("[ ]+");}).join(trailingSpaces);if(query.endsWith(trailingSpaces)){query=query.slice(0,query.length-trailingSpaces.length);}if(matchDiacritics){if(hasDiacritics){DIACRITICS_EXCEPTION_STR||(DIACRITICS_EXCEPTION_STR=String.fromCharCode.apply(String,_toConsumableArray(DIACRITICS_EXCEPTION)));isUnicode=true;query="".concat(query,"(?=[").concat(DIACRITICS_EXCEPTION_STR,"]|[^\\p{M}]|$)");}}return[isUnicode,query];}function _calculateMatch(pageIndex){var _this$visitedPagesCou;var query=_classPrivateGetter(_PDFFindController_brand,this,_get_query);if(query.length===0){return;}var pageContent=this._pageContents[pageIndex];var matcherResult=this.match(query,pageContent,pageIndex);var matches=this._pageMatches[pageIndex]=[];var matchesLength=this._pageMatchesLength[pageIndex]=[];var diffs=this._pageDiffs[pageIndex];matcherResult===null||matcherResult===void 0||matcherResult.forEach(function(_ref115){var index=_ref115.index,length=_ref115.length;var _getOriginalIndex3=getOriginalIndex(diffs,index,length),_getOriginalIndex4=_slicedToArray(_getOriginalIndex3,2),matchPos=_getOriginalIndex4[0],matchLen=_getOriginalIndex4[1];if(matchLen){matches.push(matchPos);matchesLength.push(matchLen);}});if(_classPrivateFieldGet(_state,this).highlightAll){_assertClassBrand(_PDFFindController_brand,this,_updatePage).call(this,pageIndex);}if(this._resumePageIdx===pageIndex){this._resumePageIdx=null;_assertClassBrand(_PDFFindController_brand,this,_nextPageMatch).call(this);}var pageMatchesCount=matches.length;this._matchesCountTotal+=pageMatchesCount;if(_classPrivateFieldGet(_updateMatchesCountOnProgress,this)){if(pageMatchesCount>0){_assertClassBrand(_PDFFindController_brand,this,_updateUIResultsCount).call(this);}}else if(_classPrivateFieldSet(_visitedPagesCount,this,(_this$visitedPagesCou=_classPrivateFieldGet(_visitedPagesCount,this),++_this$visitedPagesCou))===this._linkService.pagesCount){_assertClassBrand(_PDFFindController_brand,this,_updateUIResultsCount).call(this);}}function _extractText(){var _this99=this;if(this._extractTextPromises.length>0){return;}var deferred=Promise.resolve();var textOptions={disableNormalization:true};var _loop3=function _loop3(i){var _Promise$withResolver4=Promise.withResolvers(),promise=_Promise$withResolver4.promise,resolve=_Promise$withResolver4.resolve;_this99._extractTextPromises[i]=promise;deferred=deferred.then(function(){return _this99._pdfDocument.getPage(i+1).then(function(pdfPage){return pdfPage.getTextContent(textOptions);}).then(function(textContent){var strBuf=[];var _iterator54=_createForOfIteratorHelper(textContent.items),_step54;try{for(_iterator54.s();!(_step54=_iterator54.n()).done;){var textItem=_step54.value;strBuf.push(textItem.str);if(textItem.hasEOL){strBuf.push("\n");}}}catch(err){_iterator54.e(err);}finally{_iterator54.f();}var _normalize5=normalize(strBuf.join(""));var _normalize6=_slicedToArray(_normalize5,3);_this99._pageContents[i]=_normalize6[0];_this99._pageDiffs[i]=_normalize6[1];_this99._hasDiacritics[i]=_normalize6[2];resolve();},function(reason){console.error("Unable to get text content for page ".concat(i+1),reason);_this99._pageContents[i]="";_this99._pageDiffs[i]=null;_this99._hasDiacritics[i]=false;resolve();});});};for(var i=0,ii=this._linkService.pagesCount;i<ii;i++){_loop3(i);}}function _updatePage(index){if(this._scrollMatches&&this._selected.pageIdx===index){this._linkService.page=index+1;}this._eventBus.dispatch("updatetextlayermatches",{source:this,pageIndex:index});}function _updateAllPages(){this._eventBus.dispatch("updatetextlayermatches",{source:this,pageIndex:-1});}function _nextMatch(){var _this100=this;var previous=_classPrivateFieldGet(_state,this).findPrevious;var currentPageIndex=this._linkService.page-1;var numPages=this._linkService.pagesCount;this._highlightMatches=true;if(this._dirtyMatch){this._dirtyMatch=false;this._selected.pageIdx=this._selected.matchIdx=-1;this._offset.pageIdx=currentPageIndex;this._offset.matchIdx=null;this._offset.wrapped=false;this._resumePageIdx=null;this._pageMatches.length=0;this._pageMatchesLength.length=0;_classPrivateFieldSet(_visitedPagesCount,this,0);this._matchesCountTotal=0;_assertClassBrand(_PDFFindController_brand,this,_updateAllPages).call(this);var _loop4=function _loop4(i){if(_this100._pendingFindMatches.has(i)){return 1;// continue
}_this100._pendingFindMatches.add(i);_this100._extractTextPromises[i].then(function(){_this100._pendingFindMatches["delete"](i);_assertClassBrand(_PDFFindController_brand,_this100,_calculateMatch).call(_this100,i);});};for(var i=0;i<numPages;i++){if(_loop4(i))continue;}}var query=_classPrivateGetter(_PDFFindController_brand,this,_get_query);if(query.length===0){_assertClassBrand(_PDFFindController_brand,this,_updateUIState2).call(this,FindState.FOUND);return;}if(this._resumePageIdx){return;}var offset=this._offset;this._pagesToSearch=numPages;if(offset.matchIdx!==null){var numPageMatches=this._pageMatches[offset.pageIdx].length;if(!previous&&offset.matchIdx+1<numPageMatches||previous&&offset.matchIdx>0){offset.matchIdx=previous?offset.matchIdx-1:offset.matchIdx+1;_assertClassBrand(_PDFFindController_brand,this,_updateMatch).call(this,true);return;}_assertClassBrand(_PDFFindController_brand,this,_advanceOffsetPage).call(this,previous);}_assertClassBrand(_PDFFindController_brand,this,_nextPageMatch).call(this);}function _matchesReady(matches){var offset=this._offset;var numMatches=matches.length;var previous=_classPrivateFieldGet(_state,this).findPrevious;if(numMatches){offset.matchIdx=previous?numMatches-1:0;_assertClassBrand(_PDFFindController_brand,this,_updateMatch).call(this,true);return true;}_assertClassBrand(_PDFFindController_brand,this,_advanceOffsetPage).call(this,previous);if(offset.wrapped){offset.matchIdx=null;if(this._pagesToSearch<0){_assertClassBrand(_PDFFindController_brand,this,_updateMatch).call(this,false);return true;}}return false;}function _nextPageMatch(){if(this._resumePageIdx!==null){console.error("There can only be one pending page.");}var matches=null;do{var pageIdx=this._offset.pageIdx;matches=this._pageMatches[pageIdx];if(!matches){this._resumePageIdx=pageIdx;break;}}while(!_assertClassBrand(_PDFFindController_brand,this,_matchesReady).call(this,matches));}function _advanceOffsetPage(previous){var offset=this._offset;var numPages=this._linkService.pagesCount;offset.pageIdx=previous?offset.pageIdx-1:offset.pageIdx+1;offset.matchIdx=null;this._pagesToSearch--;if(offset.pageIdx>=numPages||offset.pageIdx<0){offset.pageIdx=previous?numPages-1:0;offset.wrapped=true;}}function _updateMatch(){var found=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var state=FindState.NOT_FOUND;var wrapped=this._offset.wrapped;this._offset.wrapped=false;if(found){var previousPage=this._selected.pageIdx;this._selected.pageIdx=this._offset.pageIdx;this._selected.matchIdx=this._offset.matchIdx;state=wrapped?FindState.WRAPPED:FindState.FOUND;if(previousPage!==-1&&previousPage!==this._selected.pageIdx){_assertClassBrand(_PDFFindController_brand,this,_updatePage).call(this,previousPage);}}_assertClassBrand(_PDFFindController_brand,this,_updateUIState2).call(this,state,_classPrivateFieldGet(_state,this).findPrevious);if(this._selected.pageIdx!==-1){this._scrollMatches=true;_assertClassBrand(_PDFFindController_brand,this,_updatePage).call(this,this._selected.pageIdx);}}function _onFindBarClose(evt){var _this101=this;var pdfDocument=this._pdfDocument;this._firstPageCapability.promise.then(function(){if(!_this101._pdfDocument||pdfDocument&&_this101._pdfDocument!==pdfDocument){return;}if(_this101._findTimeout){clearTimeout(_this101._findTimeout);_this101._findTimeout=null;}if(_this101._resumePageIdx){_this101._resumePageIdx=null;_this101._dirtyMatch=true;}_assertClassBrand(_PDFFindController_brand,_this101,_updateUIState2).call(_this101,FindState.FOUND);_this101._highlightMatches=false;_assertClassBrand(_PDFFindController_brand,_this101,_updateAllPages).call(_this101);});}function _requestMatchesCount(){var _this$_selected=this._selected,pageIdx=_this$_selected.pageIdx,matchIdx=_this$_selected.matchIdx;var current=0,total=this._matchesCountTotal;if(matchIdx!==-1){for(var i=0;i<pageIdx;i++){var _this$_pageMatches$i;current+=((_this$_pageMatches$i=this._pageMatches[i])===null||_this$_pageMatches$i===void 0?void 0:_this$_pageMatches$i.length)||0;}current+=matchIdx+1;}if(current<1||current>total){current=total=0;}return{current:current,total:total};}function _updateUIResultsCount(){this._eventBus.dispatch("updatefindmatchescount",{source:this,matchesCount:_assertClassBrand(_PDFFindController_brand,this,_requestMatchesCount).call(this)});}function _updateUIState2(state){var _classPrivateFieldGet58,_classPrivateFieldGet59,_classPrivateFieldGet60,_classPrivateFieldGet61;var previous=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(!_classPrivateFieldGet(_updateMatchesCountOnProgress,this)&&(_classPrivateFieldGet(_visitedPagesCount,this)!==this._linkService.pagesCount||state===FindState.PENDING)){return;}this._eventBus.dispatch("updatefindcontrolstate",{source:this,state:state,previous:previous,entireWord:(_classPrivateFieldGet58=(_classPrivateFieldGet59=_classPrivateFieldGet(_state,this))===null||_classPrivateFieldGet59===void 0?void 0:_classPrivateFieldGet59.entireWord)!==null&&_classPrivateFieldGet58!==void 0?_classPrivateFieldGet58:null,matchesCount:_assertClassBrand(_PDFFindController_brand,this,_requestMatchesCount).call(this),rawQuery:(_classPrivateFieldGet60=(_classPrivateFieldGet61=_classPrivateFieldGet(_state,this))===null||_classPrivateFieldGet61===void 0?void 0:_classPrivateFieldGet61.query)!==null&&_classPrivateFieldGet60!==void 0?_classPrivateFieldGet60:null});};// ./web/pdf_find_bar.js
var MATCHES_COUNT_LIMIT=1000;var _mainContainer2=/*#__PURE__*/new WeakMap();var _resizeObserver=/*#__PURE__*/new WeakMap();var _PDFFindBar_brand=/*#__PURE__*/new WeakSet();var PDFFindBar=/*#__PURE__*/function(){function PDFFindBar(options,mainContainer,eventBus){var _this28=this;_classCallCheck(this,PDFFindBar);_classPrivateMethodInitSpec(this,_PDFFindBar_brand);_classPrivateFieldInitSpec(this,_mainContainer2,void 0);_classPrivateFieldInitSpec(this,_resizeObserver,new ResizeObserver(_assertClassBrand(_PDFFindBar_brand,this,_resizeObserverCallback).bind(this)));this.opened=false;this.bar=options.bar;this.toggleButton=options.toggleButton;this.findField=options.findField;this.highlightAll=options.highlightAllCheckbox;this.caseSensitive=options.caseSensitiveCheckbox;this.matchDiacritics=options.matchDiacriticsCheckbox;this.entireWord=options.entireWordCheckbox;this.findMsg=options.findMsg;this.findResultsCount=options.findResultsCount;this.findPreviousButton=options.findPreviousButton;this.findNextButton=options.findNextButton;this.eventBus=eventBus;_classPrivateFieldSet(_mainContainer2,this,mainContainer);var checkedInputs=new Map([[this.highlightAll,"highlightallchange"],[this.caseSensitive,"casesensitivitychange"],[this.entireWord,"entirewordchange"],[this.matchDiacritics,"diacriticmatchingchange"]]);this.toggleButton.addEventListener("click",function(){_this28.toggle();});this.findField.addEventListener("input",function(){_this28.dispatchEvent("");});this.bar.addEventListener("keydown",function(_ref31){var keyCode=_ref31.keyCode,shiftKey=_ref31.shiftKey,target=_ref31.target;switch(keyCode){case 13:if(target===_this28.findField){_this28.dispatchEvent("again",shiftKey);}else if(checkedInputs.has(target)){target.checked=!target.checked;_this28.dispatchEvent(checkedInputs.get(target));}break;case 27:_this28.close();break;}});this.findPreviousButton.addEventListener("click",function(){_this28.dispatchEvent("again",true);});this.findNextButton.addEventListener("click",function(){_this28.dispatchEvent("again",false);});var _iterator20=_createForOfIteratorHelper(checkedInputs),_step20;try{var _loop=function _loop(){var _step20$value=_slicedToArray(_step20.value,2),elem=_step20$value[0],evtName=_step20$value[1];elem.addEventListener("click",function(){_this28.dispatchEvent(evtName);});};for(_iterator20.s();!(_step20=_iterator20.n()).done;){_loop();}}catch(err){_iterator20.e(err);}finally{_iterator20.f();}}return _createClass(PDFFindBar,[{key:"reset",value:function reset(){this.updateUIState();}},{key:"dispatchEvent",value:function dispatchEvent(type){var findPrev=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;this.eventBus.dispatch("find",{source:this,type:type,query:this.findField.value,caseSensitive:this.caseSensitive.checked,entireWord:this.entireWord.checked,highlightAll:this.highlightAll.checked,findPrevious:findPrev,matchDiacritics:this.matchDiacritics.checked});}},{key:"updateUIState",value:function updateUIState(state,previous,matchesCount){var findField=this.findField,findMsg=this.findMsg;var findMsgId="",status="";switch(state){case FindState.FOUND:break;case FindState.PENDING:status="pending";break;case FindState.NOT_FOUND:findMsgId="pdfjs-find-not-found";status="notFound";break;case FindState.WRAPPED:findMsgId=previous?"pdfjs-find-reached-top":"pdfjs-find-reached-bottom";break;}findField.setAttribute("data-status",status);findField.setAttribute("aria-invalid",state===FindState.NOT_FOUND);findMsg.setAttribute("data-status",status);if(findMsgId){findMsg.setAttribute("data-l10n-id",findMsgId);}else{findMsg.removeAttribute("data-l10n-id");findMsg.textContent="";}this.updateResultsCount(matchesCount);}},{key:"updateResultsCount",value:function updateResultsCount(){var _ref32=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},_ref32$current=_ref32.current,current=_ref32$current===void 0?0:_ref32$current,_ref32$total=_ref32.total,total=_ref32$total===void 0?0:_ref32$total;var findResultsCount=this.findResultsCount;if(total>0){var limit=MATCHES_COUNT_LIMIT;findResultsCount.setAttribute("data-l10n-id",total>limit?"pdfjs-find-match-count-limit":"pdfjs-find-match-count");findResultsCount.setAttribute("data-l10n-args",JSON.stringify({limit:limit,current:current,total:total}));}else{findResultsCount.removeAttribute("data-l10n-id");findResultsCount.textContent="";}}},{key:"open",value:function open(){if(!this.opened){_classPrivateFieldGet(_resizeObserver,this).observe(_classPrivateFieldGet(_mainContainer2,this));_classPrivateFieldGet(_resizeObserver,this).observe(this.bar);this.opened=true;toggleExpandedBtn(this.toggleButton,true,this.bar);}this.findField.select();this.findField.focus();}},{key:"close",value:function close(){if(!this.opened){return;}_classPrivateFieldGet(_resizeObserver,this).disconnect();this.opened=false;toggleExpandedBtn(this.toggleButton,false,this.bar);this.eventBus.dispatch("findbarclose",{source:this});}},{key:"toggle",value:function toggle(){if(this.opened){this.close();}else{this.open();}}}]);}();function _resizeObserverCallback(){var bar=this.bar;bar.classList.remove("wrapContainers");var findbarHeight=bar.clientHeight;var inputContainerHeight=bar.firstElementChild.clientHeight;if(findbarHeight>inputContainerHeight){bar.classList.add("wrapContainers");}};// ./web/pdf_history.js
var HASH_CHANGE_TIMEOUT=1000;var POSITION_UPDATED_THRESHOLD=50;var UPDATE_VIEWAREA_TIMEOUT=1000;function getCurrentHash(){return document.location.hash;}var _eventAbortController=/*#__PURE__*/new WeakMap();var _PDFHistory_brand=/*#__PURE__*/new WeakSet();var PDFHistory=/*#__PURE__*/function(){function PDFHistory(_ref33){var _this29=this;var linkService=_ref33.linkService,eventBus=_ref33.eventBus;_classCallCheck(this,PDFHistory);_classPrivateMethodInitSpec(this,_PDFHistory_brand);_classPrivateFieldInitSpec(this,_eventAbortController,null);this.linkService=linkService;this.eventBus=eventBus;this._initialized=false;this._fingerprint="";this.reset();this.eventBus._on("pagesinit",function(){_this29._isPagesLoaded=false;_this29.eventBus._on("pagesloaded",function(evt){_this29._isPagesLoaded=!!evt.pagesCount;},{once:true});});}return _createClass(PDFHistory,[{key:"initialize",value:function initialize(_ref34){var fingerprint=_ref34.fingerprint,_ref34$resetHistory=_ref34.resetHistory,resetHistory=_ref34$resetHistory===void 0?false:_ref34$resetHistory,_ref34$updateUrl=_ref34.updateUrl,updateUrl=_ref34$updateUrl===void 0?false:_ref34$updateUrl;if(!fingerprint||typeof fingerprint!=="string"){console.error('PDFHistory.initialize: The "fingerprint" must be a non-empty string.');return;}if(this._initialized){this.reset();}var reInitialized=this._fingerprint!==""&&this._fingerprint!==fingerprint;this._fingerprint=fingerprint;this._updateUrl=updateUrl===true;this._initialized=true;_assertClassBrand(_PDFHistory_brand,this,_bindEvents).call(this);var state=window.history.state;this._popStateInProgress=false;this._blockHashChange=0;this._currentHash=getCurrentHash();this._numPositionUpdates=0;this._uid=this._maxUid=0;this._destination=null;this._position=null;if(!_assertClassBrand(_PDFHistory_brand,this,_isValidState).call(this,state,true)||resetHistory){var _assertClassBrand$cal9=_assertClassBrand(_PDFHistory_brand,this,_parseCurrentHash).call(this,true),hash=_assertClassBrand$cal9.hash,page=_assertClassBrand$cal9.page,rotation=_assertClassBrand$cal9.rotation;if(!hash||reInitialized||resetHistory){_assertClassBrand(_PDFHistory_brand,this,_pushOrReplaceState).call(this,null,true);return;}_assertClassBrand(_PDFHistory_brand,this,_pushOrReplaceState).call(this,{hash:hash,page:page,rotation:rotation},true);return;}var destination=state.destination;_assertClassBrand(_PDFHistory_brand,this,_updateInternalState).call(this,destination,state.uid,true);if(destination.rotation!==undefined){this._initialRotation=destination.rotation;}if(destination.dest){this._initialBookmark=JSON.stringify(destination.dest);this._destination.page=null;}else if(destination.hash){this._initialBookmark=destination.hash;}else if(destination.page){this._initialBookmark="page=".concat(destination.page);}}},{key:"reset",value:function reset(){if(this._initialized){_assertClassBrand(_PDFHistory_brand,this,_pageHide).call(this);this._initialized=false;_assertClassBrand(_PDFHistory_brand,this,_unbindEvents).call(this);}if(this._updateViewareaTimeout){clearTimeout(this._updateViewareaTimeout);this._updateViewareaTimeout=null;}this._initialBookmark=null;this._initialRotation=null;}},{key:"push",value:function push(_ref35){var _this30=this;var _ref35$namedDest=_ref35.namedDest,namedDest=_ref35$namedDest===void 0?null:_ref35$namedDest,explicitDest=_ref35.explicitDest,pageNumber=_ref35.pageNumber;if(!this._initialized){return;}if(namedDest&&typeof namedDest!=="string"){console.error("PDFHistory.push: "+"\"".concat(namedDest,"\" is not a valid namedDest parameter."));return;}else if(!Array.isArray(explicitDest)){console.error("PDFHistory.push: "+"\"".concat(explicitDest,"\" is not a valid explicitDest parameter."));return;}else if(!_assertClassBrand(_PDFHistory_brand,this,_isValidPage).call(this,pageNumber)){if(pageNumber!==null||this._destination){console.error("PDFHistory.push: "+"\"".concat(pageNumber,"\" is not a valid pageNumber parameter."));return;}}var hash=namedDest||JSON.stringify(explicitDest);if(!hash){return;}var forceReplace=false;if(this._destination&&(isDestHashesEqual(this._destination.hash,hash)||isDestArraysEqual(this._destination.dest,explicitDest))){if(this._destination.page){return;}forceReplace=true;}if(this._popStateInProgress&&!forceReplace){return;}_assertClassBrand(_PDFHistory_brand,this,_pushOrReplaceState).call(this,{dest:explicitDest,hash:hash,page:pageNumber,rotation:this.linkService.rotation},forceReplace);if(!this._popStateInProgress){this._popStateInProgress=true;Promise.resolve().then(function(){_this30._popStateInProgress=false;});}}},{key:"pushPage",value:function pushPage(pageNumber){var _this$_destination,_this31=this;if(!this._initialized){return;}if(!_assertClassBrand(_PDFHistory_brand,this,_isValidPage).call(this,pageNumber)){console.error("PDFHistory.pushPage: \"".concat(pageNumber,"\" is not a valid page number."));return;}if(((_this$_destination=this._destination)===null||_this$_destination===void 0?void 0:_this$_destination.page)===pageNumber){return;}if(this._popStateInProgress){return;}_assertClassBrand(_PDFHistory_brand,this,_pushOrReplaceState).call(this,{dest:null,hash:"page=".concat(pageNumber),page:pageNumber,rotation:this.linkService.rotation});if(!this._popStateInProgress){this._popStateInProgress=true;Promise.resolve().then(function(){_this31._popStateInProgress=false;});}}},{key:"pushCurrentPosition",value:function pushCurrentPosition(){if(!this._initialized||this._popStateInProgress){return;}_assertClassBrand(_PDFHistory_brand,this,_tryPushCurrentPosition).call(this);}},{key:"back",value:function back(){if(!this._initialized||this._popStateInProgress){return;}var state=window.history.state;if(_assertClassBrand(_PDFHistory_brand,this,_isValidState).call(this,state)&&state.uid>0){window.history.back();}}},{key:"forward",value:function forward(){if(!this._initialized||this._popStateInProgress){return;}var state=window.history.state;if(_assertClassBrand(_PDFHistory_brand,this,_isValidState).call(this,state)&&state.uid<this._maxUid){window.history.forward();}}},{key:"popStateInProgress",get:function get(){return this._initialized&&(this._popStateInProgress||this._blockHashChange>0);}},{key:"initialBookmark",get:function get(){return this._initialized?this._initialBookmark:null;}},{key:"initialRotation",get:function get(){return this._initialized?this._initialRotation:null;}}]);}();function _pushOrReplaceState(destination){var forceReplace=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var shouldReplace=forceReplace||!this._destination;var newState={fingerprint:this._fingerprint,uid:shouldReplace?this._uid:this._uid+1,destination:destination};_assertClassBrand(_PDFHistory_brand,this,_updateInternalState).call(this,destination,newState.uid);var newUrl;if(this._updateUrl&&destination!==null&&destination!==void 0&&destination.hash){var baseUrl=document.location.href.split("#",1)[0];if(!baseUrl.startsWith("file://")){newUrl="".concat(baseUrl,"#").concat(destination.hash);}}if(shouldReplace){window.history.replaceState(newState,"",newUrl);}else{window.history.pushState(newState,"",newUrl);}}function _tryPushCurrentPosition(){var temporary=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;if(!this._position){return;}var position=this._position;if(temporary){position=Object.assign(Object.create(null),this._position);position.temporary=true;}if(!this._destination){_assertClassBrand(_PDFHistory_brand,this,_pushOrReplaceState).call(this,position);return;}if(this._destination.temporary){_assertClassBrand(_PDFHistory_brand,this,_pushOrReplaceState).call(this,position,true);return;}if(this._destination.hash===position.hash){return;}if(!this._destination.page&&(POSITION_UPDATED_THRESHOLD<=0||this._numPositionUpdates<=POSITION_UPDATED_THRESHOLD)){return;}var forceReplace=false;if(this._destination.page>=position.first&&this._destination.page<=position.page){if(this._destination.dest!==undefined||!this._destination.first){return;}forceReplace=true;}_assertClassBrand(_PDFHistory_brand,this,_pushOrReplaceState).call(this,position,forceReplace);}function _isValidPage(val){return Number.isInteger(val)&&val>0&&val<=this.linkService.pagesCount;}function _isValidState(state){var checkReload=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(!state){return false;}if(state.fingerprint!==this._fingerprint){if(checkReload){if(typeof state.fingerprint!=="string"||state.fingerprint.length!==this._fingerprint.length){return false;}var _performance$getEntri=performance.getEntriesByType("navigation"),_performance$getEntri2=_slicedToArray(_performance$getEntri,1),perfEntry=_performance$getEntri2[0];if((perfEntry===null||perfEntry===void 0?void 0:perfEntry.type)!=="reload"){return false;}}else{return false;}}if(!Number.isInteger(state.uid)||state.uid<0){return false;}if(state.destination===null||_typeof(state.destination)!=="object"){return false;}return true;}function _updateInternalState(destination,uid){var removeTemporary=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;if(this._updateViewareaTimeout){clearTimeout(this._updateViewareaTimeout);this._updateViewareaTimeout=null;}if(removeTemporary&&destination!==null&&destination!==void 0&&destination.temporary){delete destination.temporary;}this._destination=destination;this._uid=uid;this._maxUid=Math.max(this._maxUid,uid);this._numPositionUpdates=0;}function _parseCurrentHash(){var checkNameddest=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var hash=unescape(getCurrentHash()).substring(1);var params=parseQueryString(hash);var nameddest=params.get("nameddest")||"";var page=params.get("page")|0;if(!_assertClassBrand(_PDFHistory_brand,this,_isValidPage).call(this,page)||checkNameddest&&nameddest.length>0){page=null;}return{hash:hash,page:page,rotation:this.linkService.rotation};}function _updateViewarea(_ref116){var _this102=this;var location=_ref116.location;if(this._updateViewareaTimeout){clearTimeout(this._updateViewareaTimeout);this._updateViewareaTimeout=null;}this._position={hash:location.pdfOpenParams.substring(1),page:this.linkService.page,first:location.pageNumber,rotation:location.rotation};if(this._popStateInProgress){return;}if(POSITION_UPDATED_THRESHOLD>0&&this._isPagesLoaded&&this._destination&&!this._destination.page){this._numPositionUpdates++;}if(UPDATE_VIEWAREA_TIMEOUT>0){this._updateViewareaTimeout=setTimeout(function(){if(!_this102._popStateInProgress){_assertClassBrand(_PDFHistory_brand,_this102,_tryPushCurrentPosition).call(_this102,true);}_this102._updateViewareaTimeout=null;},UPDATE_VIEWAREA_TIMEOUT);}}function _popState(_ref117){var _this103=this;var state=_ref117.state;var newHash=getCurrentHash(),hashChanged=this._currentHash!==newHash;this._currentHash=newHash;if(!state){this._uid++;var _assertClassBrand$cal11=_assertClassBrand(_PDFHistory_brand,this,_parseCurrentHash).call(this),hash=_assertClassBrand$cal11.hash,page=_assertClassBrand$cal11.page,rotation=_assertClassBrand$cal11.rotation;_assertClassBrand(_PDFHistory_brand,this,_pushOrReplaceState).call(this,{hash:hash,page:page,rotation:rotation},true);return;}if(!_assertClassBrand(_PDFHistory_brand,this,_isValidState).call(this,state)){return;}this._popStateInProgress=true;if(hashChanged){this._blockHashChange++;waitOnEventOrTimeout({target:window,name:"hashchange",delay:HASH_CHANGE_TIMEOUT}).then(function(){_this103._blockHashChange--;});}var destination=state.destination;_assertClassBrand(_PDFHistory_brand,this,_updateInternalState).call(this,destination,state.uid,true);if(isValidRotation(destination.rotation)){this.linkService.rotation=destination.rotation;}if(destination.dest){this.linkService.goToDestination(destination.dest);}else if(destination.hash){this.linkService.setHash(destination.hash);}else if(destination.page){this.linkService.page=destination.page;}Promise.resolve().then(function(){_this103._popStateInProgress=false;});}function _pageHide(){if(!this._destination||this._destination.temporary){_assertClassBrand(_PDFHistory_brand,this,_tryPushCurrentPosition).call(this);}}function _bindEvents(){if(_classPrivateFieldGet(_eventAbortController,this)){return;}_classPrivateFieldSet(_eventAbortController,this,new AbortController());var _classPrivateFieldGet62=_classPrivateFieldGet(_eventAbortController,this),signal=_classPrivateFieldGet62.signal;this.eventBus._on("updateviewarea",_assertClassBrand(_PDFHistory_brand,this,_updateViewarea).bind(this),{signal:signal});window.addEventListener("popstate",_assertClassBrand(_PDFHistory_brand,this,_popState).bind(this),{signal:signal});window.addEventListener("pagehide",_assertClassBrand(_PDFHistory_brand,this,_pageHide).bind(this),{signal:signal});}function _unbindEvents(){var _classPrivateFieldGet63;(_classPrivateFieldGet63=_classPrivateFieldGet(_eventAbortController,this))===null||_classPrivateFieldGet63===void 0||_classPrivateFieldGet63.abort();_classPrivateFieldSet(_eventAbortController,this,null);}function isDestHashesEqual(destHash,pushHash){if(typeof destHash!=="string"||typeof pushHash!=="string"){return false;}if(destHash===pushHash){return true;}var nameddest=parseQueryString(destHash).get("nameddest");if(nameddest===pushHash){return true;}return false;}function isDestArraysEqual(firstDest,secondDest){function isEntryEqual(first,second){if(_typeof(first)!==_typeof(second)){return false;}if(Array.isArray(first)||Array.isArray(second)){return false;}if(first!==null&&_typeof(first)==="object"&&second!==null){if(Object.keys(first).length!==Object.keys(second).length){return false;}for(var key in first){if(!isEntryEqual(first[key],second[key])){return false;}}return true;}return first===second||Number.isNaN(first)&&Number.isNaN(second);}if(!(Array.isArray(firstDest)&&Array.isArray(secondDest))){return false;}if(firstDest.length!==secondDest.length){return false;}for(var i=0,ii=firstDest.length;i<ii;i++){if(!isEntryEqual(firstDest[i],secondDest[i])){return false;}}return true;};// ./web/pdf_layer_viewer.js
var _PDFLayerViewer_brand=/*#__PURE__*/new WeakSet();var PDFLayerViewer=/*#__PURE__*/function(_BaseTreeViewer2){function PDFLayerViewer(options){var _this32;_classCallCheck(this,PDFLayerViewer);_this32=_callSuper(this,PDFLayerViewer,[options]);_classPrivateMethodInitSpec(_this32,_PDFLayerViewer_brand);_this32.eventBus._on("optionalcontentconfigchanged",function(evt){_assertClassBrand(_PDFLayerViewer_brand,_this32,_updateLayers).call(_this32,evt.promise);});_this32.eventBus._on("resetlayers",function(){_assertClassBrand(_PDFLayerViewer_brand,_this32,_updateLayers).call(_this32);});_this32.eventBus._on("togglelayerstree",_this32._toggleAllTreeItems.bind(_this32));return _this32;}_inherits(PDFLayerViewer,_BaseTreeViewer2);return _createClass(PDFLayerViewer,[{key:"reset",value:function reset(){var _this$_optionalConten;_superPropGet(PDFLayerViewer,"reset",this,3)([]);this._optionalContentConfig=null;(_this$_optionalConten=this._optionalContentVisibility)===null||_this$_optionalConten===void 0||_this$_optionalConten.clear();this._optionalContentVisibility=null;}},{key:"_dispatchEvent",value:function _dispatchEvent(layersCount){this.eventBus.dispatch("layersloaded",{source:this,layersCount:layersCount});}},{key:"_bindLink",value:function _bindLink(element,_ref36){var _this33=this;var groupId=_ref36.groupId,input=_ref36.input;var setVisibility=function setVisibility(){var visible=input.checked;_this33._optionalContentConfig.setVisibility(groupId,visible);var cached=_this33._optionalContentVisibility.get(groupId);if(cached){cached.visible=visible;}_this33.eventBus.dispatch("optionalcontentconfig",{source:_this33,promise:Promise.resolve(_this33._optionalContentConfig)});};element.onclick=function(evt){if(evt.target===input){setVisibility();return true;}else if(evt.target!==element){return true;}input.checked=!input.checked;setVisibility();return false;};}},{key:"_setNestedName",value:function _setNestedName(element,_ref37){var _ref37$name=_ref37.name,name=_ref37$name===void 0?null:_ref37$name;if(typeof name==="string"){element.textContent=this._normalizeTextContent(name);return;}element.setAttribute("data-l10n-id","pdfjs-additional-layers");element.style.fontStyle="italic";this._l10n.translateOnce(element);}},{key:"_addToggleButton",value:function _addToggleButton(div,_ref38){var _ref38$name=_ref38.name,name=_ref38$name===void 0?null:_ref38$name;_superPropGet(PDFLayerViewer,"_addToggleButton",this,3)([div,name===null]);}},{key:"_toggleAllTreeItems",value:function _toggleAllTreeItems(){if(!this._optionalContentConfig){return;}_superPropGet(PDFLayerViewer,"_toggleAllTreeItems",this,3)([]);}},{key:"render",value:function render(_ref39){var optionalContentConfig=_ref39.optionalContentConfig,pdfDocument=_ref39.pdfDocument;if(this._optionalContentConfig){this.reset();}this._optionalContentConfig=optionalContentConfig||null;this._pdfDocument=pdfDocument||null;var groups=optionalContentConfig===null||optionalContentConfig===void 0?void 0:optionalContentConfig.getOrder();if(!groups){this._dispatchEvent(0);return;}this._optionalContentVisibility=new Map();var fragment=document.createDocumentFragment(),queue=[{parent:fragment,groups:groups}];var layersCount=0,hasAnyNesting=false;while(queue.length>0){var levelData=queue.shift();var _iterator21=_createForOfIteratorHelper(levelData.groups),_step21;try{for(_iterator21.s();!(_step21=_iterator21.n()).done;){var groupId=_step21.value;var div=document.createElement("div");div.className="treeItem";var element=document.createElement("a");div.append(element);if(_typeof(groupId)==="object"){hasAnyNesting=true;this._addToggleButton(div,groupId);this._setNestedName(element,groupId);var itemsDiv=document.createElement("div");itemsDiv.className="treeItems";div.append(itemsDiv);queue.push({parent:itemsDiv,groups:groupId.order});}else{var group=optionalContentConfig.getGroup(groupId);var input=document.createElement("input");this._bindLink(element,{groupId:groupId,input:input});input.type="checkbox";input.checked=group.visible;this._optionalContentVisibility.set(groupId,{input:input,visible:input.checked});var label=document.createElement("label");label.textContent=this._normalizeTextContent(group.name);label.append(input);element.append(label);layersCount++;}levelData.parent.append(div);}}catch(err){_iterator21.e(err);}finally{_iterator21.f();}}this._finishRendering(fragment,layersCount,hasAnyNesting);}}]);}(BaseTreeViewer);function _updateLayers(){return _updateLayers2.apply(this,arguments);}function _updateLayers2(){_updateLayers2=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee116(){var promise,pdfDocument,optionalContentConfig,_iterator75,_step75,_step75$value,groupId,cached,group,_args118=arguments;return _regenerator().w(function(_context117){while(1)switch(_context117.n){case 0:promise=_args118.length>0&&_args118[0]!==undefined?_args118[0]:null;if(this._optionalContentConfig){_context117.n=1;break;}return _context117.a(2);case 1:pdfDocument=this._pdfDocument;_context117.n=2;return promise||pdfDocument.getOptionalContentConfig({intent:"display"});case 2:optionalContentConfig=_context117.v;if(!(pdfDocument!==this._pdfDocument)){_context117.n=3;break;}return _context117.a(2);case 3:if(!promise){_context117.n=4;break;}_iterator75=_createForOfIteratorHelper(this._optionalContentVisibility);try{for(_iterator75.s();!(_step75=_iterator75.n()).done;){_step75$value=_slicedToArray(_step75.value,2),groupId=_step75$value[0],cached=_step75$value[1];group=optionalContentConfig.getGroup(groupId);if(group&&cached.visible!==group.visible){cached.input.checked=cached.visible=!cached.visible;}}}catch(err){_iterator75.e(err);}finally{_iterator75.f();}return _context117.a(2);case 4:this.eventBus.dispatch("optionalcontentconfig",{source:this,promise:Promise.resolve(optionalContentConfig)});this.render({optionalContentConfig:optionalContentConfig,pdfDocument:this._pdfDocument});case 5:return _context117.a(2);}},_callee116,this);}));return _updateLayers2.apply(this,arguments);};// ./web/pdf_outline_viewer.js
var PDFOutlineViewer=/*#__PURE__*/function(_BaseTreeViewer3){function PDFOutlineViewer(options){var _this34;_classCallCheck(this,PDFOutlineViewer);_this34=_callSuper(this,PDFOutlineViewer,[options]);_this34.linkService=options.linkService;_this34.downloadManager=options.downloadManager;_this34.eventBus._on("toggleoutlinetree",_this34._toggleAllTreeItems.bind(_this34));_this34.eventBus._on("currentoutlineitem",_this34._currentOutlineItem.bind(_this34));_this34.eventBus._on("pagechanging",function(evt){_this34._currentPageNumber=evt.pageNumber;});_this34.eventBus._on("pagesloaded",function(evt){var _this34$_currentOutli;_this34._isPagesLoaded=!!evt.pagesCount;(_this34$_currentOutli=_this34._currentOutlineItemCapability)===null||_this34$_currentOutli===void 0||_this34$_currentOutli.resolve(_this34._isPagesLoaded);});_this34.eventBus._on("sidebarviewchanged",function(evt){_this34._sidebarView=evt.view;});return _this34;}_inherits(PDFOutlineViewer,_BaseTreeViewer3);return _createClass(PDFOutlineViewer,[{key:"reset",value:function reset(){var _this$_currentOutline;_superPropGet(PDFOutlineViewer,"reset",this,3)([]);this._outline=null;this._pageNumberToDestHashCapability=null;this._currentPageNumber=1;this._isPagesLoaded=null;(_this$_currentOutline=this._currentOutlineItemCapability)===null||_this$_currentOutline===void 0||_this$_currentOutline.resolve(false);this._currentOutlineItemCapability=null;}},{key:"_dispatchEvent",value:function _dispatchEvent(outlineCount){var _this$_pdfDocument;this._currentOutlineItemCapability=Promise.withResolvers();if(outlineCount===0||(_this$_pdfDocument=this._pdfDocument)!==null&&_this$_pdfDocument!==void 0&&_this$_pdfDocument.loadingParams.disableAutoFetch){this._currentOutlineItemCapability.resolve(false);}else if(this._isPagesLoaded!==null){this._currentOutlineItemCapability.resolve(this._isPagesLoaded);}this.eventBus.dispatch("outlineloaded",{source:this,outlineCount:outlineCount,currentOutlineItemPromise:this._currentOutlineItemCapability.promise});}},{key:"_bindLink",value:function _bindLink(element,_ref40){var _this35=this;var url=_ref40.url,newWindow=_ref40.newWindow,action=_ref40.action,attachment=_ref40.attachment,dest=_ref40.dest,setOCGState=_ref40.setOCGState;var linkService=this.linkService;if(url){linkService.addLinkAttributes(element,url,newWindow);return;}if(action){element.href=linkService.getAnchorUrl("");element.onclick=function(){linkService.executeNamedAction(action);return false;};return;}if(attachment){element.href=linkService.getAnchorUrl("");element.onclick=function(){_this35.downloadManager.openOrDownloadData(attachment.content,attachment.filename);return false;};return;}if(setOCGState){element.href=linkService.getAnchorUrl("");element.onclick=function(){linkService.executeSetOCGState(setOCGState);return false;};return;}element.href=linkService.getDestinationHash(dest);element.onclick=function(evt){_this35._updateCurrentTreeItem(evt.target.parentNode);if(dest){linkService.goToDestination(dest);}return false;};}},{key:"_setStyles",value:function _setStyles(element,_ref41){var bold=_ref41.bold,italic=_ref41.italic;if(bold){element.style.fontWeight="bold";}if(italic){element.style.fontStyle="italic";}}},{key:"_addToggleButton",value:function _addToggleButton(div,_ref42){var count=_ref42.count,items=_ref42.items;var hidden=false;if(count<0){var totalCount=items.length;if(totalCount>0){var queue=_toConsumableArray(items);while(queue.length>0){var _queue$shift=queue.shift(),nestedCount=_queue$shift.count,nestedItems=_queue$shift.items;if(nestedCount>0&&nestedItems.length>0){totalCount+=nestedItems.length;queue.push.apply(queue,_toConsumableArray(nestedItems));}}}if(Math.abs(count)===totalCount){hidden=true;}}_superPropGet(PDFOutlineViewer,"_addToggleButton",this,3)([div,hidden]);}},{key:"_toggleAllTreeItems",value:function _toggleAllTreeItems(){if(!this._outline){return;}_superPropGet(PDFOutlineViewer,"_toggleAllTreeItems",this,3)([]);}},{key:"render",value:function render(_ref43){var outline=_ref43.outline,pdfDocument=_ref43.pdfDocument;if(this._outline){this.reset();}this._outline=outline||null;this._pdfDocument=pdfDocument||null;if(!outline){this._dispatchEvent(0);return;}var fragment=document.createDocumentFragment();var queue=[{parent:fragment,items:outline}];var outlineCount=0,hasAnyNesting=false;while(queue.length>0){var levelData=queue.shift();var _iterator22=_createForOfIteratorHelper(levelData.items),_step22;try{for(_iterator22.s();!(_step22=_iterator22.n()).done;){var item=_step22.value;var div=document.createElement("div");div.className="treeItem";var element=document.createElement("a");this._bindLink(element,item);this._setStyles(element,item);element.textContent=this._normalizeTextContent(item.title);div.append(element);if(item.items.length>0){hasAnyNesting=true;this._addToggleButton(div,item);var itemsDiv=document.createElement("div");itemsDiv.className="treeItems";div.append(itemsDiv);queue.push({parent:itemsDiv,items:item.items});}levelData.parent.append(div);outlineCount++;}}catch(err){_iterator22.e(err);}finally{_iterator22.f();}}this._finishRendering(fragment,outlineCount,hasAnyNesting);}},{key:"_currentOutlineItem",value:function(){var _currentOutlineItem2=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee44(){var pageNumberToDestHash,i,destHash,linkElement;return _regenerator().w(function(_context44){while(1)switch(_context44.n){case 0:if(this._isPagesLoaded){_context44.n=1;break;}throw new Error("_currentOutlineItem: All pages have not been loaded.");case 1:if(!(!this._outline||!this._pdfDocument)){_context44.n=2;break;}return _context44.a(2);case 2:_context44.n=3;return this._getPageNumberToDestHash(this._pdfDocument);case 3:pageNumberToDestHash=_context44.v;if(pageNumberToDestHash){_context44.n=4;break;}return _context44.a(2);case 4:this._updateCurrentTreeItem(null);if(!(this._sidebarView!==SidebarView.OUTLINE)){_context44.n=5;break;}return _context44.a(2);case 5:i=this._currentPageNumber;case 6:if(!(i>0)){_context44.n=10;break;}destHash=pageNumberToDestHash.get(i);if(destHash){_context44.n=7;break;}return _context44.a(3,9);case 7:linkElement=this.container.querySelector("a[href=\"".concat(destHash,"\"]"));if(linkElement){_context44.n=8;break;}return _context44.a(3,9);case 8:this._scrollToCurrentTreeItem(linkElement.parentNode);return _context44.a(3,10);case 9:i--;_context44.n=6;break;case 10:return _context44.a(2);}},_callee44,this);}));function _currentOutlineItem(){return _currentOutlineItem2.apply(this,arguments);}return _currentOutlineItem;}()},{key:"_getPageNumberToDestHash",value:function(){var _getPageNumberToDestHash2=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee45(pdfDocument){var pageNumberToDestHash,pageNumberNesting,queue,levelData,currentNesting,_iterator23,_step23,_step23$value,dest,items,explicitDest,pageNumber,_explicitDest3,_explicitDest4,destRef,destHash,_t12;return _regenerator().w(function(_context45){while(1)switch(_context45.n){case 0:if(!this._pageNumberToDestHashCapability){_context45.n=1;break;}return _context45.a(2,this._pageNumberToDestHashCapability.promise);case 1:this._pageNumberToDestHashCapability=Promise.withResolvers();pageNumberToDestHash=new Map(),pageNumberNesting=new Map();queue=[{nesting:0,items:this._outline}];case 2:if(!(queue.length>0)){_context45.n=14;break;}levelData=queue.shift(),currentNesting=levelData.nesting;_iterator23=_createForOfIteratorHelper(levelData.items);_context45.p=3;_iterator23.s();case 4:if((_step23=_iterator23.n()).done){_context45.n=10;break;}_step23$value=_step23.value,dest=_step23$value.dest,items=_step23$value.items;explicitDest=void 0,pageNumber=void 0;if(!(typeof dest==="string")){_context45.n=7;break;}_context45.n=5;return pdfDocument.getDestination(dest);case 5:explicitDest=_context45.v;if(!(pdfDocument!==this._pdfDocument)){_context45.n=6;break;}return _context45.a(2,null);case 6:_context45.n=8;break;case 7:explicitDest=dest;case 8:if(Array.isArray(explicitDest)){_explicitDest3=explicitDest,_explicitDest4=_slicedToArray(_explicitDest3,1),destRef=_explicitDest4[0];if(destRef&&_typeof(destRef)==="object"){pageNumber=pdfDocument.cachedPageNumber(destRef);}else if(Number.isInteger(destRef)){pageNumber=destRef+1;}if(Number.isInteger(pageNumber)&&(!pageNumberToDestHash.has(pageNumber)||currentNesting>pageNumberNesting.get(pageNumber))){destHash=this.linkService.getDestinationHash(dest);pageNumberToDestHash.set(pageNumber,destHash);pageNumberNesting.set(pageNumber,currentNesting);}}if(items.length>0){queue.push({nesting:currentNesting+1,items:items});}case 9:_context45.n=4;break;case 10:_context45.n=12;break;case 11:_context45.p=11;_t12=_context45.v;_iterator23.e(_t12);case 12:_context45.p=12;_iterator23.f();return _context45.f(12);case 13:_context45.n=2;break;case 14:this._pageNumberToDestHashCapability.resolve(pageNumberToDestHash.size>0?pageNumberToDestHash:null);return _context45.a(2,this._pageNumberToDestHashCapability.promise);}},_callee45,this,[[3,11,12,13]]);}));function _getPageNumberToDestHash(_x37){return _getPageNumberToDestHash2.apply(this,arguments);}return _getPageNumberToDestHash;}()}]);}(BaseTreeViewer);;// ./web/pdf_presentation_mode.js
var DELAY_BEFORE_HIDING_CONTROLS=3000;var ACTIVE_SELECTOR="pdfPresentationMode";var CONTROLS_SELECTOR="pdfPresentationModeControls";var MOUSE_SCROLL_COOLDOWN_TIME=50;var PAGE_SWITCH_THRESHOLD=0.1;var SWIPE_MIN_DISTANCE_THRESHOLD=50;var SWIPE_ANGLE_THRESHOLD=Math.PI/6;var _state2=/*#__PURE__*/new WeakMap();var _args46=/*#__PURE__*/new WeakMap();var _fullscreenChangeAbortController=/*#__PURE__*/new WeakMap();var _windowAbortController=/*#__PURE__*/new WeakMap();var _PDFPresentationMode_brand=/*#__PURE__*/new WeakSet();var PDFPresentationMode=/*#__PURE__*/function(){function PDFPresentationMode(_ref44){var container=_ref44.container,pdfViewer=_ref44.pdfViewer,eventBus=_ref44.eventBus;_classCallCheck(this,PDFPresentationMode);_classPrivateMethodInitSpec(this,_PDFPresentationMode_brand);_classPrivateFieldInitSpec(this,_state2,PresentationModeState.UNKNOWN);_classPrivateFieldInitSpec(this,_args46,null);_classPrivateFieldInitSpec(this,_fullscreenChangeAbortController,null);_classPrivateFieldInitSpec(this,_windowAbortController,null);this.container=container;this.pdfViewer=pdfViewer;this.eventBus=eventBus;this.contextMenuOpen=false;this.mouseScrollTimeStamp=0;this.mouseScrollDelta=0;this.touchSwipeState=null;}return _createClass(PDFPresentationMode,[{key:"request",value:function(){var _request=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee46(){var container,pdfViewer,promise,_t13;return _regenerator().w(function(_context46){while(1)switch(_context46.n){case 0:container=this.container,pdfViewer=this.pdfViewer;if(!(this.active||!pdfViewer.pagesCount||!container.requestFullscreen)){_context46.n=1;break;}return _context46.a(2,false);case 1:_assertClassBrand(_PDFPresentationMode_brand,this,_addFullscreenChangeListeners).call(this);_assertClassBrand(_PDFPresentationMode_brand,this,_notifyStateChange).call(this,PresentationModeState.CHANGING);promise=container.requestFullscreen();_classPrivateFieldSet(_args46,this,{pageNumber:pdfViewer.currentPageNumber,scaleValue:pdfViewer.currentScaleValue,scrollMode:pdfViewer.scrollMode,spreadMode:null,annotationEditorMode:null});if(pdfViewer.spreadMode!==SpreadMode.NONE&&!(pdfViewer.pageViewsReady&&pdfViewer.hasEqualPageSizes)){console.warn("Ignoring Spread modes when entering PresentationMode, "+"since the document may contain varying page sizes.");_classPrivateFieldGet(_args46,this).spreadMode=pdfViewer.spreadMode;}if(pdfViewer.annotationEditorMode!==AnnotationEditorType.DISABLE){_classPrivateFieldGet(_args46,this).annotationEditorMode=pdfViewer.annotationEditorMode;}_context46.p=2;_context46.n=3;return promise;case 3:pdfViewer.focus();return _context46.a(2,true);case 4:_context46.p=4;_t13=_context46.v;_assertClassBrand(_PDFPresentationMode_brand,this,_removeFullscreenChangeListeners).call(this);_assertClassBrand(_PDFPresentationMode_brand,this,_notifyStateChange).call(this,PresentationModeState.NORMAL);return _context46.a(2,false);}},_callee46,this,[[2,4]]);}));function request(){return _request.apply(this,arguments);}return request;}()},{key:"active",get:function get(){return _classPrivateFieldGet(_state2,this)===PresentationModeState.CHANGING||_classPrivateFieldGet(_state2,this)===PresentationModeState.FULLSCREEN;}}]);}();function _mouseWheel(evt){if(!this.active){return;}evt.preventDefault();var delta=normalizeWheelEventDelta(evt);var currentTime=Date.now();var storedTime=this.mouseScrollTimeStamp;if(currentTime>storedTime&&currentTime-storedTime<MOUSE_SCROLL_COOLDOWN_TIME){return;}if(this.mouseScrollDelta>0&&delta<0||this.mouseScrollDelta<0&&delta>0){_assertClassBrand(_PDFPresentationMode_brand,this,_resetMouseScrollState).call(this);}this.mouseScrollDelta+=delta;if(Math.abs(this.mouseScrollDelta)>=PAGE_SWITCH_THRESHOLD){var totalDelta=this.mouseScrollDelta;_assertClassBrand(_PDFPresentationMode_brand,this,_resetMouseScrollState).call(this);var success=totalDelta>0?this.pdfViewer.previousPage():this.pdfViewer.nextPage();if(success){this.mouseScrollTimeStamp=currentTime;}}}function _notifyStateChange(state){_classPrivateFieldSet(_state2,this,state);this.eventBus.dispatch("presentationmodechanged",{source:this,state:state});}function _enter(){var _this104=this;_assertClassBrand(_PDFPresentationMode_brand,this,_notifyStateChange).call(this,PresentationModeState.FULLSCREEN);this.container.classList.add(ACTIVE_SELECTOR);setTimeout(function(){_this104.pdfViewer.scrollMode=ScrollMode.PAGE;if(_classPrivateFieldGet(_args46,_this104).spreadMode!==null){_this104.pdfViewer.spreadMode=SpreadMode.NONE;}_this104.pdfViewer.currentPageNumber=_classPrivateFieldGet(_args46,_this104).pageNumber;_this104.pdfViewer.currentScaleValue="page-fit";if(_classPrivateFieldGet(_args46,_this104).annotationEditorMode!==null){_this104.pdfViewer.annotationEditorMode={mode:AnnotationEditorType.NONE};}},0);_assertClassBrand(_PDFPresentationMode_brand,this,_addWindowListeners).call(this);_assertClassBrand(_PDFPresentationMode_brand,this,_showControls).call(this);this.contextMenuOpen=false;document.getSelection().empty();}function _exit(){var _this105=this;var pageNumber=this.pdfViewer.currentPageNumber;this.container.classList.remove(ACTIVE_SELECTOR);setTimeout(function(){_assertClassBrand(_PDFPresentationMode_brand,_this105,_removeFullscreenChangeListeners).call(_this105);_assertClassBrand(_PDFPresentationMode_brand,_this105,_notifyStateChange).call(_this105,PresentationModeState.NORMAL);_this105.pdfViewer.scrollMode=_classPrivateFieldGet(_args46,_this105).scrollMode;if(_classPrivateFieldGet(_args46,_this105).spreadMode!==null){_this105.pdfViewer.spreadMode=_classPrivateFieldGet(_args46,_this105).spreadMode;}_this105.pdfViewer.currentScaleValue=_classPrivateFieldGet(_args46,_this105).scaleValue;_this105.pdfViewer.currentPageNumber=pageNumber;if(_classPrivateFieldGet(_args46,_this105).annotationEditorMode!==null){_this105.pdfViewer.annotationEditorMode={mode:_classPrivateFieldGet(_args46,_this105).annotationEditorMode};}_classPrivateFieldSet(_args46,_this105,null);},0);_assertClassBrand(_PDFPresentationMode_brand,this,_removeWindowListeners).call(this);_assertClassBrand(_PDFPresentationMode_brand,this,_hideControls).call(this);_assertClassBrand(_PDFPresentationMode_brand,this,_resetMouseScrollState).call(this);this.contextMenuOpen=false;}function _mouseDown(evt){var _evt$target$parentNod;if(this.contextMenuOpen){this.contextMenuOpen=false;evt.preventDefault();return;}if(evt.button!==0){return;}if(evt.target.href&&(_evt$target$parentNod=evt.target.parentNode)!==null&&_evt$target$parentNod!==void 0&&_evt$target$parentNod.hasAttribute("data-internal-link")){return;}evt.preventDefault();if(evt.shiftKey){this.pdfViewer.previousPage();}else{this.pdfViewer.nextPage();}}function _contextMenu(){this.contextMenuOpen=true;}function _showControls(){var _this106=this;if(this.controlsTimeout){clearTimeout(this.controlsTimeout);}else{this.container.classList.add(CONTROLS_SELECTOR);}this.controlsTimeout=setTimeout(function(){_this106.container.classList.remove(CONTROLS_SELECTOR);delete _this106.controlsTimeout;},DELAY_BEFORE_HIDING_CONTROLS);}function _hideControls(){if(!this.controlsTimeout){return;}clearTimeout(this.controlsTimeout);this.container.classList.remove(CONTROLS_SELECTOR);delete this.controlsTimeout;}function _resetMouseScrollState(){this.mouseScrollTimeStamp=0;this.mouseScrollDelta=0;}function _touchSwipe(evt){if(!this.active){return;}if(evt.touches.length>1){this.touchSwipeState=null;return;}switch(evt.type){case"touchstart":this.touchSwipeState={startX:evt.touches[0].pageX,startY:evt.touches[0].pageY,endX:evt.touches[0].pageX,endY:evt.touches[0].pageY};break;case"touchmove":if(this.touchSwipeState===null){return;}this.touchSwipeState.endX=evt.touches[0].pageX;this.touchSwipeState.endY=evt.touches[0].pageY;evt.preventDefault();break;case"touchend":if(this.touchSwipeState===null){return;}var delta=0;var dx=this.touchSwipeState.endX-this.touchSwipeState.startX;var dy=this.touchSwipeState.endY-this.touchSwipeState.startY;var absAngle=Math.abs(Math.atan2(dy,dx));if(Math.abs(dx)>SWIPE_MIN_DISTANCE_THRESHOLD&&(absAngle<=SWIPE_ANGLE_THRESHOLD||absAngle>=Math.PI-SWIPE_ANGLE_THRESHOLD)){delta=dx;}else if(Math.abs(dy)>SWIPE_MIN_DISTANCE_THRESHOLD&&Math.abs(absAngle-Math.PI/2)<=SWIPE_ANGLE_THRESHOLD){delta=dy;}if(delta>0){this.pdfViewer.previousPage();}else if(delta<0){this.pdfViewer.nextPage();}break;}}function _addWindowListeners(){if(_classPrivateFieldGet(_windowAbortController,this)){return;}_classPrivateFieldSet(_windowAbortController,this,new AbortController());var _classPrivateFieldGet64=_classPrivateFieldGet(_windowAbortController,this),signal=_classPrivateFieldGet64.signal;var touchSwipeBind=_assertClassBrand(_PDFPresentationMode_brand,this,_touchSwipe).bind(this);window.addEventListener("mousemove",_assertClassBrand(_PDFPresentationMode_brand,this,_showControls).bind(this),{signal:signal});window.addEventListener("mousedown",_assertClassBrand(_PDFPresentationMode_brand,this,_mouseDown).bind(this),{signal:signal});window.addEventListener("wheel",_assertClassBrand(_PDFPresentationMode_brand,this,_mouseWheel).bind(this),{passive:false,signal:signal});window.addEventListener("keydown",_assertClassBrand(_PDFPresentationMode_brand,this,_resetMouseScrollState).bind(this),{signal:signal});window.addEventListener("contextmenu",_assertClassBrand(_PDFPresentationMode_brand,this,_contextMenu).bind(this),{signal:signal});window.addEventListener("touchstart",touchSwipeBind,{signal:signal});window.addEventListener("touchmove",touchSwipeBind,{signal:signal});window.addEventListener("touchend",touchSwipeBind,{signal:signal});}function _removeWindowListeners(){var _classPrivateFieldGet65;(_classPrivateFieldGet65=_classPrivateFieldGet(_windowAbortController,this))===null||_classPrivateFieldGet65===void 0||_classPrivateFieldGet65.abort();_classPrivateFieldSet(_windowAbortController,this,null);}function _addFullscreenChangeListeners(){var _this107=this;if(_classPrivateFieldGet(_fullscreenChangeAbortController,this)){return;}_classPrivateFieldSet(_fullscreenChangeAbortController,this,new AbortController());window.addEventListener("fullscreenchange",function(){if(document.fullscreenElement){_assertClassBrand(_PDFPresentationMode_brand,_this107,_enter).call(_this107);}else{_assertClassBrand(_PDFPresentationMode_brand,_this107,_exit).call(_this107);}},{signal:_classPrivateFieldGet(_fullscreenChangeAbortController,this).signal});}function _removeFullscreenChangeListeners(){var _classPrivateFieldGet66;(_classPrivateFieldGet66=_classPrivateFieldGet(_fullscreenChangeAbortController,this))===null||_classPrivateFieldGet66===void 0||_classPrivateFieldGet66.abort();_classPrivateFieldSet(_fullscreenChangeAbortController,this,null);};// ./web/xfa_layer_builder.js
var XfaLayerBuilder=/*#__PURE__*/function(){function XfaLayerBuilder(_ref45){var pdfPage=_ref45.pdfPage,_ref45$annotationStor=_ref45.annotationStorage,annotationStorage=_ref45$annotationStor===void 0?null:_ref45$annotationStor,linkService=_ref45.linkService,_ref45$xfaHtml=_ref45.xfaHtml,xfaHtml=_ref45$xfaHtml===void 0?null:_ref45$xfaHtml;_classCallCheck(this,XfaLayerBuilder);this.pdfPage=pdfPage;this.annotationStorage=annotationStorage;this.linkService=linkService;this.xfaHtml=xfaHtml;this.div=null;this._cancelled=false;}return _createClass(XfaLayerBuilder,[{key:"render",value:function(){var _render=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee47(_ref46){var viewport,_ref46$intent,intent,_parameters,xfaHtml,parameters;return _regenerator().w(function(_context47){while(1)switch(_context47.n){case 0:viewport=_ref46.viewport,_ref46$intent=_ref46.intent,intent=_ref46$intent===void 0?"display":_ref46$intent;if(!(intent==="print")){_context47.n=1;break;}_parameters={viewport:viewport.clone({dontFlip:true}),div:this.div,xfaHtml:this.xfaHtml,annotationStorage:this.annotationStorage,linkService:this.linkService,intent:intent};this.div=document.createElement("div");_parameters.div=this.div;return _context47.a(2,XfaLayer.render(_parameters));case 1:_context47.n=2;return this.pdfPage.getXfa();case 2:xfaHtml=_context47.v;if(!(this._cancelled||!xfaHtml)){_context47.n=3;break;}return _context47.a(2,{textDivs:[]});case 3:parameters={viewport:viewport.clone({dontFlip:true}),div:this.div,xfaHtml:xfaHtml,annotationStorage:this.annotationStorage,linkService:this.linkService,intent:intent};if(!this.div){_context47.n=4;break;}return _context47.a(2,XfaLayer.update(parameters));case 4:this.div=document.createElement("div");parameters.div=this.div;return _context47.a(2,XfaLayer.render(parameters));}},_callee47,this);}));function render(_x38){return _render.apply(this,arguments);}return render;}()},{key:"cancel",value:function cancel(){this._cancelled=true;}},{key:"hide",value:function hide(){if(!this.div){return;}this.div.hidden=true;}}]);}();;// ./web/print_utils.js
function getXfaHtmlForPrinting(printContainer,pdfDocument){var xfaHtml=pdfDocument.allXfaHtml;var linkService=new SimpleLinkService();var scale=Math.round(PixelsPerInch.PDF_TO_CSS_UNITS*100)/100;var _iterator24=_createForOfIteratorHelper(xfaHtml.children),_step24;try{for(_iterator24.s();!(_step24=_iterator24.n()).done;){var xfaPage=_step24.value;var page=document.createElement("div");page.className="xfaPrintedPage";printContainer.append(page);var builder=new XfaLayerBuilder({pdfPage:null,annotationStorage:pdfDocument.annotationStorage,linkService:linkService,xfaHtml:xfaPage});var viewport=getXfaPageViewport(xfaPage,{scale:scale});builder.render(viewport,"print");page.append(builder.div);}}catch(err){_iterator24.e(err);}finally{_iterator24.f();}};// ./web/pdf_print_service.js
var activeService=null;var dialog=null;var overlayManager=null;var viewerApp={initialized:false};function renderPage(activeServiceOnEntry,pdfDocument,pageNumber,size,printResolution,optionalContentConfigPromise,printAnnotationStoragePromise){var scratchCanvas=activeService.scratchCanvas;var PRINT_UNITS=printResolution/PixelsPerInch.PDF;scratchCanvas.width=Math.floor(size.width*PRINT_UNITS);scratchCanvas.height=Math.floor(size.height*PRINT_UNITS);var ctx=scratchCanvas.getContext("2d");ctx.save();ctx.fillStyle="rgb(255, 255, 255)";ctx.fillRect(0,0,scratchCanvas.width,scratchCanvas.height);ctx.restore();return Promise.all([pdfDocument.getPage(pageNumber),printAnnotationStoragePromise]).then(function(_ref47){var _ref48=_slicedToArray(_ref47,2),pdfPage=_ref48[0],printAnnotationStorage=_ref48[1];var renderContext={canvasContext:ctx,transform:[PRINT_UNITS,0,0,PRINT_UNITS,0,0],viewport:pdfPage.getViewport({scale:1,rotation:size.rotation}),intent:"print",annotationMode:AnnotationMode.ENABLE_STORAGE,optionalContentConfigPromise:optionalContentConfigPromise,printAnnotationStorage:printAnnotationStorage};var renderTask=pdfPage.render(renderContext);return renderTask.promise["catch"](function(reason){if(!(reason instanceof RenderingCancelledException)){console.error(reason);}throw reason;});});}var PDFPrintService=/*#__PURE__*/function(){function PDFPrintService(_ref49){var pdfDocument=_ref49.pdfDocument,pagesOverview=_ref49.pagesOverview,printContainer=_ref49.printContainer,printResolution=_ref49.printResolution,_ref49$printAnnotatio=_ref49.printAnnotationStoragePromise,printAnnotationStoragePromise=_ref49$printAnnotatio===void 0?null:_ref49$printAnnotatio;_classCallCheck(this,PDFPrintService);this.pdfDocument=pdfDocument;this.pagesOverview=pagesOverview;this.printContainer=printContainer;this._printResolution=printResolution||150;this._optionalContentConfigPromise=pdfDocument.getOptionalContentConfig({intent:"print"});this._printAnnotationStoragePromise=printAnnotationStoragePromise||Promise.resolve();this.currentPage=-1;this.scratchCanvas=document.createElement("canvas");}return _createClass(PDFPrintService,[{key:"layout",value:function layout(){this.throwIfInactive();var body=document.querySelector("body");body.setAttribute("data-pdfjsprinting",true);var _this$pagesOverview$=this.pagesOverview[0],width=_this$pagesOverview$.width,height=_this$pagesOverview$.height;var hasEqualPageSizes=this.pagesOverview.every(function(size){return size.width===width&&size.height===height;});if(!hasEqualPageSizes){console.warn("Not all pages have the same size. The printed result may be incorrect!");}this.pageStyleSheet=document.createElement("style");this.pageStyleSheet.textContent="@page { size: ".concat(width,"pt ").concat(height,"pt;}");body.append(this.pageStyleSheet);}},{key:"destroy",value:function destroy(){if(activeService!==this){return;}this.printContainer.textContent="";var body=document.querySelector("body");body.removeAttribute("data-pdfjsprinting");if(this.pageStyleSheet){this.pageStyleSheet.remove();this.pageStyleSheet=null;}this.scratchCanvas.width=this.scratchCanvas.height=0;this.scratchCanvas=null;activeService=null;ensureOverlay().then(function(){overlayManager.closeIfActive(dialog);});}},{key:"renderPages",value:function renderPages(){var _this36=this;if(this.pdfDocument.isPureXfa){getXfaHtmlForPrinting(this.printContainer,this.pdfDocument);return Promise.resolve();}var pageCount=this.pagesOverview.length;var _renderNextPage=function renderNextPage(resolve,reject){_this36.throwIfInactive();if(++_this36.currentPage>=pageCount){renderProgress(pageCount,pageCount);resolve();return;}var index=_this36.currentPage;renderProgress(index,pageCount);renderPage(_this36,_this36.pdfDocument,index+1,_this36.pagesOverview[index],_this36._printResolution,_this36._optionalContentConfigPromise,_this36._printAnnotationStoragePromise).then(_this36.useRenderedPage.bind(_this36)).then(function(){_renderNextPage(resolve,reject);},reject);};return new Promise(_renderNextPage);}},{key:"useRenderedPage",value:function useRenderedPage(){this.throwIfInactive();var img=document.createElement("img");this.scratchCanvas.toBlob(function(blob){img.src=URL.createObjectURL(blob);});var wrapper=document.createElement("div");wrapper.className="printedPage";wrapper.append(img);this.printContainer.append(wrapper);var _Promise$withResolver=Promise.withResolvers(),promise=_Promise$withResolver.promise,resolve=_Promise$withResolver.resolve,reject=_Promise$withResolver.reject;img.onload=resolve;img.onerror=reject;promise["catch"](function(){}).then(function(){URL.revokeObjectURL(img.src);});return promise;}},{key:"performPrint",value:function performPrint(){var _this37=this;this.throwIfInactive();return new Promise(function(resolve){setTimeout(function(){if(!_this37.active){resolve();return;}print.call(window);setTimeout(resolve,20);},0);});}},{key:"active",get:function get(){return this===activeService;}},{key:"throwIfInactive",value:function throwIfInactive(){if(!this.active){throw new Error("This print request was cancelled or completed.");}}}]);}();var print=window.print;window.print=function(){if(activeService){console.warn("Ignored window.print() because of a pending print job.");return;}ensureOverlay().then(function(){if(activeService){overlayManager.open(dialog);}});try{dispatchEvent("beforeprint");}finally{if(!activeService){console.error("Expected print service to be initialized.");ensureOverlay().then(function(){overlayManager.closeIfActive(dialog);});}else{var activeServiceOnEntry=activeService;activeService.renderPages().then(function(){return activeServiceOnEntry.performPrint();})["catch"](function(){}).then(function(){if(activeServiceOnEntry.active){abort();}});}}};function dispatchEvent(eventType){var event=new CustomEvent(eventType,{bubbles:false,cancelable:false,detail:"custom"});window.dispatchEvent(event);}function abort(){if(activeService){activeService.destroy();dispatchEvent("afterprint");}}function renderProgress(index,total){dialog||(dialog=document.getElementById("printServiceDialog"));var progress=Math.round(100*index/total);var progressBar=dialog.querySelector("progress");var progressPerc=dialog.querySelector(".relative-progress");progressBar.value=progress;progressPerc.setAttribute("data-l10n-args",JSON.stringify({progress:progress}));}window.addEventListener("keydown",function(event){if(event.keyCode===80&&(event.ctrlKey||event.metaKey)&&!event.altKey&&(!event.shiftKey||window.chrome||window.opera)){window.print();event.preventDefault();event.stopImmediatePropagation();}},true);if("onbeforeprint"in window){var stopPropagationIfNeeded=function stopPropagationIfNeeded(event){if(event.detail!=="custom"){event.stopImmediatePropagation();}};window.addEventListener("beforeprint",stopPropagationIfNeeded);window.addEventListener("afterprint",stopPropagationIfNeeded);}var overlayPromise;function ensureOverlay(){if(!overlayPromise){overlayManager=viewerApp.overlayManager;if(!overlayManager){throw new Error("The overlay manager has not yet been initialized.");}dialog||(dialog=document.getElementById("printServiceDialog"));overlayPromise=overlayManager.register(dialog,true);document.getElementById("printCancel").onclick=abort;dialog.addEventListener("close",abort);}return overlayPromise;}var PDFPrintServiceFactory=/*#__PURE__*/function(){function PDFPrintServiceFactory(){_classCallCheck(this,PDFPrintServiceFactory);}return _createClass(PDFPrintServiceFactory,null,[{key:"initGlobals",value:function initGlobals(app){viewerApp=app;}},{key:"supportsPrinting",get:function get(){return shadow(this,"supportsPrinting",true);}},{key:"createPrintService",value:function createPrintService(params){if(activeService){throw new Error("The print service is created and active.");}return activeService=new PDFPrintService(params);}}]);}();;// ./web/pdf_rendering_queue.js
var CLEANUP_TIMEOUT=30000;var PDFRenderingQueue=/*#__PURE__*/function(){function PDFRenderingQueue(){var _this38=this;_classCallCheck(this,PDFRenderingQueue);this.pdfViewer=null;this.pdfThumbnailViewer=null;this.onIdle=null;this.highestPriorityPage=null;this.idleTimeout=null;this.printing=false;this.isThumbnailViewEnabled=false;Object.defineProperty(this,"hasViewer",{value:function value(){return!!_this38.pdfViewer;}});}return _createClass(PDFRenderingQueue,[{key:"setViewer",value:function setViewer(pdfViewer){this.pdfViewer=pdfViewer;}},{key:"setThumbnailViewer",value:function setThumbnailViewer(pdfThumbnailViewer){this.pdfThumbnailViewer=pdfThumbnailViewer;}},{key:"isHighestPriority",value:function isHighestPriority(view){return this.highestPriorityPage===view.renderingId;}},{key:"renderHighestPriority",value:function renderHighestPriority(currentlyVisiblePages){var _this$pdfThumbnailVie;if(this.idleTimeout){clearTimeout(this.idleTimeout);this.idleTimeout=null;}if(this.pdfViewer.forceRendering(currentlyVisiblePages)){return;}if(this.isThumbnailViewEnabled&&(_this$pdfThumbnailVie=this.pdfThumbnailViewer)!==null&&_this$pdfThumbnailVie!==void 0&&_this$pdfThumbnailVie.forceRendering()){return;}if(this.printing){return;}if(this.onIdle){this.idleTimeout=setTimeout(this.onIdle.bind(this),CLEANUP_TIMEOUT);}}},{key:"getHighestPriority",value:function getHighestPriority(visible,views,scrolledDown){var preRenderExtra=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;var ignoreDetailViews=arguments.length>4&&arguments[4]!==undefined?arguments[4]:false;var visibleViews=visible.views,numVisible=visibleViews.length;if(numVisible===0){return null;}for(var i=0;i<numVisible;i++){var view=visibleViews[i].view;if(!this.isViewFinished(view)){return view;}}if(!ignoreDetailViews){for(var _i6=0;_i6<numVisible;_i6++){var detailView=visibleViews[_i6].view.detailView;if(detailView&&!this.isViewFinished(detailView)){return detailView;}}}var firstId=visible.first.id,lastId=visible.last.id;if(lastId-firstId+1>numVisible){var visibleIds=visible.ids;for(var _i7=1,ii=lastId-firstId;_i7<ii;_i7++){var holeId=scrolledDown?firstId+_i7:lastId-_i7;if(visibleIds.has(holeId)){continue;}var holeView=views[holeId-1];if(!this.isViewFinished(holeView)){return holeView;}}}var preRenderIndex=scrolledDown?lastId:firstId-2;var preRenderView=views[preRenderIndex];if(preRenderView&&!this.isViewFinished(preRenderView)){return preRenderView;}if(preRenderExtra){preRenderIndex+=scrolledDown?1:-1;preRenderView=views[preRenderIndex];if(preRenderView&&!this.isViewFinished(preRenderView)){return preRenderView;}}return null;}},{key:"isViewFinished",value:function isViewFinished(view){return view.renderingState===RenderingStates.FINISHED;}},{key:"renderView",value:function renderView(view){var _this39=this;switch(view.renderingState){case RenderingStates.FINISHED:return false;case RenderingStates.PAUSED:this.highestPriorityPage=view.renderingId;view.resume();break;case RenderingStates.RUNNING:this.highestPriorityPage=view.renderingId;break;case RenderingStates.INITIAL:this.highestPriorityPage=view.renderingId;view.draw()["finally"](function(){_this39.renderHighestPriority();})["catch"](function(reason){if(reason instanceof RenderingCancelledException){return;}console.error("renderView:",reason);});break;}return true;}}]);}();;// ./web/pdf_scripting_manager.js
var _closeCapability=/*#__PURE__*/new WeakMap();var _destroyCapability=/*#__PURE__*/new WeakMap();var _docProperties2=/*#__PURE__*/new WeakMap();var _eventAbortController2=/*#__PURE__*/new WeakMap();var _eventBus7=/*#__PURE__*/new WeakMap();var _externalServices2=/*#__PURE__*/new WeakMap();var _pdfDocument=/*#__PURE__*/new WeakMap();var _pdfViewer=/*#__PURE__*/new WeakMap();var _ready=/*#__PURE__*/new WeakMap();var _scripting=/*#__PURE__*/new WeakMap();var _willPrintCapability=/*#__PURE__*/new WeakMap();var _PDFScriptingManager_brand=/*#__PURE__*/new WeakSet();var PDFScriptingManager=/*#__PURE__*/function(){function PDFScriptingManager(_ref50){var eventBus=_ref50.eventBus,_ref50$externalServic=_ref50.externalServices,externalServices=_ref50$externalServic===void 0?null:_ref50$externalServic,_ref50$docProperties=_ref50.docProperties,docProperties=_ref50$docProperties===void 0?null:_ref50$docProperties;_classCallCheck(this,PDFScriptingManager);_classPrivateMethodInitSpec(this,_PDFScriptingManager_brand);_classPrivateFieldInitSpec(this,_closeCapability,null);_classPrivateFieldInitSpec(this,_destroyCapability,null);_classPrivateFieldInitSpec(this,_docProperties2,null);_classPrivateFieldInitSpec(this,_eventAbortController2,null);_classPrivateFieldInitSpec(this,_eventBus7,null);_classPrivateFieldInitSpec(this,_externalServices2,null);_classPrivateFieldInitSpec(this,_pdfDocument,null);_classPrivateFieldInitSpec(this,_pdfViewer,null);_classPrivateFieldInitSpec(this,_ready,false);_classPrivateFieldInitSpec(this,_scripting,null);_classPrivateFieldInitSpec(this,_willPrintCapability,null);_classPrivateFieldSet(_eventBus7,this,eventBus);_classPrivateFieldSet(_externalServices2,this,externalServices);_classPrivateFieldSet(_docProperties2,this,docProperties);}return _createClass(PDFScriptingManager,[{key:"setViewer",value:function setViewer(pdfViewer){_classPrivateFieldSet(_pdfViewer,this,pdfViewer);}},{key:"setDocument",value:function(){var _setDocument=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee49(pdfDocument){var _this40=this,_classPrivateFieldGet13;var _yield$Promise$all5,_yield$Promise$all6,objects,calculationOrder,docActions,eventBus,_classPrivateFieldGet1,signal,_docProperties3,_t14,_t15;return _regenerator().w(function(_context49){while(1)switch(_context49.n){case 0:if(!_classPrivateFieldGet(_pdfDocument,this)){_context49.n=1;break;}_context49.n=1;return _assertClassBrand(_PDFScriptingManager_brand,this,_destroyScripting).call(this);case 1:_classPrivateFieldSet(_pdfDocument,this,pdfDocument);if(pdfDocument){_context49.n=2;break;}return _context49.a(2);case 2:_context49.n=3;return Promise.all([pdfDocument.getFieldObjects(),pdfDocument.getCalculationOrderIds(),pdfDocument.getJSActions()]);case 3:_yield$Promise$all5=_context49.v;_yield$Promise$all6=_slicedToArray(_yield$Promise$all5,3);objects=_yield$Promise$all6[0];calculationOrder=_yield$Promise$all6[1];docActions=_yield$Promise$all6[2];if(!(!objects&&!docActions)){_context49.n=5;break;}_context49.n=4;return _assertClassBrand(_PDFScriptingManager_brand,this,_destroyScripting).call(this);case 4:return _context49.a(2);case 5:if(!(pdfDocument!==_classPrivateFieldGet(_pdfDocument,this))){_context49.n=6;break;}return _context49.a(2);case 6:_context49.p=6;_classPrivateFieldSet(_scripting,this,_assertClassBrand(_PDFScriptingManager_brand,this,_initScripting).call(this));_context49.n=9;break;case 7:_context49.p=7;_t14=_context49.v;console.error("setDocument:",_t14);_context49.n=8;return _assertClassBrand(_PDFScriptingManager_brand,this,_destroyScripting).call(this);case 8:return _context49.a(2);case 9:eventBus=_classPrivateFieldGet(_eventBus7,this);_classPrivateFieldSet(_eventAbortController2,this,new AbortController());_classPrivateFieldGet1=_classPrivateFieldGet(_eventAbortController2,this),signal=_classPrivateFieldGet1.signal;eventBus._on("updatefromsandbox",function(event){if((event===null||event===void 0?void 0:event.source)===window){_assertClassBrand(_PDFScriptingManager_brand,_this40,_updateFromSandbox).call(_this40,event.detail);}},{signal:signal});eventBus._on("dispatcheventinsandbox",function(event){var _classPrivateFieldGet10;(_classPrivateFieldGet10=_classPrivateFieldGet(_scripting,_this40))===null||_classPrivateFieldGet10===void 0||_classPrivateFieldGet10.dispatchEventInSandbox(event.detail);},{signal:signal});eventBus._on("pagechanging",function(_ref51){var pageNumber=_ref51.pageNumber,previous=_ref51.previous;if(pageNumber===previous){return;}_assertClassBrand(_PDFScriptingManager_brand,_this40,_dispatchPageClose).call(_this40,previous);_assertClassBrand(_PDFScriptingManager_brand,_this40,_dispatchPageOpen).call(_this40,pageNumber);},{signal:signal});eventBus._on("pagerendered",function(_ref52){var pageNumber=_ref52.pageNumber;if(!_this40._pageOpenPending.has(pageNumber)){return;}if(pageNumber!==_classPrivateFieldGet(_pdfViewer,_this40).currentPageNumber){return;}_assertClassBrand(_PDFScriptingManager_brand,_this40,_dispatchPageOpen).call(_this40,pageNumber);},{signal:signal});eventBus._on("pagesdestroy",/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee48(){var _classPrivateFieldGet11,_classPrivateFieldGet12;return _regenerator().w(function(_context48){while(1)switch(_context48.n){case 0:_context48.n=1;return _assertClassBrand(_PDFScriptingManager_brand,_this40,_dispatchPageClose).call(_this40,_classPrivateFieldGet(_pdfViewer,_this40).currentPageNumber);case 1:_context48.n=2;return(_classPrivateFieldGet11=_classPrivateFieldGet(_scripting,_this40))===null||_classPrivateFieldGet11===void 0?void 0:_classPrivateFieldGet11.dispatchEventInSandbox({id:"doc",name:"WillClose"});case 2:(_classPrivateFieldGet12=_classPrivateFieldGet(_closeCapability,_this40))===null||_classPrivateFieldGet12===void 0||_classPrivateFieldGet12.resolve();case 3:return _context48.a(2);}},_callee48);})),{signal:signal});_context49.p=10;_context49.n=11;return _classPrivateFieldGet(_docProperties2,this).call(this,pdfDocument);case 11:_docProperties3=_context49.v;if(!(pdfDocument!==_classPrivateFieldGet(_pdfDocument,this))){_context49.n=12;break;}return _context49.a(2);case 12:_context49.n=13;return _classPrivateFieldGet(_scripting,this).createSandbox({objects:objects,calculationOrder:calculationOrder,appInfo:{platform:navigator.platform,language:navigator.language},docInfo:_objectSpread(_objectSpread({},_docProperties3),{},{actions:docActions})});case 13:eventBus.dispatch("sandboxcreated",{source:this});_context49.n=16;break;case 14:_context49.p=14;_t15=_context49.v;console.error("setDocument:",_t15);_context49.n=15;return _assertClassBrand(_PDFScriptingManager_brand,this,_destroyScripting).call(this);case 15:return _context49.a(2);case 16:_context49.n=17;return(_classPrivateFieldGet13=_classPrivateFieldGet(_scripting,this))===null||_classPrivateFieldGet13===void 0?void 0:_classPrivateFieldGet13.dispatchEventInSandbox({id:"doc",name:"Open"});case 17:_context49.n=18;return _assertClassBrand(_PDFScriptingManager_brand,this,_dispatchPageOpen).call(this,_classPrivateFieldGet(_pdfViewer,this).currentPageNumber,true);case 18:Promise.resolve().then(function(){if(pdfDocument===_classPrivateFieldGet(_pdfDocument,_this40)){_classPrivateFieldSet(_ready,_this40,true);}});case 19:return _context49.a(2);}},_callee49,this,[[10,14],[6,7]]);}));function setDocument(_x39){return _setDocument.apply(this,arguments);}return setDocument;}()},{key:"dispatchWillSave",value:function(){var _dispatchWillSave=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee50(){var _classPrivateFieldGet14;return _regenerator().w(function(_context50){while(1)switch(_context50.n){case 0:return _context50.a(2,(_classPrivateFieldGet14=_classPrivateFieldGet(_scripting,this))===null||_classPrivateFieldGet14===void 0?void 0:_classPrivateFieldGet14.dispatchEventInSandbox({id:"doc",name:"WillSave"}));}},_callee50,this);}));function dispatchWillSave(){return _dispatchWillSave.apply(this,arguments);}return dispatchWillSave;}()},{key:"dispatchDidSave",value:function(){var _dispatchDidSave=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee51(){var _classPrivateFieldGet15;return _regenerator().w(function(_context51){while(1)switch(_context51.n){case 0:return _context51.a(2,(_classPrivateFieldGet15=_classPrivateFieldGet(_scripting,this))===null||_classPrivateFieldGet15===void 0?void 0:_classPrivateFieldGet15.dispatchEventInSandbox({id:"doc",name:"DidSave"}));}},_callee51,this);}));function dispatchDidSave(){return _dispatchDidSave.apply(this,arguments);}return dispatchDidSave;}()},{key:"dispatchWillPrint",value:function(){var _dispatchWillPrint=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee52(){var _classPrivateFieldGet16;var _t16;return _regenerator().w(function(_context52){while(1)switch(_context52.n){case 0:if(_classPrivateFieldGet(_scripting,this)){_context52.n=1;break;}return _context52.a(2);case 1:_context52.n=2;return(_classPrivateFieldGet16=_classPrivateFieldGet(_willPrintCapability,this))===null||_classPrivateFieldGet16===void 0?void 0:_classPrivateFieldGet16.promise;case 2:_classPrivateFieldSet(_willPrintCapability,this,Promise.withResolvers());_context52.p=3;_context52.n=4;return _classPrivateFieldGet(_scripting,this).dispatchEventInSandbox({id:"doc",name:"WillPrint"});case 4:_context52.n=6;break;case 5:_context52.p=5;_t16=_context52.v;_classPrivateFieldGet(_willPrintCapability,this).resolve();_classPrivateFieldSet(_willPrintCapability,this,null);throw _t16;case 6:_context52.n=7;return _classPrivateFieldGet(_willPrintCapability,this).promise;case 7:return _context52.a(2);}},_callee52,this,[[3,5]]);}));function dispatchWillPrint(){return _dispatchWillPrint.apply(this,arguments);}return dispatchWillPrint;}()},{key:"dispatchDidPrint",value:function(){var _dispatchDidPrint=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee53(){var _classPrivateFieldGet17;return _regenerator().w(function(_context53){while(1)switch(_context53.n){case 0:return _context53.a(2,(_classPrivateFieldGet17=_classPrivateFieldGet(_scripting,this))===null||_classPrivateFieldGet17===void 0?void 0:_classPrivateFieldGet17.dispatchEventInSandbox({id:"doc",name:"DidPrint"}));}},_callee53,this);}));function dispatchDidPrint(){return _dispatchDidPrint.apply(this,arguments);}return dispatchDidPrint;}()},{key:"destroyPromise",get:function get(){var _classPrivateFieldGet18;return((_classPrivateFieldGet18=_classPrivateFieldGet(_destroyCapability,this))===null||_classPrivateFieldGet18===void 0?void 0:_classPrivateFieldGet18.promise)||null;}},{key:"ready",get:function get(){return _classPrivateFieldGet(_ready,this);}},{key:"_pageOpenPending",get:function get(){return shadow(this,"_pageOpenPending",new Set());}},{key:"_visitedPages",get:function get(){return shadow(this,"_visitedPages",new Map());}}]);}();function _updateFromSandbox(_x70){return _updateFromSandbox2.apply(this,arguments);}function _updateFromSandbox2(){_updateFromSandbox2=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee117(detail){var _classPrivateFieldGet95;var pdfViewer,isInPresentationMode,id,siblings,command,value,modes,ids,_iterator76,_step76,elementId,element,_classPrivateFieldGet96,_t66;return _regenerator().w(function(_context118){while(1)switch(_context118.n){case 0:pdfViewer=_classPrivateFieldGet(_pdfViewer,this);isInPresentationMode=pdfViewer.isInPresentationMode||pdfViewer.isChangingPresentationMode;id=detail.id,siblings=detail.siblings,command=detail.command,value=detail.value;if(id){_context118.n=18;break;}_t66=command;_context118.n=_t66==="clear"?1:_t66==="error"?2:_t66==="layout"?3:_t66==="page-num"?4:_t66==="print"?5:_t66==="println"?7:_t66==="zoom"?8:_t66==="SaveAs"?9:_t66==="FirstPage"?10:_t66==="LastPage"?11:_t66==="NextPage"?12:_t66==="PrevPage"?13:_t66==="ZoomViewIn"?14:_t66==="ZoomViewOut"?15:_t66==="WillPrintFinished"?16:17;break;case 1:console.clear();return _context118.a(3,17);case 2:console.error(value);return _context118.a(3,17);case 3:if(!isInPresentationMode){modes=apiPageLayoutToViewerModes(value);pdfViewer.spreadMode=modes.spreadMode;}return _context118.a(3,17);case 4:pdfViewer.currentPageNumber=value+1;return _context118.a(3,17);case 5:_context118.n=6;return pdfViewer.pagesPromise;case 6:_classPrivateFieldGet(_eventBus7,this).dispatch("print",{source:this});return _context118.a(3,17);case 7:console.log(value);return _context118.a(3,17);case 8:if(!isInPresentationMode){pdfViewer.currentScaleValue=value;}return _context118.a(3,17);case 9:_classPrivateFieldGet(_eventBus7,this).dispatch("download",{source:this});return _context118.a(3,17);case 10:pdfViewer.currentPageNumber=1;return _context118.a(3,17);case 11:pdfViewer.currentPageNumber=pdfViewer.pagesCount;return _context118.a(3,17);case 12:pdfViewer.nextPage();return _context118.a(3,17);case 13:pdfViewer.previousPage();return _context118.a(3,17);case 14:if(!isInPresentationMode){pdfViewer.increaseScale();}return _context118.a(3,17);case 15:if(!isInPresentationMode){pdfViewer.decreaseScale();}return _context118.a(3,17);case 16:(_classPrivateFieldGet95=_classPrivateFieldGet(_willPrintCapability,this))===null||_classPrivateFieldGet95===void 0||_classPrivateFieldGet95.resolve();_classPrivateFieldSet(_willPrintCapability,this,null);return _context118.a(3,17);case 17:return _context118.a(2);case 18:if(!(isInPresentationMode&&detail.focus)){_context118.n=19;break;}return _context118.a(2);case 19:delete detail.id;delete detail.siblings;ids=siblings?[id].concat(_toConsumableArray(siblings)):[id];_iterator76=_createForOfIteratorHelper(ids);try{for(_iterator76.s();!(_step76=_iterator76.n()).done;){elementId=_step76.value;element=document.querySelector("[data-element-id=\"".concat(elementId,"\"]"));if(element){element.dispatchEvent(new CustomEvent("updatefromsandbox",{detail:detail}));}else{(_classPrivateFieldGet96=_classPrivateFieldGet(_pdfDocument,this))===null||_classPrivateFieldGet96===void 0||_classPrivateFieldGet96.annotationStorage.setValue(elementId,detail);}}}catch(err){_iterator76.e(err);}finally{_iterator76.f();}case 20:return _context118.a(2);}},_callee117,this);}));return _updateFromSandbox2.apply(this,arguments);}function _dispatchPageOpen(_x71){return _dispatchPageOpen2.apply(this,arguments);}function _dispatchPageOpen2(){_dispatchPageOpen2=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee119(pageNumber){var _this121=this;var initialize,pdfDocument,visitedPages,pageView,actionsPromise,_args121=arguments;return _regenerator().w(function(_context120){while(1)switch(_context120.n){case 0:initialize=_args121.length>1&&_args121[1]!==undefined?_args121[1]:false;pdfDocument=_classPrivateFieldGet(_pdfDocument,this),visitedPages=this._visitedPages;if(initialize){_classPrivateFieldSet(_closeCapability,this,Promise.withResolvers());}if(_classPrivateFieldGet(_closeCapability,this)){_context120.n=1;break;}return _context120.a(2);case 1:pageView=_classPrivateFieldGet(_pdfViewer,this).getPageView(pageNumber-1);if(!((pageView===null||pageView===void 0?void 0:pageView.renderingState)!==RenderingStates.FINISHED)){_context120.n=2;break;}this._pageOpenPending.add(pageNumber);return _context120.a(2);case 2:this._pageOpenPending["delete"](pageNumber);actionsPromise=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee118(){var _pageView$pdfPage,_classPrivateFieldGet97;var actions;return _regenerator().w(function(_context119){while(1)switch(_context119.n){case 0:_context119.n=1;return!visitedPages.has(pageNumber)?(_pageView$pdfPage=pageView.pdfPage)===null||_pageView$pdfPage===void 0?void 0:_pageView$pdfPage.getJSActions():null;case 1:actions=_context119.v;if(!(pdfDocument!==_classPrivateFieldGet(_pdfDocument,_this121))){_context119.n=2;break;}return _context119.a(2);case 2:_context119.n=3;return(_classPrivateFieldGet97=_classPrivateFieldGet(_scripting,_this121))===null||_classPrivateFieldGet97===void 0?void 0:_classPrivateFieldGet97.dispatchEventInSandbox({id:"page",name:"PageOpen",pageNumber:pageNumber,actions:actions});case 3:return _context119.a(2);}},_callee118);}))();visitedPages.set(pageNumber,actionsPromise);case 3:return _context120.a(2);}},_callee119,this);}));return _dispatchPageOpen2.apply(this,arguments);}function _dispatchPageClose(_x72){return _dispatchPageClose2.apply(this,arguments);}function _dispatchPageClose2(){_dispatchPageClose2=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee120(pageNumber){var _classPrivateFieldGet98;var pdfDocument,visitedPages,actionsPromise;return _regenerator().w(function(_context121){while(1)switch(_context121.n){case 0:pdfDocument=_classPrivateFieldGet(_pdfDocument,this),visitedPages=this._visitedPages;if(_classPrivateFieldGet(_closeCapability,this)){_context121.n=1;break;}return _context121.a(2);case 1:if(!this._pageOpenPending.has(pageNumber)){_context121.n=2;break;}return _context121.a(2);case 2:actionsPromise=visitedPages.get(pageNumber);if(actionsPromise){_context121.n=3;break;}return _context121.a(2);case 3:visitedPages.set(pageNumber,null);_context121.n=4;return actionsPromise;case 4:if(!(pdfDocument!==_classPrivateFieldGet(_pdfDocument,this))){_context121.n=5;break;}return _context121.a(2);case 5:_context121.n=6;return(_classPrivateFieldGet98=_classPrivateFieldGet(_scripting,this))===null||_classPrivateFieldGet98===void 0?void 0:_classPrivateFieldGet98.dispatchEventInSandbox({id:"page",name:"PageClose",pageNumber:pageNumber});case 6:return _context121.a(2);}},_callee120,this);}));return _dispatchPageClose2.apply(this,arguments);}function _initScripting(){_classPrivateFieldSet(_destroyCapability,this,Promise.withResolvers());if(_classPrivateFieldGet(_scripting,this)){throw new Error("#initScripting: Scripting already exists.");}return _classPrivateFieldGet(_externalServices2,this).createScripting();}function _destroyScripting(){return _destroyScripting2.apply(this,arguments);}function _destroyScripting2(){_destroyScripting2=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee121(){var _classPrivateFieldGet100,_classPrivateFieldGet101,_classPrivateFieldGet102;var _classPrivateFieldGet99,_t67;return _regenerator().w(function(_context122){while(1)switch(_context122.n){case 0:if(_classPrivateFieldGet(_scripting,this)){_context122.n=1;break;}_classPrivateFieldSet(_pdfDocument,this,null);(_classPrivateFieldGet99=_classPrivateFieldGet(_destroyCapability,this))===null||_classPrivateFieldGet99===void 0||_classPrivateFieldGet99.resolve();return _context122.a(2);case 1:if(!_classPrivateFieldGet(_closeCapability,this)){_context122.n=3;break;}_context122.n=2;return Promise.race([_classPrivateFieldGet(_closeCapability,this).promise,new Promise(function(resolve){setTimeout(resolve,1000);})])["catch"](function(){});case 2:_classPrivateFieldSet(_closeCapability,this,null);case 3:_classPrivateFieldSet(_pdfDocument,this,null);_context122.p=4;_context122.n=5;return _classPrivateFieldGet(_scripting,this).destroySandbox();case 5:_context122.n=7;break;case 6:_context122.p=6;_t67=_context122.v;case 7:(_classPrivateFieldGet100=_classPrivateFieldGet(_willPrintCapability,this))===null||_classPrivateFieldGet100===void 0||_classPrivateFieldGet100.reject(new Error("Scripting destroyed."));_classPrivateFieldSet(_willPrintCapability,this,null);(_classPrivateFieldGet101=_classPrivateFieldGet(_eventAbortController2,this))===null||_classPrivateFieldGet101===void 0||_classPrivateFieldGet101.abort();_classPrivateFieldSet(_eventAbortController2,this,null);this._pageOpenPending.clear();this._visitedPages.clear();_classPrivateFieldSet(_scripting,this,null);_classPrivateFieldSet(_ready,this,false);(_classPrivateFieldGet102=_classPrivateFieldGet(_destroyCapability,this))===null||_classPrivateFieldGet102===void 0||_classPrivateFieldGet102.resolve();case 8:return _context122.a(2);}},_callee121,this,[[4,6]]);}));return _destroyScripting2.apply(this,arguments);};// ./web/pdf_sidebar.js
var SIDEBAR_WIDTH_VAR="--sidebar-width";var SIDEBAR_MIN_WIDTH=200;var SIDEBAR_RESIZING_CLASS="sidebarResizing";var UI_NOTIFICATION_CLASS="pdfSidebarNotification";var _isRTL3=/*#__PURE__*/new WeakMap();var _mouseAC=/*#__PURE__*/new WeakMap();var _outerContainerWidth=/*#__PURE__*/new WeakMap();var _width=/*#__PURE__*/new WeakMap();var _PDFSidebar_brand=/*#__PURE__*/new WeakSet();var PDFSidebar=/*#__PURE__*/function(){function PDFSidebar(_ref54){var elements=_ref54.elements,_eventBus8=_ref54.eventBus,l10n=_ref54.l10n;_classCallCheck(this,PDFSidebar);_classPrivateMethodInitSpec(this,_PDFSidebar_brand);_classPrivateFieldInitSpec(this,_isRTL3,false);_classPrivateFieldInitSpec(this,_mouseAC,null);_classPrivateFieldInitSpec(this,_outerContainerWidth,null);_classPrivateFieldInitSpec(this,_width,null);this.isOpen=false;this.active=SidebarView.THUMBS;this.isInitialViewSet=false;this.isInitialEventDispatched=false;this.onToggled=null;this.onUpdateThumbnails=null;this.outerContainer=elements.outerContainer;this.sidebarContainer=elements.sidebarContainer;this.toggleButton=elements.toggleButton;this.resizer=elements.resizer;this.thumbnailButton=elements.thumbnailButton;this.outlineButton=elements.outlineButton;this.attachmentsButton=elements.attachmentsButton;this.layersButton=elements.layersButton;this.thumbnailView=elements.thumbnailView;this.outlineView=elements.outlineView;this.attachmentsView=elements.attachmentsView;this.layersView=elements.layersView;this._currentOutlineItemButton=elements.currentOutlineItemButton;this.eventBus=_eventBus8;_classPrivateFieldSet(_isRTL3,this,l10n.getDirection()==="rtl");_assertClassBrand(_PDFSidebar_brand,this,_addEventListeners2).call(this);}return _createClass(PDFSidebar,[{key:"reset",value:function reset(){this.isInitialViewSet=false;this.isInitialEventDispatched=false;_assertClassBrand(_PDFSidebar_brand,this,_hideUINotification).call(this,true);this.switchView(SidebarView.THUMBS);this.outlineButton.disabled=false;this.attachmentsButton.disabled=false;this.layersButton.disabled=false;this._currentOutlineItemButton.disabled=true;}},{key:"visibleView",get:function get(){return this.isOpen?this.active:SidebarView.NONE;}},{key:"setInitialView",value:function setInitialView(){var view=arguments.length>0&&arguments[0]!==undefined?arguments[0]:SidebarView.NONE;if(this.isInitialViewSet){return;}this.isInitialViewSet=true;if(view===SidebarView.NONE||view===SidebarView.UNKNOWN){_assertClassBrand(_PDFSidebar_brand,this,_dispatchEvent3).call(this);return;}this.switchView(view,true);if(!this.isInitialEventDispatched){_assertClassBrand(_PDFSidebar_brand,this,_dispatchEvent3).call(this);}}},{key:"switchView",value:function switchView(view){var forceOpen=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var isViewChanged=view!==this.active;var forceRendering=false;switch(view){case SidebarView.NONE:if(this.isOpen){this.close();}return;case SidebarView.THUMBS:if(this.isOpen&&isViewChanged){forceRendering=true;}break;case SidebarView.OUTLINE:if(this.outlineButton.disabled){return;}break;case SidebarView.ATTACHMENTS:if(this.attachmentsButton.disabled){return;}break;case SidebarView.LAYERS:if(this.layersButton.disabled){return;}break;default:console.error("PDFSidebar.switchView: \"".concat(view,"\" is not a valid view."));return;}this.active=view;toggleCheckedBtn(this.thumbnailButton,view===SidebarView.THUMBS,this.thumbnailView);toggleCheckedBtn(this.outlineButton,view===SidebarView.OUTLINE,this.outlineView);toggleCheckedBtn(this.attachmentsButton,view===SidebarView.ATTACHMENTS,this.attachmentsView);toggleCheckedBtn(this.layersButton,view===SidebarView.LAYERS,this.layersView);if(forceOpen&&!this.isOpen){this.open();return;}if(forceRendering){this.onUpdateThumbnails();this.onToggled();}if(isViewChanged){_assertClassBrand(_PDFSidebar_brand,this,_dispatchEvent3).call(this);}}},{key:"open",value:function open(){if(this.isOpen){return;}this.isOpen=true;toggleExpandedBtn(this.toggleButton,true);this.outerContainer.classList.add("sidebarMoving","sidebarOpen");if(this.active===SidebarView.THUMBS){this.onUpdateThumbnails();}this.onToggled();_assertClassBrand(_PDFSidebar_brand,this,_dispatchEvent3).call(this);_assertClassBrand(_PDFSidebar_brand,this,_hideUINotification).call(this);}},{key:"close",value:function close(){var evt=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;if(!this.isOpen){return;}this.isOpen=false;toggleExpandedBtn(this.toggleButton,false);this.outerContainer.classList.add("sidebarMoving");this.outerContainer.classList.remove("sidebarOpen");this.onToggled();_assertClassBrand(_PDFSidebar_brand,this,_dispatchEvent3).call(this);if((evt===null||evt===void 0?void 0:evt.detail)>0){this.toggleButton.blur();}}},{key:"toggle",value:function toggle(){var evt=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;if(this.isOpen){this.close(evt);}else{this.open();}}},{key:"outerContainerWidth",get:function get(){return _classPrivateFieldGet(_outerContainerWidth,this)||_classPrivateFieldSet(_outerContainerWidth,this,this.outerContainer.clientWidth);}}]);}();function _dispatchEvent3(){if(this.isInitialViewSet){this.isInitialEventDispatched||(this.isInitialEventDispatched=true);}this.eventBus.dispatch("sidebarviewchanged",{source:this,view:this.visibleView});}function _showUINotification(){this.toggleButton.setAttribute("data-l10n-id","pdfjs-toggle-sidebar-notification-button");if(!this.isOpen){this.toggleButton.classList.add(UI_NOTIFICATION_CLASS);}}function _hideUINotification(){var reset=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;if(this.isOpen||reset){this.toggleButton.classList.remove(UI_NOTIFICATION_CLASS);}if(reset){this.toggleButton.setAttribute("data-l10n-id","pdfjs-toggle-sidebar-button");}}function _addEventListeners2(){var _this108=this;var eventBus=this.eventBus,outerContainer=this.outerContainer;this.sidebarContainer.addEventListener("transitionend",function(evt){if(evt.target===_this108.sidebarContainer){outerContainer.classList.remove("sidebarMoving");eventBus.dispatch("resize",{source:_this108});}});this.toggleButton.addEventListener("click",function(evt){_this108.toggle(evt);});this.thumbnailButton.addEventListener("click",function(){_this108.switchView(SidebarView.THUMBS);});this.outlineButton.addEventListener("click",function(){_this108.switchView(SidebarView.OUTLINE);});this.outlineButton.addEventListener("dblclick",function(){eventBus.dispatch("toggleoutlinetree",{source:_this108});});this.attachmentsButton.addEventListener("click",function(){_this108.switchView(SidebarView.ATTACHMENTS);});this.layersButton.addEventListener("click",function(){_this108.switchView(SidebarView.LAYERS);});this.layersButton.addEventListener("dblclick",function(){eventBus.dispatch("resetlayers",{source:_this108});});this._currentOutlineItemButton.addEventListener("click",function(){eventBus.dispatch("currentoutlineitem",{source:_this108});});var onTreeLoaded=function onTreeLoaded(count,button,view){button.disabled=!count;if(count){_assertClassBrand(_PDFSidebar_brand,_this108,_showUINotification).call(_this108);}else if(_this108.active===view){_this108.switchView(SidebarView.THUMBS);}};eventBus._on("outlineloaded",function(evt){onTreeLoaded(evt.outlineCount,_this108.outlineButton,SidebarView.OUTLINE);evt.currentOutlineItemPromise.then(function(enabled){if(!_this108.isInitialViewSet){return;}_this108._currentOutlineItemButton.disabled=!enabled;});});eventBus._on("attachmentsloaded",function(evt){onTreeLoaded(evt.attachmentsCount,_this108.attachmentsButton,SidebarView.ATTACHMENTS);});eventBus._on("layersloaded",function(evt){onTreeLoaded(evt.layersCount,_this108.layersButton,SidebarView.LAYERS);});eventBus._on("presentationmodechanged",function(evt){if(evt.state===PresentationModeState.NORMAL&&_this108.visibleView===SidebarView.THUMBS){_this108.onUpdateThumbnails();}});this.resizer.addEventListener("mousedown",function(evt){if(evt.button!==0){return;}outerContainer.classList.add(SIDEBAR_RESIZING_CLASS);_classPrivateFieldSet(_mouseAC,_this108,new AbortController());var opts={signal:_classPrivateFieldGet(_mouseAC,_this108).signal};window.addEventListener("mousemove",_assertClassBrand(_PDFSidebar_brand,_this108,_mouseMove).bind(_this108),opts);window.addEventListener("mouseup",_assertClassBrand(_PDFSidebar_brand,_this108,_mouseUp).bind(_this108),opts);window.addEventListener("blur",_assertClassBrand(_PDFSidebar_brand,_this108,_mouseUp).bind(_this108),opts);});eventBus._on("resize",function(evt){if(evt.source!==window){return;}_classPrivateFieldSet(_outerContainerWidth,_this108,null);if(!_classPrivateFieldGet(_width,_this108)){return;}if(!_this108.isOpen){_assertClassBrand(_PDFSidebar_brand,_this108,_updateWidth).call(_this108,_classPrivateFieldGet(_width,_this108));return;}outerContainer.classList.add(SIDEBAR_RESIZING_CLASS);var updated=_assertClassBrand(_PDFSidebar_brand,_this108,_updateWidth).call(_this108,_classPrivateFieldGet(_width,_this108));Promise.resolve().then(function(){outerContainer.classList.remove(SIDEBAR_RESIZING_CLASS);if(updated){eventBus.dispatch("resize",{source:_this108});}});});}function _updateWidth(){var width=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;var maxWidth=Math.floor(this.outerContainerWidth/2);if(width>maxWidth){width=maxWidth;}if(width<SIDEBAR_MIN_WIDTH){width=SIDEBAR_MIN_WIDTH;}if(width===_classPrivateFieldGet(_width,this)){return false;}_classPrivateFieldSet(_width,this,width);docStyle.setProperty(SIDEBAR_WIDTH_VAR,"".concat(width,"px"));return true;}function _mouseMove(evt){var width=evt.clientX;if(_classPrivateFieldGet(_isRTL3,this)){width=this.outerContainerWidth-width;}_assertClassBrand(_PDFSidebar_brand,this,_updateWidth).call(this,width);}function _mouseUp(evt){var _classPrivateFieldGet67;this.outerContainer.classList.remove(SIDEBAR_RESIZING_CLASS);this.eventBus.dispatch("resize",{source:this});(_classPrivateFieldGet67=_classPrivateFieldGet(_mouseAC,this))===null||_classPrivateFieldGet67===void 0||_classPrivateFieldGet67.abort();_classPrivateFieldSet(_mouseAC,this,null);};// ./web/pdf_thumbnail_view.js
var DRAW_UPSCALE_FACTOR=2;var MAX_NUM_SCALING_STEPS=3;var THUMBNAIL_WIDTH=98;function zeroCanvas(c){c.width=0;c.height=0;}var TempImageFactory=/*#__PURE__*/function(){function TempImageFactory(){_classCallCheck(this,TempImageFactory);}return _createClass(TempImageFactory,null,[{key:"getCanvas",value:function getCanvas(width,height){var tempCanvas=_assertClassBrand(TempImageFactory,this,_tempCanvas)._||(_tempCanvas._=_assertClassBrand(TempImageFactory,this,document.createElement("canvas")));tempCanvas.width=width;tempCanvas.height=height;var ctx=tempCanvas.getContext("2d",{alpha:false});ctx.save();ctx.fillStyle="rgb(255, 255, 255)";ctx.fillRect(0,0,width,height);ctx.restore();return[tempCanvas,tempCanvas.getContext("2d")];}},{key:"destroyCanvas",value:function destroyCanvas(){if(_assertClassBrand(TempImageFactory,this,_tempCanvas)._){zeroCanvas(_assertClassBrand(TempImageFactory,this,_tempCanvas)._);}_tempCanvas._=_assertClassBrand(TempImageFactory,this,null);}}]);}();var _tempCanvas={_:null};var _PDFThumbnailView_brand=/*#__PURE__*/new WeakSet();var PDFThumbnailView=/*#__PURE__*/function(){function PDFThumbnailView(_ref55){var container=_ref55.container,eventBus=_ref55.eventBus,id=_ref55.id,defaultViewport=_ref55.defaultViewport,optionalContentConfigPromise=_ref55.optionalContentConfigPromise,linkService=_ref55.linkService,renderingQueue=_ref55.renderingQueue,maxCanvasPixels=_ref55.maxCanvasPixels,maxCanvasDim=_ref55.maxCanvasDim,pageColors=_ref55.pageColors,_enableHWA=_ref55.enableHWA;_classCallCheck(this,PDFThumbnailView);_classPrivateMethodInitSpec(this,_PDFThumbnailView_brand);this.id=id;this.renderingId="thumbnail"+id;this.pageLabel=null;this.pdfPage=null;this.rotation=0;this.viewport=defaultViewport;this.pdfPageRotate=defaultViewport.rotation;this._optionalContentConfigPromise=optionalContentConfigPromise||null;this.maxCanvasPixels=maxCanvasPixels!==null&&maxCanvasPixels!==void 0?maxCanvasPixels:AppOptions.get("maxCanvasPixels");this.maxCanvasDim=maxCanvasDim||AppOptions.get("maxCanvasDim");this.pageColors=pageColors||null;this.enableHWA=_enableHWA||false;this.eventBus=eventBus;this.linkService=linkService;this.renderingQueue=renderingQueue;this.renderTask=null;this.renderingState=RenderingStates.INITIAL;this.resume=null;var anchor=document.createElement("a");anchor.href=linkService.getAnchorUrl("#page="+id);anchor.setAttribute("data-l10n-id","pdfjs-thumb-page-title");anchor.setAttribute("data-l10n-args",_classPrivateGetter(_PDFThumbnailView_brand,this,_get_pageL10nArgs));anchor.onclick=function(){linkService.goToPage(id);return false;};this.anchor=anchor;var div=document.createElement("div");div.className="thumbnail";div.setAttribute("data-page-number",this.id);this.div=div;_assertClassBrand(_PDFThumbnailView_brand,this,_updateDims).call(this);var _img=document.createElement("div");_img.className="thumbnailImage";this._placeholderImg=_img;div.append(_img);anchor.append(div);container.append(anchor);}return _createClass(PDFThumbnailView,[{key:"setPdfPage",value:function setPdfPage(pdfPage){this.pdfPage=pdfPage;this.pdfPageRotate=pdfPage.rotate;var totalRotation=(this.rotation+this.pdfPageRotate)%360;this.viewport=pdfPage.getViewport({scale:1,rotation:totalRotation});this.reset();}},{key:"reset",value:function reset(){var _this$image;this.cancelRendering();this.renderingState=RenderingStates.INITIAL;this.div.removeAttribute("data-loaded");(_this$image=this.image)===null||_this$image===void 0||_this$image.replaceWith(this._placeholderImg);_assertClassBrand(_PDFThumbnailView_brand,this,_updateDims).call(this);if(this.image){this.image.removeAttribute("src");delete this.image;}}},{key:"update",value:function update(_ref56){var _ref56$rotation=_ref56.rotation,rotation=_ref56$rotation===void 0?null:_ref56$rotation;if(typeof rotation==="number"){this.rotation=rotation;}var totalRotation=(this.rotation+this.pdfPageRotate)%360;this.viewport=this.viewport.clone({scale:1,rotation:totalRotation});this.reset();}},{key:"cancelRendering",value:function cancelRendering(){if(this.renderTask){this.renderTask.cancel();this.renderTask=null;}this.resume=null;}},{key:"draw",value:function(){var _draw=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee54(){var _this42=this;var pageColors,pdfPage,_assertClassBrand$cal0,ctx,canvas,transform,drawViewport,renderContinueCallback,renderContext,renderTask,error,_t17;return _regenerator().w(function(_context54){while(1)switch(_context54.n){case 0:if(!(this.renderingState!==RenderingStates.INITIAL)){_context54.n=1;break;}console.error("Must be in new state before drawing");return _context54.a(2);case 1:pageColors=this.pageColors,pdfPage=this.pdfPage;if(pdfPage){_context54.n=2;break;}this.renderingState=RenderingStates.FINISHED;throw new Error("pdfPage is not loaded");case 2:this.renderingState=RenderingStates.RUNNING;_assertClassBrand$cal0=_assertClassBrand(_PDFThumbnailView_brand,this,_getPageDrawContext).call(this,DRAW_UPSCALE_FACTOR),ctx=_assertClassBrand$cal0.ctx,canvas=_assertClassBrand$cal0.canvas,transform=_assertClassBrand$cal0.transform;drawViewport=this.viewport.clone({scale:DRAW_UPSCALE_FACTOR*this.scale});renderContinueCallback=function renderContinueCallback(cont){if(!_this42.renderingQueue.isHighestPriority(_this42)){_this42.renderingState=RenderingStates.PAUSED;_this42.resume=function(){_this42.renderingState=RenderingStates.RUNNING;cont();};return;}cont();};renderContext={canvasContext:ctx,transform:transform,viewport:drawViewport,optionalContentConfigPromise:this._optionalContentConfigPromise,pageColors:pageColors};renderTask=this.renderTask=pdfPage.render(renderContext);renderTask.onContinue=renderContinueCallback;error=null;_context54.p=3;_context54.n=4;return renderTask.promise;case 4:_context54.n=7;break;case 5:_context54.p=5;_t17=_context54.v;if(!(_t17 instanceof RenderingCancelledException)){_context54.n=6;break;}zeroCanvas(canvas);return _context54.a(2);case 6:error=_t17;case 7:_context54.p=7;if(renderTask===this.renderTask){this.renderTask=null;}return _context54.f(7);case 8:this.renderingState=RenderingStates.FINISHED;_assertClassBrand(_PDFThumbnailView_brand,this,_convertCanvasToImage).call(this,canvas);zeroCanvas(canvas);this.eventBus.dispatch("thumbnailrendered",{source:this,pageNumber:this.id,pdfPage:pdfPage});if(!error){_context54.n=9;break;}throw error;case 9:return _context54.a(2);}},_callee54,this,[[3,5,7,8]]);}));function draw(){return _draw.apply(this,arguments);}return draw;}()},{key:"setImage",value:function setImage(pageView){if(this.renderingState!==RenderingStates.INITIAL){return;}var canvas=pageView.thumbnailCanvas,pdfPage=pageView.pdfPage,scale=pageView.scale;if(!canvas){return;}if(!this.pdfPage){this.setPdfPage(pdfPage);}if(scale<this.scale){return;}this.renderingState=RenderingStates.FINISHED;_assertClassBrand(_PDFThumbnailView_brand,this,_convertCanvasToImage).call(this,canvas);}},{key:"setPageLabel",value:function setPageLabel(label){var _this$image2;this.pageLabel=typeof label==="string"?label:null;this.anchor.setAttribute("data-l10n-args",_classPrivateGetter(_PDFThumbnailView_brand,this,_get_pageL10nArgs));if(this.renderingState!==RenderingStates.FINISHED){return;}(_this$image2=this.image)===null||_this$image2===void 0||_this$image2.setAttribute("data-l10n-args",_classPrivateGetter(_PDFThumbnailView_brand,this,_get_pageL10nArgs));}}]);}();function _updateDims(){var _this$viewport2=this.viewport,width=_this$viewport2.width,height=_this$viewport2.height;var ratio=width/height;this.canvasWidth=THUMBNAIL_WIDTH;this.canvasHeight=this.canvasWidth/ratio|0;this.scale=this.canvasWidth/width;var style=this.div.style;style.setProperty("--thumbnail-width","".concat(this.canvasWidth,"px"));style.setProperty("--thumbnail-height","".concat(this.canvasHeight,"px"));}function _getPageDrawContext(){var upscaleFactor=arguments.length>0&&arguments[0]!==undefined?arguments[0]:1;var enableHWA=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.enableHWA;var canvas=document.createElement("canvas");var ctx=canvas.getContext("2d",{alpha:false,willReadFrequently:!enableHWA});var outputScale=new OutputScale();var width=upscaleFactor*this.canvasWidth,height=upscaleFactor*this.canvasHeight;outputScale.limitCanvas(width,height,this.maxCanvasPixels,this.maxCanvasDim);canvas.width=width*outputScale.sx|0;canvas.height=height*outputScale.sy|0;var transform=outputScale.scaled?[outputScale.sx,0,0,outputScale.sy,0,0]:null;return{ctx:ctx,canvas:canvas,transform:transform};}function _convertCanvasToImage(canvas){if(this.renderingState!==RenderingStates.FINISHED){throw new Error("#convertCanvasToImage: Rendering has not finished.");}var reducedCanvas=_assertClassBrand(_PDFThumbnailView_brand,this,_reduceImage).call(this,canvas);var image=document.createElement("img");image.className="thumbnailImage";image.setAttribute("data-l10n-id","pdfjs-thumb-page-canvas");image.setAttribute("data-l10n-args",_classPrivateGetter(_PDFThumbnailView_brand,this,_get_pageL10nArgs));image.src=reducedCanvas.toDataURL();this.image=image;this.div.setAttribute("data-loaded",true);this._placeholderImg.replaceWith(image);zeroCanvas(reducedCanvas);}function _getReducedImageDims(canvas){var width=canvas.width<<MAX_NUM_SCALING_STEPS,height=canvas.height<<MAX_NUM_SCALING_STEPS;var outputScale=new OutputScale();outputScale.sx=outputScale.sy=1;outputScale.limitCanvas(width,height,this.maxCanvasPixels,this.maxCanvasDim);return[width*outputScale.sx|0,height*outputScale.sy|0];}function _reduceImage(img){var _assertClassBrand$cal12=_assertClassBrand(_PDFThumbnailView_brand,this,_getPageDrawContext).call(this,1,true),ctx=_assertClassBrand$cal12.ctx,canvas=_assertClassBrand$cal12.canvas;if(img.width<=2*canvas.width){ctx.drawImage(img,0,0,img.width,img.height,0,0,canvas.width,canvas.height);return canvas;}var _assertClassBrand$cal13=_assertClassBrand(_PDFThumbnailView_brand,this,_getReducedImageDims).call(this,canvas),_assertClassBrand$cal14=_slicedToArray(_assertClassBrand$cal13,2),reducedWidth=_assertClassBrand$cal14[0],reducedHeight=_assertClassBrand$cal14[1];var _TempImageFactory$get=TempImageFactory.getCanvas(reducedWidth,reducedHeight),_TempImageFactory$get2=_slicedToArray(_TempImageFactory$get,2),reducedImage=_TempImageFactory$get2[0],reducedImageCtx=_TempImageFactory$get2[1];while(reducedWidth>img.width||reducedHeight>img.height){reducedWidth>>=1;reducedHeight>>=1;}reducedImageCtx.drawImage(img,0,0,img.width,img.height,0,0,reducedWidth,reducedHeight);while(reducedWidth>2*canvas.width){reducedImageCtx.drawImage(reducedImage,0,0,reducedWidth,reducedHeight,0,0,reducedWidth>>1,reducedHeight>>1);reducedWidth>>=1;reducedHeight>>=1;}ctx.drawImage(reducedImage,0,0,reducedWidth,reducedHeight,0,0,canvas.width,canvas.height);return canvas;}function _get_pageL10nArgs(_this41){var _this41$pageLabel;return JSON.stringify({page:(_this41$pageLabel=_this41.pageLabel)!==null&&_this41$pageLabel!==void 0?_this41$pageLabel:_this41.id});};// ./web/pdf_thumbnail_viewer.js
var THUMBNAIL_SCROLL_MARGIN=-19;var THUMBNAIL_SELECTED_CLASS="selected";var _PDFThumbnailViewer_brand=/*#__PURE__*/new WeakSet();var PDFThumbnailViewer=/*#__PURE__*/function(){function PDFThumbnailViewer(_ref57){var container=_ref57.container,eventBus=_ref57.eventBus,linkService=_ref57.linkService,renderingQueue=_ref57.renderingQueue,maxCanvasPixels=_ref57.maxCanvasPixels,maxCanvasDim=_ref57.maxCanvasDim,pageColors=_ref57.pageColors,abortSignal=_ref57.abortSignal,enableHWA=_ref57.enableHWA;_classCallCheck(this,PDFThumbnailViewer);_classPrivateMethodInitSpec(this,_PDFThumbnailViewer_brand);this.container=container;this.eventBus=eventBus;this.linkService=linkService;this.renderingQueue=renderingQueue;this.maxCanvasPixels=maxCanvasPixels;this.maxCanvasDim=maxCanvasDim;this.pageColors=pageColors||null;this.enableHWA=enableHWA||false;this.scroll=watchScroll(this.container,_assertClassBrand(_PDFThumbnailViewer_brand,this,_scrollUpdated).bind(this),abortSignal);_assertClassBrand(_PDFThumbnailViewer_brand,this,_resetView).call(this);}return _createClass(PDFThumbnailViewer,[{key:"getThumbnail",value:function getThumbnail(index){return this._thumbnails[index];}},{key:"scrollThumbnailIntoView",value:function scrollThumbnailIntoView(pageNumber){if(!this.pdfDocument){return;}var thumbnailView=this._thumbnails[pageNumber-1];if(!thumbnailView){console.error('scrollThumbnailIntoView: Invalid "pageNumber" parameter.');return;}if(pageNumber!==this._currentPageNumber){var prevThumbnailView=this._thumbnails[this._currentPageNumber-1];prevThumbnailView.div.classList.remove(THUMBNAIL_SELECTED_CLASS);thumbnailView.div.classList.add(THUMBNAIL_SELECTED_CLASS);}var _assertClassBrand$cal1=_assertClassBrand(_PDFThumbnailViewer_brand,this,_getVisibleThumbs).call(this),first=_assertClassBrand$cal1.first,last=_assertClassBrand$cal1.last,views=_assertClassBrand$cal1.views;if(views.length>0){var shouldScroll=false;if(pageNumber<=first.id||pageNumber>=last.id){shouldScroll=true;}else{var _iterator25=_createForOfIteratorHelper(views),_step25;try{for(_iterator25.s();!(_step25=_iterator25.n()).done;){var _step25$value=_step25.value,id=_step25$value.id,percent=_step25$value.percent;if(id!==pageNumber){continue;}shouldScroll=percent<100;break;}}catch(err){_iterator25.e(err);}finally{_iterator25.f();}}if(shouldScroll){scrollIntoView(thumbnailView.div,{top:THUMBNAIL_SCROLL_MARGIN});}}this._currentPageNumber=pageNumber;}},{key:"pagesRotation",get:function get(){return this._pagesRotation;},set:function set(rotation){if(!isValidRotation(rotation)){throw new Error("Invalid thumbnails rotation angle.");}if(!this.pdfDocument){return;}if(this._pagesRotation===rotation){return;}this._pagesRotation=rotation;var updateArgs={rotation:rotation};var _iterator26=_createForOfIteratorHelper(this._thumbnails),_step26;try{for(_iterator26.s();!(_step26=_iterator26.n()).done;){var thumbnail=_step26.value;thumbnail.update(updateArgs);}}catch(err){_iterator26.e(err);}finally{_iterator26.f();}}},{key:"cleanup",value:function cleanup(){var _iterator27=_createForOfIteratorHelper(this._thumbnails),_step27;try{for(_iterator27.s();!(_step27=_iterator27.n()).done;){var thumbnail=_step27.value;if(thumbnail.renderingState!==RenderingStates.FINISHED){thumbnail.reset();}}}catch(err){_iterator27.e(err);}finally{_iterator27.f();}TempImageFactory.destroyCanvas();}},{key:"setDocument",value:function setDocument(pdfDocument){var _this43=this;if(this.pdfDocument){_assertClassBrand(_PDFThumbnailViewer_brand,this,_cancelRendering).call(this);_assertClassBrand(_PDFThumbnailViewer_brand,this,_resetView).call(this);}this.pdfDocument=pdfDocument;if(!pdfDocument){return;}var firstPagePromise=pdfDocument.getPage(1);var optionalContentConfigPromise=pdfDocument.getOptionalContentConfig({intent:"display"});firstPagePromise.then(function(firstPdfPage){var _this43$_thumbnails$;var pagesCount=pdfDocument.numPages;var viewport=firstPdfPage.getViewport({scale:1});for(var pageNum=1;pageNum<=pagesCount;++pageNum){var thumbnail=new PDFThumbnailView({container:_this43.container,eventBus:_this43.eventBus,id:pageNum,defaultViewport:viewport.clone(),optionalContentConfigPromise:optionalContentConfigPromise,linkService:_this43.linkService,renderingQueue:_this43.renderingQueue,maxCanvasPixels:_this43.maxCanvasPixels,maxCanvasDim:_this43.maxCanvasDim,pageColors:_this43.pageColors,enableHWA:_this43.enableHWA});_this43._thumbnails.push(thumbnail);}(_this43$_thumbnails$=_this43._thumbnails[0])===null||_this43$_thumbnails$===void 0||_this43$_thumbnails$.setPdfPage(firstPdfPage);var thumbnailView=_this43._thumbnails[_this43._currentPageNumber-1];thumbnailView.div.classList.add(THUMBNAIL_SELECTED_CLASS);})["catch"](function(reason){console.error("Unable to initialize thumbnail viewer",reason);});}},{key:"setPageLabels",value:function setPageLabels(labels){if(!this.pdfDocument){return;}if(!labels){this._pageLabels=null;}else if(!(Array.isArray(labels)&&this.pdfDocument.numPages===labels.length)){this._pageLabels=null;console.error("PDFThumbnailViewer_setPageLabels: Invalid page labels.");}else{this._pageLabels=labels;}for(var i=0,ii=this._thumbnails.length;i<ii;i++){var _this$_pageLabels$i,_this$_pageLabels;this._thumbnails[i].setPageLabel((_this$_pageLabels$i=(_this$_pageLabels=this._pageLabels)===null||_this$_pageLabels===void 0?void 0:_this$_pageLabels[i])!==null&&_this$_pageLabels$i!==void 0?_this$_pageLabels$i:null);}}},{key:"forceRendering",value:function forceRendering(){var _this44=this;var visibleThumbs=_assertClassBrand(_PDFThumbnailViewer_brand,this,_getVisibleThumbs).call(this);var scrollAhead=_assertClassBrand(_PDFThumbnailViewer_brand,this,_getScrollAhead).call(this,visibleThumbs);var thumbView=this.renderingQueue.getHighestPriority(visibleThumbs,this._thumbnails,scrollAhead,false,true);if(thumbView){_assertClassBrand(_PDFThumbnailViewer_brand,this,_ensurePdfPageLoaded).call(this,thumbView).then(function(){_this44.renderingQueue.renderView(thumbView);});return true;}return false;}}]);}();function _scrollUpdated(){this.renderingQueue.renderHighestPriority();}function _getVisibleThumbs(){return getVisibleElements({scrollEl:this.container,views:this._thumbnails});}function _resetView(){this._thumbnails=[];this._currentPageNumber=1;this._pageLabels=null;this._pagesRotation=0;this.container.textContent="";}function _cancelRendering(){var _iterator55=_createForOfIteratorHelper(this._thumbnails),_step55;try{for(_iterator55.s();!(_step55=_iterator55.n()).done;){var thumbnail=_step55.value;thumbnail.cancelRendering();}}catch(err){_iterator55.e(err);}finally{_iterator55.f();}}function _ensurePdfPageLoaded(_x73){return _ensurePdfPageLoaded3.apply(this,arguments);}function _ensurePdfPageLoaded3(){_ensurePdfPageLoaded3=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee122(thumbView){var pdfPage,_t68;return _regenerator().w(function(_context123){while(1)switch(_context123.n){case 0:if(!thumbView.pdfPage){_context123.n=1;break;}return _context123.a(2,thumbView.pdfPage);case 1:_context123.p=1;_context123.n=2;return this.pdfDocument.getPage(thumbView.id);case 2:pdfPage=_context123.v;if(!thumbView.pdfPage){thumbView.setPdfPage(pdfPage);}return _context123.a(2,pdfPage);case 3:_context123.p=3;_t68=_context123.v;console.error("Unable to get page for thumb view",_t68);return _context123.a(2,null);}},_callee122,this,[[1,3]]);}));return _ensurePdfPageLoaded3.apply(this,arguments);}function _getScrollAhead(visible){var _visible$first,_visible$last;if(((_visible$first=visible.first)===null||_visible$first===void 0?void 0:_visible$first.id)===1){return true;}else if(((_visible$last=visible.last)===null||_visible$last===void 0?void 0:_visible$last.id)===this._thumbnails.length){return false;}return this.scroll.down;};// ./web/annotation_editor_layer_builder.js
var _annotationLayer=/*#__PURE__*/new WeakMap();var _drawLayer=/*#__PURE__*/new WeakMap();var _onAppend=/*#__PURE__*/new WeakMap();var _structTreeLayer=/*#__PURE__*/new WeakMap();var _textLayer=/*#__PURE__*/new WeakMap();var _uiManager3=/*#__PURE__*/new WeakMap();var AnnotationEditorLayerBuilder=/*#__PURE__*/function(){function AnnotationEditorLayerBuilder(options){_classCallCheck(this,AnnotationEditorLayerBuilder);_classPrivateFieldInitSpec(this,_annotationLayer,null);_classPrivateFieldInitSpec(this,_drawLayer,null);_classPrivateFieldInitSpec(this,_onAppend,null);_classPrivateFieldInitSpec(this,_structTreeLayer,null);_classPrivateFieldInitSpec(this,_textLayer,null);_classPrivateFieldInitSpec(this,_uiManager3,void 0);this.pdfPage=options.pdfPage;this.accessibilityManager=options.accessibilityManager;this.l10n=options.l10n;this.l10n||(this.l10n=new genericl10n_GenericL10n());this.annotationEditorLayer=null;this.div=null;this._cancelled=false;_classPrivateFieldSet(_uiManager3,this,options.uiManager);_classPrivateFieldSet(_annotationLayer,this,options.annotationLayer||null);_classPrivateFieldSet(_textLayer,this,options.textLayer||null);_classPrivateFieldSet(_drawLayer,this,options.drawLayer||null);_classPrivateFieldSet(_onAppend,this,options.onAppend||null);_classPrivateFieldSet(_structTreeLayer,this,options.structTreeLayer||null);}return _createClass(AnnotationEditorLayerBuilder,[{key:"render",value:function(){var _render2=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee55(_ref58){var _classPrivateFieldGet19;var viewport,_ref58$intent,intent,clonedViewport,div,parameters;return _regenerator().w(function(_context55){while(1)switch(_context55.n){case 0:viewport=_ref58.viewport,_ref58$intent=_ref58.intent,intent=_ref58$intent===void 0?"display":_ref58$intent;if(!(intent!=="display")){_context55.n=1;break;}return _context55.a(2);case 1:if(!this._cancelled){_context55.n=2;break;}return _context55.a(2);case 2:clonedViewport=viewport.clone({dontFlip:true});if(!this.div){_context55.n=3;break;}this.annotationEditorLayer.update({viewport:clonedViewport});this.show();return _context55.a(2);case 3:div=this.div=document.createElement("div");div.className="annotationEditorLayer";div.hidden=true;div.dir=_classPrivateFieldGet(_uiManager3,this).direction;(_classPrivateFieldGet19=_classPrivateFieldGet(_onAppend,this))===null||_classPrivateFieldGet19===void 0||_classPrivateFieldGet19.call(this,div);this.annotationEditorLayer=new AnnotationEditorLayer({uiManager:_classPrivateFieldGet(_uiManager3,this),div:div,structTreeLayer:_classPrivateFieldGet(_structTreeLayer,this),accessibilityManager:this.accessibilityManager,pageIndex:this.pdfPage.pageNumber-1,l10n:this.l10n,viewport:clonedViewport,annotationLayer:_classPrivateFieldGet(_annotationLayer,this),textLayer:_classPrivateFieldGet(_textLayer,this),drawLayer:_classPrivateFieldGet(_drawLayer,this)});parameters={viewport:clonedViewport,div:div,annotations:null,intent:intent};this.annotationEditorLayer.render(parameters);this.show();case 4:return _context55.a(2);}},_callee55,this);}));function render(_x40){return _render2.apply(this,arguments);}return render;}()},{key:"cancel",value:function cancel(){this._cancelled=true;if(!this.div){return;}this.annotationEditorLayer.destroy();}},{key:"hide",value:function hide(){if(!this.div){return;}this.annotationEditorLayer.pause(true);this.div.hidden=true;}},{key:"show",value:function show(){if(!this.div||this.annotationEditorLayer.isInvisible){return;}this.div.hidden=false;this.annotationEditorLayer.pause(false);}}]);}();;// ./web/annotation_layer_builder.js
var _annotations=/*#__PURE__*/new WeakMap();var _externalHide=/*#__PURE__*/new WeakMap();var _onAppend2=/*#__PURE__*/new WeakMap();var _eventAbortController3=/*#__PURE__*/new WeakMap();var _linksInjected=/*#__PURE__*/new WeakMap();var _AnnotationLayerBuilder_brand=/*#__PURE__*/new WeakSet();var AnnotationLayerBuilder=/*#__PURE__*/function(){function AnnotationLayerBuilder(_ref59){var pdfPage=_ref59.pdfPage,linkService=_ref59.linkService,downloadManager=_ref59.downloadManager,_ref59$annotationStor=_ref59.annotationStorage,annotationStorage=_ref59$annotationStor===void 0?null:_ref59$annotationStor,_ref59$imageResources=_ref59.imageResourcesPath,imageResourcesPath=_ref59$imageResources===void 0?"":_ref59$imageResources,_ref59$renderForms=_ref59.renderForms,renderForms=_ref59$renderForms===void 0?true:_ref59$renderForms,_ref59$enableScriptin=_ref59.enableScripting,enableScripting=_ref59$enableScriptin===void 0?false:_ref59$enableScriptin,_ref59$hasJSActionsPr=_ref59.hasJSActionsPromise,hasJSActionsPromise=_ref59$hasJSActionsPr===void 0?null:_ref59$hasJSActionsPr,_ref59$fieldObjectsPr=_ref59.fieldObjectsPromise,fieldObjectsPromise=_ref59$fieldObjectsPr===void 0?null:_ref59$fieldObjectsPr,_ref59$annotationCanv=_ref59.annotationCanvasMap,annotationCanvasMap=_ref59$annotationCanv===void 0?null:_ref59$annotationCanv,_ref59$accessibilityM=_ref59.accessibilityManager,accessibilityManager=_ref59$accessibilityM===void 0?null:_ref59$accessibilityM,_ref59$annotationEdit=_ref59.annotationEditorUIManager,annotationEditorUIManager=_ref59$annotationEdit===void 0?null:_ref59$annotationEdit,_ref59$onAppend=_ref59.onAppend,onAppend=_ref59$onAppend===void 0?null:_ref59$onAppend;_classCallCheck(this,AnnotationLayerBuilder);_classPrivateMethodInitSpec(this,_AnnotationLayerBuilder_brand);_classPrivateFieldInitSpec(this,_annotations,null);_classPrivateFieldInitSpec(this,_externalHide,false);_classPrivateFieldInitSpec(this,_onAppend2,null);_classPrivateFieldInitSpec(this,_eventAbortController3,null);_classPrivateFieldInitSpec(this,_linksInjected,false);this.pdfPage=pdfPage;this.linkService=linkService;this.downloadManager=downloadManager;this.imageResourcesPath=imageResourcesPath;this.renderForms=renderForms;this.annotationStorage=annotationStorage;this.enableScripting=enableScripting;this._hasJSActionsPromise=hasJSActionsPromise||Promise.resolve(false);this._fieldObjectsPromise=fieldObjectsPromise||Promise.resolve(null);this._annotationCanvasMap=annotationCanvasMap;this._accessibilityManager=accessibilityManager;this._annotationEditorUIManager=annotationEditorUIManager;_classPrivateFieldSet(_onAppend2,this,onAppend);this.annotationLayer=null;this.div=null;this._cancelled=false;this._eventBus=linkService.eventBus;}return _createClass(AnnotationLayerBuilder,[{key:"render",value:function(){var _render3=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee56(_ref60){var _classPrivateFieldGet20,_this45=this;var viewport,_ref60$intent,intent,_ref60$structTreeLaye,structTreeLayer,_yield$Promise$all7,_yield$Promise$all8,annotations,hasJSActions,fieldObjects,div,_this$_eventBus;return _regenerator().w(function(_context56){while(1)switch(_context56.n){case 0:viewport=_ref60.viewport,_ref60$intent=_ref60.intent,intent=_ref60$intent===void 0?"display":_ref60$intent,_ref60$structTreeLaye=_ref60.structTreeLayer,structTreeLayer=_ref60$structTreeLaye===void 0?null:_ref60$structTreeLaye;if(!this.div){_context56.n=2;break;}if(!(this._cancelled||!this.annotationLayer)){_context56.n=1;break;}return _context56.a(2);case 1:this.annotationLayer.update({viewport:viewport.clone({dontFlip:true})});return _context56.a(2);case 2:_context56.n=3;return Promise.all([this.pdfPage.getAnnotations({intent:intent}),this._hasJSActionsPromise,this._fieldObjectsPromise]);case 3:_yield$Promise$all7=_context56.v;_yield$Promise$all8=_slicedToArray(_yield$Promise$all7,3);annotations=_yield$Promise$all8[0];hasJSActions=_yield$Promise$all8[1];fieldObjects=_yield$Promise$all8[2];if(!this._cancelled){_context56.n=4;break;}return _context56.a(2);case 4:div=this.div=document.createElement("div");div.className="annotationLayer";(_classPrivateFieldGet20=_classPrivateFieldGet(_onAppend2,this))===null||_classPrivateFieldGet20===void 0||_classPrivateFieldGet20.call(this,div);if(!(annotations.length===0)){_context56.n=5;break;}_classPrivateFieldSet(_annotations,this,annotations);this.hide(true);return _context56.a(2);case 5:_assertClassBrand(_AnnotationLayerBuilder_brand,this,_initAnnotationLayer).call(this,viewport,structTreeLayer);_context56.n=6;return this.annotationLayer.render({annotations:annotations,imageResourcesPath:this.imageResourcesPath,renderForms:this.renderForms,linkService:this.linkService,downloadManager:this.downloadManager,annotationStorage:this.annotationStorage,enableScripting:this.enableScripting,hasJSActions:hasJSActions,fieldObjects:fieldObjects});case 6:_classPrivateFieldSet(_annotations,this,annotations);if(this.linkService.isInPresentationMode){_assertClassBrand(_AnnotationLayerBuilder_brand,this,_updatePresentationModeState).call(this,PresentationModeState.FULLSCREEN);}if(!_classPrivateFieldGet(_eventAbortController3,this)){_classPrivateFieldSet(_eventAbortController3,this,new AbortController());(_this$_eventBus=this._eventBus)===null||_this$_eventBus===void 0||_this$_eventBus._on("presentationmodechanged",function(evt){_assertClassBrand(_AnnotationLayerBuilder_brand,_this45,_updatePresentationModeState).call(_this45,evt.state);},{signal:_classPrivateFieldGet(_eventAbortController3,this).signal});}case 7:return _context56.a(2);}},_callee56,this);}));function render(_x41){return _render3.apply(this,arguments);}return render;}()},{key:"cancel",value:function cancel(){var _classPrivateFieldGet21;this._cancelled=true;(_classPrivateFieldGet21=_classPrivateFieldGet(_eventAbortController3,this))===null||_classPrivateFieldGet21===void 0||_classPrivateFieldGet21.abort();_classPrivateFieldSet(_eventAbortController3,this,null);}},{key:"hide",value:function hide(){var internal=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;_classPrivateFieldSet(_externalHide,this,!internal);if(!this.div){return;}this.div.hidden=true;}},{key:"hasEditableAnnotations",value:function hasEditableAnnotations(){var _this$annotationLayer;return!!((_this$annotationLayer=this.annotationLayer)!==null&&_this$annotationLayer!==void 0&&_this$annotationLayer.hasEditableAnnotations());}},{key:"injectLinkAnnotations",value:function(){var _injectLinkAnnotations=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee57(_ref61){var inferredLinks,viewport,_ref61$structTreeLaye,structTreeLayer,newLinks;return _regenerator().w(function(_context57){while(1)switch(_context57.n){case 0:inferredLinks=_ref61.inferredLinks,viewport=_ref61.viewport,_ref61$structTreeLaye=_ref61.structTreeLayer,structTreeLayer=_ref61$structTreeLaye===void 0?null:_ref61$structTreeLaye;if(!(_classPrivateFieldGet(_annotations,this)===null)){_context57.n=1;break;}throw new Error("`render` method must be called before `injectLinkAnnotations`.");case 1:if(!(this._cancelled||_classPrivateFieldGet(_linksInjected,this))){_context57.n=2;break;}return _context57.a(2);case 2:_classPrivateFieldSet(_linksInjected,this,true);newLinks=_classPrivateFieldGet(_annotations,this).length?_assertClassBrand(_AnnotationLayerBuilder_brand,this,_checkInferredLinks).call(this,inferredLinks):inferredLinks;if(newLinks.length){_context57.n=3;break;}return _context57.a(2);case 3:if(!this.annotationLayer){_assertClassBrand(_AnnotationLayerBuilder_brand,this,_initAnnotationLayer).call(this,viewport,structTreeLayer);setLayerDimensions(this.div,viewport);}_context57.n=4;return this.annotationLayer.addLinkAnnotations(newLinks,this.linkService);case 4:if(!_classPrivateFieldGet(_externalHide,this)){this.div.hidden=false;}case 5:return _context57.a(2);}},_callee57,this);}));function injectLinkAnnotations(_x42){return _injectLinkAnnotations.apply(this,arguments);}return injectLinkAnnotations;}()}]);}();function _initAnnotationLayer(viewport,structTreeLayer){this.annotationLayer=new AnnotationLayer({div:this.div,accessibilityManager:this._accessibilityManager,annotationCanvasMap:this._annotationCanvasMap,annotationEditorUIManager:this._annotationEditorUIManager,page:this.pdfPage,viewport:viewport.clone({dontFlip:true}),structTreeLayer:structTreeLayer});}function _updatePresentationModeState(state){if(!this.div){return;}var disableFormElements=false;switch(state){case PresentationModeState.FULLSCREEN:disableFormElements=true;break;case PresentationModeState.NORMAL:break;default:return;}var _iterator56=_createForOfIteratorHelper(this.div.childNodes),_step56;try{for(_iterator56.s();!(_step56=_iterator56.n()).done;){var section=_step56.value;if(section.hasAttribute("data-internal-link")){continue;}section.inert=disableFormElements;}}catch(err){_iterator56.e(err);}finally{_iterator56.f();}}function _checkInferredLinks(inferredLinks){var _this109=this;function annotationRects(annot){if(!annot.quadPoints){return[annot.rect];}var rects=[];for(var i=2,ii=annot.quadPoints.length;i<ii;i+=8){var trX=annot.quadPoints[i];var trY=annot.quadPoints[i+1];var blX=annot.quadPoints[i+2];var blY=annot.quadPoints[i+3];rects.push([blX,blY,trX,trY]);}return rects;}function intersectAnnotations(annot1,annot2){var intersections=[];var annot1Rects=annotationRects(annot1);var annot2Rects=annotationRects(annot2);var _iterator57=_createForOfIteratorHelper(annot1Rects),_step57;try{for(_iterator57.s();!(_step57=_iterator57.n()).done;){var rect1=_step57.value;var _iterator58=_createForOfIteratorHelper(annot2Rects),_step58;try{for(_iterator58.s();!(_step58=_iterator58.n()).done;){var rect2=_step58.value;var intersection=Util.intersect(rect1,rect2);if(intersection){intersections.push(intersection);}}}catch(err){_iterator58.e(err);}finally{_iterator58.f();}}}catch(err){_iterator57.e(err);}finally{_iterator57.f();}return intersections;}function areaRects(rects){var totalArea=0;var _iterator59=_createForOfIteratorHelper(rects),_step59;try{for(_iterator59.s();!(_step59=_iterator59.n()).done;){var rect=_step59.value;totalArea+=Math.abs((rect[2]-rect[0])*(rect[3]-rect[1]));}}catch(err){_iterator59.e(err);}finally{_iterator59.f();}return totalArea;}return inferredLinks.filter(function(link){var linkAreaRects;var _iterator60=_createForOfIteratorHelper(_classPrivateFieldGet(_annotations,_this109)),_step60;try{for(_iterator60.s();!(_step60=_iterator60.n()).done;){var annotation=_step60.value;if(annotation.annotationType!==AnnotationType.LINK||!annotation.url){continue;}var intersections=intersectAnnotations(annotation,link);if(intersections.length===0){continue;}linkAreaRects!==null&&linkAreaRects!==void 0?linkAreaRects:linkAreaRects=areaRects(annotationRects(link));if(areaRects(intersections)/linkAreaRects>0.5){return false;}}}catch(err){_iterator60.e(err);}finally{_iterator60.f();}return true;});};// ./web/autolinker.js
function DOMRectToPDF(_ref62,pdfPageView){var width=_ref62.width,height=_ref62.height,left=_ref62.left,top=_ref62.top;if(width===0||height===0){return null;}var pageBox=pdfPageView.textLayer.div.getBoundingClientRect();var bottomLeft=pdfPageView.getPagePoint(left-pageBox.left,top-pageBox.top);var topRight=pdfPageView.getPagePoint(left-pageBox.left+width,top-pageBox.top+height);return Util.normalizeRect([bottomLeft[0],bottomLeft[1],topRight[0],topRight[1]]);}function calculateLinkPosition(range,pdfPageView){var rangeRects=range.getClientRects();if(rangeRects.length===1){return{rect:DOMRectToPDF(rangeRects[0],pdfPageView)};}var rect=[Infinity,Infinity,-Infinity,-Infinity];var quadPoints=[];var i=0;var _iterator28=_createForOfIteratorHelper(rangeRects),_step28;try{for(_iterator28.s();!(_step28=_iterator28.n()).done;){var domRect=_step28.value;var normalized=DOMRectToPDF(domRect,pdfPageView);if(normalized===null){continue;}quadPoints[i]=quadPoints[i+4]=normalized[0];quadPoints[i+1]=quadPoints[i+3]=normalized[3];quadPoints[i+2]=quadPoints[i+6]=normalized[2];quadPoints[i+5]=quadPoints[i+7]=normalized[1];Util.rectBoundingBox.apply(Util,_toConsumableArray(normalized).concat([rect]));i+=8;}}catch(err){_iterator28.e(err);}finally{_iterator28.f();}return{quadPoints:quadPoints,rect:rect};}function textPosition(container,offset){var currentContainer=container;do{if(currentContainer.nodeType===Node.TEXT_NODE){var currentLength=currentContainer.textContent.length;if(offset<=currentLength){return[currentContainer,offset];}offset-=currentLength;}else if(currentContainer.firstChild){currentContainer=currentContainer.firstChild;continue;}while(!currentContainer.nextSibling&&currentContainer!==container){currentContainer=currentContainer.parentNode;}if(currentContainer!==container){currentContainer=currentContainer.nextSibling;}}while(currentContainer!==container);throw new Error("Offset is bigger than container's contents length.");}function createLinkAnnotation(_ref63,pdfPageView,id){var url=_ref63.url,index=_ref63.index,length=_ref63.length;var highlighter=pdfPageView._textHighlighter;var _highlighter$_convert=highlighter._convertMatches([index],[length]),_highlighter$_convert2=_slicedToArray(_highlighter$_convert,1),_highlighter$_convert3=_highlighter$_convert2[0],begin=_highlighter$_convert3.begin,end=_highlighter$_convert3.end;var range=new Range();range.setStart.apply(range,_toConsumableArray(textPosition(highlighter.textDivs[begin.divIdx],begin.offset)));range.setEnd.apply(range,_toConsumableArray(textPosition(highlighter.textDivs[end.divIdx],end.offset)));return _objectSpread(_objectSpread({id:"inferred_link_".concat(id),unsafeUrl:url,url:url,annotationType:AnnotationType.LINK,rotation:0},calculateLinkPosition(range,pdfPageView)),{},{borderStyle:null});}var Autolinker=/*#__PURE__*/function(){function Autolinker(){_classCallCheck(this,Autolinker);}return _createClass(Autolinker,null,[{key:"findLinks",value:function findLinks(text){var _assertClassBrand$_;(_assertClassBrand$_=_assertClassBrand(Autolinker,this,_regex)._)!==null&&_assertClassBrand$_!==void 0?_assertClassBrand$_:_regex._=_assertClassBrand(Autolinker,this,/\b(?:https?:\/\/|mailto:|www\.)(?:(?:[\0-\x08\x0E-\x1F\$\+0-9=A-Z\^`-z\|~-\x9F\xA2-\xA6\xA8-\xAA\xAC-\xB5\xB8-\xBA\xBC-\xBE\xC0-\u037D\u037F-\u0386\u0388-\u0559\u0560-\u0588\u058B-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7-\u05F2\u05F5-\u0608\u060B\u060E-\u061A\u061C\u0620-\u0669\u066E-\u06D3\u06D5-\u06FF\u070E-\u07F6\u07FA-\u082F\u083F-\u085D\u085F-\u0963\u0966-\u096F\u0971-\u09FC\u09FE-\u0A75\u0A77-\u0AEF\u0AF1-\u0C76\u0C78-\u0C83\u0C85-\u0DF3\u0DF5-\u0E4E\u0E50-\u0E59\u0E5C-\u0F03\u0F13\u0F15-\u0F39\u0F3E-\u0F84\u0F86-\u0FCF\u0FD5-\u0FD8\u0FDB-\u1049\u1050-\u10FA\u10FC-\u135F\u1369-\u13FF\u1401-\u166D\u166F-\u167F\u1681-\u169A\u169D-\u16EA\u16EE-\u1734\u1737-\u17D3\u17D7\u17DB-\u17FF\u180B-\u1943\u1946-\u1A1D\u1A20-\u1A9F\u1AA7\u1AAE-\u1B4D\u1B50-\u1B59\u1B61-\u1B7C\u1B80-\u1BFB\u1C00-\u1C3A\u1C40-\u1C7D\u1C80-\u1CBF\u1CC8-\u1CD2\u1CD4-\u1FFF\u200B-\u200F\u202A-\u202E\u2044\u2052\u2060-\u207C\u207F-\u208C\u208F-\u2307\u230C-\u2328\u232B-\u2767\u2776-\u27C4\u27C7-\u27E5\u27F0-\u2982\u2999-\u29D7\u29DC-\u29FB\u29FE-\u2CF8\u2CFD\u2D00-\u2D6F\u2D71-\u2DFF\u2E2F\u2E50\u2E51\u2E5E-\u2FFF\u3004-\u3007\u3012\u3013\u3020-\u302F\u3031-\u303C\u303E-\u309F\u30A1-\u30FA\u30FC-\uA4FD\uA500-\uA60C\uA610-\uA672\uA674-\uA67D\uA67F-\uA6F1\uA6F8-\uA873\uA878-\uA8CD\uA8D0-\uA8F7\uA8FB\uA8FD-\uA92D\uA930-\uA95E\uA960-\uA9C0\uA9CE-\uA9DD\uA9E0-\uAA5B\uAA60-\uAADD\uAAE0-\uAAEF\uAAF2-\uABEA\uABEC-\uFD3D\uFD40-\uFE0F\uFE1A-\uFE2F\uFE53\uFE62\uFE64-\uFE67\uFE69\uFE6C-\uFEFE\uFF00\uFF04\uFF0B\uFF10-\uFF19\uFF1C-\uFF1E\uFF21-\uFF3A\uFF3E\uFF40-\uFF5A\uFF5C\uFF5E\uFF66-\uFFFF]|\uD800[\uDC00-\uDCFF\uDD03-\uDF9E\uDFA0-\uDFCF\uDFD1-\uDFFF]|\uD801[\uDC00-\uDD6E\uDD70-\uDFFF]|\uD802[\uDC00-\uDC56\uDC58-\uDD1E\uDD20-\uDD3E\uDD40-\uDE4F\uDE59-\uDE7E\uDE80-\uDEEF\uDEF7-\uDF38\uDF40-\uDF98\uDF9D-\uDFFF]|\uD803[\uDC00-\uDD6D\uDD6F-\uDEAC\uDEAE-\uDF54\uDF5A-\uDF85\uDF8A-\uDFFF]|\uD804[\uDC00-\uDC46\uDC4E-\uDCBA\uDCBD\uDCC2-\uDD3F\uDD44-\uDD73\uDD76-\uDDC4\uDDC9-\uDDCC\uDDCE-\uDDDA\uDDDC\uDDE0-\uDE37\uDE3E-\uDEA8\uDEAA-\uDFD3\uDFD6\uDFD9-\uDFFF]|\uD805[\uDC00-\uDC4A\uDC50-\uDC59\uDC5C\uDC5E-\uDCC5\uDCC7-\uDDC0\uDDD8-\uDE40\uDE44-\uDE5F\uDE6D-\uDEB8\uDEBA-\uDF3B\uDF3F-\uDFFF]|\uD806[\uDC00-\uDC3A\uDC3C-\uDD43\uDD47-\uDDE1\uDDE3-\uDE3E\uDE47-\uDE99\uDE9D\uDEA3-\uDEFF\uDF0A-\uDFE0\uDFE2-\uDFFF]|\uD807[\uDC00-\uDC40\uDC46-\uDC6F\uDC72-\uDEF6\uDEF9-\uDF42\uDF50-\uDFFE]|[\uD808\uD80A\uD80C-\uD819\uD81C-\uD82E\uD830-\uD835\uD837\uD838\uD83B-\uDBFF][\uDC00-\uDFFF]|\uD809[\uDC00-\uDC6F\uDC75-\uDFFF]|\uD80B[\uDC00-\uDFF0\uDFF3-\uDFFF]|\uD81A[\uDC00-\uDE6D\uDE70-\uDEF4\uDEF6-\uDF36\uDF3C-\uDF43\uDF45-\uDFFF]|\uD81B[\uDC00-\uDD6C\uDD70-\uDE96\uDE9B-\uDFE1\uDFE3-\uDFFF]|\uD82F[\uDC00-\uDC9E\uDCA0-\uDFFF]|\uD836[\uDC00-\uDE86\uDE8C-\uDFFF]|\uD839[\uDC00-\uDDFE\uDE00-\uDFFF]|\uD83A[\uDC00-\uDD5D\uDD60-\uDFFF])|\/|(?:[\0-\x08\x0E-\x1F!-Z\\\^-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF])+(?:[\0-\x08\x0E-\x1F\$\+0-9=A-Z\^`-z\|~-\x9F\xA2-\xA6\xA8-\xAA\xAC-\xB5\xB8-\xBA\xBC-\xBE\xC0-\u037D\u037F-\u0386\u0388-\u0559\u0560-\u0588\u058B-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7-\u05F2\u05F5-\u0608\u060B\u060E-\u061A\u061C\u0620-\u0669\u066E-\u06D3\u06D5-\u06FF\u070E-\u07F6\u07FA-\u082F\u083F-\u085D\u085F-\u0963\u0966-\u096F\u0971-\u09FC\u09FE-\u0A75\u0A77-\u0AEF\u0AF1-\u0C76\u0C78-\u0C83\u0C85-\u0DF3\u0DF5-\u0E4E\u0E50-\u0E59\u0E5C-\u0F03\u0F13\u0F15-\u0F39\u0F3E-\u0F84\u0F86-\u0FCF\u0FD5-\u0FD8\u0FDB-\u1049\u1050-\u10FA\u10FC-\u135F\u1369-\u13FF\u1401-\u166D\u166F-\u167F\u1681-\u169A\u169D-\u16EA\u16EE-\u1734\u1737-\u17D3\u17D7\u17DB-\u17FF\u180B-\u1943\u1946-\u1A1D\u1A20-\u1A9F\u1AA7\u1AAE-\u1B4D\u1B50-\u1B59\u1B61-\u1B7C\u1B80-\u1BFB\u1C00-\u1C3A\u1C40-\u1C7D\u1C80-\u1CBF\u1CC8-\u1CD2\u1CD4-\u1FFF\u200B-\u200F\u202A-\u202E\u2044\u2052\u2060-\u207C\u207F-\u208C\u208F-\u2307\u230C-\u2328\u232B-\u2767\u2776-\u27C4\u27C7-\u27E5\u27F0-\u2982\u2999-\u29D7\u29DC-\u29FB\u29FE-\u2CF8\u2CFD\u2D00-\u2D6F\u2D71-\u2DFF\u2E2F\u2E50\u2E51\u2E5E-\u2FFF\u3004-\u3007\u3012\u3013\u3020-\u302F\u3031-\u303C\u303E-\u309F\u30A1-\u30FA\u30FC-\uA4FD\uA500-\uA60C\uA610-\uA672\uA674-\uA67D\uA67F-\uA6F1\uA6F8-\uA873\uA878-\uA8CD\uA8D0-\uA8F7\uA8FB\uA8FD-\uA92D\uA930-\uA95E\uA960-\uA9C0\uA9CE-\uA9DD\uA9E0-\uAA5B\uAA60-\uAADD\uAAE0-\uAAEF\uAAF2-\uABEA\uABEC-\uFD3D\uFD40-\uFE0F\uFE1A-\uFE2F\uFE53\uFE62\uFE64-\uFE67\uFE69\uFE6C-\uFEFE\uFF00\uFF04\uFF0B\uFF10-\uFF19\uFF1C-\uFF1E\uFF21-\uFF3A\uFF3E\uFF40-\uFF5A\uFF5C\uFF5E\uFF66-\uFFFF]|\uD800[\uDC00-\uDCFF\uDD03-\uDF9E\uDFA0-\uDFCF\uDFD1-\uDFFF]|\uD801[\uDC00-\uDD6E\uDD70-\uDFFF]|\uD802[\uDC00-\uDC56\uDC58-\uDD1E\uDD20-\uDD3E\uDD40-\uDE4F\uDE59-\uDE7E\uDE80-\uDEEF\uDEF7-\uDF38\uDF40-\uDF98\uDF9D-\uDFFF]|\uD803[\uDC00-\uDD6D\uDD6F-\uDEAC\uDEAE-\uDF54\uDF5A-\uDF85\uDF8A-\uDFFF]|\uD804[\uDC00-\uDC46\uDC4E-\uDCBA\uDCBD\uDCC2-\uDD3F\uDD44-\uDD73\uDD76-\uDDC4\uDDC9-\uDDCC\uDDCE-\uDDDA\uDDDC\uDDE0-\uDE37\uDE3E-\uDEA8\uDEAA-\uDFD3\uDFD6\uDFD9-\uDFFF]|\uD805[\uDC00-\uDC4A\uDC50-\uDC59\uDC5C\uDC5E-\uDCC5\uDCC7-\uDDC0\uDDD8-\uDE40\uDE44-\uDE5F\uDE6D-\uDEB8\uDEBA-\uDF3B\uDF3F-\uDFFF]|\uD806[\uDC00-\uDC3A\uDC3C-\uDD43\uDD47-\uDDE1\uDDE3-\uDE3E\uDE47-\uDE99\uDE9D\uDEA3-\uDEFF\uDF0A-\uDFE0\uDFE2-\uDFFF]|\uD807[\uDC00-\uDC40\uDC46-\uDC6F\uDC72-\uDEF6\uDEF9-\uDF42\uDF50-\uDFFE]|[\uD808\uD80A\uD80C-\uD819\uD81C-\uD82E\uD830-\uD835\uD837\uD838\uD83B-\uDBFF][\uDC00-\uDFFF]|\uD809[\uDC00-\uDC6F\uDC75-\uDFFF]|\uD80B[\uDC00-\uDFF0\uDFF3-\uDFFF]|\uD81A[\uDC00-\uDE6D\uDE70-\uDEF4\uDEF6-\uDF36\uDF3C-\uDF43\uDF45-\uDFFF]|\uD81B[\uDC00-\uDD6C\uDD70-\uDE96\uDE9B-\uDFE1\uDFE3-\uDFFF]|\uD82F[\uDC00-\uDC9E\uDCA0-\uDFFF]|\uD836[\uDC00-\uDE86\uDE8C-\uDFFF]|\uD839[\uDC00-\uDDFE\uDE00-\uDFFF]|\uD83A[\uDC00-\uDD5D\uDD60-\uDFFF]))+|\b(?:[\0-\x08\x0E-\x1F!-'\*-;=\?A-Z\\\^-z\|~-\x9F\xA1-\u0F39\u0F3E-\u167F\u1681-\u169A\u169D-\u1FFF\u200B-\u2019\u201B-\u201D\u201F-\u2027\u202A-\u202E\u2030-\u2044\u2047-\u205E\u2060-\u207C\u207F-\u208C\u208F-\u2307\u230C-\u2328\u232B-\u2767\u2776-\u27C4\u27C7-\u27E5\u27F0-\u2982\u2999-\u29D7\u29DC-\u29FB\u29FE-\u2E21\u2E2A-\u2E41\u2E43-\u2E54\u2E5D-\u2FFF\u3001-\u3007\u3012\u3013\u301C\u3020-\uFD3D\uFD40-\uFE16\uFE19-\uFE34\uFE45\uFE46\uFE49-\uFE58\uFE5F-\uFEFE\uFF00-\uFF07\uFF0A-\uFF3A\uFF3C\uFF3E-\uFF5A\uFF5C\uFF5E\uFF61\uFF64-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF])+@((?:[\0-\x08\x0E-\x1F\$\+0-9=A-Z\^`-z\|~-\x9F\xA2-\xA6\xA8-\xAA\xAC-\xB5\xB8-\xBA\xBC-\xBE\xC0-\u037D\u037F-\u0386\u0388-\u0559\u0560-\u0588\u058B-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7-\u05F2\u05F5-\u0608\u060B\u060E-\u061A\u061C\u0620-\u0669\u066E-\u06D3\u06D5-\u06FF\u070E-\u07F6\u07FA-\u082F\u083F-\u085D\u085F-\u0963\u0966-\u096F\u0971-\u09FC\u09FE-\u0A75\u0A77-\u0AEF\u0AF1-\u0C76\u0C78-\u0C83\u0C85-\u0DF3\u0DF5-\u0E4E\u0E50-\u0E59\u0E5C-\u0F03\u0F13\u0F15-\u0F39\u0F3E-\u0F84\u0F86-\u0FCF\u0FD5-\u0FD8\u0FDB-\u1049\u1050-\u10FA\u10FC-\u135F\u1369-\u13FF\u1401-\u166D\u166F-\u167F\u1681-\u169A\u169D-\u16EA\u16EE-\u1734\u1737-\u17D3\u17D7\u17DB-\u17FF\u180B-\u1943\u1946-\u1A1D\u1A20-\u1A9F\u1AA7\u1AAE-\u1B4D\u1B50-\u1B59\u1B61-\u1B7C\u1B80-\u1BFB\u1C00-\u1C3A\u1C40-\u1C7D\u1C80-\u1CBF\u1CC8-\u1CD2\u1CD4-\u1FFF\u200B-\u200F\u202A-\u202E\u2044\u2052\u2060-\u207C\u207F-\u208C\u208F-\u2307\u230C-\u2328\u232B-\u2767\u2776-\u27C4\u27C7-\u27E5\u27F0-\u2982\u2999-\u29D7\u29DC-\u29FB\u29FE-\u2CF8\u2CFD\u2D00-\u2D6F\u2D71-\u2DFF\u2E2F\u2E50\u2E51\u2E5E-\u2FFF\u3004-\u3007\u3012\u3013\u3020-\u302F\u3031-\u303C\u303E-\u309F\u30A1-\u30FA\u30FC-\uA4FD\uA500-\uA60C\uA610-\uA672\uA674-\uA67D\uA67F-\uA6F1\uA6F8-\uA873\uA878-\uA8CD\uA8D0-\uA8F7\uA8FB\uA8FD-\uA92D\uA930-\uA95E\uA960-\uA9C0\uA9CE-\uA9DD\uA9E0-\uAA5B\uAA60-\uAADD\uAAE0-\uAAEF\uAAF2-\uABEA\uABEC-\uFD3D\uFD40-\uFE0F\uFE1A-\uFE2F\uFE53\uFE62\uFE64-\uFE67\uFE69\uFE6C-\uFEFE\uFF00\uFF04\uFF0B\uFF10-\uFF19\uFF1C-\uFF1E\uFF21-\uFF3A\uFF3E\uFF40-\uFF5A\uFF5C\uFF5E\uFF66-\uFFFF]|\uD800[\uDC00-\uDCFF\uDD03-\uDF9E\uDFA0-\uDFCF\uDFD1-\uDFFF]|\uD801[\uDC00-\uDD6E\uDD70-\uDFFF]|\uD802[\uDC00-\uDC56\uDC58-\uDD1E\uDD20-\uDD3E\uDD40-\uDE4F\uDE59-\uDE7E\uDE80-\uDEEF\uDEF7-\uDF38\uDF40-\uDF98\uDF9D-\uDFFF]|\uD803[\uDC00-\uDD6D\uDD6F-\uDEAC\uDEAE-\uDF54\uDF5A-\uDF85\uDF8A-\uDFFF]|\uD804[\uDC00-\uDC46\uDC4E-\uDCBA\uDCBD\uDCC2-\uDD3F\uDD44-\uDD73\uDD76-\uDDC4\uDDC9-\uDDCC\uDDCE-\uDDDA\uDDDC\uDDE0-\uDE37\uDE3E-\uDEA8\uDEAA-\uDFD3\uDFD6\uDFD9-\uDFFF]|\uD805[\uDC00-\uDC4A\uDC50-\uDC59\uDC5C\uDC5E-\uDCC5\uDCC7-\uDDC0\uDDD8-\uDE40\uDE44-\uDE5F\uDE6D-\uDEB8\uDEBA-\uDF3B\uDF3F-\uDFFF]|\uD806[\uDC00-\uDC3A\uDC3C-\uDD43\uDD47-\uDDE1\uDDE3-\uDE3E\uDE47-\uDE99\uDE9D\uDEA3-\uDEFF\uDF0A-\uDFE0\uDFE2-\uDFFF]|\uD807[\uDC00-\uDC40\uDC46-\uDC6F\uDC72-\uDEF6\uDEF9-\uDF42\uDF50-\uDFFE]|[\uD808\uD80A\uD80C-\uD819\uD81C-\uD82E\uD830-\uD835\uD837\uD838\uD83B-\uDBFF][\uDC00-\uDFFF]|\uD809[\uDC00-\uDC6F\uDC75-\uDFFF]|\uD80B[\uDC00-\uDFF0\uDFF3-\uDFFF]|\uD81A[\uDC00-\uDE6D\uDE70-\uDEF4\uDEF6-\uDF36\uDF3C-\uDF43\uDF45-\uDFFF]|\uD81B[\uDC00-\uDD6C\uDD70-\uDE96\uDE9B-\uDFE1\uDFE3-\uDFFF]|\uD82F[\uDC00-\uDC9E\uDCA0-\uDFFF]|\uD836[\uDC00-\uDE86\uDE8C-\uDFFF]|\uD839[\uDC00-\uDDFE\uDE00-\uDFFF]|\uD83A[\uDC00-\uDD5D\uDD60-\uDFFF])+(?:\.(?:[\0-\x08\x0E-\x1F\$\+0-9=A-Z\^`-z\|~-\x9F\xA2-\xA6\xA8-\xAA\xAC-\xB5\xB8-\xBA\xBC-\xBE\xC0-\u037D\u037F-\u0386\u0388-\u0559\u0560-\u0588\u058B-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7-\u05F2\u05F5-\u0608\u060B\u060E-\u061A\u061C\u0620-\u0669\u066E-\u06D3\u06D5-\u06FF\u070E-\u07F6\u07FA-\u082F\u083F-\u085D\u085F-\u0963\u0966-\u096F\u0971-\u09FC\u09FE-\u0A75\u0A77-\u0AEF\u0AF1-\u0C76\u0C78-\u0C83\u0C85-\u0DF3\u0DF5-\u0E4E\u0E50-\u0E59\u0E5C-\u0F03\u0F13\u0F15-\u0F39\u0F3E-\u0F84\u0F86-\u0FCF\u0FD5-\u0FD8\u0FDB-\u1049\u1050-\u10FA\u10FC-\u135F\u1369-\u13FF\u1401-\u166D\u166F-\u167F\u1681-\u169A\u169D-\u16EA\u16EE-\u1734\u1737-\u17D3\u17D7\u17DB-\u17FF\u180B-\u1943\u1946-\u1A1D\u1A20-\u1A9F\u1AA7\u1AAE-\u1B4D\u1B50-\u1B59\u1B61-\u1B7C\u1B80-\u1BFB\u1C00-\u1C3A\u1C40-\u1C7D\u1C80-\u1CBF\u1CC8-\u1CD2\u1CD4-\u1FFF\u200B-\u200F\u202A-\u202E\u2044\u2052\u2060-\u207C\u207F-\u208C\u208F-\u2307\u230C-\u2328\u232B-\u2767\u2776-\u27C4\u27C7-\u27E5\u27F0-\u2982\u2999-\u29D7\u29DC-\u29FB\u29FE-\u2CF8\u2CFD\u2D00-\u2D6F\u2D71-\u2DFF\u2E2F\u2E50\u2E51\u2E5E-\u2FFF\u3004-\u3007\u3012\u3013\u3020-\u302F\u3031-\u303C\u303E-\u309F\u30A1-\u30FA\u30FC-\uA4FD\uA500-\uA60C\uA610-\uA672\uA674-\uA67D\uA67F-\uA6F1\uA6F8-\uA873\uA878-\uA8CD\uA8D0-\uA8F7\uA8FB\uA8FD-\uA92D\uA930-\uA95E\uA960-\uA9C0\uA9CE-\uA9DD\uA9E0-\uAA5B\uAA60-\uAADD\uAAE0-\uAAEF\uAAF2-\uABEA\uABEC-\uFD3D\uFD40-\uFE0F\uFE1A-\uFE2F\uFE53\uFE62\uFE64-\uFE67\uFE69\uFE6C-\uFEFE\uFF00\uFF04\uFF0B\uFF10-\uFF19\uFF1C-\uFF1E\uFF21-\uFF3A\uFF3E\uFF40-\uFF5A\uFF5C\uFF5E\uFF66-\uFFFF]|\uD800[\uDC00-\uDCFF\uDD03-\uDF9E\uDFA0-\uDFCF\uDFD1-\uDFFF]|\uD801[\uDC00-\uDD6E\uDD70-\uDFFF]|\uD802[\uDC00-\uDC56\uDC58-\uDD1E\uDD20-\uDD3E\uDD40-\uDE4F\uDE59-\uDE7E\uDE80-\uDEEF\uDEF7-\uDF38\uDF40-\uDF98\uDF9D-\uDFFF]|\uD803[\uDC00-\uDD6D\uDD6F-\uDEAC\uDEAE-\uDF54\uDF5A-\uDF85\uDF8A-\uDFFF]|\uD804[\uDC00-\uDC46\uDC4E-\uDCBA\uDCBD\uDCC2-\uDD3F\uDD44-\uDD73\uDD76-\uDDC4\uDDC9-\uDDCC\uDDCE-\uDDDA\uDDDC\uDDE0-\uDE37\uDE3E-\uDEA8\uDEAA-\uDFD3\uDFD6\uDFD9-\uDFFF]|\uD805[\uDC00-\uDC4A\uDC50-\uDC59\uDC5C\uDC5E-\uDCC5\uDCC7-\uDDC0\uDDD8-\uDE40\uDE44-\uDE5F\uDE6D-\uDEB8\uDEBA-\uDF3B\uDF3F-\uDFFF]|\uD806[\uDC00-\uDC3A\uDC3C-\uDD43\uDD47-\uDDE1\uDDE3-\uDE3E\uDE47-\uDE99\uDE9D\uDEA3-\uDEFF\uDF0A-\uDFE0\uDFE2-\uDFFF]|\uD807[\uDC00-\uDC40\uDC46-\uDC6F\uDC72-\uDEF6\uDEF9-\uDF42\uDF50-\uDFFE]|[\uD808\uD80A\uD80C-\uD819\uD81C-\uD82E\uD830-\uD835\uD837\uD838\uD83B-\uDBFF][\uDC00-\uDFFF]|\uD809[\uDC00-\uDC6F\uDC75-\uDFFF]|\uD80B[\uDC00-\uDFF0\uDFF3-\uDFFF]|\uD81A[\uDC00-\uDE6D\uDE70-\uDEF4\uDEF6-\uDF36\uDF3C-\uDF43\uDF45-\uDFFF]|\uD81B[\uDC00-\uDD6C\uDD70-\uDE96\uDE9B-\uDFE1\uDFE3-\uDFFF]|\uD82F[\uDC00-\uDC9E\uDCA0-\uDFFF]|\uD836[\uDC00-\uDE86\uDE8C-\uDFFF]|\uD839[\uDC00-\uDDFE\uDE00-\uDFFF]|\uD83A[\uDC00-\uDD5D\uDD60-\uDFFF])+)+)/gm);var _normalize=normalize(text),_normalize2=_slicedToArray(_normalize,2),normalizedText=_normalize2[0],diffs=_normalize2[1];var matches=normalizedText.matchAll(_assertClassBrand(Autolinker,this,_regex)._);var links=[];var _iterator29=_createForOfIteratorHelper(matches),_step29;try{for(_iterator29.s();!(_step29=_iterator29.n()).done;){var _match7=_step29.value;var _match8=_slicedToArray(_match7,2),url=_match8[0],emailDomain=_match8[1];var raw=void 0;if(url.startsWith("www.")||url.startsWith("http://")||url.startsWith("https://")){raw=url;}else if(URL.canParse("http://".concat(emailDomain))){raw=url.startsWith("mailto:")?url:"mailto:".concat(url);}else{continue;}var absoluteURL=createValidAbsoluteUrl(raw,null,{addDefaultProtocol:true});if(absoluteURL){var _getOriginalIndex=getOriginalIndex(diffs,_match7.index,url.length),_getOriginalIndex2=_slicedToArray(_getOriginalIndex,2),index=_getOriginalIndex2[0],length=_getOriginalIndex2[1];links.push({url:absoluteURL.href,index:index,length:length});}}}catch(err){_iterator29.e(err);}finally{_iterator29.f();}return links;}},{key:"processLinks",value:function processLinks(pdfPageView){var _this46=this;return this.findLinks(pdfPageView._textHighlighter.textContentItemsStr.join("\n")).map(function(link){var _this$index,_this$index2;return createLinkAnnotation(link,pdfPageView,(_index._=_assertClassBrand(Autolinker,_this46,(_this$index=_assertClassBrand(Autolinker,_this46,_index)._,_this$index2=_this$index++,_this$index)),_this$index2));});}}]);}();var _index={_:0};var _regex={_:void 0};;// ./web/base_pdf_page_view.js
var _enableHWA2=/*#__PURE__*/new WeakMap();var _loadingId=/*#__PURE__*/new WeakMap();var _renderError=/*#__PURE__*/new WeakMap();var _renderingState=/*#__PURE__*/new WeakMap();var _showCanvas=/*#__PURE__*/new WeakMap();var _renderContinueCallback=/*#__PURE__*/new WeakMap();var BasePDFPageView=/*#__PURE__*/function(){function BasePDFPageView(options){var _this47=this;_classCallCheck(this,BasePDFPageView);_classPrivateFieldInitSpec(this,_enableHWA2,false);_classPrivateFieldInitSpec(this,_loadingId,null);_classPrivateFieldInitSpec(this,_renderError,null);_classPrivateFieldInitSpec(this,_renderingState,RenderingStates.INITIAL);_classPrivateFieldInitSpec(this,_showCanvas,null);_defineProperty(this,"canvas",null);_defineProperty(this,"div",null);_defineProperty(this,"eventBus",null);_defineProperty(this,"id",null);_defineProperty(this,"pageColors",null);_defineProperty(this,"renderingQueue",null);_defineProperty(this,"renderTask",null);_defineProperty(this,"resume",null);_classPrivateFieldInitSpec(this,_renderContinueCallback,function(cont){var _classPrivateFieldGet22;(_classPrivateFieldGet22=_classPrivateFieldGet(_showCanvas,_this47))===null||_classPrivateFieldGet22===void 0||_classPrivateFieldGet22.call(_this47,false);if(_this47.renderingQueue&&!_this47.renderingQueue.isHighestPriority(_this47)){_this47.renderingState=RenderingStates.PAUSED;_this47.resume=function(){_this47.renderingState=RenderingStates.RUNNING;cont();};return;}cont();});_classPrivateFieldSet(_enableHWA2,this,_enableHWA2.has(_checkInRHS(options))?_classPrivateFieldGet(_enableHWA2,options):options.enableHWA||false);this.eventBus=options.eventBus;this.id=options.id;this.pageColors=options.pageColors||null;this.renderingQueue=options.renderingQueue;}return _createClass(BasePDFPageView,[{key:"renderingState",get:function get(){return _classPrivateFieldGet(_renderingState,this);},set:function set(state){var _this48=this;if(state===_classPrivateFieldGet(_renderingState,this)){return;}_classPrivateFieldSet(_renderingState,this,state);if(_classPrivateFieldGet(_loadingId,this)){clearTimeout(_classPrivateFieldGet(_loadingId,this));_classPrivateFieldSet(_loadingId,this,null);}switch(state){case RenderingStates.PAUSED:this.div.classList.remove("loading");break;case RenderingStates.RUNNING:this.div.classList.add("loadingIcon");_classPrivateFieldSet(_loadingId,this,setTimeout(function(){_this48.div.classList.add("loading");_classPrivateFieldSet(_loadingId,_this48,null);},0));break;case RenderingStates.INITIAL:case RenderingStates.FINISHED:this.div.classList.remove("loadingIcon","loading");break;}}},{key:"_createCanvas",value:function _createCanvas(onShow){var _this49=this;var hideUntilComplete=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var pageColors=this.pageColors;var hasHCM=!!(pageColors!==null&&pageColors!==void 0&&pageColors.background&&pageColors!==null&&pageColors!==void 0&&pageColors.foreground);var prevCanvas=this.canvas;var updateOnFirstShow=!prevCanvas&&!hasHCM&&!hideUntilComplete;var canvas=this.canvas=document.createElement("canvas");_classPrivateFieldSet(_showCanvas,this,function(isLastShow){if(updateOnFirstShow){onShow(canvas);_classPrivateFieldSet(_showCanvas,_this49,null);return;}if(!isLastShow){return;}if(prevCanvas){prevCanvas.replaceWith(canvas);prevCanvas.width=prevCanvas.height=0;}else{onShow(canvas);}});var ctx=canvas.getContext("2d",{alpha:false,willReadFrequently:!_classPrivateFieldGet(_enableHWA2,this)});return{canvas:canvas,prevCanvas:prevCanvas,ctx:ctx};}},{key:"_resetCanvas",value:function _resetCanvas(){var canvas=this.canvas;if(!canvas){return;}canvas.remove();canvas.width=canvas.height=0;this.canvas=null;}},{key:"_drawCanvas",value:function(){var _drawCanvas2=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee58(options,onCancel,onFinish){var _this50=this;var renderTask,error,_classPrivateFieldGet23,_classPrivateFieldGet24,_t18;return _regenerator().w(function(_context58){while(1)switch(_context58.n){case 0:renderTask=this.renderTask=this.pdfPage.render(options);renderTask.onContinue=_classPrivateFieldGet(_renderContinueCallback,this);renderTask.onError=function(error){if(error instanceof RenderingCancelledException){onCancel();_classPrivateFieldSet(_renderError,_this50,null);}};error=null;_context58.p=1;_context58.n=2;return renderTask.promise;case 2:(_classPrivateFieldGet23=_classPrivateFieldGet(_showCanvas,this))===null||_classPrivateFieldGet23===void 0||_classPrivateFieldGet23.call(this,true);_context58.n=5;break;case 3:_context58.p=3;_t18=_context58.v;if(!(_t18 instanceof RenderingCancelledException)){_context58.n=4;break;}return _context58.a(2);case 4:error=_t18;(_classPrivateFieldGet24=_classPrivateFieldGet(_showCanvas,this))===null||_classPrivateFieldGet24===void 0||_classPrivateFieldGet24.call(this,true);case 5:_context58.p=5;_classPrivateFieldSet(_renderError,this,error);if(renderTask===this.renderTask){this.renderTask=null;}return _context58.f(5);case 6:this.renderingState=RenderingStates.FINISHED;onFinish(renderTask);if(!error){_context58.n=7;break;}throw error;case 7:return _context58.a(2);}},_callee58,this,[[1,3,5,6]]);}));function _drawCanvas(_x43,_x44,_x45){return _drawCanvas2.apply(this,arguments);}return _drawCanvas;}()},{key:"cancelRendering",value:function cancelRendering(){var _ref64=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},_ref64$cancelExtraDel=_ref64.cancelExtraDelay,cancelExtraDelay=_ref64$cancelExtraDel===void 0?0:_ref64$cancelExtraDel;if(this.renderTask){this.renderTask.cancel(cancelExtraDelay);this.renderTask=null;}this.resume=null;}},{key:"dispatchPageRender",value:function dispatchPageRender(){this.eventBus.dispatch("pagerender",{source:this,pageNumber:this.id});}},{key:"dispatchPageRendered",value:function dispatchPageRendered(cssTransform,isDetailView){this.eventBus.dispatch("pagerendered",{source:this,pageNumber:this.id,cssTransform:cssTransform,isDetailView:isDetailView,timestamp:performance.now(),error:_classPrivateFieldGet(_renderError,this)});}}]);}();;// ./web/draw_layer_builder.js
var _drawLayer2=/*#__PURE__*/new WeakMap();var DrawLayerBuilder=/*#__PURE__*/function(){function DrawLayerBuilder(options){_classCallCheck(this,DrawLayerBuilder);_classPrivateFieldInitSpec(this,_drawLayer2,null);this.pageIndex=options.pageIndex;}return _createClass(DrawLayerBuilder,[{key:"render",value:function(){var _render4=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee59(_ref65){var _ref65$intent,intent;return _regenerator().w(function(_context59){while(1)switch(_context59.n){case 0:_ref65$intent=_ref65.intent,intent=_ref65$intent===void 0?"display":_ref65$intent;if(!(intent!=="display"||_classPrivateFieldGet(_drawLayer2,this)||this._cancelled)){_context59.n=1;break;}return _context59.a(2);case 1:_classPrivateFieldSet(_drawLayer2,this,new DrawLayer({pageIndex:this.pageIndex}));case 2:return _context59.a(2);}},_callee59,this);}));function render(_x46){return _render4.apply(this,arguments);}return render;}()},{key:"cancel",value:function cancel(){this._cancelled=true;if(!_classPrivateFieldGet(_drawLayer2,this)){return;}_classPrivateFieldGet(_drawLayer2,this).destroy();_classPrivateFieldSet(_drawLayer2,this,null);}},{key:"setParent",value:function setParent(parent){var _classPrivateFieldGet25;(_classPrivateFieldGet25=_classPrivateFieldGet(_drawLayer2,this))===null||_classPrivateFieldGet25===void 0||_classPrivateFieldGet25.setParent(parent);}},{key:"getDrawLayer",value:function getDrawLayer(){return _classPrivateFieldGet(_drawLayer2,this);}}]);}();;// ./web/pdf_page_detail_view.js
var _detailArea=/*#__PURE__*/new WeakMap();var _PDFPageDetailView_brand=/*#__PURE__*/new WeakSet();var PDFPageDetailView=/*#__PURE__*/function(_BasePDFPageView2){function PDFPageDetailView(_ref66){var _this51;var pageView=_ref66.pageView;_classCallCheck(this,PDFPageDetailView);_this51=_callSuper(this,PDFPageDetailView,[pageView]);_classPrivateMethodInitSpec(_this51,_PDFPageDetailView_brand);_classPrivateFieldInitSpec(_this51,_detailArea,null);_defineProperty(_this51,"renderingCancelled",false);_this51.pageView=pageView;_this51.renderingId="detail"+_this51.id;_this51.div=pageView.div;return _this51;}_inherits(PDFPageDetailView,_BasePDFPageView2);return _createClass(PDFPageDetailView,[{key:"setPdfPage",value:function setPdfPage(pdfPage){this.pageView.setPdfPage(pdfPage);}},{key:"pdfPage",get:function get(){return this.pageView.pdfPage;}},{key:"renderingState",get:function get(){return _superPropGet(PDFPageDetailView,"renderingState",this,1);},set:function set(value){this.renderingCancelled=false;_superPropSet(PDFPageDetailView,"renderingState",value,this,1,1);}},{key:"reset",value:function reset(){var _ref67=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},_ref67$keepCanvas=_ref67.keepCanvas,keepCanvas=_ref67$keepCanvas===void 0?false:_ref67$keepCanvas;var renderingCancelled=this.renderingCancelled||this.renderingState===RenderingStates.RUNNING||this.renderingState===RenderingStates.PAUSED;this.cancelRendering();this.renderingState=RenderingStates.INITIAL;this.renderingCancelled=renderingCancelled;if(!keepCanvas){this._resetCanvas();}}},{key:"update",value:function update(){var _ref68=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},_ref68$visibleArea=_ref68.visibleArea,visibleArea=_ref68$visibleArea===void 0?null:_ref68$visibleArea,_ref68$underlyingView=_ref68.underlyingViewUpdated,underlyingViewUpdated=_ref68$underlyingView===void 0?false:_ref68$underlyingView;if(underlyingViewUpdated){this.cancelRendering();this.renderingState=RenderingStates.INITIAL;return;}if(!_assertClassBrand(_PDFPageDetailView_brand,this,_shouldRenderDifferentArea).call(this,visibleArea)){return;}var _this$pageView=this.pageView,viewport=_this$pageView.viewport,maxCanvasPixels=_this$pageView.maxCanvasPixels;var visibleWidth=visibleArea.maxX-visibleArea.minX;var visibleHeight=visibleArea.maxY-visibleArea.minY;var visiblePixels=visibleWidth*visibleHeight*Math.pow(OutputScale.pixelRatio,2);var maxDetailToVisibleLinearRatio=Math.sqrt(maxCanvasPixels/visiblePixels);var maxOverflowScale=(maxDetailToVisibleLinearRatio-1)/2;var overflowScale=Math.min(1,maxOverflowScale);if(overflowScale<0){overflowScale=0;}var overflowWidth=visibleWidth*overflowScale;var overflowHeight=visibleHeight*overflowScale;var minX=Math.max(0,visibleArea.minX-overflowWidth);var maxX=Math.min(viewport.width,visibleArea.maxX+overflowWidth);var minY=Math.max(0,visibleArea.minY-overflowHeight);var maxY=Math.min(viewport.height,visibleArea.maxY+overflowHeight);var width=maxX-minX;var height=maxY-minY;_classPrivateFieldSet(_detailArea,this,{minX:minX,minY:minY,width:width,height:height,scale:viewport.scale});this.reset({keepCanvas:true});}},{key:"draw",value:function(){var _draw2=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee60(){var _this52=this;var hideUntilComplete,_this$pageView2,div,pdfPage,viewport,canvasWrapper,_this$_createCanvas,canvas,prevCanvas,ctx,width,height,area,pixelRatio,transform,style,renderingPromise;return _regenerator().w(function(_context60){while(1)switch(_context60.n){case 0:if(!(this.pageView.detailView!==this)){_context60.n=1;break;}return _context60.a(2,undefined);case 1:hideUntilComplete=this.pageView.renderingState===RenderingStates.FINISHED||this.renderingState===RenderingStates.FINISHED;if(this.renderingState!==RenderingStates.INITIAL){console.error("Must be in new state before drawing");this.reset();}_this$pageView2=this.pageView,div=_this$pageView2.div,pdfPage=_this$pageView2.pdfPage,viewport=_this$pageView2.viewport;if(pdfPage){_context60.n=2;break;}this.renderingState=RenderingStates.FINISHED;throw new Error("pdfPage is not loaded");case 2:this.renderingState=RenderingStates.RUNNING;canvasWrapper=this.pageView._ensureCanvasWrapper();_this$_createCanvas=this._createCanvas(function(newCanvas){var _canvasWrapper$firstE;if(((_canvasWrapper$firstE=canvasWrapper.firstElementChild)===null||_canvasWrapper$firstE===void 0?void 0:_canvasWrapper$firstE.tagName)==="CANVAS"){canvasWrapper.firstElementChild.after(newCanvas);}else{canvasWrapper.prepend(newCanvas);}},hideUntilComplete),canvas=_this$_createCanvas.canvas,prevCanvas=_this$_createCanvas.prevCanvas,ctx=_this$_createCanvas.ctx;canvas.setAttribute("aria-hidden","true");width=viewport.width,height=viewport.height;area=_classPrivateFieldGet(_detailArea,this);pixelRatio=OutputScale.pixelRatio;transform=[pixelRatio,0,0,pixelRatio,-area.minX*pixelRatio,-area.minY*pixelRatio];canvas.width=area.width*pixelRatio;canvas.height=area.height*pixelRatio;style=canvas.style;style.width="".concat(area.width*100/width,"%");style.height="".concat(area.height*100/height,"%");style.top="".concat(area.minY*100/height,"%");style.left="".concat(area.minX*100/width,"%");renderingPromise=this._drawCanvas(this.pageView._getRenderingContext(ctx,transform),function(){var _this52$canvas;(_this52$canvas=_this52.canvas)===null||_this52$canvas===void 0||_this52$canvas.remove();_this52.canvas=prevCanvas;},function(){_this52.dispatchPageRendered(false,true);});div.setAttribute("data-loaded",true);this.dispatchPageRender();return _context60.a(2,renderingPromise);}},_callee60,this);}));function draw(){return _draw2.apply(this,arguments);}return draw;}()}]);}(BasePDFPageView);function _shouldRenderDifferentArea(visibleArea){if(!_classPrivateFieldGet(_detailArea,this)){return true;}var minDetailX=_classPrivateFieldGet(_detailArea,this).minX;var minDetailY=_classPrivateFieldGet(_detailArea,this).minY;var maxDetailX=_classPrivateFieldGet(_detailArea,this).width+minDetailX;var maxDetailY=_classPrivateFieldGet(_detailArea,this).height+minDetailY;if(visibleArea.minX<minDetailX||visibleArea.minY<minDetailY||visibleArea.maxX>maxDetailX||visibleArea.maxY>maxDetailY){return true;}var _this$pageView$viewpo=this.pageView.viewport,maxWidth=_this$pageView$viewpo.width,maxHeight=_this$pageView$viewpo.height,scale=_this$pageView$viewpo.scale;if(_classPrivateFieldGet(_detailArea,this).scale!==scale){return true;}var paddingLeftSize=visibleArea.minX-minDetailX;var paddingRightSize=maxDetailX-visibleArea.maxX;var paddingTopSize=visibleArea.minY-minDetailY;var paddingBottomSize=maxDetailY-visibleArea.maxY;var MOVEMENT_THRESHOLD=0.5;var ratio=(1+MOVEMENT_THRESHOLD)/MOVEMENT_THRESHOLD;if(minDetailX>0&&paddingRightSize/paddingLeftSize>ratio||maxDetailX<maxWidth&&paddingLeftSize/paddingRightSize>ratio||minDetailY>0&&paddingBottomSize/paddingTopSize>ratio||maxDetailY<maxHeight&&paddingTopSize/paddingBottomSize>ratio){return true;}return false;};// ./web/struct_tree_layer_builder.js
var PDF_ROLE_TO_HTML_ROLE={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null};var HEADING_PATTERN=/^H(\d+)$/;var _promise=/*#__PURE__*/new WeakMap();var _treeDom=/*#__PURE__*/new WeakMap();var _treePromise=/*#__PURE__*/new WeakMap();var _elementAttributes=/*#__PURE__*/new WeakMap();var _rawDims=/*#__PURE__*/new WeakMap();var _elementsToAddToTextLayer=/*#__PURE__*/new WeakMap();var _StructTreeLayerBuilder_brand=/*#__PURE__*/new WeakSet();var StructTreeLayerBuilder=/*#__PURE__*/function(){function StructTreeLayerBuilder(pdfPage,rawDims){_classCallCheck(this,StructTreeLayerBuilder);_classPrivateMethodInitSpec(this,_StructTreeLayerBuilder_brand);_classPrivateFieldInitSpec(this,_promise,void 0);_classPrivateFieldInitSpec(this,_treeDom,null);_classPrivateFieldInitSpec(this,_treePromise,void 0);_classPrivateFieldInitSpec(this,_elementAttributes,new Map());_classPrivateFieldInitSpec(this,_rawDims,void 0);_classPrivateFieldInitSpec(this,_elementsToAddToTextLayer,null);_classPrivateFieldSet(_promise,this,pdfPage.getStructTree());_classPrivateFieldSet(_rawDims,this,rawDims);}return _createClass(StructTreeLayerBuilder,[{key:"render",value:function(){var _render5=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee61(){var _classPrivateFieldGet26;var _Promise$withResolver2,promise,resolve,reject,_t19,_t20,_t21,_t22,_t23,_t24,_t25,_t26;return _regenerator().w(function(_context61){while(1)switch(_context61.n){case 0:if(!_classPrivateFieldGet(_treePromise,this)){_context61.n=1;break;}return _context61.a(2,_classPrivateFieldGet(_treePromise,this));case 1:_Promise$withResolver2=Promise.withResolvers(),promise=_Promise$withResolver2.promise,resolve=_Promise$withResolver2.resolve,reject=_Promise$withResolver2.reject;_classPrivateFieldSet(_treePromise,this,promise);_context61.p=2;_t19=_classPrivateFieldSet;_t20=_treeDom;_t21=this;_t22=_assertClassBrand(_StructTreeLayerBuilder_brand,this,_walk);_t23=this;_context61.n=3;return _classPrivateFieldGet(_promise,this);case 3:_t24=_context61.v;_t25=_t22.call.call(_t22,_t23,_t24);_t19(_t20,_t21,_t25);_context61.n=5;break;case 4:_context61.p=4;_t26=_context61.v;reject(_t26);case 5:_classPrivateFieldSet(_promise,this,null);(_classPrivateFieldGet26=_classPrivateFieldGet(_treeDom,this))===null||_classPrivateFieldGet26===void 0||_classPrivateFieldGet26.classList.add("structTree");resolve(_classPrivateFieldGet(_treeDom,this));return _context61.a(2,promise);}},_callee61,this,[[2,4]]);}));function render(){return _render5.apply(this,arguments);}return render;}()},{key:"getAriaAttributes",value:function(){var _getAriaAttributes=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee62(annotationId){var _t27;return _regenerator().w(function(_context62){while(1)switch(_context62.n){case 0:_context62.p=0;_context62.n=1;return this.render();case 1:return _context62.a(2,_classPrivateFieldGet(_elementAttributes,this).get(annotationId));case 2:_context62.p=2;_t27=_context62.v;return _context62.a(2,null);}},_callee62,this,[[0,2]]);}));function getAriaAttributes(_x47){return _getAriaAttributes.apply(this,arguments);}return getAriaAttributes;}()},{key:"hide",value:function hide(){if(_classPrivateFieldGet(_treeDom,this)&&!_classPrivateFieldGet(_treeDom,this).hidden){_classPrivateFieldGet(_treeDom,this).hidden=true;}}},{key:"show",value:function show(){var _classPrivateFieldGet27;if((_classPrivateFieldGet27=_classPrivateFieldGet(_treeDom,this))!==null&&_classPrivateFieldGet27!==void 0&&_classPrivateFieldGet27.hidden){_classPrivateFieldGet(_treeDom,this).hidden=false;}}},{key:"addElementsToTextLayer",value:function addElementsToTextLayer(){if(!_classPrivateFieldGet(_elementsToAddToTextLayer,this)){return;}var _iterator30=_createForOfIteratorHelper(_classPrivateFieldGet(_elementsToAddToTextLayer,this)),_step30;try{for(_iterator30.s();!(_step30=_iterator30.n()).done;){var _document$getElementB;var _step30$value=_slicedToArray(_step30.value,2),id=_step30$value[0],img=_step30$value[1];(_document$getElementB=document.getElementById(id))===null||_document$getElementB===void 0||_document$getElementB.append(img);}}catch(err){_iterator30.e(err);}finally{_iterator30.f();}_classPrivateFieldGet(_elementsToAddToTextLayer,this).clear();_classPrivateFieldSet(_elementsToAddToTextLayer,this,null);}}]);}();function _setAttributes(structElement,htmlElement){var alt=structElement.alt,id=structElement.id,lang=structElement.lang;if(alt!==undefined){var added=false;var label=removeNullCharacters(alt);var _iterator61=_createForOfIteratorHelper(structElement.children),_step61;try{for(_iterator61.s();!(_step61=_iterator61.n()).done;){var child=_step61.value;if(child.type==="annotation"){var attrs=_classPrivateFieldGet(_elementAttributes,this).get(child.id);if(!attrs){attrs=new Map();_classPrivateFieldGet(_elementAttributes,this).set(child.id,attrs);}attrs.set("aria-label",label);added=true;}}}catch(err){_iterator61.e(err);}finally{_iterator61.f();}if(!added){htmlElement.setAttribute("aria-label",label);}}if(id!==undefined){htmlElement.setAttribute("aria-owns",id);}if(lang!==undefined){htmlElement.setAttribute("lang",removeNullCharacters(lang,true));}}function _addImageInTextLayer(node,element){var alt=node.alt,bbox=node.bbox,children=node.children;var child=children===null||children===void 0?void 0:children[0];if(!_classPrivateFieldGet(_rawDims,this)||!alt||!bbox||(child===null||child===void 0?void 0:child.type)!=="content"){return false;}var id=child.id;if(!id){return false;}element.setAttribute("aria-owns",id);var img=document.createElement("span");(_classPrivateFieldGet(_elementsToAddToTextLayer,this)||_classPrivateFieldSet(_elementsToAddToTextLayer,this,new Map())).set(id,img);img.setAttribute("role","img");img.setAttribute("aria-label",removeNullCharacters(alt));var _classPrivateFieldGet68=_classPrivateFieldGet(_rawDims,this),pageHeight=_classPrivateFieldGet68.pageHeight,pageX=_classPrivateFieldGet68.pageX,pageY=_classPrivateFieldGet68.pageY;var calc="calc(var(--total-scale-factor) *";var style=img.style;style.width="".concat(calc).concat(bbox[2]-bbox[0],"px)");style.height="".concat(calc).concat(bbox[3]-bbox[1],"px)");style.left="".concat(calc).concat(bbox[0]-pageX,"px)");style.top="".concat(calc).concat(pageHeight-bbox[3]+pageY,"px)");return true;}function _walk(node){if(!node){return null;}var element=document.createElement("span");if("role"in node){var role=node.role;var _match10=role.match(HEADING_PATTERN);if(_match10){element.setAttribute("role","heading");element.setAttribute("aria-level",_match10[1]);}else if(PDF_ROLE_TO_HTML_ROLE[role]){element.setAttribute("role",PDF_ROLE_TO_HTML_ROLE[role]);}if(role==="Figure"&&_assertClassBrand(_StructTreeLayerBuilder_brand,this,_addImageInTextLayer).call(this,node,element)){return element;}}_assertClassBrand(_StructTreeLayerBuilder_brand,this,_setAttributes).call(this,node,element);if(node.children){if(node.children.length===1&&"id"in node.children[0]){_assertClassBrand(_StructTreeLayerBuilder_brand,this,_setAttributes).call(this,node.children[0],element);}else{var _iterator62=_createForOfIteratorHelper(node.children),_step62;try{for(_iterator62.s();!(_step62=_iterator62.n()).done;){var kid=_step62.value;element.append(_assertClassBrand(_StructTreeLayerBuilder_brand,this,_walk).call(this,kid));}}catch(err){_iterator62.e(err);}finally{_iterator62.f();}}}return element;};// ./web/text_accessibility.js
var _enabled2=/*#__PURE__*/new WeakMap();var _textChildren=/*#__PURE__*/new WeakMap();var _textNodes=/*#__PURE__*/new WeakMap();var _waitingElements=/*#__PURE__*/new WeakMap();var _TextAccessibilityManager_brand=/*#__PURE__*/new WeakSet();var TextAccessibilityManager=/*#__PURE__*/function(){function TextAccessibilityManager(){_classCallCheck(this,TextAccessibilityManager);_classPrivateMethodInitSpec(this,_TextAccessibilityManager_brand);_classPrivateFieldInitSpec(this,_enabled2,false);_classPrivateFieldInitSpec(this,_textChildren,null);_classPrivateFieldInitSpec(this,_textNodes,new Map());_classPrivateFieldInitSpec(this,_waitingElements,new Map());}return _createClass(TextAccessibilityManager,[{key:"setTextMapping",value:function setTextMapping(textDivs){_classPrivateFieldSet(_textChildren,this,textDivs);}},{key:"enable",value:function enable(){if(_classPrivateFieldGet(_enabled2,this)){throw new Error("TextAccessibilityManager is already enabled.");}if(!_classPrivateFieldGet(_textChildren,this)){throw new Error("Text divs and strings have not been set.");}_classPrivateFieldSet(_enabled2,this,true);_classPrivateFieldSet(_textChildren,this,_classPrivateFieldGet(_textChildren,this).slice());_classPrivateFieldGet(_textChildren,this).sort(_compareElementPositions);if(_classPrivateFieldGet(_textNodes,this).size>0){var textChildren=_classPrivateFieldGet(_textChildren,this);var _iterator31=_createForOfIteratorHelper(_classPrivateFieldGet(_textNodes,this)),_step31;try{for(_iterator31.s();!(_step31=_iterator31.n()).done;){var _step31$value=_slicedToArray(_step31.value,2),id=_step31$value[0],nodeIndex=_step31$value[1];var element=document.getElementById(id);if(!element){_classPrivateFieldGet(_textNodes,this)["delete"](id);continue;}_assertClassBrand(_TextAccessibilityManager_brand,this,_addIdToAriaOwns).call(this,id,textChildren[nodeIndex]);}}catch(err){_iterator31.e(err);}finally{_iterator31.f();}}var _iterator32=_createForOfIteratorHelper(_classPrivateFieldGet(_waitingElements,this)),_step32;try{for(_iterator32.s();!(_step32=_iterator32.n()).done;){var _step32$value=_slicedToArray(_step32.value,2),_element2=_step32$value[0],isRemovable=_step32$value[1];this.addPointerInTextLayer(_element2,isRemovable);}}catch(err){_iterator32.e(err);}finally{_iterator32.f();}_classPrivateFieldGet(_waitingElements,this).clear();}},{key:"disable",value:function disable(){if(!_classPrivateFieldGet(_enabled2,this)){return;}_classPrivateFieldGet(_waitingElements,this).clear();_classPrivateFieldSet(_textChildren,this,null);_classPrivateFieldSet(_enabled2,this,false);}},{key:"removePointerInTextLayer",value:function removePointerInTextLayer(element){var _owns;if(!_classPrivateFieldGet(_enabled2,this)){_classPrivateFieldGet(_waitingElements,this)["delete"](element);return;}var children=_classPrivateFieldGet(_textChildren,this);if(!children||children.length===0){return;}var id=element.id;var nodeIndex=_classPrivateFieldGet(_textNodes,this).get(id);if(nodeIndex===undefined){return;}var node=children[nodeIndex];_classPrivateFieldGet(_textNodes,this)["delete"](id);var owns=node.getAttribute("aria-owns");if((_owns=owns)!==null&&_owns!==void 0&&_owns.includes(id)){owns=owns.split(" ").filter(function(x){return x!==id;}).join(" ");if(owns){node.setAttribute("aria-owns",owns);}else{node.removeAttribute("aria-owns");node.setAttribute("role","presentation");}}}},{key:"addPointerInTextLayer",value:function addPointerInTextLayer(element,isRemovable){var id=element.id;if(!id){return null;}if(!_classPrivateFieldGet(_enabled2,this)){_classPrivateFieldGet(_waitingElements,this).set(element,isRemovable);return null;}if(isRemovable){this.removePointerInTextLayer(element);}var children=_classPrivateFieldGet(_textChildren,this);if(!children||children.length===0){return null;}var index=binarySearchFirstItem(children,function(node){return _compareElementPositions.call(TextAccessibilityManager,element,node)<0;});var nodeIndex=Math.max(0,index-1);var child=children[nodeIndex];_assertClassBrand(_TextAccessibilityManager_brand,this,_addIdToAriaOwns).call(this,id,child);_classPrivateFieldGet(_textNodes,this).set(id,nodeIndex);var parent=child.parentNode;return parent!==null&&parent!==void 0&&parent.classList.contains("markedContent")?parent.id:null;}},{key:"moveElementInDOM",value:function moveElementInDOM(container,element,contentElement,isRemovable){var id=this.addPointerInTextLayer(contentElement,isRemovable);if(!container.hasChildNodes()){container.append(element);return id;}var children=Array.from(container.childNodes).filter(function(node){return node!==element;});if(children.length===0){return id;}var elementToCompare=contentElement||element;var index=binarySearchFirstItem(children,function(node){return _compareElementPositions.call(TextAccessibilityManager,elementToCompare,node)<0;});if(index===0){children[0].before(element);}else{children[index-1].after(element);}return id;}}]);}();function _compareElementPositions(e1,e2){var rect1=e1.getBoundingClientRect();var rect2=e2.getBoundingClientRect();if(rect1.width===0&&rect1.height===0){return+1;}if(rect2.width===0&&rect2.height===0){return-1;}var top1=rect1.y;var bot1=rect1.y+rect1.height;var mid1=rect1.y+rect1.height/2;var top2=rect2.y;var bot2=rect2.y+rect2.height;var mid2=rect2.y+rect2.height/2;if(mid1<=top2&&mid2>=bot1){return-1;}if(mid2<=top1&&mid1>=bot2){return+1;}var centerX1=rect1.x+rect1.width/2;var centerX2=rect2.x+rect2.width/2;return centerX1-centerX2;}function _addIdToAriaOwns(id,node){var owns=node.getAttribute("aria-owns");if(!(owns!==null&&owns!==void 0&&owns.includes(id))){node.setAttribute("aria-owns",owns?"".concat(owns," ").concat(id):id);}node.removeAttribute("role");};// ./web/text_highlighter.js
var _eventAbortController4=/*#__PURE__*/new WeakMap();var TextHighlighter=/*#__PURE__*/function(){function TextHighlighter(_ref69){var findController=_ref69.findController,eventBus=_ref69.eventBus,pageIndex=_ref69.pageIndex;_classCallCheck(this,TextHighlighter);_classPrivateFieldInitSpec(this,_eventAbortController4,null);this.findController=findController;this.matches=[];this.eventBus=eventBus;this.pageIdx=pageIndex;this.textDivs=null;this.textContentItemsStr=null;this.enabled=false;}return _createClass(TextHighlighter,[{key:"setTextMapping",value:function setTextMapping(divs,texts){this.textDivs=divs;this.textContentItemsStr=texts;}},{key:"enable",value:function enable(){var _this53=this;if(!this.textDivs||!this.textContentItemsStr){throw new Error("Text divs and strings have not been set.");}if(this.enabled){throw new Error("TextHighlighter is already enabled.");}this.enabled=true;if(!_classPrivateFieldGet(_eventAbortController4,this)){_classPrivateFieldSet(_eventAbortController4,this,new AbortController());this.eventBus._on("updatetextlayermatches",function(evt){if(evt.pageIndex===_this53.pageIdx||evt.pageIndex===-1){_this53._updateMatches();}},{signal:_classPrivateFieldGet(_eventAbortController4,this).signal});}this._updateMatches();}},{key:"disable",value:function disable(){var _classPrivateFieldGet28;if(!this.enabled){return;}this.enabled=false;(_classPrivateFieldGet28=_classPrivateFieldGet(_eventAbortController4,this))===null||_classPrivateFieldGet28===void 0||_classPrivateFieldGet28.abort();_classPrivateFieldSet(_eventAbortController4,this,null);this._updateMatches(true);}},{key:"_convertMatches",value:function _convertMatches(matches,matchesLength){if(!matches){return[];}var textContentItemsStr=this.textContentItemsStr;var i=0,iIndex=0;var end=textContentItemsStr.length-1;var result=[];for(var m=0,mm=matches.length;m<mm;m++){var matchIdx=matches[m];while(i!==end&&matchIdx>=iIndex+textContentItemsStr[i].length){iIndex+=textContentItemsStr[i].length;i++;}if(i===textContentItemsStr.length){console.error("Could not find a matching mapping");}var _match9={begin:{divIdx:i,offset:matchIdx-iIndex}};matchIdx+=matchesLength[m];while(i!==end&&matchIdx>iIndex+textContentItemsStr[i].length){iIndex+=textContentItemsStr[i].length;i++;}_match9.end={divIdx:i,offset:matchIdx-iIndex};result.push(_match9);}return result;}},{key:"_renderMatches",value:function _renderMatches(matches){if(matches.length===0){return;}var findController=this.findController,pageIdx=this.pageIdx;var textContentItemsStr=this.textContentItemsStr,textDivs=this.textDivs;var isSelectedPage=pageIdx===findController.selected.pageIdx;var selectedMatchIdx=findController.selected.matchIdx;var highlightAll=findController.state.highlightAll;var prevEnd=null;var infinity={divIdx:-1,offset:undefined};function beginText(begin,className){var divIdx=begin.divIdx;textDivs[divIdx].textContent="";return appendTextToDiv(divIdx,0,begin.offset,className);}function appendTextToDiv(divIdx,fromOffset,toOffset,className){var div=textDivs[divIdx];if(div.nodeType===Node.TEXT_NODE){var span=document.createElement("span");div.before(span);span.append(div);textDivs[divIdx]=span;div=span;}var content=textContentItemsStr[divIdx].substring(fromOffset,toOffset);var node=document.createTextNode(content);if(className){var _span=document.createElement("span");_span.className="".concat(className," appended");_span.append(node);div.append(_span);if(className.includes("selected")){var left=_span.getClientRects()[0].left;var parentLeft=div.getBoundingClientRect().left;return left-parentLeft;}return 0;}div.append(node);return 0;}var i0=selectedMatchIdx,i1=i0+1;if(highlightAll){i0=0;i1=matches.length;}else if(!isSelectedPage){return;}var lastDivIdx=-1;var lastOffset=-1;for(var i=i0;i<i1;i++){var _match0=matches[i];var begin=_match0.begin;if(begin.divIdx===lastDivIdx&&begin.offset===lastOffset){continue;}lastDivIdx=begin.divIdx;lastOffset=begin.offset;var end=_match0.end;var isSelected=isSelectedPage&&i===selectedMatchIdx;var highlightSuffix=isSelected?" selected":"";var selectedLeft=0;if(!prevEnd||begin.divIdx!==prevEnd.divIdx){if(prevEnd!==null){appendTextToDiv(prevEnd.divIdx,prevEnd.offset,infinity.offset);}beginText(begin);}else{appendTextToDiv(prevEnd.divIdx,prevEnd.offset,begin.offset);}if(begin.divIdx===end.divIdx){selectedLeft=appendTextToDiv(begin.divIdx,begin.offset,end.offset,"highlight"+highlightSuffix);}else{selectedLeft=appendTextToDiv(begin.divIdx,begin.offset,infinity.offset,"highlight begin"+highlightSuffix);for(var n0=begin.divIdx+1,n1=end.divIdx;n0<n1;n0++){textDivs[n0].className="highlight middle"+highlightSuffix;}beginText(end,"highlight end"+highlightSuffix);}prevEnd=end;if(isSelected){findController.scrollMatchIntoView({element:textDivs[begin.divIdx],selectedLeft:selectedLeft,pageIndex:pageIdx,matchIndex:selectedMatchIdx});}}if(prevEnd){appendTextToDiv(prevEnd.divIdx,prevEnd.offset,infinity.offset);}}},{key:"_updateMatches",value:function _updateMatches(){var reset=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;if(!this.enabled&&!reset){return;}var findController=this.findController,matches=this.matches,pageIdx=this.pageIdx;var textContentItemsStr=this.textContentItemsStr,textDivs=this.textDivs;var clearedUntilDivIdx=-1;var _iterator33=_createForOfIteratorHelper(matches),_step33;try{for(_iterator33.s();!(_step33=_iterator33.n()).done;){var _match1=_step33.value;var begin=Math.max(clearedUntilDivIdx,_match1.begin.divIdx);for(var n=begin,end=_match1.end.divIdx;n<=end;n++){var div=textDivs[n];div.textContent=textContentItemsStr[n];div.className="";}clearedUntilDivIdx=_match1.end.divIdx+1;}}catch(err){_iterator33.e(err);}finally{_iterator33.f();}if(!(findController!==null&&findController!==void 0&&findController.highlightMatches)||reset){return;}var pageMatches=findController.pageMatches[pageIdx]||null;var pageMatchesLength=findController.pageMatchesLength[pageIdx]||null;this.matches=this._convertMatches(pageMatches,pageMatchesLength);this._renderMatches(this.matches);}}]);}();;// ./web/text_layer_builder.js
var _enablePermissions=/*#__PURE__*/new WeakMap();var _onAppend3=/*#__PURE__*/new WeakMap();var _renderingDone=/*#__PURE__*/new WeakMap();var _textLayer2=/*#__PURE__*/new WeakMap();var _TextLayerBuilder_brand=/*#__PURE__*/new WeakSet();var TextLayerBuilder=/*#__PURE__*/function(){function TextLayerBuilder(_ref70){var pdfPage=_ref70.pdfPage,_ref70$highlighter=_ref70.highlighter,highlighter=_ref70$highlighter===void 0?null:_ref70$highlighter,_ref70$accessibilityM=_ref70.accessibilityManager,accessibilityManager=_ref70$accessibilityM===void 0?null:_ref70$accessibilityM,_ref70$enablePermissi=_ref70.enablePermissions,enablePermissions=_ref70$enablePermissi===void 0?false:_ref70$enablePermissi,_ref70$onAppend=_ref70.onAppend,onAppend=_ref70$onAppend===void 0?null:_ref70$onAppend;_classCallCheck(this,TextLayerBuilder);_classPrivateMethodInitSpec(this,_TextLayerBuilder_brand);_classPrivateFieldInitSpec(this,_enablePermissions,false);_classPrivateFieldInitSpec(this,_onAppend3,null);_classPrivateFieldInitSpec(this,_renderingDone,false);_classPrivateFieldInitSpec(this,_textLayer2,null);this.pdfPage=pdfPage;this.highlighter=highlighter;this.accessibilityManager=accessibilityManager;_classPrivateFieldSet(_enablePermissions,this,enablePermissions===true);_classPrivateFieldSet(_onAppend3,this,onAppend);this.div=document.createElement("div");this.div.tabIndex=0;this.div.className="textLayer";}return _createClass(TextLayerBuilder,[{key:"render",value:function(){var _render6=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee63(_ref71){var _this$highlighter,_this$accessibilityMa,_classPrivateFieldGet30,_this$highlighter2,_this$accessibilityMa2;var viewport,_ref71$textContentPar,textContentParams,_classPrivateFieldGet29,textDivs,textContentItemsStr,endOfContent;return _regenerator().w(function(_context63){while(1)switch(_context63.n){case 0:viewport=_ref71.viewport,_ref71$textContentPar=_ref71.textContentParams,textContentParams=_ref71$textContentPar===void 0?null:_ref71$textContentPar;if(!(_classPrivateFieldGet(_renderingDone,this)&&_classPrivateFieldGet(_textLayer2,this))){_context63.n=1;break;}_classPrivateFieldGet(_textLayer2,this).update({viewport:viewport,onBefore:this.hide.bind(this)});this.show();return _context63.a(2);case 1:this.cancel();_classPrivateFieldSet(_textLayer2,this,new TextLayer({textContentSource:this.pdfPage.streamTextContent(textContentParams||{includeMarkedContent:true,disableNormalization:true}),container:this.div,viewport:viewport}));_classPrivateFieldGet29=_classPrivateFieldGet(_textLayer2,this),textDivs=_classPrivateFieldGet29.textDivs,textContentItemsStr=_classPrivateFieldGet29.textContentItemsStr;(_this$highlighter=this.highlighter)===null||_this$highlighter===void 0||_this$highlighter.setTextMapping(textDivs,textContentItemsStr);(_this$accessibilityMa=this.accessibilityManager)===null||_this$accessibilityMa===void 0||_this$accessibilityMa.setTextMapping(textDivs);_context63.n=2;return _classPrivateFieldGet(_textLayer2,this).render();case 2:_classPrivateFieldSet(_renderingDone,this,true);endOfContent=document.createElement("div");endOfContent.className="endOfContent";this.div.append(endOfContent);_assertClassBrand(_TextLayerBuilder_brand,this,_bindMouse).call(this,endOfContent);(_classPrivateFieldGet30=_classPrivateFieldGet(_onAppend3,this))===null||_classPrivateFieldGet30===void 0||_classPrivateFieldGet30.call(this,this.div);(_this$highlighter2=this.highlighter)===null||_this$highlighter2===void 0||_this$highlighter2.enable();(_this$accessibilityMa2=this.accessibilityManager)===null||_this$accessibilityMa2===void 0||_this$accessibilityMa2.enable();case 3:return _context63.a(2);}},_callee63,this);}));function render(_x48){return _render6.apply(this,arguments);}return render;}()},{key:"hide",value:function hide(){if(!this.div.hidden&&_classPrivateFieldGet(_renderingDone,this)){var _this$highlighter3;(_this$highlighter3=this.highlighter)===null||_this$highlighter3===void 0||_this$highlighter3.disable();this.div.hidden=true;}}},{key:"show",value:function show(){if(this.div.hidden&&_classPrivateFieldGet(_renderingDone,this)){var _this$highlighter4;this.div.hidden=false;(_this$highlighter4=this.highlighter)===null||_this$highlighter4===void 0||_this$highlighter4.enable();}}},{key:"cancel",value:function cancel(){var _classPrivateFieldGet31,_this$highlighter5,_this$accessibilityMa3;(_classPrivateFieldGet31=_classPrivateFieldGet(_textLayer2,this))===null||_classPrivateFieldGet31===void 0||_classPrivateFieldGet31.cancel();_classPrivateFieldSet(_textLayer2,this,null);(_this$highlighter5=this.highlighter)===null||_this$highlighter5===void 0||_this$highlighter5.disable();(_this$accessibilityMa3=this.accessibilityManager)===null||_this$accessibilityMa3===void 0||_this$accessibilityMa3.disable();_removeGlobalSelectionListener.call(TextLayerBuilder,this.div);}}]);}();_TextLayerBuilder=TextLayerBuilder;function _bindMouse(end){var _this110=this;var div=this.div;div.addEventListener("mousedown",function(){div.classList.add("selecting");});div.addEventListener("copy",function(event){if(!_classPrivateFieldGet(_enablePermissions,_this110)){var selection=document.getSelection();event.clipboardData.setData("text/plain",removeNullCharacters(normalizeUnicode(selection.toString())));}stopEvent(event);});_textLayers._.set(div,end);_enableGlobalSelectionListener.call(_TextLayerBuilder);}function _removeGlobalSelectionListener(textLayerDiv){_assertClassBrand(_TextLayerBuilder,this,_textLayers)._["delete"](textLayerDiv);if(_assertClassBrand(_TextLayerBuilder,this,_textLayers)._.size===0){var _assertClassBrand$_2;(_assertClassBrand$_2=_assertClassBrand(_TextLayerBuilder,this,_selectionChangeAbortController)._)===null||_assertClassBrand$_2===void 0||_assertClassBrand$_2.abort();_selectionChangeAbortController._=_assertClassBrand(_TextLayerBuilder,this,null);}}function _enableGlobalSelectionListener(){var _this111=this;if(_assertClassBrand(_TextLayerBuilder,this,_selectionChangeAbortController)._){return;}_selectionChangeAbortController._=_assertClassBrand(_TextLayerBuilder,this,new AbortController());var signal=_assertClassBrand(_TextLayerBuilder,this,_selectionChangeAbortController)._.signal;var reset=function reset(end,textLayer){textLayer.append(end);end.style.width="";end.style.height="";textLayer.classList.remove("selecting");};var isPointerDown=false;document.addEventListener("pointerdown",function(){isPointerDown=true;},{signal:signal});document.addEventListener("pointerup",function(){isPointerDown=false;_assertClassBrand(_TextLayerBuilder,_this111,_textLayers)._.forEach(reset);},{signal:signal});window.addEventListener("blur",function(){isPointerDown=false;_assertClassBrand(_TextLayerBuilder,_this111,_textLayers)._.forEach(reset);},{signal:signal});document.addEventListener("keyup",function(){if(!isPointerDown){_assertClassBrand(_TextLayerBuilder,_this111,_textLayers)._.forEach(reset);}},{signal:signal});var isFirefox,prevRange;document.addEventListener("selectionchange",function(){var _anchor$parentElement;var selection=document.getSelection();if(selection.rangeCount===0){_assertClassBrand(_TextLayerBuilder,_this111,_textLayers)._.forEach(reset);return;}var activeTextLayers=new Set();for(var i=0;i<selection.rangeCount;i++){var _range=selection.getRangeAt(i);var _iterator63=_createForOfIteratorHelper(_assertClassBrand(_TextLayerBuilder,_this111,_textLayers)._.keys()),_step63;try{for(_iterator63.s();!(_step63=_iterator63.n()).done;){var textLayerDiv=_step63.value;if(!activeTextLayers.has(textLayerDiv)&&_range.intersectsNode(textLayerDiv)){activeTextLayers.add(textLayerDiv);}}}catch(err){_iterator63.e(err);}finally{_iterator63.f();}}var _iterator64=_createForOfIteratorHelper(_assertClassBrand(_TextLayerBuilder,_this111,_textLayers)._),_step64;try{for(_iterator64.s();!(_step64=_iterator64.n()).done;){var _step64$value=_slicedToArray(_step64.value,2),_textLayerDiv=_step64$value[0],_endDiv=_step64$value[1];if(activeTextLayers.has(_textLayerDiv)){_textLayerDiv.classList.add("selecting");}else{reset(_endDiv,_textLayerDiv);}}}catch(err){_iterator64.e(err);}finally{_iterator64.f();}isFirefox!==null&&isFirefox!==void 0?isFirefox:isFirefox=getComputedStyle(_assertClassBrand(_TextLayerBuilder,_this111,_textLayers)._.values().next().value).getPropertyValue("-moz-user-select")==="none";if(isFirefox){return;}var range=selection.getRangeAt(0);var modifyStart=prevRange&&(range.compareBoundaryPoints(Range.END_TO_END,prevRange)===0||range.compareBoundaryPoints(Range.START_TO_END,prevRange)===0);var anchor=modifyStart?range.startContainer:range.endContainer;if(anchor.nodeType===Node.TEXT_NODE){anchor=anchor.parentNode;}var parentTextLayer=(_anchor$parentElement=anchor.parentElement)===null||_anchor$parentElement===void 0?void 0:_anchor$parentElement.closest(".textLayer");var endDiv=_assertClassBrand(_TextLayerBuilder,_this111,_textLayers)._.get(parentTextLayer);if(endDiv){endDiv.style.width=parentTextLayer.style.width;endDiv.style.height=parentTextLayer.style.height;anchor.parentElement.insertBefore(endDiv,modifyStart?anchor:anchor.nextSibling);}prevRange=range.cloneRange();},{signal:signal});}var _textLayers={_:new Map()};var _selectionChangeAbortController={_:null};;// ./web/pdf_page_view.js
var DEFAULT_LAYER_PROPERTIES=null;var LAYERS_ORDER=new Map([["canvasWrapper",0],["textLayer",1],["annotationLayer",2],["annotationEditorLayer",3],["xfaLayer",3]]);var _annotationMode=/*#__PURE__*/new WeakMap();var _canvasWrapper=/*#__PURE__*/new WeakMap();var _enableAutoLinking=/*#__PURE__*/new WeakMap();var _hasRestrictedScaling=/*#__PURE__*/new WeakMap();var _isEditing2=/*#__PURE__*/new WeakMap();var _layerProperties=/*#__PURE__*/new WeakMap();var _needsRestrictedScaling=/*#__PURE__*/new WeakMap();var _originalViewport=/*#__PURE__*/new WeakMap();var _previousRotation=/*#__PURE__*/new WeakMap();var _scaleRoundX=/*#__PURE__*/new WeakMap();var _scaleRoundY=/*#__PURE__*/new WeakMap();var _textLayerMode=/*#__PURE__*/new WeakMap();var _userUnit=/*#__PURE__*/new WeakMap();var _useThumbnailCanvas=/*#__PURE__*/new WeakMap();var _layers=/*#__PURE__*/new WeakMap();var _PDFPageView_brand=/*#__PURE__*/new WeakSet();var PDFPageView=/*#__PURE__*/function(_BasePDFPageView3){function PDFPageView(options){var _options$textLayerMod,_options$annotationMo,_options$enableDetail,_options$maxCanvasPix,_this55,_this54$renderingQueu;var _this54;_classCallCheck(this,PDFPageView);_this54=_callSuper(this,PDFPageView,[options]);_classPrivateMethodInitSpec(_this54,_PDFPageView_brand);_classPrivateFieldInitSpec(_this54,_annotationMode,AnnotationMode.ENABLE_FORMS);_classPrivateFieldInitSpec(_this54,_canvasWrapper,null);_classPrivateFieldInitSpec(_this54,_enableAutoLinking,true);_classPrivateFieldInitSpec(_this54,_hasRestrictedScaling,false);_classPrivateFieldInitSpec(_this54,_isEditing2,false);_classPrivateFieldInitSpec(_this54,_layerProperties,null);_classPrivateFieldInitSpec(_this54,_needsRestrictedScaling,false);_classPrivateFieldInitSpec(_this54,_originalViewport,null);_classPrivateFieldInitSpec(_this54,_previousRotation,null);_classPrivateFieldInitSpec(_this54,_scaleRoundX,1);_classPrivateFieldInitSpec(_this54,_scaleRoundY,1);_classPrivateFieldInitSpec(_this54,_textLayerMode,TextLayerMode.ENABLE);_classPrivateFieldInitSpec(_this54,_userUnit,1);_classPrivateFieldInitSpec(_this54,_useThumbnailCanvas,{directDrawing:true,initialOptionalContent:true,regularAnnotations:true});_classPrivateFieldInitSpec(_this54,_layers,[null,null,null,null]);var container=options.container;var defaultViewport=options.defaultViewport;_this54.renderingId="page"+_this54.id;_classPrivateFieldSet(_layerProperties,_this54,options.layerProperties||DEFAULT_LAYER_PROPERTIES);_this54.pdfPage=null;_this54.pageLabel=null;_this54.rotation=0;_this54.scale=options.scale||DEFAULT_SCALE;_this54.viewport=defaultViewport;_this54.pdfPageRotate=defaultViewport.rotation;_this54._optionalContentConfigPromise=options.optionalContentConfigPromise||null;_classPrivateFieldSet(_textLayerMode,_this54,(_options$textLayerMod=options.textLayerMode)!==null&&_options$textLayerMod!==void 0?_options$textLayerMod:TextLayerMode.ENABLE);_classPrivateFieldSet(_annotationMode,_this54,(_options$annotationMo=options.annotationMode)!==null&&_options$annotationMo!==void 0?_options$annotationMo:AnnotationMode.ENABLE_FORMS);_this54.imageResourcesPath=options.imageResourcesPath||"";_this54.enableDetailCanvas=(_options$enableDetail=options.enableDetailCanvas)!==null&&_options$enableDetail!==void 0?_options$enableDetail:true;_this54.maxCanvasPixels=(_options$maxCanvasPix=options.maxCanvasPixels)!==null&&_options$maxCanvasPix!==void 0?_options$maxCanvasPix:AppOptions.get("maxCanvasPixels");_this54.maxCanvasDim=options.maxCanvasDim||AppOptions.get("maxCanvasDim");_classPrivateFieldSet(_enableAutoLinking,_this54,options.enableAutoLinking!==false);_this54.l10n=options.l10n;(_this55=_this54).l10n||(_this55.l10n=new genericl10n_GenericL10n());_this54._isStandalone=!((_this54$renderingQueu=_this54.renderingQueue)!==null&&_this54$renderingQueu!==void 0&&_this54$renderingQueu.hasViewer());_this54._container=container;_this54._annotationCanvasMap=null;_this54.annotationLayer=null;_this54.annotationEditorLayer=null;_this54.textLayer=null;_this54.xfaLayer=null;_this54.structTreeLayer=null;_this54.drawLayer=null;_this54.detailView=null;var _div=document.createElement("div");_div.className="page";_div.setAttribute("data-page-number",_this54.id);_div.setAttribute("role","region");_div.setAttribute("data-l10n-id","pdfjs-page-landmark");_div.setAttribute("data-l10n-args",JSON.stringify({page:_this54.id}));_this54.div=_div;_assertClassBrand(_PDFPageView_brand,_this54,_setDimensions).call(_this54);container===null||container===void 0||container.append(_div);if(_this54._isStandalone){var _this54$pageColors;container===null||container===void 0||container.style.setProperty("--scale-factor",_this54.scale*PixelsPerInch.PDF_TO_CSS_UNITS);if((_this54$pageColors=_this54.pageColors)!==null&&_this54$pageColors!==void 0&&_this54$pageColors.background){container===null||container===void 0||container.style.setProperty("--page-bg-color",_this54.pageColors.background);}var optionalContentConfigPromise=options.optionalContentConfigPromise;if(optionalContentConfigPromise){optionalContentConfigPromise.then(function(optionalContentConfig){if(optionalContentConfigPromise!==_this54._optionalContentConfigPromise){return;}_classPrivateFieldGet(_useThumbnailCanvas,_this54).initialOptionalContent=optionalContentConfig.hasInitialVisibility;});}if(!options.l10n){_this54.l10n.translate(_this54.div);}}return _this54;}_inherits(PDFPageView,_BasePDFPageView3);return _createClass(PDFPageView,[{key:"setPdfPage",value:function setPdfPage(pdfPage){var _this$pageColors,_this$pageColors2;if(this._isStandalone&&(((_this$pageColors=this.pageColors)===null||_this$pageColors===void 0?void 0:_this$pageColors.foreground)==="CanvasText"||((_this$pageColors2=this.pageColors)===null||_this$pageColors2===void 0?void 0:_this$pageColors2.background)==="Canvas")){var _this$_container,_this$_container2;(_this$_container=this._container)===null||_this$_container===void 0||_this$_container.style.setProperty("--hcm-highlight-filter",pdfPage.filterFactory.addHighlightHCMFilter("highlight","CanvasText","Canvas","HighlightText","Highlight"));(_this$_container2=this._container)===null||_this$_container2===void 0||_this$_container2.style.setProperty("--hcm-highlight-selected-filter",pdfPage.filterFactory.addHighlightHCMFilter("highlight_selected","CanvasText","Canvas","HighlightText","Highlight"));}this.pdfPage=pdfPage;this.pdfPageRotate=pdfPage.rotate;var totalRotation=(this.rotation+this.pdfPageRotate)%360;this.viewport=pdfPage.getViewport({scale:this.scale*PixelsPerInch.PDF_TO_CSS_UNITS,rotation:totalRotation});_assertClassBrand(_PDFPageView_brand,this,_setDimensions).call(this);this.reset();}},{key:"destroy",value:function destroy(){var _this$pdfPage;this.reset();(_this$pdfPage=this.pdfPage)===null||_this$pdfPage===void 0||_this$pdfPage.cleanup();}},{key:"hasEditableAnnotations",value:function hasEditableAnnotations(){var _this$annotationLayer2;return!!((_this$annotationLayer2=this.annotationLayer)!==null&&_this$annotationLayer2!==void 0&&_this$annotationLayer2.hasEditableAnnotations());}},{key:"_textHighlighter",get:function get(){return shadow(this,"_textHighlighter",new TextHighlighter({pageIndex:this.id-1,eventBus:this.eventBus,findController:_classPrivateFieldGet(_layerProperties,this).findController}));}},{key:"_resetCanvas",value:function _resetCanvas(){_superPropGet(PDFPageView,"_resetCanvas",this,3)([]);_classPrivateFieldSet(_originalViewport,this,null);}},{key:"reset",value:function reset(){var _this$annotationLayer3,_this$annotationEdito,_this$xfaLayer,_this$textLayer,_this$structTreeLayer;var _ref72=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},_ref72$keepAnnotation=_ref72.keepAnnotationLayer,keepAnnotationLayer=_ref72$keepAnnotation===void 0?false:_ref72$keepAnnotation,_ref72$keepAnnotation2=_ref72.keepAnnotationEditorLayer,keepAnnotationEditorLayer=_ref72$keepAnnotation2===void 0?false:_ref72$keepAnnotation2,_ref72$keepXfaLayer=_ref72.keepXfaLayer,keepXfaLayer=_ref72$keepXfaLayer===void 0?false:_ref72$keepXfaLayer,_ref72$keepTextLayer=_ref72.keepTextLayer,keepTextLayer=_ref72$keepTextLayer===void 0?false:_ref72$keepTextLayer,_ref72$keepCanvasWrap=_ref72.keepCanvasWrapper,keepCanvasWrapper=_ref72$keepCanvasWrap===void 0?false:_ref72$keepCanvasWrap,_ref72$preserveDetail=_ref72.preserveDetailViewState,preserveDetailViewState=_ref72$preserveDetail===void 0?false:_ref72$preserveDetail;this.cancelRendering({keepAnnotationLayer:keepAnnotationLayer,keepAnnotationEditorLayer:keepAnnotationEditorLayer,keepXfaLayer:keepXfaLayer,keepTextLayer:keepTextLayer});this.renderingState=RenderingStates.INITIAL;var div=this.div;var childNodes=div.childNodes,annotationLayerNode=keepAnnotationLayer&&((_this$annotationLayer3=this.annotationLayer)===null||_this$annotationLayer3===void 0?void 0:_this$annotationLayer3.div)||null,annotationEditorLayerNode=keepAnnotationEditorLayer&&((_this$annotationEdito=this.annotationEditorLayer)===null||_this$annotationEdito===void 0?void 0:_this$annotationEdito.div)||null,xfaLayerNode=keepXfaLayer&&((_this$xfaLayer=this.xfaLayer)===null||_this$xfaLayer===void 0?void 0:_this$xfaLayer.div)||null,textLayerNode=keepTextLayer&&((_this$textLayer=this.textLayer)===null||_this$textLayer===void 0?void 0:_this$textLayer.div)||null,canvasWrapperNode=keepCanvasWrapper&&_classPrivateFieldGet(_canvasWrapper,this)||null;for(var i=childNodes.length-1;i>=0;i--){var node=childNodes[i];switch(node){case annotationLayerNode:case annotationEditorLayerNode:case xfaLayerNode:case textLayerNode:case canvasWrapperNode:continue;}node.remove();var layerIndex=_classPrivateFieldGet(_layers,this).indexOf(node);if(layerIndex>=0){_classPrivateFieldGet(_layers,this)[layerIndex]=null;}}div.removeAttribute("data-loaded");if(annotationLayerNode){this.annotationLayer.hide();}if(annotationEditorLayerNode){this.annotationEditorLayer.hide();}if(xfaLayerNode){this.xfaLayer.hide();}if(textLayerNode){this.textLayer.hide();}(_this$structTreeLayer=this.structTreeLayer)===null||_this$structTreeLayer===void 0||_this$structTreeLayer.hide();if(!keepCanvasWrapper&&_classPrivateFieldGet(_canvasWrapper,this)){_classPrivateFieldSet(_canvasWrapper,this,null);this._resetCanvas();}if(!preserveDetailViewState){var _this$detailView;(_this$detailView=this.detailView)===null||_this$detailView===void 0||_this$detailView.reset({keepCanvas:keepCanvasWrapper});if(!keepCanvasWrapper){this.detailView=null;}}}},{key:"toggleEditingMode",value:function toggleEditingMode(isEditing){_classPrivateFieldSet(_isEditing2,this,isEditing);if(!this.hasEditableAnnotations()){return;}this.reset({keepAnnotationLayer:true,keepAnnotationEditorLayer:true,keepXfaLayer:true,keepTextLayer:true,keepCanvasWrapper:true});}},{key:"updateVisibleArea",value:function updateVisibleArea(visibleArea){if(this.enableDetailCanvas){if(_classPrivateFieldGet(_needsRestrictedScaling,this)&&this.maxCanvasPixels>0&&visibleArea){var _this$detailView2;(_this$detailView2=this.detailView)!==null&&_this$detailView2!==void 0?_this$detailView2:this.detailView=new PDFPageDetailView({pageView:this});this.detailView.update({visibleArea:visibleArea});}else if(this.detailView){this.detailView.reset();this.detailView=null;}}}},{key:"update",value:function update(_ref73){var _this56=this,_this$detailView4;var _ref73$scale=_ref73.scale,scale=_ref73$scale===void 0?0:_ref73$scale,_ref73$rotation=_ref73.rotation,rotation=_ref73$rotation===void 0?null:_ref73$rotation,_ref73$optionalConten=_ref73.optionalContentConfigPromise,optionalContentConfigPromise=_ref73$optionalConten===void 0?null:_ref73$optionalConten,_ref73$drawingDelay=_ref73.drawingDelay,drawingDelay=_ref73$drawingDelay===void 0?-1:_ref73$drawingDelay;this.scale=scale||this.scale;if(typeof rotation==="number"){this.rotation=rotation;}if(optionalContentConfigPromise instanceof Promise){this._optionalContentConfigPromise=optionalContentConfigPromise;optionalContentConfigPromise.then(function(optionalContentConfig){if(optionalContentConfigPromise!==_this56._optionalContentConfigPromise){return;}_classPrivateFieldGet(_useThumbnailCanvas,_this56).initialOptionalContent=optionalContentConfig.hasInitialVisibility;});}_classPrivateFieldGet(_useThumbnailCanvas,this).directDrawing=true;var totalRotation=(this.rotation+this.pdfPageRotate)%360;this.viewport=this.viewport.clone({scale:this.scale*PixelsPerInch.PDF_TO_CSS_UNITS,rotation:totalRotation});_assertClassBrand(_PDFPageView_brand,this,_setDimensions).call(this);if(this._isStandalone){var _this$_container3;(_this$_container3=this._container)===null||_this$_container3===void 0||_this$_container3.style.setProperty("--scale-factor",this.viewport.scale);}_assertClassBrand(_PDFPageView_brand,this,_computeScale).call(this);if(this.canvas){var onlyCssZoom=_classPrivateFieldGet(_hasRestrictedScaling,this)&&_classPrivateFieldGet(_needsRestrictedScaling,this);var postponeDrawing=drawingDelay>=0&&drawingDelay<1000;if(postponeDrawing||onlyCssZoom){if(postponeDrawing&&!onlyCssZoom&&this.renderingState!==RenderingStates.FINISHED){this.cancelRendering({keepAnnotationLayer:true,keepAnnotationEditorLayer:true,keepXfaLayer:true,keepTextLayer:true,cancelExtraDelay:drawingDelay});this.renderingState=RenderingStates.FINISHED;_classPrivateFieldGet(_useThumbnailCanvas,this).directDrawing=false;}this.cssTransform({redrawAnnotationLayer:true,redrawAnnotationEditorLayer:true,redrawXfaLayer:true,redrawTextLayer:!postponeDrawing,hideTextLayer:postponeDrawing});if(!postponeDrawing){var _this$detailView3;(_this$detailView3=this.detailView)===null||_this$detailView3===void 0||_this$detailView3.update({underlyingViewUpdated:true});this.dispatchPageRendered(true,false);}return;}}this.cssTransform({});this.reset({keepAnnotationLayer:true,keepAnnotationEditorLayer:true,keepXfaLayer:true,keepTextLayer:true,keepCanvasWrapper:true,preserveDetailViewState:true});(_this$detailView4=this.detailView)===null||_this$detailView4===void 0||_this$detailView4.update({underlyingViewUpdated:true});}},{key:"cancelRendering",value:function cancelRendering(){var _ref74=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},_ref74$keepAnnotation=_ref74.keepAnnotationLayer,keepAnnotationLayer=_ref74$keepAnnotation===void 0?false:_ref74$keepAnnotation,_ref74$keepAnnotation2=_ref74.keepAnnotationEditorLayer,keepAnnotationEditorLayer=_ref74$keepAnnotation2===void 0?false:_ref74$keepAnnotation2,_ref74$keepXfaLayer=_ref74.keepXfaLayer,keepXfaLayer=_ref74$keepXfaLayer===void 0?false:_ref74$keepXfaLayer,_ref74$keepTextLayer=_ref74.keepTextLayer,keepTextLayer=_ref74$keepTextLayer===void 0?false:_ref74$keepTextLayer,_ref74$cancelExtraDel=_ref74.cancelExtraDelay,cancelExtraDelay=_ref74$cancelExtraDel===void 0?0:_ref74$cancelExtraDel;_superPropGet(PDFPageView,"cancelRendering",this,3)([{cancelExtraDelay:cancelExtraDelay}]);if(this.textLayer&&(!keepTextLayer||!this.textLayer.div)){this.textLayer.cancel();this.textLayer=null;}if(this.annotationLayer&&(!keepAnnotationLayer||!this.annotationLayer.div)){this.annotationLayer.cancel();this.annotationLayer=null;this._annotationCanvasMap=null;}if(this.structTreeLayer&&!this.textLayer){this.structTreeLayer=null;}if(this.annotationEditorLayer&&(!keepAnnotationEditorLayer||!this.annotationEditorLayer.div)){if(this.drawLayer){this.drawLayer.cancel();this.drawLayer=null;}this.annotationEditorLayer.cancel();this.annotationEditorLayer=null;}if(this.xfaLayer&&(!keepXfaLayer||!this.xfaLayer.div)){var _this$_textHighlighte;this.xfaLayer.cancel();this.xfaLayer=null;(_this$_textHighlighte=this._textHighlighter)===null||_this$_textHighlighte===void 0||_this$_textHighlighte.disable();}}},{key:"cssTransform",value:function cssTransform(_ref75){var _ref75$redrawAnnotati=_ref75.redrawAnnotationLayer,redrawAnnotationLayer=_ref75$redrawAnnotati===void 0?false:_ref75$redrawAnnotati,_ref75$redrawAnnotati2=_ref75.redrawAnnotationEditorLayer,redrawAnnotationEditorLayer=_ref75$redrawAnnotati2===void 0?false:_ref75$redrawAnnotati2,_ref75$redrawXfaLayer=_ref75.redrawXfaLayer,redrawXfaLayer=_ref75$redrawXfaLayer===void 0?false:_ref75$redrawXfaLayer,_ref75$redrawTextLaye=_ref75.redrawTextLayer,redrawTextLayer=_ref75$redrawTextLaye===void 0?false:_ref75$redrawTextLaye,_ref75$hideTextLayer=_ref75.hideTextLayer,hideTextLayer=_ref75$hideTextLayer===void 0?false:_ref75$hideTextLayer;var canvas=this.canvas;if(!canvas){return;}var originalViewport=_classPrivateFieldGet(_originalViewport,this);if(this.viewport!==originalViewport){var relativeRotation=(360+this.viewport.rotation-originalViewport.rotation)%360;if(relativeRotation===90||relativeRotation===270){var _this$viewport=this.viewport,width=_this$viewport.width,height=_this$viewport.height;var scaleX=height/width;var scaleY=width/height;canvas.style.transform="rotate(".concat(relativeRotation,"deg) scale(").concat(scaleX,",").concat(scaleY,")");}else{canvas.style.transform=relativeRotation===0?"":"rotate(".concat(relativeRotation,"deg)");}}if(redrawAnnotationLayer&&this.annotationLayer){_assertClassBrand(_PDFPageView_brand,this,_renderAnnotationLayer).call(this);}if(redrawAnnotationEditorLayer&&this.annotationEditorLayer){if(this.drawLayer){_assertClassBrand(_PDFPageView_brand,this,_renderDrawLayer).call(this);}_assertClassBrand(_PDFPageView_brand,this,_renderAnnotationEditorLayer).call(this);}if(redrawXfaLayer&&this.xfaLayer){_assertClassBrand(_PDFPageView_brand,this,_renderXfaLayer).call(this);}if(this.textLayer){if(hideTextLayer){var _this$structTreeLayer2;this.textLayer.hide();(_this$structTreeLayer2=this.structTreeLayer)===null||_this$structTreeLayer2===void 0||_this$structTreeLayer2.hide();}else if(redrawTextLayer){_assertClassBrand(_PDFPageView_brand,this,_renderTextLayer).call(this);}}}},{key:"width",get:function get(){return this.viewport.width;}},{key:"height",get:function get(){return this.viewport.height;}},{key:"getPagePoint",value:function getPagePoint(x,y){return this.viewport.convertToPdfPoint(x,y);}},{key:"_ensureCanvasWrapper",value:function _ensureCanvasWrapper(){var canvasWrapper=_classPrivateFieldGet(_canvasWrapper,this);if(!canvasWrapper){canvasWrapper=_classPrivateFieldSet(_canvasWrapper,this,document.createElement("div"));canvasWrapper.classList.add("canvasWrapper");_assertClassBrand(_PDFPageView_brand,this,_addLayer).call(this,canvasWrapper,"canvasWrapper");}return canvasWrapper;}},{key:"_getRenderingContext",value:function _getRenderingContext(canvasContext,transform){return{canvasContext:canvasContext,transform:transform,viewport:this.viewport,annotationMode:_classPrivateFieldGet(_annotationMode,this),optionalContentConfigPromise:this._optionalContentConfigPromise,annotationCanvasMap:this._annotationCanvasMap,pageColors:this.pageColors,isEditing:_classPrivateFieldGet(_isEditing2,this)};}},{key:"draw",value:function(){var _draw3=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee65(){var _this57=this;var div,l10n,pdfPage,viewport,canvasWrapper,_classPrivateFieldGet32,annotationStorage,annotationEditorUIManager,downloadManager,enableScripting,fieldObjectsPromise,hasJSActionsPromise,linkService,width,height,_this$_createCanvas2,canvas,prevCanvas,ctx,outputScale,sfx,sfy,canvasWidth,canvasHeight,pageWidth,pageHeight,transform,resultPromise,_classPrivateFieldGet34,_annotationStorage,_linkService2;return _regenerator().w(function(_context65){while(1)switch(_context65.n){case 0:if(this.renderingState!==RenderingStates.INITIAL){console.error("Must be in new state before drawing");this.reset();}div=this.div,l10n=this.l10n,pdfPage=this.pdfPage,viewport=this.viewport;if(pdfPage){_context65.n=1;break;}this.renderingState=RenderingStates.FINISHED;throw new Error("pdfPage is not loaded");case 1:this.renderingState=RenderingStates.RUNNING;canvasWrapper=this._ensureCanvasWrapper();if(!this.textLayer&&_classPrivateFieldGet(_textLayerMode,this)!==TextLayerMode.DISABLE&&!pdfPage.isPureXfa){this._accessibilityManager||(this._accessibilityManager=new TextAccessibilityManager());this.textLayer=new TextLayerBuilder({pdfPage:pdfPage,highlighter:this._textHighlighter,accessibilityManager:this._accessibilityManager,enablePermissions:_classPrivateFieldGet(_textLayerMode,this)===TextLayerMode.ENABLE_PERMISSIONS,onAppend:function onAppend(textLayerDiv){_this57.l10n.pause();_assertClassBrand(_PDFPageView_brand,_this57,_addLayer).call(_this57,textLayerDiv,"textLayer");_this57.l10n.resume();}});}if(!this.annotationLayer&&_classPrivateFieldGet(_annotationMode,this)!==AnnotationMode.DISABLE){_classPrivateFieldGet32=_classPrivateFieldGet(_layerProperties,this),annotationStorage=_classPrivateFieldGet32.annotationStorage,annotationEditorUIManager=_classPrivateFieldGet32.annotationEditorUIManager,downloadManager=_classPrivateFieldGet32.downloadManager,enableScripting=_classPrivateFieldGet32.enableScripting,fieldObjectsPromise=_classPrivateFieldGet32.fieldObjectsPromise,hasJSActionsPromise=_classPrivateFieldGet32.hasJSActionsPromise,linkService=_classPrivateFieldGet32.linkService;this._annotationCanvasMap||(this._annotationCanvasMap=new Map());this.annotationLayer=new AnnotationLayerBuilder({pdfPage:pdfPage,annotationStorage:annotationStorage,imageResourcesPath:this.imageResourcesPath,renderForms:_classPrivateFieldGet(_annotationMode,this)===AnnotationMode.ENABLE_FORMS,linkService:linkService,downloadManager:downloadManager,enableScripting:enableScripting,hasJSActionsPromise:hasJSActionsPromise,fieldObjectsPromise:fieldObjectsPromise,annotationCanvasMap:this._annotationCanvasMap,accessibilityManager:this._accessibilityManager,annotationEditorUIManager:annotationEditorUIManager,onAppend:function onAppend(annotationLayerDiv){_assertClassBrand(_PDFPageView_brand,_this57,_addLayer).call(_this57,annotationLayerDiv,"annotationLayer");}});}width=viewport.width,height=viewport.height;_classPrivateFieldSet(_originalViewport,this,viewport);_this$_createCanvas2=this._createCanvas(function(newCanvas){canvasWrapper.prepend(newCanvas);}),canvas=_this$_createCanvas2.canvas,prevCanvas=_this$_createCanvas2.prevCanvas,ctx=_this$_createCanvas2.ctx;canvas.setAttribute("role","presentation");if(!this.outputScale){_assertClassBrand(_PDFPageView_brand,this,_computeScale).call(this);}outputScale=this.outputScale;_classPrivateFieldSet(_hasRestrictedScaling,this,_classPrivateFieldGet(_needsRestrictedScaling,this));sfx=approximateFraction(outputScale.sx);sfy=approximateFraction(outputScale.sy);canvasWidth=canvas.width=floorToDivide(calcRound(width*outputScale.sx),sfx[0]);canvasHeight=canvas.height=floorToDivide(calcRound(height*outputScale.sy),sfy[0]);pageWidth=floorToDivide(calcRound(width),sfx[1]);pageHeight=floorToDivide(calcRound(height),sfy[1]);outputScale.sx=canvasWidth/pageWidth;outputScale.sy=canvasHeight/pageHeight;if(_classPrivateFieldGet(_scaleRoundX,this)!==sfx[1]){div.style.setProperty("--scale-round-x","".concat(sfx[1],"px"));_classPrivateFieldSet(_scaleRoundX,this,sfx[1]);}if(_classPrivateFieldGet(_scaleRoundY,this)!==sfy[1]){div.style.setProperty("--scale-round-y","".concat(sfy[1],"px"));_classPrivateFieldSet(_scaleRoundY,this,sfy[1]);}transform=outputScale.scaled?[outputScale.sx,0,0,outputScale.sy,0,0]:null;resultPromise=this._drawCanvas(this._getRenderingContext(ctx,transform),function(){prevCanvas===null||prevCanvas===void 0||prevCanvas.remove();_this57._resetCanvas();},function(renderTask){_classPrivateFieldGet(_useThumbnailCanvas,_this57).regularAnnotations=!renderTask.separateAnnots;_this57.dispatchPageRendered(false,false);}).then(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee64(){var _this57$annotationLay;var textLayerPromise,_classPrivateFieldGet33,annotationEditorUIManager;return _regenerator().w(function(_context64){while(1)switch(_context64.n){case 0:_this57.structTreeLayer||(_this57.structTreeLayer=new StructTreeLayerBuilder(pdfPage,viewport.rawDims));textLayerPromise=_assertClassBrand(_PDFPageView_brand,_this57,_renderTextLayer).call(_this57);if(!_this57.annotationLayer){_context64.n=2;break;}_context64.n=1;return _assertClassBrand(_PDFPageView_brand,_this57,_renderAnnotationLayer).call(_this57);case 1:if(!(_classPrivateFieldGet(_enableAutoLinking,_this57)&&_this57.annotationLayer&&_this57.textLayer)){_context64.n=2;break;}_context64.n=2;return _assertClassBrand(_PDFPageView_brand,_this57,_injectLinkAnnotations2).call(_this57,textLayerPromise);case 2:_classPrivateFieldGet33=_classPrivateFieldGet(_layerProperties,_this57),annotationEditorUIManager=_classPrivateFieldGet33.annotationEditorUIManager;if(annotationEditorUIManager){_context64.n=3;break;}return _context64.a(2);case 3:_this57.drawLayer||(_this57.drawLayer=new DrawLayerBuilder({pageIndex:_this57.id}));_context64.n=4;return _assertClassBrand(_PDFPageView_brand,_this57,_renderDrawLayer).call(_this57);case 4:_this57.drawLayer.setParent(canvasWrapper);_this57.annotationEditorLayer||(_this57.annotationEditorLayer=new AnnotationEditorLayerBuilder({uiManager:annotationEditorUIManager,pdfPage:pdfPage,l10n:l10n,structTreeLayer:_this57.structTreeLayer,accessibilityManager:_this57._accessibilityManager,annotationLayer:(_this57$annotationLay=_this57.annotationLayer)===null||_this57$annotationLay===void 0?void 0:_this57$annotationLay.annotationLayer,textLayer:_this57.textLayer,drawLayer:_this57.drawLayer.getDrawLayer(),onAppend:function onAppend(annotationEditorLayerDiv){_assertClassBrand(_PDFPageView_brand,_this57,_addLayer).call(_this57,annotationEditorLayerDiv,"annotationEditorLayer");}}));_assertClassBrand(_PDFPageView_brand,_this57,_renderAnnotationEditorLayer).call(_this57);case 5:return _context64.a(2);}},_callee64);})));if(pdfPage.isPureXfa){if(!this.xfaLayer){_classPrivateFieldGet34=_classPrivateFieldGet(_layerProperties,this),_annotationStorage=_classPrivateFieldGet34.annotationStorage,_linkService2=_classPrivateFieldGet34.linkService;this.xfaLayer=new XfaLayerBuilder({pdfPage:pdfPage,annotationStorage:_annotationStorage,linkService:_linkService2});}_assertClassBrand(_PDFPageView_brand,this,_renderXfaLayer).call(this);}div.setAttribute("data-loaded",true);this.dispatchPageRender();return _context65.a(2,resultPromise);}},_callee65,this);}));function draw(){return _draw3.apply(this,arguments);}return draw;}()},{key:"setPageLabel",value:function setPageLabel(label){var _this$pageLabel;this.pageLabel=typeof label==="string"?label:null;this.div.setAttribute("data-l10n-args",JSON.stringify({page:(_this$pageLabel=this.pageLabel)!==null&&_this$pageLabel!==void 0?_this$pageLabel:this.id}));if(this.pageLabel!==null){this.div.setAttribute("data-page-label",this.pageLabel);}else{this.div.removeAttribute("data-page-label");}}},{key:"thumbnailCanvas",get:function get(){var _classPrivateFieldGet35=_classPrivateFieldGet(_useThumbnailCanvas,this),directDrawing=_classPrivateFieldGet35.directDrawing,initialOptionalContent=_classPrivateFieldGet35.initialOptionalContent,regularAnnotations=_classPrivateFieldGet35.regularAnnotations;return directDrawing&&initialOptionalContent&&regularAnnotations?this.canvas:null;}}]);}(BasePDFPageView);function _addLayer(div,name){var pos=LAYERS_ORDER.get(name);var oldDiv=_classPrivateFieldGet(_layers,this)[pos];_classPrivateFieldGet(_layers,this)[pos]=div;if(oldDiv){oldDiv.replaceWith(div);return;}for(var i=pos-1;i>=0;i--){var layer=_classPrivateFieldGet(_layers,this)[i];if(layer){layer.after(div);return;}}this.div.prepend(div);}function _setDimensions(){var div=this.div,viewport=this.viewport;if(viewport.userUnit!==_classPrivateFieldGet(_userUnit,this)){if(viewport.userUnit!==1){div.style.setProperty("--user-unit",viewport.userUnit);}else{div.style.removeProperty("--user-unit");}_classPrivateFieldSet(_userUnit,this,viewport.userUnit);}if(this.pdfPage){if(_classPrivateFieldGet(_previousRotation,this)===viewport.rotation){return;}_classPrivateFieldSet(_previousRotation,this,viewport.rotation);}setLayerDimensions(div,viewport,true,false);}function _dispatchLayerRendered(name,error){this.eventBus.dispatch(name,{source:this,pageNumber:this.id,error:error});}function _renderAnnotationLayer(){return _renderAnnotationLayer2.apply(this,arguments);}function _renderAnnotationLayer2(){_renderAnnotationLayer2=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee123(){var error,_t69;return _regenerator().w(function(_context124){while(1)switch(_context124.n){case 0:error=null;_context124.p=1;_context124.n=2;return this.annotationLayer.render({viewport:this.viewport,intent:"display",structTreeLayer:this.structTreeLayer});case 2:_context124.n=4;break;case 3:_context124.p=3;_t69=_context124.v;console.error("#renderAnnotationLayer:",_t69);error=_t69;case 4:_context124.p=4;_assertClassBrand(_PDFPageView_brand,this,_dispatchLayerRendered).call(this,"annotationlayerrendered",error);return _context124.f(4);case 5:return _context124.a(2);}},_callee123,this,[[1,3,4,5]]);}));return _renderAnnotationLayer2.apply(this,arguments);}function _renderAnnotationEditorLayer(){return _renderAnnotationEditorLayer2.apply(this,arguments);}function _renderAnnotationEditorLayer2(){_renderAnnotationEditorLayer2=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee124(){var error,_t70;return _regenerator().w(function(_context125){while(1)switch(_context125.n){case 0:error=null;_context125.p=1;_context125.n=2;return this.annotationEditorLayer.render({viewport:this.viewport,intent:"display"});case 2:_context125.n=4;break;case 3:_context125.p=3;_t70=_context125.v;console.error("#renderAnnotationEditorLayer:",_t70);error=_t70;case 4:_context125.p=4;_assertClassBrand(_PDFPageView_brand,this,_dispatchLayerRendered).call(this,"annotationeditorlayerrendered",error);return _context125.f(4);case 5:return _context125.a(2);}},_callee124,this,[[1,3,4,5]]);}));return _renderAnnotationEditorLayer2.apply(this,arguments);}function _renderDrawLayer(){return _renderDrawLayer2.apply(this,arguments);}function _renderDrawLayer2(){_renderDrawLayer2=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee125(){var _t71;return _regenerator().w(function(_context126){while(1)switch(_context126.n){case 0:_context126.p=0;_context126.n=1;return this.drawLayer.render({intent:"display"});case 1:_context126.n=3;break;case 2:_context126.p=2;_t71=_context126.v;console.error("#renderDrawLayer:",_t71);case 3:return _context126.a(2);}},_callee125,this,[[0,2]]);}));return _renderDrawLayer2.apply(this,arguments);}function _renderXfaLayer(){return _renderXfaLayer2.apply(this,arguments);}function _renderXfaLayer2(){_renderXfaLayer2=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee126(){var error,result,_this$xfaLayer2,_t72;return _regenerator().w(function(_context127){while(1)switch(_context127.n){case 0:error=null;_context127.p=1;_context127.n=2;return this.xfaLayer.render({viewport:this.viewport,intent:"display"});case 2:result=_context127.v;if(result!==null&&result!==void 0&&result.textDivs&&this._textHighlighter){_assertClassBrand(_PDFPageView_brand,this,_buildXfaTextContentItems).call(this,result.textDivs);}_context127.n=4;break;case 3:_context127.p=3;_t72=_context127.v;console.error("#renderXfaLayer:",_t72);error=_t72;case 4:_context127.p=4;if((_this$xfaLayer2=this.xfaLayer)!==null&&_this$xfaLayer2!==void 0&&_this$xfaLayer2.div){this.l10n.pause();_assertClassBrand(_PDFPageView_brand,this,_addLayer).call(this,this.xfaLayer.div,"xfaLayer");this.l10n.resume();}_assertClassBrand(_PDFPageView_brand,this,_dispatchLayerRendered).call(this,"xfalayerrendered",error);return _context127.f(4);case 5:return _context127.a(2);}},_callee126,this,[[1,3,4,5]]);}));return _renderXfaLayer2.apply(this,arguments);}function _renderTextLayer(){return _renderTextLayer2.apply(this,arguments);}function _renderTextLayer2(){_renderTextLayer2=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee127(){var error,_t73;return _regenerator().w(function(_context128){while(1)switch(_context128.n){case 0:if(this.textLayer){_context128.n=1;break;}return _context128.a(2);case 1:error=null;_context128.p=2;_context128.n=3;return this.textLayer.render({viewport:this.viewport});case 3:_context128.n=6;break;case 4:_context128.p=4;_t73=_context128.v;if(!(_t73 instanceof AbortException)){_context128.n=5;break;}return _context128.a(2);case 5:console.error("#renderTextLayer:",_t73);error=_t73;case 6:_assertClassBrand(_PDFPageView_brand,this,_dispatchLayerRendered).call(this,"textlayerrendered",error);_assertClassBrand(_PDFPageView_brand,this,_renderStructTreeLayer).call(this);case 7:return _context128.a(2);}},_callee127,this,[[2,4]]);}));return _renderTextLayer2.apply(this,arguments);}function _renderStructTreeLayer(){return _renderStructTreeLayer2.apply(this,arguments);}function _renderStructTreeLayer2(){_renderStructTreeLayer2=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee128(){var _this$structTreeLayer3,_this$structTreeLayer5;var treeDom,_this$structTreeLayer4;return _regenerator().w(function(_context129){while(1)switch(_context129.n){case 0:if(this.textLayer){_context129.n=1;break;}return _context129.a(2);case 1:_context129.n=2;return(_this$structTreeLayer3=this.structTreeLayer)===null||_this$structTreeLayer3===void 0?void 0:_this$structTreeLayer3.render();case 2:treeDom=_context129.v;if(treeDom){this.l10n.pause();(_this$structTreeLayer4=this.structTreeLayer)===null||_this$structTreeLayer4===void 0||_this$structTreeLayer4.addElementsToTextLayer();if(this.canvas&&treeDom.parentNode!==this.canvas){this.canvas.append(treeDom);}this.l10n.resume();}(_this$structTreeLayer5=this.structTreeLayer)===null||_this$structTreeLayer5===void 0||_this$structTreeLayer5.show();case 3:return _context129.a(2);}},_callee128,this);}));return _renderStructTreeLayer2.apply(this,arguments);}function _buildXfaTextContentItems(_x74){return _buildXfaTextContentItems2.apply(this,arguments);}function _buildXfaTextContentItems2(){_buildXfaTextContentItems2=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee129(textDivs){var text,items,_iterator77,_step77,item;return _regenerator().w(function(_context130){while(1)switch(_context130.n){case 0:_context130.n=1;return this.pdfPage.getTextContent();case 1:text=_context130.v;items=[];_iterator77=_createForOfIteratorHelper(text.items);try{for(_iterator77.s();!(_step77=_iterator77.n()).done;){item=_step77.value;items.push(item.str);}}catch(err){_iterator77.e(err);}finally{_iterator77.f();}this._textHighlighter.setTextMapping(textDivs,items);this._textHighlighter.enable();case 2:return _context130.a(2);}},_callee129,this);}));return _buildXfaTextContentItems2.apply(this,arguments);}function _injectLinkAnnotations2(_x75){return _injectLinkAnnotations3.apply(this,arguments);}function _injectLinkAnnotations3(){_injectLinkAnnotations3=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee130(textLayerPromise){var error,_t74;return _regenerator().w(function(_context131){while(1)switch(_context131.n){case 0:error=null;_context131.p=1;_context131.n=2;return textLayerPromise;case 2:if(this.annotationLayer){_context131.n=3;break;}return _context131.a(2);case 3:_context131.n=4;return this.annotationLayer.injectLinkAnnotations({inferredLinks:Autolinker.processLinks(this),viewport:this.viewport,structTreeLayer:this.structTreeLayer});case 4:_context131.n=6;break;case 5:_context131.p=5;_t74=_context131.v;console.error("#injectLinkAnnotations:",_t74);error=_t74;case 6:return _context131.a(2);}},_callee130,this,[[1,5]]);}));return _injectLinkAnnotations3.apply(this,arguments);}function _computeScale(){var _this$viewport3=this.viewport,width=_this$viewport3.width,height=_this$viewport3.height;var outputScale=this.outputScale=new OutputScale();if(this.maxCanvasPixels===0){var invScale=1/this.scale;outputScale.sx*=invScale;outputScale.sy*=invScale;_classPrivateFieldSet(_needsRestrictedScaling,this,true);}else{_classPrivateFieldSet(_needsRestrictedScaling,this,outputScale.limitCanvas(width,height,this.maxCanvasPixels,this.maxCanvasDim));}};// ./web/pdf_viewer.js
var DEFAULT_CACHE_SIZE=10;var PagesCountLimit={FORCE_SCROLL_MODE_PAGE:10000,FORCE_LAZY_PAGE_INIT:5000,PAUSE_EAGER_PAGE_INIT:250};function isValidAnnotationEditorMode(mode){return Object.values(AnnotationEditorType).includes(mode)&&mode!==AnnotationEditorType.DISABLE;}var _buf=/*#__PURE__*/new WeakMap();var _size2=/*#__PURE__*/new WeakMap();var _PDFPageViewBuffer_brand=/*#__PURE__*/new WeakSet();var PDFPageViewBuffer=/*#__PURE__*/function(){function PDFPageViewBuffer(size){_classCallCheck(this,PDFPageViewBuffer);_classPrivateMethodInitSpec(this,_PDFPageViewBuffer_brand);_classPrivateFieldInitSpec(this,_buf,new Set());_classPrivateFieldInitSpec(this,_size2,0);_classPrivateFieldSet(_size2,this,size);}return _createClass(PDFPageViewBuffer,[{key:"push",value:function push(view){var buf=_classPrivateFieldGet(_buf,this);if(buf.has(view)){buf["delete"](view);}buf.add(view);if(buf.size>_classPrivateFieldGet(_size2,this)){_assertClassBrand(_PDFPageViewBuffer_brand,this,_destroyFirstView).call(this);}}},{key:"resize",value:function resize(newSize){var idsToKeep=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;_classPrivateFieldSet(_size2,this,newSize);var buf=_classPrivateFieldGet(_buf,this);if(idsToKeep){var ii=buf.size;var i=1;var _iterator34=_createForOfIteratorHelper(buf),_step34;try{for(_iterator34.s();!(_step34=_iterator34.n()).done;){var view=_step34.value;if(idsToKeep.has(view.id)){buf["delete"](view);buf.add(view);}if(++i>ii){break;}}}catch(err){_iterator34.e(err);}finally{_iterator34.f();}}while(buf.size>_classPrivateFieldGet(_size2,this)){_assertClassBrand(_PDFPageViewBuffer_brand,this,_destroyFirstView).call(this);}}},{key:"has",value:function has(view){return _classPrivateFieldGet(_buf,this).has(view);}},{key:Symbol.iterator,value:function value(){return _classPrivateFieldGet(_buf,this).keys();}}]);}();function _destroyFirstView(){var firstView=_classPrivateFieldGet(_buf,this).keys().next().value;firstView===null||firstView===void 0||firstView.destroy();_classPrivateFieldGet(_buf,this)["delete"](firstView);}var _buffer=/*#__PURE__*/new WeakMap();var _altTextManager=/*#__PURE__*/new WeakMap();var _annotationEditorHighlightColors=/*#__PURE__*/new WeakMap();var _annotationEditorMode=/*#__PURE__*/new WeakMap();var _annotationEditorUIManager=/*#__PURE__*/new WeakMap();var _annotationMode2=/*#__PURE__*/new WeakMap();var _containerTopLeft=/*#__PURE__*/new WeakMap();var _editorUndoBar=/*#__PURE__*/new WeakMap();var _enableHWA3=/*#__PURE__*/new WeakMap();var _enableHighlightFloatingButton=/*#__PURE__*/new WeakMap();var _enablePermissions2=/*#__PURE__*/new WeakMap();var _enableUpdatedAddImage=/*#__PURE__*/new WeakMap();var _enableNewAltTextWhenAddingImage=/*#__PURE__*/new WeakMap();var _enableAutoLinking2=/*#__PURE__*/new WeakMap();var _eventAbortController5=/*#__PURE__*/new WeakMap();var _mlManager3=/*#__PURE__*/new WeakMap();var _scrollTimeoutId=/*#__PURE__*/new WeakMap();var _switchAnnotationEditorModeAC=/*#__PURE__*/new WeakMap();var _switchAnnotationEditorModeTimeoutId=/*#__PURE__*/new WeakMap();var _getAllTextInProgress=/*#__PURE__*/new WeakMap();var _hiddenCopyElement=/*#__PURE__*/new WeakMap();var _interruptCopyCondition=/*#__PURE__*/new WeakMap();var _previousContainerHeight=/*#__PURE__*/new WeakMap();var _resizeObserver2=/*#__PURE__*/new WeakMap();var _scrollModePageState=/*#__PURE__*/new WeakMap();var _scaleTimeoutId=/*#__PURE__*/new WeakMap();var _signatureManager=/*#__PURE__*/new WeakMap();var _supportsPinchToZoom=/*#__PURE__*/new WeakMap();var _textLayerMode2=/*#__PURE__*/new WeakMap();var _PDFViewer_brand=/*#__PURE__*/new WeakSet();var PDFViewer=/*#__PURE__*/function(){function PDFViewer(_options){var _this$container,_this$viewer,_this59=this,_options$textLayerMod2,_options$annotationMo2,_options$annotationEd,_options$enableDetail2;_classCallCheck(this,PDFViewer);_classPrivateMethodInitSpec(this,_PDFViewer_brand);_classPrivateFieldInitSpec(this,_buffer,null);_classPrivateFieldInitSpec(this,_altTextManager,null);_classPrivateFieldInitSpec(this,_annotationEditorHighlightColors,null);_classPrivateFieldInitSpec(this,_annotationEditorMode,AnnotationEditorType.NONE);_classPrivateFieldInitSpec(this,_annotationEditorUIManager,null);_classPrivateFieldInitSpec(this,_annotationMode2,AnnotationMode.ENABLE_FORMS);_classPrivateFieldInitSpec(this,_containerTopLeft,null);_classPrivateFieldInitSpec(this,_editorUndoBar,null);_classPrivateFieldInitSpec(this,_enableHWA3,false);_classPrivateFieldInitSpec(this,_enableHighlightFloatingButton,false);_classPrivateFieldInitSpec(this,_enablePermissions2,false);_classPrivateFieldInitSpec(this,_enableUpdatedAddImage,false);_classPrivateFieldInitSpec(this,_enableNewAltTextWhenAddingImage,false);_classPrivateFieldInitSpec(this,_enableAutoLinking2,true);_classPrivateFieldInitSpec(this,_eventAbortController5,null);_classPrivateFieldInitSpec(this,_mlManager3,null);_classPrivateFieldInitSpec(this,_scrollTimeoutId,null);_classPrivateFieldInitSpec(this,_switchAnnotationEditorModeAC,null);_classPrivateFieldInitSpec(this,_switchAnnotationEditorModeTimeoutId,null);_classPrivateFieldInitSpec(this,_getAllTextInProgress,false);_classPrivateFieldInitSpec(this,_hiddenCopyElement,null);_classPrivateFieldInitSpec(this,_interruptCopyCondition,false);_classPrivateFieldInitSpec(this,_previousContainerHeight,0);_classPrivateFieldInitSpec(this,_resizeObserver2,new ResizeObserver(_assertClassBrand(_PDFViewer_brand,this,_resizeObserverCallback2).bind(this)));_classPrivateFieldInitSpec(this,_scrollModePageState,null);_classPrivateFieldInitSpec(this,_scaleTimeoutId,null);_classPrivateFieldInitSpec(this,_signatureManager,null);_classPrivateFieldInitSpec(this,_supportsPinchToZoom,true);_classPrivateFieldInitSpec(this,_textLayerMode2,TextLayerMode.ENABLE);var viewerVersion="5.1.91";if(version!==viewerVersion){throw new Error("The API version \"".concat(version,"\" does not match the Viewer version \"").concat(viewerVersion,"\"."));}this.container=_options.container;this.viewer=_options.viewer||_options.container.firstElementChild;if(((_this$container=this.container)===null||_this$container===void 0?void 0:_this$container.tagName)!=="DIV"||((_this$viewer=this.viewer)===null||_this$viewer===void 0?void 0:_this$viewer.tagName)!=="DIV"){throw new Error("Invalid `container` and/or `viewer` option.");}if(this.container.offsetParent&&getComputedStyle(this.container).position!=="absolute"){throw new Error("The `container` must be absolutely positioned.");}_classPrivateFieldGet(_resizeObserver2,this).observe(this.container);this.eventBus=_options.eventBus;this.linkService=_options.linkService||new SimpleLinkService();this.downloadManager=_options.downloadManager||null;this.findController=_options.findController||null;_classPrivateFieldSet(_altTextManager,this,_options.altTextManager||null);_classPrivateFieldSet(_signatureManager,this,_options.signatureManager||null);_classPrivateFieldSet(_editorUndoBar,this,_options.editorUndoBar||null);if(this.findController){this.findController.onIsPageVisible=function(pageNumber){return _this59._getVisiblePages().ids.has(pageNumber);};}this._scriptingManager=_options.scriptingManager||null;_classPrivateFieldSet(_textLayerMode2,this,(_options$textLayerMod2=_options.textLayerMode)!==null&&_options$textLayerMod2!==void 0?_options$textLayerMod2:TextLayerMode.ENABLE);_classPrivateFieldSet(_annotationMode2,this,(_options$annotationMo2=_options.annotationMode)!==null&&_options$annotationMo2!==void 0?_options$annotationMo2:AnnotationMode.ENABLE_FORMS);_classPrivateFieldSet(_annotationEditorMode,this,(_options$annotationEd=_options.annotationEditorMode)!==null&&_options$annotationEd!==void 0?_options$annotationEd:AnnotationEditorType.NONE);_classPrivateFieldSet(_annotationEditorHighlightColors,this,_options.annotationEditorHighlightColors||null);_classPrivateFieldSet(_enableHighlightFloatingButton,this,_options.enableHighlightFloatingButton===true);_classPrivateFieldSet(_enableUpdatedAddImage,this,_options.enableUpdatedAddImage===true);_classPrivateFieldSet(_enableNewAltTextWhenAddingImage,this,_options.enableNewAltTextWhenAddingImage===true);this.imageResourcesPath=_options.imageResourcesPath||"";this.enablePrintAutoRotate=_options.enablePrintAutoRotate||false;this.removePageBorders=_options.removePageBorders||false;this.maxCanvasPixels=_options.maxCanvasPixels;this.maxCanvasDim=_options.maxCanvasDim;this.enableDetailCanvas=(_options$enableDetail2=_options.enableDetailCanvas)!==null&&_options$enableDetail2!==void 0?_options$enableDetail2:true;this.l10n=_options.l10n;this.l10n||(this.l10n=new genericl10n_GenericL10n());_classPrivateFieldSet(_enablePermissions2,this,_options.enablePermissions||false);this.pageColors=_options.pageColors||null;_classPrivateFieldSet(_mlManager3,this,_options.mlManager||null);_classPrivateFieldSet(_enableHWA3,this,_options.enableHWA||false);_classPrivateFieldSet(_supportsPinchToZoom,this,_options.supportsPinchToZoom!==false);_classPrivateFieldSet(_enableAutoLinking2,this,_options.enableAutoLinking!==false);this.defaultRenderingQueue=!_options.renderingQueue;if(this.defaultRenderingQueue){this.renderingQueue=new PDFRenderingQueue();this.renderingQueue.setViewer(this);}else{this.renderingQueue=_options.renderingQueue;}var abortSignal=_options.abortSignal;abortSignal===null||abortSignal===void 0||abortSignal.addEventListener("abort",function(){_classPrivateFieldGet(_resizeObserver2,_this59).disconnect();_classPrivateFieldSet(_resizeObserver2,_this59,null);},{once:true});this.scroll=watchScroll(this.container,this._scrollUpdate.bind(this),abortSignal);this.presentationModeState=PresentationModeState.UNKNOWN;this._resetView();if(this.removePageBorders){this.viewer.classList.add("removePageBorders");}_assertClassBrand(_PDFViewer_brand,this,_updateContainerHeightCss).call(this);this.eventBus._on("thumbnailrendered",function(_ref77){var pageNumber=_ref77.pageNumber,pdfPage=_ref77.pdfPage;var pageView=_this59._pages[pageNumber-1];if(!_classPrivateFieldGet(_buffer,_this59).has(pageView)){pdfPage===null||pdfPage===void 0||pdfPage.cleanup();}});if(!_options.l10n){this.l10n.translate(this.container);}}return _createClass(PDFViewer,[{key:"pagesCount",get:function get(){return this._pages.length;}},{key:"getPageView",value:function getPageView(index){return this._pages[index];}},{key:"getCachedPageViews",value:function getCachedPageViews(){return new Set(_classPrivateFieldGet(_buffer,this));}},{key:"pageViewsReady",get:function get(){return this._pages.every(function(pageView){return pageView===null||pageView===void 0?void 0:pageView.pdfPage;});}},{key:"renderForms",get:function get(){return _classPrivateFieldGet(_annotationMode2,this)===AnnotationMode.ENABLE_FORMS;}},{key:"enableScripting",get:function get(){return!!this._scriptingManager;}},{key:"currentPageNumber",get:function get(){return this._currentPageNumber;},set:function set(val){if(!Number.isInteger(val)){throw new Error("Invalid page number.");}if(!this.pdfDocument){return;}if(!this._setCurrentPageNumber(val,true)){console.error("currentPageNumber: \"".concat(val,"\" is not a valid page."));}}},{key:"_setCurrentPageNumber",value:function _setCurrentPageNumber(val){var _this$_pageLabels2,_this$_pageLabels3;var resetCurrentPageView=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(this._currentPageNumber===val){if(resetCurrentPageView){_assertClassBrand(_PDFViewer_brand,this,_resetCurrentPageView).call(this);}return true;}if(!(0<val&&val<=this.pagesCount)){return false;}var previous=this._currentPageNumber;this._currentPageNumber=val;this.eventBus.dispatch("pagechanging",{source:this,pageNumber:val,pageLabel:(_this$_pageLabels2=(_this$_pageLabels3=this._pageLabels)===null||_this$_pageLabels3===void 0?void 0:_this$_pageLabels3[val-1])!==null&&_this$_pageLabels2!==void 0?_this$_pageLabels2:null,previous:previous});if(resetCurrentPageView){_assertClassBrand(_PDFViewer_brand,this,_resetCurrentPageView).call(this);}return true;}},{key:"currentPageLabel",get:function get(){var _this$_pageLabels4,_this$_pageLabels5;return(_this$_pageLabels4=(_this$_pageLabels5=this._pageLabels)===null||_this$_pageLabels5===void 0?void 0:_this$_pageLabels5[this._currentPageNumber-1])!==null&&_this$_pageLabels4!==void 0?_this$_pageLabels4:null;},set:function set(val){if(!this.pdfDocument){return;}var page=val|0;if(this._pageLabels){var i=this._pageLabels.indexOf(val);if(i>=0){page=i+1;}}if(!this._setCurrentPageNumber(page,true)){console.error("currentPageLabel: \"".concat(val,"\" is not a valid page."));}}},{key:"currentScale",get:function get(){return this._currentScale!==UNKNOWN_SCALE?this._currentScale:DEFAULT_SCALE;},set:function set(val){if(isNaN(val)){throw new Error("Invalid numeric scale.");}if(!this.pdfDocument){return;}_assertClassBrand(_PDFViewer_brand,this,_setScale).call(this,val,{noScroll:false});}},{key:"currentScaleValue",get:function get(){return this._currentScaleValue;},set:function set(val){if(!this.pdfDocument){return;}_assertClassBrand(_PDFViewer_brand,this,_setScale).call(this,val,{noScroll:false});}},{key:"pagesRotation",get:function get(){return this._pagesRotation;},set:function set(rotation){if(!isValidRotation(rotation)){throw new Error("Invalid pages rotation angle.");}if(!this.pdfDocument){return;}rotation%=360;if(rotation<0){rotation+=360;}if(this._pagesRotation===rotation){return;}this._pagesRotation=rotation;var pageNumber=this._currentPageNumber;this.refresh(true,{rotation:rotation});if(this._currentScaleValue){_assertClassBrand(_PDFViewer_brand,this,_setScale).call(this,this._currentScaleValue,{noScroll:true});}this.eventBus.dispatch("rotationchanging",{source:this,pagesRotation:rotation,pageNumber:pageNumber});if(this.defaultRenderingQueue){this.update();}}},{key:"firstPagePromise",get:function get(){return this.pdfDocument?this._firstPageCapability.promise:null;}},{key:"onePageRendered",get:function get(){return this.pdfDocument?this._onePageRenderedCapability.promise:null;}},{key:"pagesPromise",get:function get(){return this.pdfDocument?this._pagesCapability.promise:null;}},{key:"_layerProperties",get:function get(){var self=this;return shadow(this,"_layerProperties",{get annotationEditorUIManager(){return _classPrivateFieldGet(_annotationEditorUIManager,self);},get annotationStorage(){var _self$pdfDocument;return(_self$pdfDocument=self.pdfDocument)===null||_self$pdfDocument===void 0?void 0:_self$pdfDocument.annotationStorage;},get downloadManager(){return self.downloadManager;},get enableScripting(){return!!self._scriptingManager;},get fieldObjectsPromise(){var _self$pdfDocument2;return(_self$pdfDocument2=self.pdfDocument)===null||_self$pdfDocument2===void 0?void 0:_self$pdfDocument2.getFieldObjects();},get findController(){return self.findController;},get hasJSActionsPromise(){var _self$pdfDocument3;return(_self$pdfDocument3=self.pdfDocument)===null||_self$pdfDocument3===void 0?void 0:_self$pdfDocument3.hasJSActions();},get linkService(){return self.linkService;}});}},{key:"getAllText",value:function(){var _getAllText=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee66(){var texts,buffer,pageNum,pagesCount,page,_yield$page$getTextCo,items,_iterator35,_step35,item;return _regenerator().w(function(_context66){while(1)switch(_context66.n){case 0:texts=[];buffer=[];pageNum=1,pagesCount=this.pdfDocument.numPages;case 1:if(!(pageNum<=pagesCount)){_context66.n=6;break;}if(!_classPrivateFieldGet(_interruptCopyCondition,this)){_context66.n=2;break;}return _context66.a(2,null);case 2:buffer.length=0;_context66.n=3;return this.pdfDocument.getPage(pageNum);case 3:page=_context66.v;_context66.n=4;return page.getTextContent();case 4:_yield$page$getTextCo=_context66.v;items=_yield$page$getTextCo.items;_iterator35=_createForOfIteratorHelper(items);try{for(_iterator35.s();!(_step35=_iterator35.n()).done;){item=_step35.value;if(item.str){buffer.push(item.str);}if(item.hasEOL){buffer.push("\n");}}}catch(err){_iterator35.e(err);}finally{_iterator35.f();}texts.push(removeNullCharacters(buffer.join("")));case 5:++pageNum;_context66.n=1;break;case 6:return _context66.a(2,texts.join("\n"));}},_callee66,this);}));function getAllText(){return _getAllText.apply(this,arguments);}return getAllText;}()},{key:"setDocument",value:function setDocument(pdfDocument){var _this60=this;if(this.pdfDocument){var _this$findController,_this$_scriptingManag,_classPrivateFieldGet36;this.eventBus.dispatch("pagesdestroy",{source:this});this._cancelRendering();this._resetView();(_this$findController=this.findController)===null||_this$findController===void 0||_this$findController.setDocument(null);(_this$_scriptingManag=this._scriptingManager)===null||_this$_scriptingManag===void 0||_this$_scriptingManag.setDocument(null);(_classPrivateFieldGet36=_classPrivateFieldGet(_annotationEditorUIManager,this))===null||_classPrivateFieldGet36===void 0||_classPrivateFieldGet36.destroy();_classPrivateFieldSet(_annotationEditorUIManager,this,null);}this.pdfDocument=pdfDocument;if(!pdfDocument){return;}var pagesCount=pdfDocument.numPages;var firstPagePromise=pdfDocument.getPage(1);var optionalContentConfigPromise=pdfDocument.getOptionalContentConfig({intent:"display"});var permissionsPromise=_classPrivateFieldGet(_enablePermissions2,this)?pdfDocument.getPermissions():Promise.resolve();var eventBus=this.eventBus,pageColors=this.pageColors,viewer=this.viewer;_classPrivateFieldSet(_eventAbortController5,this,new AbortController());var _classPrivateFieldGet37=_classPrivateFieldGet(_eventAbortController5,this),signal=_classPrivateFieldGet37.signal;if(pagesCount>PagesCountLimit.FORCE_SCROLL_MODE_PAGE){console.warn("Forcing PAGE-scrolling for performance reasons, given the length of the document.");var mode=this._scrollMode=ScrollMode.PAGE;eventBus.dispatch("scrollmodechanged",{source:this,mode:mode});}this._pagesCapability.promise.then(function(){eventBus.dispatch("pagesloaded",{source:_this60,pagesCount:pagesCount});},function(){});var onBeforeDraw=function onBeforeDraw(evt){var pageView=_this60._pages[evt.pageNumber-1];if(!pageView){return;}_classPrivateFieldGet(_buffer,_this60).push(pageView);};eventBus._on("pagerender",onBeforeDraw,{signal:signal});var _onAfterDraw=function onAfterDraw(evt){if(evt.cssTransform||evt.isDetailView){return;}_this60._onePageRenderedCapability.resolve({timestamp:evt.timestamp});eventBus._off("pagerendered",_onAfterDraw);};eventBus._on("pagerendered",_onAfterDraw,{signal:signal});Promise.all([firstPagePromise,permissionsPromise]).then(function(_ref78){var _this60$_pages$;var _ref79=_slicedToArray(_ref78,2),firstPdfPage=_ref79[0],permissions=_ref79[1];if(pdfDocument!==_this60.pdfDocument){return;}_this60._firstPageCapability.resolve(firstPdfPage);_this60._optionalContentConfigPromise=optionalContentConfigPromise;var _assertClassBrand$cal10=_assertClassBrand(_PDFViewer_brand,_this60,_initializePermissions).call(_this60,permissions),annotationEditorMode=_assertClassBrand$cal10.annotationEditorMode,annotationMode=_assertClassBrand$cal10.annotationMode,textLayerMode=_assertClassBrand$cal10.textLayerMode;if(textLayerMode!==TextLayerMode.DISABLE){var element=_classPrivateFieldSet(_hiddenCopyElement,_this60,document.createElement("div"));element.id="hiddenCopyElement";viewer.before(element);}if(annotationEditorMode!==AnnotationEditorType.DISABLE){var _mode=annotationEditorMode;if(pdfDocument.isPureXfa){console.warn("Warning: XFA-editing is not implemented.");}else if(isValidAnnotationEditorMode(_mode)){_classPrivateFieldSet(_annotationEditorUIManager,_this60,new AnnotationEditorUIManager(_this60.container,viewer,_classPrivateFieldGet(_altTextManager,_this60),_classPrivateFieldGet(_signatureManager,_this60),eventBus,pdfDocument,pageColors,_classPrivateFieldGet(_annotationEditorHighlightColors,_this60),_classPrivateFieldGet(_enableHighlightFloatingButton,_this60),_classPrivateFieldGet(_enableUpdatedAddImage,_this60),_classPrivateFieldGet(_enableNewAltTextWhenAddingImage,_this60),_classPrivateFieldGet(_mlManager3,_this60),_classPrivateFieldGet(_editorUndoBar,_this60),_classPrivateFieldGet(_supportsPinchToZoom,_this60)));eventBus.dispatch("annotationeditoruimanager",{source:_this60,uiManager:_classPrivateFieldGet(_annotationEditorUIManager,_this60)});if(_mode!==AnnotationEditorType.NONE){_assertClassBrand(_PDFViewer_brand,_this60,_preloadEditingData).call(_this60,_mode);_classPrivateFieldGet(_annotationEditorUIManager,_this60).updateMode(_mode);}}else{console.error("Invalid AnnotationEditor mode: ".concat(_mode));}}var viewerElement=_this60._scrollMode===ScrollMode.PAGE?null:viewer;var scale=_this60.currentScale;var viewport=firstPdfPage.getViewport({scale:scale*PixelsPerInch.PDF_TO_CSS_UNITS});viewer.style.setProperty("--scale-factor",viewport.scale);if(pageColors!==null&&pageColors!==void 0&&pageColors.background){viewer.style.setProperty("--page-bg-color",pageColors.background);}if((pageColors===null||pageColors===void 0?void 0:pageColors.foreground)==="CanvasText"||(pageColors===null||pageColors===void 0?void 0:pageColors.background)==="Canvas"){viewer.style.setProperty("--hcm-highlight-filter",pdfDocument.filterFactory.addHighlightHCMFilter("highlight","CanvasText","Canvas","HighlightText","Highlight"));viewer.style.setProperty("--hcm-highlight-selected-filter",pdfDocument.filterFactory.addHighlightHCMFilter("highlight_selected","CanvasText","Canvas","HighlightText","ButtonText"));}for(var pageNum=1;pageNum<=pagesCount;++pageNum){var pageView=new PDFPageView({container:viewerElement,eventBus:eventBus,id:pageNum,scale:scale,defaultViewport:viewport.clone(),optionalContentConfigPromise:optionalContentConfigPromise,renderingQueue:_this60.renderingQueue,textLayerMode:textLayerMode,annotationMode:annotationMode,imageResourcesPath:_this60.imageResourcesPath,maxCanvasPixels:_this60.maxCanvasPixels,maxCanvasDim:_this60.maxCanvasDim,enableDetailCanvas:_this60.enableDetailCanvas,pageColors:pageColors,l10n:_this60.l10n,layerProperties:_this60._layerProperties,enableHWA:_classPrivateFieldGet(_enableHWA3,_this60),enableAutoLinking:_classPrivateFieldGet(_enableAutoLinking2,_this60)});_this60._pages.push(pageView);}(_this60$_pages$=_this60._pages[0])===null||_this60$_pages$===void 0||_this60$_pages$.setPdfPage(firstPdfPage);if(_this60._scrollMode===ScrollMode.PAGE){_assertClassBrand(_PDFViewer_brand,_this60,_ensurePageViewVisible).call(_this60);}else if(_this60._spreadMode!==SpreadMode.NONE){_this60._updateSpreadMode();}_assertClassBrand(_PDFViewer_brand,_this60,_onePageRenderedOrForceFetch).call(_this60,signal).then(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee67(){var _this60$findControlle,_this60$_scriptingMan;var getPagesLeft,_loop2,_pageNum;return _regenerator().w(function(_context68){while(1)switch(_context68.n){case 0:if(!(pdfDocument!==_this60.pdfDocument)){_context68.n=1;break;}return _context68.a(2);case 1:(_this60$findControlle=_this60.findController)===null||_this60$findControlle===void 0||_this60$findControlle.setDocument(pdfDocument);(_this60$_scriptingMan=_this60._scriptingManager)===null||_this60$_scriptingMan===void 0||_this60$_scriptingMan.setDocument(pdfDocument);if(_classPrivateFieldGet(_hiddenCopyElement,_this60)){document.addEventListener("copy",_assertClassBrand(_PDFViewer_brand,_this60,_copyCallback).bind(_this60,textLayerMode),{signal:signal});}if(_classPrivateFieldGet(_annotationEditorUIManager,_this60)){eventBus.dispatch("annotationeditormodechanged",{source:_this60,mode:_classPrivateFieldGet(_annotationEditorMode,_this60)});}if(!(pdfDocument.loadingParams.disableAutoFetch||pagesCount>PagesCountLimit.FORCE_LAZY_PAGE_INIT)){_context68.n=2;break;}_this60._pagesCapability.resolve();return _context68.a(2);case 2:getPagesLeft=pagesCount-1;if(!(getPagesLeft<=0)){_context68.n=3;break;}_this60._pagesCapability.resolve();return _context68.a(2);case 3:_loop2=/*#__PURE__*/_regenerator().m(function _loop2(_pageNum){var promise;return _regenerator().w(function(_context67){while(1)switch(_context67.n){case 0:promise=pdfDocument.getPage(_pageNum).then(function(pdfPage){var pageView=_this60._pages[_pageNum-1];if(!pageView.pdfPage){pageView.setPdfPage(pdfPage);}if(--getPagesLeft===0){_this60._pagesCapability.resolve();}},function(reason){console.error("Unable to get page ".concat(_pageNum," to initialize viewer"),reason);if(--getPagesLeft===0){_this60._pagesCapability.resolve();}});if(!(_pageNum%PagesCountLimit.PAUSE_EAGER_PAGE_INIT===0)){_context67.n=1;break;}_context67.n=1;return promise;case 1:return _context67.a(2);}},_loop2);});_pageNum=2;case 4:if(!(_pageNum<=pagesCount)){_context68.n=6;break;}return _context68.d(_regeneratorValues(_loop2(_pageNum)),5);case 5:++_pageNum;_context68.n=4;break;case 6:return _context68.a(2);}},_callee67);})));eventBus.dispatch("pagesinit",{source:_this60});pdfDocument.getMetadata().then(function(_ref81){var info=_ref81.info;if(pdfDocument!==_this60.pdfDocument){return;}if(info.Language){viewer.lang=info.Language;}});if(_this60.defaultRenderingQueue){_this60.update();}})["catch"](function(reason){console.error("Unable to initialize viewer",reason);_this60._pagesCapability.reject(reason);});}},{key:"setPageLabels",value:function setPageLabels(labels){if(!this.pdfDocument){return;}if(!labels){this._pageLabels=null;}else if(!(Array.isArray(labels)&&this.pdfDocument.numPages===labels.length)){this._pageLabels=null;console.error("setPageLabels: Invalid page labels.");}else{this._pageLabels=labels;}for(var i=0,ii=this._pages.length;i<ii;i++){var _this$_pageLabels$i2,_this$_pageLabels6;this._pages[i].setPageLabel((_this$_pageLabels$i2=(_this$_pageLabels6=this._pageLabels)===null||_this$_pageLabels6===void 0?void 0:_this$_pageLabels6[i])!==null&&_this$_pageLabels$i2!==void 0?_this$_pageLabels$i2:null);}}},{key:"_resetView",value:function _resetView(){var _classPrivateFieldGet38,_classPrivateFieldGet39;this._pages=[];this._currentPageNumber=1;this._currentScale=UNKNOWN_SCALE;this._currentScaleValue=null;this._pageLabels=null;_classPrivateFieldSet(_buffer,this,new PDFPageViewBuffer(DEFAULT_CACHE_SIZE));this._location=null;this._pagesRotation=0;this._optionalContentConfigPromise=null;this._firstPageCapability=Promise.withResolvers();this._onePageRenderedCapability=Promise.withResolvers();this._pagesCapability=Promise.withResolvers();this._scrollMode=ScrollMode.VERTICAL;this._previousScrollMode=ScrollMode.UNKNOWN;this._spreadMode=SpreadMode.NONE;_classPrivateFieldSet(_scrollModePageState,this,{previousPageNumber:1,scrollDown:true,pages:[]});(_classPrivateFieldGet38=_classPrivateFieldGet(_eventAbortController5,this))===null||_classPrivateFieldGet38===void 0||_classPrivateFieldGet38.abort();_classPrivateFieldSet(_eventAbortController5,this,null);this.viewer.textContent="";this._updateScrollMode();this.viewer.removeAttribute("lang");(_classPrivateFieldGet39=_classPrivateFieldGet(_hiddenCopyElement,this))===null||_classPrivateFieldGet39===void 0||_classPrivateFieldGet39.remove();_classPrivateFieldSet(_hiddenCopyElement,this,null);_assertClassBrand(_PDFViewer_brand,this,_cleanupTimeouts).call(this);_assertClassBrand(_PDFViewer_brand,this,_cleanupSwitchAnnotationEditorMode).call(this);}},{key:"_scrollUpdate",value:function _scrollUpdate(){var _this61=this;if(this.pagesCount===0){return;}if(_classPrivateFieldGet(_scrollTimeoutId,this)){clearTimeout(_classPrivateFieldGet(_scrollTimeoutId,this));}_classPrivateFieldSet(_scrollTimeoutId,this,setTimeout(function(){_classPrivateFieldSet(_scrollTimeoutId,_this61,null);_this61.update();},100));this.update();}},{key:"pageLabelToPageNumber",value:function pageLabelToPageNumber(label){if(!this._pageLabels){return null;}var i=this._pageLabels.indexOf(label);if(i<0){return null;}return i+1;}},{key:"scrollPageIntoView",value:function scrollPageIntoView(_ref82){var pageNumber=_ref82.pageNumber,_ref82$destArray=_ref82.destArray,destArray=_ref82$destArray===void 0?null:_ref82$destArray,_ref82$allowNegativeO=_ref82.allowNegativeOffset,allowNegativeOffset=_ref82$allowNegativeO===void 0?false:_ref82$allowNegativeO,_ref82$ignoreDestinat=_ref82.ignoreDestinationZoom,ignoreDestinationZoom=_ref82$ignoreDestinat===void 0?false:_ref82$ignoreDestinat;if(!this.pdfDocument){return;}var pageView=Number.isInteger(pageNumber)&&this._pages[pageNumber-1];if(!pageView){console.error("scrollPageIntoView: \"".concat(pageNumber,"\" is not a valid pageNumber parameter."));return;}if(this.isInPresentationMode||!destArray){this._setCurrentPageNumber(pageNumber,true);return;}var x=0,y=0;var width=0,height=0,widthScale,heightScale;var changeOrientation=pageView.rotation%180!==0;var pageWidth=(changeOrientation?pageView.height:pageView.width)/pageView.scale/PixelsPerInch.PDF_TO_CSS_UNITS;var pageHeight=(changeOrientation?pageView.width:pageView.height)/pageView.scale/PixelsPerInch.PDF_TO_CSS_UNITS;var scale=0;switch(destArray[1].name){case"XYZ":x=destArray[2];y=destArray[3];scale=destArray[4];x=x!==null?x:0;y=y!==null?y:pageHeight;break;case"Fit":case"FitB":scale="page-fit";break;case"FitH":case"FitBH":y=destArray[2];scale="page-width";if(y===null&&this._location){x=this._location.left;y=this._location.top;}else if(typeof y!=="number"||y<0){y=pageHeight;}break;case"FitV":case"FitBV":x=destArray[2];width=pageWidth;height=pageHeight;scale="page-height";break;case"FitR":x=destArray[2];y=destArray[3];width=destArray[4]-x;height=destArray[5]-y;var hPadding=SCROLLBAR_PADDING,vPadding=VERTICAL_PADDING;if(this.removePageBorders){hPadding=vPadding=0;}widthScale=(this.container.clientWidth-hPadding)/width/PixelsPerInch.PDF_TO_CSS_UNITS;heightScale=(this.container.clientHeight-vPadding)/height/PixelsPerInch.PDF_TO_CSS_UNITS;scale=Math.min(Math.abs(widthScale),Math.abs(heightScale));break;default:console.error("scrollPageIntoView: \"".concat(destArray[1].name,"\" is not a valid destination type."));return;}if(!ignoreDestinationZoom){if(scale&&scale!==this._currentScale){this.currentScaleValue=scale;}else if(this._currentScale===UNKNOWN_SCALE){this.currentScaleValue=DEFAULT_SCALE_VALUE;}}if(scale==="page-fit"&&!destArray[4]){_assertClassBrand(_PDFViewer_brand,this,_scrollIntoView).call(this,pageView);return;}var boundingRect=[pageView.viewport.convertToViewportPoint(x,y),pageView.viewport.convertToViewportPoint(x+width,y+height)];var left=Math.min(boundingRect[0][0],boundingRect[1][0]);var top=Math.min(boundingRect[0][1],boundingRect[1][1]);if(!allowNegativeOffset){left=Math.max(left,0);top=Math.max(top,0);}_assertClassBrand(_PDFViewer_brand,this,_scrollIntoView).call(this,pageView,{left:left,top:top});}},{key:"_updateLocation",value:function _updateLocation(firstPage){var currentScale=this._currentScale;var currentScaleValue=this._currentScaleValue;var normalizedScaleValue=parseFloat(currentScaleValue)===currentScale?Math.round(currentScale*10000)/100:currentScaleValue;var pageNumber=firstPage.id;var currentPageView=this._pages[pageNumber-1];var container=this.container;var topLeft=currentPageView.getPagePoint(container.scrollLeft-firstPage.x,container.scrollTop-firstPage.y);var intLeft=Math.round(topLeft[0]);var intTop=Math.round(topLeft[1]);var pdfOpenParams="#page=".concat(pageNumber);if(!this.isInPresentationMode){pdfOpenParams+="&zoom=".concat(normalizedScaleValue,",").concat(intLeft,",").concat(intTop);}this._location={pageNumber:pageNumber,scale:normalizedScaleValue,top:intTop,left:intLeft,rotation:this._pagesRotation,pdfOpenParams:pdfOpenParams};}},{key:"update",value:function update(){var visible=this._getVisiblePages();var visiblePages=visible.views,numVisiblePages=visiblePages.length;if(numVisiblePages===0){return;}var newCacheSize=Math.max(DEFAULT_CACHE_SIZE,2*numVisiblePages+1);_classPrivateFieldGet(_buffer,this).resize(newCacheSize,visible.ids);var _iterator36=_createForOfIteratorHelper(visiblePages),_step36;try{for(_iterator36.s();!(_step36=_iterator36.n()).done;){var _step36$value=_step36.value,view=_step36$value.view,visibleArea=_step36$value.visibleArea;view.updateVisibleArea(visibleArea);}}catch(err){_iterator36.e(err);}finally{_iterator36.f();}var _iterator37=_createForOfIteratorHelper(_classPrivateFieldGet(_buffer,this)),_step37;try{for(_iterator37.s();!(_step37=_iterator37.n()).done;){var _view2=_step37.value;if(!visible.ids.has(_view2.id)){_view2.updateVisibleArea(null);}}}catch(err){_iterator37.e(err);}finally{_iterator37.f();}this.renderingQueue.renderHighestPriority(visible);var isSimpleLayout=this._spreadMode===SpreadMode.NONE&&(this._scrollMode===ScrollMode.PAGE||this._scrollMode===ScrollMode.VERTICAL);var currentId=this._currentPageNumber;var stillFullyVisible=false;var _iterator38=_createForOfIteratorHelper(visiblePages),_step38;try{for(_iterator38.s();!(_step38=_iterator38.n()).done;){var page=_step38.value;if(page.percent<100){break;}if(page.id===currentId&&isSimpleLayout){stillFullyVisible=true;break;}}}catch(err){_iterator38.e(err);}finally{_iterator38.f();}this._setCurrentPageNumber(stillFullyVisible?currentId:visiblePages[0].id);this._updateLocation(visible.first);this.eventBus.dispatch("updateviewarea",{source:this,location:this._location});}},{key:"containsElement",value:function containsElement(element){return this.container.contains(element);}},{key:"focus",value:function focus(){this.container.focus();}},{key:"_isContainerRtl",get:function get(){return getComputedStyle(this.container).direction==="rtl";}},{key:"isInPresentationMode",get:function get(){return this.presentationModeState===PresentationModeState.FULLSCREEN;}},{key:"isChangingPresentationMode",get:function get(){return this.presentationModeState===PresentationModeState.CHANGING;}},{key:"isHorizontalScrollbarEnabled",get:function get(){return this.isInPresentationMode?false:this.container.scrollWidth>this.container.clientWidth;}},{key:"isVerticalScrollbarEnabled",get:function get(){return this.isInPresentationMode?false:this.container.scrollHeight>this.container.clientHeight;}},{key:"_getVisiblePages",value:function _getVisiblePages(){var views=this._scrollMode===ScrollMode.PAGE?_classPrivateFieldGet(_scrollModePageState,this).pages:this._pages,horizontal=this._scrollMode===ScrollMode.HORIZONTAL,rtl=horizontal&&this._isContainerRtl;return getVisibleElements({scrollEl:this.container,views:views,sortByVisibility:true,horizontal:horizontal,rtl:rtl});}},{key:"cleanup",value:function cleanup(){var _iterator39=_createForOfIteratorHelper(this._pages),_step39;try{for(_iterator39.s();!(_step39=_iterator39.n()).done;){var pageView=_step39.value;if(pageView.renderingState!==RenderingStates.FINISHED){pageView.reset();}}}catch(err){_iterator39.e(err);}finally{_iterator39.f();}}},{key:"_cancelRendering",value:function _cancelRendering(){var _iterator40=_createForOfIteratorHelper(this._pages),_step40;try{for(_iterator40.s();!(_step40=_iterator40.n()).done;){var pageView=_step40.value;pageView.cancelRendering();}}catch(err){_iterator40.e(err);}finally{_iterator40.f();}}},{key:"forceRendering",value:function forceRendering(currentlyVisiblePages){var _this62=this;var visiblePages=currentlyVisiblePages||this._getVisiblePages();var scrollAhead=_assertClassBrand(_PDFViewer_brand,this,_getScrollAhead2).call(this,visiblePages);var preRenderExtra=this._spreadMode!==SpreadMode.NONE&&this._scrollMode!==ScrollMode.HORIZONTAL;var ignoreDetailViews=_classPrivateFieldGet(_scaleTimeoutId,this)!==null||_classPrivateFieldGet(_scrollTimeoutId,this)!==null&&visiblePages.views.some(function(page){var _page$detailView;return(_page$detailView=page.detailView)===null||_page$detailView===void 0?void 0:_page$detailView.renderingCancelled;});var pageView=this.renderingQueue.getHighestPriority(visiblePages,this._pages,scrollAhead,preRenderExtra,ignoreDetailViews);if(pageView){_assertClassBrand(_PDFViewer_brand,this,_ensurePdfPageLoaded2).call(this,pageView).then(function(){_this62.renderingQueue.renderView(pageView);});return true;}return false;}},{key:"hasEqualPageSizes",get:function get(){var firstPageView=this._pages[0];for(var i=1,ii=this._pages.length;i<ii;++i){var pageView=this._pages[i];if(pageView.width!==firstPageView.width||pageView.height!==firstPageView.height){return false;}}return true;}},{key:"getPagesOverview",value:function getPagesOverview(){var _this63=this;var initialOrientation;return this._pages.map(function(pageView){var viewport=pageView.pdfPage.getViewport({scale:1});var orientation=isPortraitOrientation(viewport);if(initialOrientation===undefined){initialOrientation=orientation;}else if(_this63.enablePrintAutoRotate&&orientation!==initialOrientation){return{width:viewport.height,height:viewport.width,rotation:(viewport.rotation-90)%360};}return{width:viewport.width,height:viewport.height,rotation:viewport.rotation};});}},{key:"optionalContentConfigPromise",get:function get(){if(!this.pdfDocument){return Promise.resolve(null);}if(!this._optionalContentConfigPromise){console.error("optionalContentConfigPromise: Not initialized yet.");return this.pdfDocument.getOptionalContentConfig({intent:"display"});}return this._optionalContentConfigPromise;},set:function set(promise){if(!(promise instanceof Promise)){throw new Error("Invalid optionalContentConfigPromise: ".concat(promise));}if(!this.pdfDocument){return;}if(!this._optionalContentConfigPromise){return;}this._optionalContentConfigPromise=promise;this.refresh(false,{optionalContentConfigPromise:promise});this.eventBus.dispatch("optionalcontentconfigchanged",{source:this,promise:promise});}},{key:"scrollMode",get:function get(){return this._scrollMode;},set:function set(mode){if(this._scrollMode===mode){return;}if(!isValidScrollMode(mode)){throw new Error("Invalid scroll mode: ".concat(mode));}if(this.pagesCount>PagesCountLimit.FORCE_SCROLL_MODE_PAGE){return;}this._previousScrollMode=this._scrollMode;this._scrollMode=mode;this.eventBus.dispatch("scrollmodechanged",{source:this,mode:mode});this._updateScrollMode(this._currentPageNumber);}},{key:"_updateScrollMode",value:function _updateScrollMode(){var pageNumber=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;var scrollMode=this._scrollMode,viewer=this.viewer;viewer.classList.toggle("scrollHorizontal",scrollMode===ScrollMode.HORIZONTAL);viewer.classList.toggle("scrollWrapped",scrollMode===ScrollMode.WRAPPED);if(!this.pdfDocument||!pageNumber){return;}if(scrollMode===ScrollMode.PAGE){_assertClassBrand(_PDFViewer_brand,this,_ensurePageViewVisible).call(this);}else if(this._previousScrollMode===ScrollMode.PAGE){this._updateSpreadMode();}if(this._currentScaleValue&&isNaN(this._currentScaleValue)){_assertClassBrand(_PDFViewer_brand,this,_setScale).call(this,this._currentScaleValue,{noScroll:true});}this._setCurrentPageNumber(pageNumber,true);this.update();}},{key:"spreadMode",get:function get(){return this._spreadMode;},set:function set(mode){if(this._spreadMode===mode){return;}if(!isValidSpreadMode(mode)){throw new Error("Invalid spread mode: ".concat(mode));}this._spreadMode=mode;this.eventBus.dispatch("spreadmodechanged",{source:this,mode:mode});this._updateSpreadMode(this._currentPageNumber);}},{key:"_updateSpreadMode",value:function _updateSpreadMode(){var pageNumber=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;if(!this.pdfDocument){return;}var viewer=this.viewer,pages=this._pages;if(this._scrollMode===ScrollMode.PAGE){_assertClassBrand(_PDFViewer_brand,this,_ensurePageViewVisible).call(this);}else{viewer.textContent="";if(this._spreadMode===SpreadMode.NONE){var _iterator41=_createForOfIteratorHelper(this._pages),_step41;try{for(_iterator41.s();!(_step41=_iterator41.n()).done;){var pageView=_step41.value;viewer.append(pageView.div);}}catch(err){_iterator41.e(err);}finally{_iterator41.f();}}else{var parity=this._spreadMode-1;var spread=null;for(var i=0,ii=pages.length;i<ii;++i){if(spread===null){spread=document.createElement("div");spread.className="spread";viewer.append(spread);}else if(i%2===parity){spread=spread.cloneNode(false);viewer.append(spread);}spread.append(pages[i].div);}}}if(!pageNumber){return;}if(this._currentScaleValue&&isNaN(this._currentScaleValue)){_assertClassBrand(_PDFViewer_brand,this,_setScale).call(this,this._currentScaleValue,{noScroll:true});}this._setCurrentPageNumber(pageNumber,true);this.update();}},{key:"_getPageAdvance",value:function _getPageAdvance(currentPageNumber){var previous=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;switch(this._scrollMode){case ScrollMode.WRAPPED:{var _this$_getVisiblePage=this._getVisiblePages(),views=_this$_getVisiblePage.views,pageLayout=new Map();var _iterator42=_createForOfIteratorHelper(views),_step42;try{for(_iterator42.s();!(_step42=_iterator42.n()).done;){var _step42$value=_step42.value,id=_step42$value.id,y=_step42$value.y,percent=_step42$value.percent,widthPercent=_step42$value.widthPercent;if(percent===0||widthPercent<100){continue;}var yArray=pageLayout.get(y);if(!yArray){pageLayout.set(y,yArray||(yArray=[]));}yArray.push(id);}}catch(err){_iterator42.e(err);}finally{_iterator42.f();}var _iterator43=_createForOfIteratorHelper(pageLayout.values()),_step43;try{for(_iterator43.s();!(_step43=_iterator43.n()).done;){var _yArray=_step43.value;var currentIndex=_yArray.indexOf(currentPageNumber);if(currentIndex===-1){continue;}var numPages=_yArray.length;if(numPages===1){break;}if(previous){for(var i=currentIndex-1,ii=0;i>=ii;i--){var currentId=_yArray[i],expectedId=_yArray[i+1]-1;if(currentId<expectedId){return currentPageNumber-expectedId;}}}else{for(var _i8=currentIndex+1,_ii=numPages;_i8<_ii;_i8++){var _currentId=_yArray[_i8],_expectedId=_yArray[_i8-1]+1;if(_currentId>_expectedId){return _expectedId-currentPageNumber;}}}if(previous){var firstId=_yArray[0];if(firstId<currentPageNumber){return currentPageNumber-firstId+1;}}else{var lastId=_yArray[numPages-1];if(lastId>currentPageNumber){return lastId-currentPageNumber+1;}}break;}}catch(err){_iterator43.e(err);}finally{_iterator43.f();}break;}case ScrollMode.HORIZONTAL:{break;}case ScrollMode.PAGE:case ScrollMode.VERTICAL:{if(this._spreadMode===SpreadMode.NONE){break;}var parity=this._spreadMode-1;if(previous&&currentPageNumber%2!==parity){break;}else if(!previous&&currentPageNumber%2===parity){break;}var _this$_getVisiblePage2=this._getVisiblePages(),_views=_this$_getVisiblePage2.views,_expectedId2=previous?currentPageNumber-1:currentPageNumber+1;var _iterator44=_createForOfIteratorHelper(_views),_step44;try{for(_iterator44.s();!(_step44=_iterator44.n()).done;){var _step44$value=_step44.value,_id=_step44$value.id,_percent2=_step44$value.percent,_widthPercent=_step44$value.widthPercent;if(_id!==_expectedId2){continue;}if(_percent2>0&&_widthPercent===100){return 2;}break;}}catch(err){_iterator44.e(err);}finally{_iterator44.f();}break;}}return 1;}},{key:"nextPage",value:function nextPage(){var currentPageNumber=this._currentPageNumber,pagesCount=this.pagesCount;if(currentPageNumber>=pagesCount){return false;}var advance=this._getPageAdvance(currentPageNumber,false)||1;this.currentPageNumber=Math.min(currentPageNumber+advance,pagesCount);return true;}},{key:"previousPage",value:function previousPage(){var currentPageNumber=this._currentPageNumber;if(currentPageNumber<=1){return false;}var advance=this._getPageAdvance(currentPageNumber,true)||1;this.currentPageNumber=Math.max(currentPageNumber-advance,1);return true;}},{key:"updateScale",value:function updateScale(_ref83){var drawingDelay=_ref83.drawingDelay,_ref83$scaleFactor=_ref83.scaleFactor,scaleFactor=_ref83$scaleFactor===void 0?null:_ref83$scaleFactor,_ref83$steps=_ref83.steps,steps=_ref83$steps===void 0?null:_ref83$steps,origin=_ref83.origin;if(steps===null&&scaleFactor===null){throw new Error("Invalid updateScale options: either `steps` or `scaleFactor` must be provided.");}if(!this.pdfDocument){return;}var newScale=this._currentScale;if(scaleFactor>0&&scaleFactor!==1){newScale=Math.round(newScale*scaleFactor*100)/100;}else if(steps){var delta=steps>0?DEFAULT_SCALE_DELTA:1/DEFAULT_SCALE_DELTA;var round=steps>0?Math.ceil:Math.floor;steps=Math.abs(steps);do{newScale=round((newScale*delta).toFixed(2)*10)/10;}while(--steps>0);}newScale=Math.max(MIN_SCALE,Math.min(MAX_SCALE,newScale));_assertClassBrand(_PDFViewer_brand,this,_setScale).call(this,newScale,{noScroll:false,drawingDelay:drawingDelay,origin:origin});}},{key:"increaseScale",value:function increaseScale(){var _options$steps;var options=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.updateScale(_objectSpread(_objectSpread({},options),{},{steps:(_options$steps=options.steps)!==null&&_options$steps!==void 0?_options$steps:1}));}},{key:"decreaseScale",value:function decreaseScale(){var _options$steps2;var options=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.updateScale(_objectSpread(_objectSpread({},options),{},{steps:-((_options$steps2=options.steps)!==null&&_options$steps2!==void 0?_options$steps2:1)}));}},{key:"containerTopLeft",get:function get(){return _classPrivateFieldGet(_containerTopLeft,this)||_classPrivateFieldSet(_containerTopLeft,this,[this.container.offsetTop,this.container.offsetLeft]);}},{key:"annotationEditorMode",get:function get(){return _classPrivateFieldGet(_annotationEditorUIManager,this)?_classPrivateFieldGet(_annotationEditorMode,this):AnnotationEditorType.DISABLE;},set:function set(_ref84){var _this64=this;var mode=_ref84.mode,_ref84$editId=_ref84.editId,editId=_ref84$editId===void 0?null:_ref84$editId,_ref84$isFromKeyboard=_ref84.isFromKeyboard,isFromKeyboard=_ref84$isFromKeyboard===void 0?false:_ref84$isFromKeyboard;if(!_classPrivateFieldGet(_annotationEditorUIManager,this)){throw new Error("The AnnotationEditor is not enabled.");}if(_classPrivateFieldGet(_annotationEditorMode,this)===mode){return;}if(!isValidAnnotationEditorMode(mode)){throw new Error("Invalid AnnotationEditor mode: ".concat(mode));}if(!this.pdfDocument){return;}_assertClassBrand(_PDFViewer_brand,this,_preloadEditingData).call(this,mode);var eventBus=this.eventBus,pdfDocument=this.pdfDocument;var updater=/*#__PURE__*/function(){var _ref85=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee68(){return _regenerator().w(function(_context69){while(1)switch(_context69.n){case 0:_assertClassBrand(_PDFViewer_brand,_this64,_cleanupSwitchAnnotationEditorMode).call(_this64);_classPrivateFieldSet(_annotationEditorMode,_this64,mode);_context69.n=1;return _classPrivateFieldGet(_annotationEditorUIManager,_this64).updateMode(mode,editId,isFromKeyboard);case 1:if(!(mode!==_classPrivateFieldGet(_annotationEditorMode,_this64)||pdfDocument!==_this64.pdfDocument)){_context69.n=2;break;}return _context69.a(2);case 2:eventBus.dispatch("annotationeditormodechanged",{source:_this64,mode:mode});case 3:return _context69.a(2);}},_callee68);}));return function updater(){return _ref85.apply(this,arguments);};}();if(mode===AnnotationEditorType.NONE||_classPrivateFieldGet(_annotationEditorMode,this)===AnnotationEditorType.NONE){var isEditing=mode!==AnnotationEditorType.NONE;if(!isEditing){this.pdfDocument.annotationStorage.resetModifiedIds();}var _iterator45=_createForOfIteratorHelper(this._pages),_step45;try{for(_iterator45.s();!(_step45=_iterator45.n()).done;){var pageView=_step45.value;pageView.toggleEditingMode(isEditing);}}catch(err){_iterator45.e(err);}finally{_iterator45.f();}var idsToRefresh=_assertClassBrand(_PDFViewer_brand,this,_switchToEditAnnotationMode).call(this);if(isEditing&&idsToRefresh){_assertClassBrand(_PDFViewer_brand,this,_cleanupSwitchAnnotationEditorMode).call(this);_classPrivateFieldSet(_switchAnnotationEditorModeAC,this,new AbortController());var signal=AbortSignal.any([_classPrivateFieldGet(_eventAbortController5,this).signal,_classPrivateFieldGet(_switchAnnotationEditorModeAC,this).signal]);eventBus._on("pagerendered",function(_ref86){var pageNumber=_ref86.pageNumber;idsToRefresh["delete"](pageNumber);if(idsToRefresh.size===0){_classPrivateFieldSet(_switchAnnotationEditorModeTimeoutId,_this64,setTimeout(updater,0));}},{signal:signal});return;}}updater();}},{key:"refresh",value:function refresh(){var noUpdate=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var updateArgs=arguments.length>1&&arguments[1]!==undefined?arguments[1]:Object.create(null);if(!this.pdfDocument){return;}var _iterator46=_createForOfIteratorHelper(this._pages),_step46;try{for(_iterator46.s();!(_step46=_iterator46.n()).done;){var pageView=_step46.value;pageView.update(updateArgs);}}catch(err){_iterator46.e(err);}finally{_iterator46.f();}_assertClassBrand(_PDFViewer_brand,this,_cleanupTimeouts).call(this);if(!noUpdate){this.update();}}}]);}();function _initializePermissions(permissions){var params={annotationEditorMode:_classPrivateFieldGet(_annotationEditorMode,this),annotationMode:_classPrivateFieldGet(_annotationMode2,this),textLayerMode:_classPrivateFieldGet(_textLayerMode2,this)};if(!permissions){return params;}if(!permissions.includes(PermissionFlag.COPY)&&_classPrivateFieldGet(_textLayerMode2,this)===TextLayerMode.ENABLE){params.textLayerMode=TextLayerMode.ENABLE_PERMISSIONS;}if(!permissions.includes(PermissionFlag.MODIFY_CONTENTS)){params.annotationEditorMode=AnnotationEditorType.DISABLE;}if(!permissions.includes(PermissionFlag.MODIFY_ANNOTATIONS)&&!permissions.includes(PermissionFlag.FILL_INTERACTIVE_FORMS)&&_classPrivateFieldGet(_annotationMode2,this)===AnnotationMode.ENABLE_FORMS){params.annotationMode=AnnotationMode.ENABLE;}return params;}function _onePageRenderedOrForceFetch(_x76){return _onePageRenderedOrForceFetch2.apply(this,arguments);}function _onePageRenderedOrForceFetch2(){_onePageRenderedOrForceFetch2=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee131(signal){var hiddenCapability,ac;return _regenerator().w(function(_context132){while(1)switch(_context132.n){case 0:if(!(document.visibilityState==="hidden"||!this.container.offsetParent||this._getVisiblePages().views.length===0)){_context132.n=1;break;}return _context132.a(2);case 1:hiddenCapability=Promise.withResolvers(),ac=new AbortController();document.addEventListener("visibilitychange",function(){if(document.visibilityState==="hidden"){hiddenCapability.resolve();}},{signal:AbortSignal.any([signal,ac.signal])});_context132.n=2;return Promise.race([this._onePageRenderedCapability.promise,hiddenCapability.promise]);case 2:ac.abort();case 3:return _context132.a(2);}},_callee131,this);}));return _onePageRenderedOrForceFetch2.apply(this,arguments);}function _copyCallback(textLayerMode,event){var _this112=this;var selection=document.getSelection();var focusNode=selection.focusNode,anchorNode=selection.anchorNode;if(anchorNode&&focusNode&&selection.containsNode(_classPrivateFieldGet(_hiddenCopyElement,this))){if(_classPrivateFieldGet(_getAllTextInProgress,this)||textLayerMode===TextLayerMode.ENABLE_PERMISSIONS){stopEvent(event);return;}_classPrivateFieldSet(_getAllTextInProgress,this,true);var classList=this.viewer.classList;classList.add("copyAll");var _ac=new AbortController();window.addEventListener("keydown",function(ev){return _classPrivateFieldSet(_interruptCopyCondition,_this112,ev.key==="Escape");},{signal:_ac.signal});this.getAllText().then(/*#__PURE__*/function(){var _ref118=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee103(text){return _regenerator().w(function(_context104){while(1)switch(_context104.n){case 0:if(!(text!==null)){_context104.n=1;break;}_context104.n=1;return navigator.clipboard.writeText(text);case 1:return _context104.a(2);}},_callee103);}));return function(_x77){return _ref118.apply(this,arguments);};}())["catch"](function(reason){console.warn("Something goes wrong when extracting the text: ".concat(reason.message));})["finally"](function(){_classPrivateFieldSet(_getAllTextInProgress,_this112,false);_classPrivateFieldSet(_interruptCopyCondition,_this112,false);_ac.abort();classList.remove("copyAll");});stopEvent(event);}}function _ensurePageViewVisible(){if(this._scrollMode!==ScrollMode.PAGE){throw new Error("#ensurePageViewVisible: Invalid scrollMode value.");}var pageNumber=this._currentPageNumber,state=_classPrivateFieldGet(_scrollModePageState,this),viewer=this.viewer;viewer.textContent="";state.pages.length=0;if(this._spreadMode===SpreadMode.NONE&&!this.isInPresentationMode){var pageView=this._pages[pageNumber-1];viewer.append(pageView.div);state.pages.push(pageView);}else{var pageIndexSet=new Set(),parity=this._spreadMode-1;if(parity===-1){pageIndexSet.add(pageNumber-1);}else if(pageNumber%2!==parity){pageIndexSet.add(pageNumber-1);pageIndexSet.add(pageNumber);}else{pageIndexSet.add(pageNumber-2);pageIndexSet.add(pageNumber-1);}var spread=document.createElement("div");spread.className="spread";if(this.isInPresentationMode){var dummyPage=document.createElement("div");dummyPage.className="dummyPage";spread.append(dummyPage);}var _iterator65=_createForOfIteratorHelper(pageIndexSet),_step65;try{for(_iterator65.s();!(_step65=_iterator65.n()).done;){var i=_step65.value;var _pageView=this._pages[i];if(!_pageView){continue;}spread.append(_pageView.div);state.pages.push(_pageView);}}catch(err){_iterator65.e(err);}finally{_iterator65.f();}viewer.append(spread);}state.scrollDown=pageNumber>=state.previousPageNumber;state.previousPageNumber=pageNumber;}function _scrollIntoView(pageView){var pageSpot=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var div=pageView.div,id=pageView.id;if(this._currentPageNumber!==id){this._setCurrentPageNumber(id);}if(this._scrollMode===ScrollMode.PAGE){_assertClassBrand(_PDFViewer_brand,this,_ensurePageViewVisible).call(this);this.update();}if(!pageSpot&&!this.isInPresentationMode){var left=div.offsetLeft+div.clientLeft,right=left+div.clientWidth;var _this$container2=this.container,scrollLeft=_this$container2.scrollLeft,clientWidth=_this$container2.clientWidth;if(this._scrollMode===ScrollMode.HORIZONTAL||left<scrollLeft||right>scrollLeft+clientWidth){pageSpot={left:0,top:0};}}scrollIntoView(div,pageSpot);if(!this._currentScaleValue&&this._location){this._location=null;}}function _isSameScale(newScale){return newScale===this._currentScale||Math.abs(newScale-this._currentScale)<1e-15;}function _setScaleUpdatePages(newScale,newValue,_ref119){var _this113=this;var _ref119$noScroll=_ref119.noScroll,noScroll=_ref119$noScroll===void 0?false:_ref119$noScroll,_ref119$preset=_ref119.preset,preset=_ref119$preset===void 0?false:_ref119$preset,_ref119$drawingDelay=_ref119.drawingDelay,drawingDelay=_ref119$drawingDelay===void 0?-1:_ref119$drawingDelay,_ref119$origin=_ref119.origin,origin=_ref119$origin===void 0?null:_ref119$origin;this._currentScaleValue=newValue.toString();if(_assertClassBrand(_PDFViewer_brand,this,_isSameScale).call(this,newScale)){if(preset){this.eventBus.dispatch("scalechanging",{source:this,scale:newScale,presetValue:newValue});}return;}this.viewer.style.setProperty("--scale-factor",newScale*PixelsPerInch.PDF_TO_CSS_UNITS);var postponeDrawing=drawingDelay>=0&&drawingDelay<1000;this.refresh(true,{scale:newScale,drawingDelay:postponeDrawing?drawingDelay:-1});if(postponeDrawing){_classPrivateFieldSet(_scaleTimeoutId,this,setTimeout(function(){_classPrivateFieldSet(_scaleTimeoutId,_this113,null);_this113.refresh();},drawingDelay));}var previousScale=this._currentScale;this._currentScale=newScale;if(!noScroll){var page=this._currentPageNumber,dest;if(this._location&&!(this.isInPresentationMode||this.isChangingPresentationMode)){page=this._location.pageNumber;dest=[null,{name:"XYZ"},this._location.left,this._location.top,null];}this.scrollPageIntoView({pageNumber:page,destArray:dest,allowNegativeOffset:true});if(Array.isArray(origin)){var scaleDiff=newScale/previousScale-1;var _this$containerTopLef=_slicedToArray(this.containerTopLeft,2),top=_this$containerTopLef[0],left=_this$containerTopLef[1];this.container.scrollLeft+=(origin[0]-left)*scaleDiff;this.container.scrollTop+=(origin[1]-top)*scaleDiff;}}this.eventBus.dispatch("scalechanging",{source:this,scale:newScale,presetValue:preset?newValue:undefined});if(this.defaultRenderingQueue){this.update();}}function _get_pageWidthScaleFactor(_this58){if(_this58._spreadMode!==SpreadMode.NONE&&_this58._scrollMode!==ScrollMode.HORIZONTAL){return 2;}return 1;}function _setScale(value,options){var scale=parseFloat(value);if(scale>0){options.preset=false;_assertClassBrand(_PDFViewer_brand,this,_setScaleUpdatePages).call(this,scale,value,options);}else{var currentPage=this._pages[this._currentPageNumber-1];if(!currentPage){return;}var hPadding=SCROLLBAR_PADDING,vPadding=VERTICAL_PADDING;if(this.isInPresentationMode){hPadding=vPadding=4;if(this._spreadMode!==SpreadMode.NONE){hPadding*=2;}}else if(this.removePageBorders){hPadding=vPadding=0;}else if(this._scrollMode===ScrollMode.HORIZONTAL){var _ref120=[vPadding,hPadding];hPadding=_ref120[0];vPadding=_ref120[1];}var pageWidthScale=(this.container.clientWidth-hPadding)/currentPage.width*currentPage.scale/_classPrivateGetter(_PDFViewer_brand,this,_get_pageWidthScaleFactor);var pageHeightScale=(this.container.clientHeight-vPadding)/currentPage.height*currentPage.scale;switch(value){case"page-actual":scale=1;break;case"page-width":scale=pageWidthScale;break;case"page-height":scale=pageHeightScale;break;case"page-fit":scale=Math.min(pageWidthScale,pageHeightScale);break;case"auto":var horizontalScale=isPortraitOrientation(currentPage)?pageWidthScale:Math.min(pageHeightScale,pageWidthScale);scale=Math.min(MAX_AUTO_SCALE,horizontalScale);break;default:console.error("#setScale: \"".concat(value,"\" is an unknown zoom value."));return;}options.preset=true;_assertClassBrand(_PDFViewer_brand,this,_setScaleUpdatePages).call(this,scale,value,options);}}function _resetCurrentPageView(){var pageView=this._pages[this._currentPageNumber-1];if(this.isInPresentationMode){_assertClassBrand(_PDFViewer_brand,this,_setScale).call(this,this._currentScaleValue,{noScroll:true});}_assertClassBrand(_PDFViewer_brand,this,_scrollIntoView).call(this,pageView);}function _switchToEditAnnotationMode(){var visible=this._getVisiblePages();var pagesToRefresh=[];var ids=visible.ids,views=visible.views;var _iterator66=_createForOfIteratorHelper(views),_step66;try{for(_iterator66.s();!(_step66=_iterator66.n()).done;){var page=_step66.value;var view=page.view;if(!view.hasEditableAnnotations()){ids["delete"](view.id);continue;}pagesToRefresh.push(page);}}catch(err){_iterator66.e(err);}finally{_iterator66.f();}if(pagesToRefresh.length===0){return null;}this.renderingQueue.renderHighestPriority({first:pagesToRefresh[0],last:pagesToRefresh.at(-1),views:pagesToRefresh,ids:ids});return ids;}function _ensurePdfPageLoaded2(_x78){return _ensurePdfPageLoaded4.apply(this,arguments);}function _ensurePdfPageLoaded4(){_ensurePdfPageLoaded4=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee132(pageView){var pdfPage,_t75;return _regenerator().w(function(_context133){while(1)switch(_context133.n){case 0:if(!pageView.pdfPage){_context133.n=1;break;}return _context133.a(2,pageView.pdfPage);case 1:_context133.p=1;_context133.n=2;return this.pdfDocument.getPage(pageView.id);case 2:pdfPage=_context133.v;if(!pageView.pdfPage){pageView.setPdfPage(pdfPage);}return _context133.a(2,pdfPage);case 3:_context133.p=3;_t75=_context133.v;console.error("Unable to get page for page view",_t75);return _context133.a(2,null);}},_callee132,this,[[1,3]]);}));return _ensurePdfPageLoaded4.apply(this,arguments);}function _getScrollAhead2(visible){var _visible$first2,_visible$last2;if(((_visible$first2=visible.first)===null||_visible$first2===void 0?void 0:_visible$first2.id)===1){return true;}else if(((_visible$last2=visible.last)===null||_visible$last2===void 0?void 0:_visible$last2.id)===this.pagesCount){return false;}switch(this._scrollMode){case ScrollMode.PAGE:return _classPrivateFieldGet(_scrollModePageState,this).scrollDown;case ScrollMode.HORIZONTAL:return this.scroll.right;}return this.scroll.down;}function _updateContainerHeightCss(){var height=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.container.clientHeight;if(height!==_classPrivateFieldGet(_previousContainerHeight,this)){_classPrivateFieldSet(_previousContainerHeight,this,height);docStyle.setProperty("--viewer-container-height","".concat(height,"px"));}}function _resizeObserverCallback2(entries){var _iterator67=_createForOfIteratorHelper(entries),_step67;try{for(_iterator67.s();!(_step67=_iterator67.n()).done;){var entry=_step67.value;if(entry.target===this.container){_assertClassBrand(_PDFViewer_brand,this,_updateContainerHeightCss).call(this,Math.floor(entry.borderBoxSize[0].blockSize));_classPrivateFieldSet(_containerTopLeft,this,null);break;}}}catch(err){_iterator67.e(err);}finally{_iterator67.f();}}function _cleanupTimeouts(){if(_classPrivateFieldGet(_scaleTimeoutId,this)!==null){clearTimeout(_classPrivateFieldGet(_scaleTimeoutId,this));_classPrivateFieldSet(_scaleTimeoutId,this,null);}if(_classPrivateFieldGet(_scrollTimeoutId,this)!==null){clearTimeout(_classPrivateFieldGet(_scrollTimeoutId,this));_classPrivateFieldSet(_scrollTimeoutId,this,null);}}function _cleanupSwitchAnnotationEditorMode(){var _classPrivateFieldGet69;(_classPrivateFieldGet69=_classPrivateFieldGet(_switchAnnotationEditorModeAC,this))===null||_classPrivateFieldGet69===void 0||_classPrivateFieldGet69.abort();_classPrivateFieldSet(_switchAnnotationEditorModeAC,this,null);if(_classPrivateFieldGet(_switchAnnotationEditorModeTimeoutId,this)!==null){clearTimeout(_classPrivateFieldGet(_switchAnnotationEditorModeTimeoutId,this));_classPrivateFieldSet(_switchAnnotationEditorModeTimeoutId,this,null);}}function _preloadEditingData(mode){var _classPrivateFieldGet70,_classPrivateFieldGet71;switch(mode){case AnnotationEditorType.STAMP:(_classPrivateFieldGet70=_classPrivateFieldGet(_mlManager3,this))===null||_classPrivateFieldGet70===void 0||_classPrivateFieldGet70.loadModel("altText");break;case AnnotationEditorType.SIGNATURE:(_classPrivateFieldGet71=_classPrivateFieldGet(_signatureManager,this))===null||_classPrivateFieldGet71===void 0||_classPrivateFieldGet71.loadSignatures();break;}};// ./web/secondary_toolbar.js
var _opts2=/*#__PURE__*/new WeakMap();var _SecondaryToolbar_brand=/*#__PURE__*/new WeakSet();var SecondaryToolbar=/*#__PURE__*/function(){function SecondaryToolbar(options,_eventBus9){_classCallCheck(this,SecondaryToolbar);_classPrivateMethodInitSpec(this,_SecondaryToolbar_brand);_classPrivateFieldInitSpec(this,_opts2,void 0);_classPrivateFieldSet(_opts2,this,options);var _buttons=[{element:options.presentationModeButton,eventName:"presentationmode",close:true},{element:options.printButton,eventName:"print",close:true},{element:options.downloadButton,eventName:"download",close:true},{element:options.viewBookmarkButton,eventName:null,close:true},{element:options.firstPageButton,eventName:"firstpage",close:true},{element:options.lastPageButton,eventName:"lastpage",close:true},{element:options.pageRotateCwButton,eventName:"rotatecw",close:false},{element:options.pageRotateCcwButton,eventName:"rotateccw",close:false},{element:options.cursorSelectToolButton,eventName:"switchcursortool",eventDetails:{tool:CursorTool.SELECT},close:true},{element:options.cursorHandToolButton,eventName:"switchcursortool",eventDetails:{tool:CursorTool.HAND},close:true},{element:options.scrollPageButton,eventName:"switchscrollmode",eventDetails:{mode:ScrollMode.PAGE},close:true},{element:options.scrollVerticalButton,eventName:"switchscrollmode",eventDetails:{mode:ScrollMode.VERTICAL},close:true},{element:options.scrollHorizontalButton,eventName:"switchscrollmode",eventDetails:{mode:ScrollMode.HORIZONTAL},close:true},{element:options.scrollWrappedButton,eventName:"switchscrollmode",eventDetails:{mode:ScrollMode.WRAPPED},close:true},{element:options.spreadNoneButton,eventName:"switchspreadmode",eventDetails:{mode:SpreadMode.NONE},close:true},{element:options.spreadOddButton,eventName:"switchspreadmode",eventDetails:{mode:SpreadMode.ODD},close:true},{element:options.spreadEvenButton,eventName:"switchspreadmode",eventDetails:{mode:SpreadMode.EVEN},close:true},{element:options.imageAltTextSettingsButton,eventName:"imagealttextsettings",close:true},{element:options.documentPropertiesButton,eventName:"documentproperties",close:true}];_buttons.push({element:options.openFileButton,eventName:"openfile",close:true});this.eventBus=_eventBus9;this.opened=false;_assertClassBrand(_SecondaryToolbar_brand,this,_bindListeners2).call(this,_buttons);this.reset();}return _createClass(SecondaryToolbar,[{key:"isOpen",get:function get(){return this.opened;}},{key:"setPageNumber",value:function setPageNumber(pageNumber){this.pageNumber=pageNumber;_assertClassBrand(_SecondaryToolbar_brand,this,_updateUIState3).call(this);}},{key:"setPagesCount",value:function setPagesCount(pagesCount){this.pagesCount=pagesCount;_assertClassBrand(_SecondaryToolbar_brand,this,_updateUIState3).call(this);}},{key:"reset",value:function reset(){this.pageNumber=0;this.pagesCount=0;_assertClassBrand(_SecondaryToolbar_brand,this,_updateUIState3).call(this);this.eventBus.dispatch("switchcursortool",{source:this,reset:true});_assertClassBrand(_SecondaryToolbar_brand,this,_scrollModeChanged).call(this,{mode:ScrollMode.VERTICAL});_assertClassBrand(_SecondaryToolbar_brand,this,_spreadModeChanged).call(this,{mode:SpreadMode.NONE});}},{key:"open",value:function open(){if(this.opened){return;}this.opened=true;var _classPrivateFieldGet40=_classPrivateFieldGet(_opts2,this),toggleButton=_classPrivateFieldGet40.toggleButton,toolbar=_classPrivateFieldGet40.toolbar;toggleExpandedBtn(toggleButton,true,toolbar);}},{key:"close",value:function close(){if(!this.opened){return;}this.opened=false;var _classPrivateFieldGet41=_classPrivateFieldGet(_opts2,this),toggleButton=_classPrivateFieldGet41.toggleButton,toolbar=_classPrivateFieldGet41.toolbar;toggleExpandedBtn(toggleButton,false,toolbar);}},{key:"toggle",value:function toggle(){if(this.opened){this.close();}else{this.open();}}}]);}();function _updateUIState3(){var _classPrivateFieldGet72=_classPrivateFieldGet(_opts2,this),firstPageButton=_classPrivateFieldGet72.firstPageButton,lastPageButton=_classPrivateFieldGet72.lastPageButton,pageRotateCwButton=_classPrivateFieldGet72.pageRotateCwButton,pageRotateCcwButton=_classPrivateFieldGet72.pageRotateCcwButton;firstPageButton.disabled=this.pageNumber<=1;lastPageButton.disabled=this.pageNumber>=this.pagesCount;pageRotateCwButton.disabled=this.pagesCount===0;pageRotateCcwButton.disabled=this.pagesCount===0;}function _bindListeners2(buttons){var _this114=this;var eventBus=this.eventBus;var _classPrivateFieldGet73=_classPrivateFieldGet(_opts2,this),toggleButton=_classPrivateFieldGet73.toggleButton;toggleButton.addEventListener("click",this.toggle.bind(this));var _iterator68=_createForOfIteratorHelper(buttons),_step68;try{var _loop5=function _loop5(){var _step68$value=_step68.value,element=_step68$value.element,eventName=_step68$value.eventName,close=_step68$value.close,eventDetails=_step68$value.eventDetails;element.addEventListener("click",function(evt){if(eventName!==null){eventBus.dispatch(eventName,_objectSpread({source:_this114},eventDetails));}if(close){_this114.close();}eventBus.dispatch("reporttelemetry",{source:_this114,details:{type:"buttons",data:{id:element.id}}});});};for(_iterator68.s();!(_step68=_iterator68.n()).done;){_loop5();}}catch(err){_iterator68.e(err);}finally{_iterator68.f();}eventBus._on("cursortoolchanged",_assertClassBrand(_SecondaryToolbar_brand,this,_cursorToolChanged).bind(this));eventBus._on("scrollmodechanged",_assertClassBrand(_SecondaryToolbar_brand,this,_scrollModeChanged).bind(this));eventBus._on("spreadmodechanged",_assertClassBrand(_SecondaryToolbar_brand,this,_spreadModeChanged).bind(this));}function _cursorToolChanged(_ref121){var tool=_ref121.tool,disabled=_ref121.disabled;var _classPrivateFieldGet74=_classPrivateFieldGet(_opts2,this),cursorSelectToolButton=_classPrivateFieldGet74.cursorSelectToolButton,cursorHandToolButton=_classPrivateFieldGet74.cursorHandToolButton;toggleCheckedBtn(cursorSelectToolButton,tool===CursorTool.SELECT);toggleCheckedBtn(cursorHandToolButton,tool===CursorTool.HAND);cursorSelectToolButton.disabled=disabled;cursorHandToolButton.disabled=disabled;}function _scrollModeChanged(_ref122){var mode=_ref122.mode;var _classPrivateFieldGet75=_classPrivateFieldGet(_opts2,this),scrollPageButton=_classPrivateFieldGet75.scrollPageButton,scrollVerticalButton=_classPrivateFieldGet75.scrollVerticalButton,scrollHorizontalButton=_classPrivateFieldGet75.scrollHorizontalButton,scrollWrappedButton=_classPrivateFieldGet75.scrollWrappedButton,spreadNoneButton=_classPrivateFieldGet75.spreadNoneButton,spreadOddButton=_classPrivateFieldGet75.spreadOddButton,spreadEvenButton=_classPrivateFieldGet75.spreadEvenButton;toggleCheckedBtn(scrollPageButton,mode===ScrollMode.PAGE);toggleCheckedBtn(scrollVerticalButton,mode===ScrollMode.VERTICAL);toggleCheckedBtn(scrollHorizontalButton,mode===ScrollMode.HORIZONTAL);toggleCheckedBtn(scrollWrappedButton,mode===ScrollMode.WRAPPED);var forceScrollModePage=this.pagesCount>PagesCountLimit.FORCE_SCROLL_MODE_PAGE;scrollPageButton.disabled=forceScrollModePage;scrollVerticalButton.disabled=forceScrollModePage;scrollHorizontalButton.disabled=forceScrollModePage;scrollWrappedButton.disabled=forceScrollModePage;var isHorizontal=mode===ScrollMode.HORIZONTAL;spreadNoneButton.disabled=isHorizontal;spreadOddButton.disabled=isHorizontal;spreadEvenButton.disabled=isHorizontal;}function _spreadModeChanged(_ref123){var mode=_ref123.mode;var _classPrivateFieldGet76=_classPrivateFieldGet(_opts2,this),spreadNoneButton=_classPrivateFieldGet76.spreadNoneButton,spreadOddButton=_classPrivateFieldGet76.spreadOddButton,spreadEvenButton=_classPrivateFieldGet76.spreadEvenButton;toggleCheckedBtn(spreadNoneButton,mode===SpreadMode.NONE);toggleCheckedBtn(spreadOddButton,mode===SpreadMode.ODD);toggleCheckedBtn(spreadEvenButton,mode===SpreadMode.EVEN);};// ./web/signature_manager.js
var DEFAULT_HEIGHT_IN_PAGE=40;var _addButton=/*#__PURE__*/new WeakMap();var _tabsToAltText=/*#__PURE__*/new WeakMap();var _clearButton=/*#__PURE__*/new WeakMap();var _clearDescription=/*#__PURE__*/new WeakMap();var _currentEditor3=/*#__PURE__*/new WeakMap();var _description=/*#__PURE__*/new WeakMap();var _dialog5=/*#__PURE__*/new WeakMap();var _drawCurves=/*#__PURE__*/new WeakMap();var _drawPlaceholder=/*#__PURE__*/new WeakMap();var _drawPath=/*#__PURE__*/new WeakMap();var _drawPathString=/*#__PURE__*/new WeakMap();var _drawPoints=/*#__PURE__*/new WeakMap();var _drawSVG=/*#__PURE__*/new WeakMap();var _drawThickness=/*#__PURE__*/new WeakMap();var _errorBar=/*#__PURE__*/new WeakMap();var _extractedSignatureData=/*#__PURE__*/new WeakMap();var _imagePath=/*#__PURE__*/new WeakMap();var _imagePicker=/*#__PURE__*/new WeakMap();var _imagePickerLink=/*#__PURE__*/new WeakMap();var _imagePlaceholder=/*#__PURE__*/new WeakMap();var _imageSVG=/*#__PURE__*/new WeakMap();var _saveCheckbox=/*#__PURE__*/new WeakMap();var _saveContainer=/*#__PURE__*/new WeakMap();var _tabButtons=/*#__PURE__*/new WeakMap();var _addSignatureToolbarButton=/*#__PURE__*/new WeakMap();var _loadSignaturesPromise=/*#__PURE__*/new WeakMap();var _typeInput=/*#__PURE__*/new WeakMap();var _currentTab=/*#__PURE__*/new WeakMap();var _currentTabAC=/*#__PURE__*/new WeakMap();var _hasDescriptionChanged=/*#__PURE__*/new WeakMap();var _eventBus0=/*#__PURE__*/new WeakMap();var _l10n2=/*#__PURE__*/new WeakMap();var _overlayManager4=/*#__PURE__*/new WeakMap();var _editDescriptionDialog=/*#__PURE__*/new WeakMap();var _signatureStorage=/*#__PURE__*/new WeakMap();var _uiManager4=/*#__PURE__*/new WeakMap();var _SignatureManager_brand=/*#__PURE__*/new WeakSet();var SignatureManager=/*#__PURE__*/function(){function SignatureManager(_ref87,editSignatureElements,addSignatureToolbarButton,overlayManager,l10n,signatureStorage,eventBus){var _this65=this;var dialog=_ref87.dialog,_panels=_ref87.panels,_typeButton=_ref87.typeButton,typeInput=_ref87.typeInput,_drawButton=_ref87.drawButton,drawPlaceholder=_ref87.drawPlaceholder,drawSVG=_ref87.drawSVG,drawThickness=_ref87.drawThickness,_imageButton=_ref87.imageButton,imageSVG=_ref87.imageSVG,imagePlaceholder=_ref87.imagePlaceholder,imagePicker=_ref87.imagePicker,imagePickerLink=_ref87.imagePickerLink,_description2=_ref87.description,clearButton=_ref87.clearButton,cancelButton=_ref87.cancelButton,addButton=_ref87.addButton,errorCloseButton=_ref87.errorCloseButton,errorBar=_ref87.errorBar,saveCheckbox=_ref87.saveCheckbox,saveContainer=_ref87.saveContainer;_classCallCheck(this,SignatureManager);_classPrivateMethodInitSpec(this,_SignatureManager_brand);_classPrivateFieldInitSpec(this,_addButton,void 0);_classPrivateFieldInitSpec(this,_tabsToAltText,null);_classPrivateFieldInitSpec(this,_clearButton,void 0);_classPrivateFieldInitSpec(this,_clearDescription,void 0);_classPrivateFieldInitSpec(this,_currentEditor3,void 0);_classPrivateFieldInitSpec(this,_description,void 0);_classPrivateFieldInitSpec(this,_dialog5,void 0);_classPrivateFieldInitSpec(this,_drawCurves,null);_classPrivateFieldInitSpec(this,_drawPlaceholder,void 0);_classPrivateFieldInitSpec(this,_drawPath,null);_classPrivateFieldInitSpec(this,_drawPathString,"");_classPrivateFieldInitSpec(this,_drawPoints,null);_classPrivateFieldInitSpec(this,_drawSVG,void 0);_classPrivateFieldInitSpec(this,_drawThickness,void 0);_classPrivateFieldInitSpec(this,_errorBar,void 0);_classPrivateFieldInitSpec(this,_extractedSignatureData,null);_classPrivateFieldInitSpec(this,_imagePath,null);_classPrivateFieldInitSpec(this,_imagePicker,void 0);_classPrivateFieldInitSpec(this,_imagePickerLink,void 0);_classPrivateFieldInitSpec(this,_imagePlaceholder,void 0);_classPrivateFieldInitSpec(this,_imageSVG,void 0);_classPrivateFieldInitSpec(this,_saveCheckbox,void 0);_classPrivateFieldInitSpec(this,_saveContainer,void 0);_classPrivateFieldInitSpec(this,_tabButtons,void 0);_classPrivateFieldInitSpec(this,_addSignatureToolbarButton,void 0);_classPrivateFieldInitSpec(this,_loadSignaturesPromise,null);_classPrivateFieldInitSpec(this,_typeInput,void 0);_classPrivateFieldInitSpec(this,_currentTab,null);_classPrivateFieldInitSpec(this,_currentTabAC,null);_classPrivateFieldInitSpec(this,_hasDescriptionChanged,false);_classPrivateFieldInitSpec(this,_eventBus0,void 0);_classPrivateFieldInitSpec(this,_l10n2,void 0);_classPrivateFieldInitSpec(this,_overlayManager4,void 0);_classPrivateFieldInitSpec(this,_editDescriptionDialog,void 0);_classPrivateFieldInitSpec(this,_signatureStorage,void 0);_classPrivateFieldInitSpec(this,_uiManager4,null);_classPrivateFieldSet(_addButton,this,addButton);_classPrivateFieldSet(_clearButton,this,clearButton);_classPrivateFieldSet(_clearDescription,this,_description2.lastElementChild);_classPrivateFieldSet(_description,this,_description2.firstElementChild);_classPrivateFieldSet(_dialog5,this,dialog);_classPrivateFieldSet(_drawSVG,this,drawSVG);_classPrivateFieldSet(_drawPlaceholder,this,drawPlaceholder);_classPrivateFieldSet(_drawThickness,this,drawThickness);_classPrivateFieldSet(_errorBar,this,errorBar);_classPrivateFieldSet(_imageSVG,this,imageSVG);_classPrivateFieldSet(_imagePlaceholder,this,imagePlaceholder);_classPrivateFieldSet(_imagePicker,this,imagePicker);_classPrivateFieldSet(_imagePickerLink,this,imagePickerLink);_classPrivateFieldSet(_overlayManager4,this,overlayManager);_classPrivateFieldSet(_saveCheckbox,this,saveCheckbox);_classPrivateFieldSet(_saveContainer,this,saveContainer);_classPrivateFieldSet(_addSignatureToolbarButton,this,addSignatureToolbarButton);_classPrivateFieldSet(_typeInput,this,typeInput);_classPrivateFieldSet(_l10n2,this,l10n);_classPrivateFieldSet(_signatureStorage,this,signatureStorage);_classPrivateFieldSet(_eventBus0,this,eventBus);_classPrivateFieldSet(_editDescriptionDialog,this,new EditDescriptionDialog(editSignatureElements,overlayManager));_l10nDescription._||(_l10nDescription._=Object.freeze({signature:"pdfjs-editor-add-signature-description-default-when-drawing"}));dialog.addEventListener("close",_assertClassBrand(_SignatureManager_brand,this,_close6).bind(this));dialog.addEventListener("contextmenu",function(e){var target=e.target;if(target!==_classPrivateFieldGet(_typeInput,_this65)&&target!==_classPrivateFieldGet(_description,_this65)){e.preventDefault();}});dialog.addEventListener("drop",function(e){stopEvent(e);});cancelButton.addEventListener("click",_assertClassBrand(_SignatureManager_brand,this,_cancel3).bind(this));addButton.addEventListener("click",_assertClassBrand(_SignatureManager_brand,this,_add).bind(this));clearButton.addEventListener("click",function(){_assertClassBrand(_SignatureManager_brand,_this65,_reportTelemetry2).call(_this65,{type:"signature",action:"pdfjs.signature.clear",data:{type:_classPrivateFieldGet(_currentTab,_this65)}});_assertClassBrand(_SignatureManager_brand,_this65,_initTab).call(_this65,null);},{passive:true});_classPrivateFieldGet(_description,this).addEventListener("input",function(){_classPrivateFieldGet(_clearDescription,_this65).disabled=_classPrivateFieldGet(_description,_this65).value==="";},{passive:true});_classPrivateFieldGet(_clearDescription,this).addEventListener("click",function(){_classPrivateFieldGet(_description,_this65).value="";_classPrivateFieldGet(_clearDescription,_this65).disabled=true;},{passive:true});errorCloseButton.addEventListener("click",function(){errorBar.hidden=true;},{passive:true});_assertClassBrand(_SignatureManager_brand,this,_initTabButtons).call(this,_typeButton,_drawButton,_imageButton,_panels);imagePicker.accept=SupportedImageMimeTypes.join(",");eventBus._on("storedsignatureschanged",_assertClassBrand(_SignatureManager_brand,this,_signaturesChanged).bind(this));overlayManager.register(dialog);}return _createClass(SignatureManager,[{key:"getSignature",value:function getSignature(params){return this.open(params);}},{key:"loadSignatures",value:function(){var _loadSignatures=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee70(){var reload,_yield$_classPrivateF,_yield$_classPrivateF2,signatures,signaturesData,i,_iterator47,_step47,_step47$value,uuid,description,data,_args72=arguments,_t30;return _regenerator().w(function(_context71){while(1)switch(_context71.n){case 0:reload=_args72.length>0&&_args72[0]!==undefined?_args72[0]:false;if(!(!_classPrivateFieldGet(_addSignatureToolbarButton,this)||!reload&&_classPrivateFieldGet(_addSignatureToolbarButton,this).previousElementSibling||!_classPrivateFieldGet(_signatureStorage,this))){_context71.n=1;break;}return _context71.a(2);case 1:if(_classPrivateFieldGet(_loadSignaturesPromise,this)){_context71.n=2;break;}_classPrivateFieldSet(_loadSignaturesPromise,this,_classPrivateFieldGet(_signatureStorage,this).getAll().then(/*#__PURE__*/function(){var _ref88=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee69(signatures){var _t28,_t29;return _regenerator().w(function(_context70){while(1)switch(_context70.n){case 0:_t28=signatures;_context70.n=1;return Promise.all(Array.from(signatures.values(),function(_ref89){var signatureData=_ref89.signatureData;return SignatureExtractor.decompressSignature(signatureData);}));case 1:_t29=_context70.v;return _context70.a(2,[_t28,_t29]);}},_callee69);}));return function(_x49){return _ref88.apply(this,arguments);};}()));if(reload){_context71.n=2;break;}return _context71.a(2);case 2:_context71.n=3;return _classPrivateFieldGet(_loadSignaturesPromise,this);case 3:_yield$_classPrivateF=_context71.v;_yield$_classPrivateF2=_slicedToArray(_yield$_classPrivateF,2);signatures=_yield$_classPrivateF2[0];signaturesData=_yield$_classPrivateF2[1];_classPrivateFieldSet(_loadSignaturesPromise,this,null);i=0;_iterator47=_createForOfIteratorHelper(signatures);_context71.p=4;_iterator47.s();case 5:if((_step47=_iterator47.n()).done){_context71.n=8;break;}_step47$value=_slicedToArray(_step47.value,2),uuid=_step47$value[0],description=_step47$value[1].description;data=signaturesData[i++];if(data){_context71.n=6;break;}return _context71.a(3,7);case 6:data.curves=data.outlines.map(function(points){return{points:points};});delete data.outlines;_assertClassBrand(_SignatureManager_brand,this,_addToolbarButton).call(this,data,uuid,description);case 7:_context71.n=5;break;case 8:_context71.n=10;break;case 9:_context71.p=9;_t30=_context71.v;_iterator47.e(_t30);case 10:_context71.p=10;_iterator47.f();return _context71.f(10);case 11:return _context71.a(2);}},_callee70,this,[[4,9,10,11]]);}));function loadSignatures(){return _loadSignatures.apply(this,arguments);}return loadSignatures;}()},{key:"renderEditButton",value:function(){var _renderEditButton=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee71(editor){var _this66=this;var button,span;return _regenerator().w(function(_context72){while(1)switch(_context72.n){case 0:button=document.createElement("button");button.classList.add("altText","editDescription");button.tabIndex=0;button.title=editor.description;span=document.createElement("span");button.append(span);span.setAttribute("data-l10n-id","pdfjs-editor-add-signature-edit-button-label");button.addEventListener("click",function(){_classPrivateFieldGet(_editDescriptionDialog,_this66).open(editor);},{passive:true});return _context72.a(2,button);}},_callee71);}));function renderEditButton(_x50){return _renderEditButton.apply(this,arguments);}return renderEditButton;}()},{key:"open",value:function(){var _open5=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee72(_ref90){var uiManager,editor,isStorageFull,tabType;return _regenerator().w(function(_context73){while(1)switch(_context73.n){case 0:uiManager=_ref90.uiManager,editor=_ref90.editor;_classPrivateFieldGet(_tabsToAltText,this)||_classPrivateFieldSet(_tabsToAltText,this,new Map(_classPrivateFieldGet(_tabButtons,this).keys().map(function(name){return[name,{value:"","default":""}];})));_classPrivateFieldSet(_uiManager4,this,uiManager);_classPrivateFieldSet(_currentEditor3,this,editor);_classPrivateFieldGet(_uiManager4,this).removeEditListeners();_context73.n=1;return _classPrivateFieldGet(_signatureStorage,this).isFull();case 1:isStorageFull=_context73.v;_classPrivateFieldGet(_saveContainer,this).classList.toggle("fullStorage",isStorageFull);_classPrivateFieldGet(_saveCheckbox,this).checked=!isStorageFull;_context73.n=2;return _classPrivateFieldGet(_overlayManager4,this).open(_classPrivateFieldGet(_dialog5,this));case 2:tabType=_classPrivateFieldGet(_tabButtons,this).get("type");tabType.focus();tabType.click();case 3:return _context73.a(2);}},_callee72,this);}));function open(_x51){return _open5.apply(this,arguments);}return open;}()},{key:"destroy",value:function destroy(){_classPrivateFieldSet(_uiManager4,this,null);_assertClassBrand(_SignatureManager_brand,this,_finish4).call(this);}}]);}();function _initTabButtons(typeButton,drawButton,imageButton,panels){var _this115=this;var buttons=_classPrivateFieldSet(_tabButtons,this,new Map([["type",typeButton],["draw",drawButton],["image",imageButton]]));var tabCallback=function tabCallback(e){var _iterator69=_createForOfIteratorHelper(buttons),_step69;try{for(_iterator69.s();!(_step69=_iterator69.n()).done;){var _step69$value=_slicedToArray(_step69.value,2),name=_step69$value[0],button=_step69$value[1];if(button===e.target){button.setAttribute("aria-selected",true);button.setAttribute("tabindex",0);panels.setAttribute("data-selected",name);_assertClassBrand(_SignatureManager_brand,_this115,_initTab).call(_this115,name);}else{button.setAttribute("aria-selected",false);button.setAttribute("tabindex",-1);}}}catch(err){_iterator69.e(err);}finally{_iterator69.f();}};var buttonsArray=Array.from(buttons.values());var _loop6=function _loop6(i){var button=buttonsArray[i];button.addEventListener("click",tabCallback,{passive:true});button.addEventListener("keydown",function(_ref124){var _buttonsArray;var key=_ref124.key;if(key!=="ArrowLeft"&&key!=="ArrowRight"){return;}(_buttonsArray=buttonsArray[i+(key==="ArrowLeft"?-1:1)])===null||_buttonsArray===void 0||_buttonsArray.focus();},{passive:true});};for(var i=0,ii=buttonsArray.length;i<ii;i++){_loop6(i);}}function _resetCommon(){_classPrivateFieldSet(_hasDescriptionChanged,this,false);_classPrivateFieldGet(_description,this).value="";if(_classPrivateFieldGet(_currentTab,this)){_classPrivateFieldGet(_tabsToAltText,this).get(_classPrivateFieldGet(_currentTab,this)).value="";}}function _resetTab(name){var _classPrivateFieldGet77,_classPrivateFieldGet78;switch(name){case"type":_classPrivateFieldGet(_typeInput,this).value="";break;case"draw":_classPrivateFieldSet(_drawCurves,this,null);_classPrivateFieldSet(_drawPoints,this,null);_classPrivateFieldSet(_drawPathString,this,"");(_classPrivateFieldGet77=_classPrivateFieldGet(_drawPath,this))===null||_classPrivateFieldGet77===void 0||_classPrivateFieldGet77.remove();_classPrivateFieldSet(_drawPath,this,null);_classPrivateFieldGet(_drawPlaceholder,this).hidden=false;_classPrivateFieldGet(_drawThickness,this).value=1;break;case"image":_classPrivateFieldGet(_imagePlaceholder,this).hidden=false;(_classPrivateFieldGet78=_classPrivateFieldGet(_imagePath,this))===null||_classPrivateFieldGet78===void 0||_classPrivateFieldGet78.remove();_classPrivateFieldSet(_imagePath,this,null);break;}}function _initTab(name){var _classPrivateFieldGet79;if(name&&_classPrivateFieldGet(_currentTab,this)===name){return;}if(_classPrivateFieldGet(_currentTab,this)){_classPrivateFieldGet(_tabsToAltText,this).get(_classPrivateFieldGet(_currentTab,this)).value=_classPrivateFieldGet(_description,this).value;}if(name){_classPrivateFieldSet(_currentTab,this,name);}_classPrivateFieldGet(_errorBar,this).hidden=true;var reset=!name;if(reset){_assertClassBrand(_SignatureManager_brand,this,_resetCommon).call(this);}else{_classPrivateFieldGet(_description,this).value=_classPrivateFieldGet(_tabsToAltText,this).get(_classPrivateFieldGet(_currentTab,this)).value;}_classPrivateFieldGet(_clearDescription,this).disabled=_classPrivateFieldGet(_description,this).value==="";(_classPrivateFieldGet79=_classPrivateFieldGet(_currentTabAC,this))===null||_classPrivateFieldGet79===void 0||_classPrivateFieldGet79.abort();_classPrivateFieldSet(_currentTabAC,this,new AbortController());switch(_classPrivateFieldGet(_currentTab,this)){case"type":_assertClassBrand(_SignatureManager_brand,this,_initTypeTab).call(this,reset);break;case"draw":_assertClassBrand(_SignatureManager_brand,this,_initDrawTab).call(this,reset);break;case"image":_assertClassBrand(_SignatureManager_brand,this,_initImageTab).call(this,reset);break;}}function _disableButtons(value){_classPrivateFieldGet(_saveCheckbox,this).disabled=_classPrivateFieldGet(_clearButton,this).disabled=_classPrivateFieldGet(_addButton,this).disabled=_classPrivateFieldGet(_description,this).disabled=!value;}function _initTypeTab(reset){var _this116=this;if(reset){_assertClassBrand(_SignatureManager_brand,this,_resetTab).call(this,"type");}_assertClassBrand(_SignatureManager_brand,this,_disableButtons).call(this,_classPrivateFieldGet(_typeInput,this).value);var _classPrivateFieldGet80=_classPrivateFieldGet(_currentTabAC,this),signal=_classPrivateFieldGet80.signal;var options={passive:true,signal:signal};_classPrivateFieldGet(_typeInput,this).addEventListener("input",function(){var _classPrivateFieldGet81=_classPrivateFieldGet(_typeInput,_this116),value=_classPrivateFieldGet81.value;if(!_classPrivateFieldGet(_hasDescriptionChanged,_this116)){_classPrivateFieldGet(_tabsToAltText,_this116).get("type")["default"]=_classPrivateFieldGet(_description,_this116).value=value;_classPrivateFieldGet(_clearDescription,_this116).disabled=value==="";}_assertClassBrand(_SignatureManager_brand,_this116,_disableButtons).call(_this116,value);},options);_classPrivateFieldGet(_description,this).addEventListener("input",function(){_classPrivateFieldSet(_hasDescriptionChanged,_this116,_classPrivateFieldGet(_typeInput,_this116).value!==_classPrivateFieldGet(_description,_this116).value);},options);}function _initDrawTab(reset){var _this117=this;if(reset){_assertClassBrand(_SignatureManager_brand,this,_resetTab).call(this,"draw");}_assertClassBrand(_SignatureManager_brand,this,_disableButtons).call(this,_classPrivateFieldGet(_drawPath,this));var _classPrivateFieldGet82=_classPrivateFieldGet(_currentTabAC,this),signal=_classPrivateFieldGet82.signal;var options={signal:signal};var currentPointerId=NaN;var _drawCallback=function drawCallback(e){var pointerId=e.pointerId;if(!isNaN(currentPointerId)&&currentPointerId!==pointerId){return;}currentPointerId=pointerId;e.preventDefault();_classPrivateFieldGet(_drawSVG,_this117).setPointerCapture(pointerId);var _classPrivateFieldGet83=_classPrivateFieldGet(_drawSVG,_this117).getBoundingClientRect(),drawWidth=_classPrivateFieldGet83.width,drawHeight=_classPrivateFieldGet83.height;var offsetX=e.offsetX,offsetY=e.offsetY;offsetX=Math.round(offsetX);offsetY=Math.round(offsetY);if(e.target===_classPrivateFieldGet(_drawPlaceholder,_this117)){_classPrivateFieldGet(_drawPlaceholder,_this117).hidden=true;}if(!_classPrivateFieldGet(_drawCurves,_this117)){_classPrivateFieldSet(_drawCurves,_this117,{width:drawWidth,height:drawHeight,thickness:parseInt(_classPrivateFieldGet(_drawThickness,_this117).value),curves:[]});_assertClassBrand(_SignatureManager_brand,_this117,_disableButtons).call(_this117,true);var svgFactory=new DOMSVGFactory();var path=_classPrivateFieldSet(_drawPath,_this117,svgFactory.createElement("path"));path.setAttribute("stroke-width",_classPrivateFieldGet(_drawThickness,_this117).value);_classPrivateFieldGet(_drawSVG,_this117).append(path);_classPrivateFieldGet(_drawSVG,_this117).addEventListener("pointerdown",_drawCallback,options);_classPrivateFieldGet(_drawPlaceholder,_this117).removeEventListener("pointerdown",_drawCallback);if(_classPrivateFieldGet(_description,_this117).value===""){_classPrivateFieldGet(_l10n2,_this117).get(_l10nDescription._.signature).then(function(description){var _classPrivateFieldGet84;_classPrivateFieldGet(_tabsToAltText,_this117).get("draw")["default"]=description;(_classPrivateFieldGet84=_classPrivateFieldGet(_description,_this117)).value||(_classPrivateFieldGet84.value=description);_classPrivateFieldGet(_clearDescription,_this117).disabled=_classPrivateFieldGet(_description,_this117).value==="";});}}_classPrivateFieldSet(_drawPoints,_this117,[offsetX,offsetY]);_classPrivateFieldGet(_drawCurves,_this117).curves.push({points:_classPrivateFieldGet(_drawPoints,_this117)});_classPrivateFieldSet(_drawPathString,_this117,_classPrivateFieldGet(_drawPathString,_this117)+"M ".concat(offsetX," ").concat(offsetY));_classPrivateFieldGet(_drawPath,_this117).setAttribute("d",_classPrivateFieldGet(_drawPathString,_this117));var finishDrawAC=new AbortController();var listenerDrawOptions={signal:AbortSignal.any([signal,finishDrawAC.signal])};_classPrivateFieldGet(_drawSVG,_this117).addEventListener("contextmenu",noContextMenu,listenerDrawOptions);_classPrivateFieldGet(_drawSVG,_this117).addEventListener("pointermove",function(evt){evt.preventDefault();var x=evt.offsetX,y=evt.offsetY;x=Math.round(x);y=Math.round(y);var drawPoints=_classPrivateFieldGet(_drawPoints,_this117);if(x<0||y<0||x>drawWidth||y>drawHeight||x===drawPoints.at(-2)&&y===drawPoints.at(-1)){return;}if(drawPoints.length>=4){var _drawPoints$slice=drawPoints.slice(-4),_drawPoints$slice2=_slicedToArray(_drawPoints$slice,4),x1=_drawPoints$slice2[0],y1=_drawPoints$slice2[1],x2=_drawPoints$slice2[2],y2=_drawPoints$slice2[3];_classPrivateFieldSet(_drawPathString,_this117,_classPrivateFieldGet(_drawPathString,_this117)+"C".concat((x1+5*x2)/6," ").concat((y1+5*y2)/6," ").concat((5*x2+x)/6," ").concat((5*y2+y)/6," ").concat((x2+x)/2," ").concat((y2+y)/2));}else{_classPrivateFieldSet(_drawPathString,_this117,_classPrivateFieldGet(_drawPathString,_this117)+"L".concat(x," ").concat(y));}drawPoints.push(x,y);_classPrivateFieldGet(_drawPath,_this117).setAttribute("d",_classPrivateFieldGet(_drawPathString,_this117));},listenerDrawOptions);_classPrivateFieldGet(_drawSVG,_this117).addEventListener("pointerup",function(evt){var pId=evt.pointerId;if(!isNaN(currentPointerId)&&currentPointerId!==pId){return;}currentPointerId=NaN;evt.preventDefault();_classPrivateFieldGet(_drawSVG,_this117).releasePointerCapture(pId);finishDrawAC.abort();if(_classPrivateFieldGet(_drawPoints,_this117).length===2){_classPrivateFieldSet(_drawPathString,_this117,_classPrivateFieldGet(_drawPathString,_this117)+"L".concat(_classPrivateFieldGet(_drawPoints,_this117)[0]," ").concat(_classPrivateFieldGet(_drawPoints,_this117)[1]));_classPrivateFieldGet(_drawPath,_this117).setAttribute("d",_classPrivateFieldGet(_drawPathString,_this117));}},listenerDrawOptions);};if(_classPrivateFieldGet(_drawCurves,this)){_classPrivateFieldGet(_drawSVG,this).addEventListener("pointerdown",_drawCallback,options);}else{_classPrivateFieldGet(_drawPlaceholder,this).addEventListener("pointerdown",_drawCallback,options);}_classPrivateFieldGet(_drawThickness,this).addEventListener("input",function(){var _classPrivateFieldGet85=_classPrivateFieldGet(_drawThickness,_this117),thickness=_classPrivateFieldGet85.value;_classPrivateFieldGet(_drawThickness,_this117).setAttribute("data-l10n-args",JSON.stringify({thickness:thickness}));if(!_classPrivateFieldGet(_drawCurves,_this117)){return;}_classPrivateFieldGet(_drawPath,_this117).setAttribute("stroke-width",thickness);_classPrivateFieldGet(_drawCurves,_this117).thickness=thickness;},options);}function _initImageTab(reset){var _this118=this;if(reset){_assertClassBrand(_SignatureManager_brand,this,_resetTab).call(this,"image");}_assertClassBrand(_SignatureManager_brand,this,_disableButtons).call(this,_classPrivateFieldGet(_imagePath,this));var _classPrivateFieldGet86=_classPrivateFieldGet(_currentTabAC,this),signal=_classPrivateFieldGet86.signal;var options={signal:signal};var passiveOptions={passive:true,signal:signal};_classPrivateFieldGet(_imagePickerLink,this).addEventListener("keydown",function(e){var key=e.key;if(key==="Enter"||key===" "){stopEvent(e);_classPrivateFieldGet(_imagePicker,_this118).click();}},options);_classPrivateFieldGet(_imagePicker,this).addEventListener("click",function(){_classPrivateFieldGet(_dialog5,_this118).classList.toggle("waiting",true);},passiveOptions);_classPrivateFieldGet(_imagePicker,this).addEventListener("change",/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee104(){var _classPrivateFieldGet87;var file;return _regenerator().w(function(_context105){while(1)switch(_context105.n){case 0:file=(_classPrivateFieldGet87=_classPrivateFieldGet(_imagePicker,_this118).files)===null||_classPrivateFieldGet87===void 0?void 0:_classPrivateFieldGet87[0];if(!(!file||!SupportedImageMimeTypes.includes(file.type))){_context105.n=1;break;}_classPrivateFieldGet(_errorBar,_this118).hidden=false;_classPrivateFieldGet(_dialog5,_this118).classList.toggle("waiting",false);return _context105.a(2);case 1:_context105.n=2;return _assertClassBrand(_SignatureManager_brand,_this118,_extractSignature).call(_this118,file);case 2:return _context105.a(2);}},_callee104);})),passiveOptions);_classPrivateFieldGet(_imagePicker,this).addEventListener("cancel",function(){_classPrivateFieldGet(_dialog5,_this118).classList.toggle("waiting",false);},passiveOptions);_classPrivateFieldGet(_imagePlaceholder,this).addEventListener("dragover",function(e){var dataTransfer=e.dataTransfer;var _iterator70=_createForOfIteratorHelper(dataTransfer.items),_step70;try{for(_iterator70.s();!(_step70=_iterator70.n()).done;){var type=_step70.value.type;if(!SupportedImageMimeTypes.includes(type)){continue;}dataTransfer.dropEffect=dataTransfer.effectAllowed==="copy"?"copy":"move";stopEvent(e);return;}}catch(err){_iterator70.e(err);}finally{_iterator70.f();}dataTransfer.dropEffect="none";},options);_classPrivateFieldGet(_imagePlaceholder,this).addEventListener("drop",function(e){var files=e.dataTransfer.files;if(!(files!==null&&files!==void 0&&files.length)){return;}var _iterator71=_createForOfIteratorHelper(files),_step71;try{for(_iterator71.s();!(_step71=_iterator71.n()).done;){var file=_step71.value;if(SupportedImageMimeTypes.includes(file.type)){_assertClassBrand(_SignatureManager_brand,_this118,_extractSignature).call(_this118,file);break;}}}catch(err){_iterator71.e(err);}finally{_iterator71.f();}stopEvent(e);_classPrivateFieldGet(_dialog5,_this118).classList.toggle("waiting",true);},options);}function _extractSignature(_x79){return _extractSignature2.apply(this,arguments);}function _extractSignature2(){_extractSignature2=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee133(file){var data,_classPrivateFieldSet2,outline,svgFactory,path,_t76;return _regenerator().w(function(_context134){while(1)switch(_context134.n){case 0:_context134.p=0;_context134.n=1;return _classPrivateFieldGet(_uiManager4,this).imageManager.getFromFile(file);case 1:data=_context134.v;_context134.n=3;break;case 2:_context134.p=2;_t76=_context134.v;console.error("SignatureManager.#extractSignature.",_t76);case 3:if(data){_context134.n=4;break;}_classPrivateFieldGet(_errorBar,this).hidden=false;_classPrivateFieldGet(_dialog5,this).classList.toggle("waiting",false);return _context134.a(2);case 4:_classPrivateFieldSet2=_classPrivateFieldSet(_extractedSignatureData,this,_classPrivateFieldGet(_currentEditor3,this).getFromImage(data.bitmap)),outline=_classPrivateFieldSet2.outline;if(outline){_context134.n=5;break;}_classPrivateFieldGet(_dialog5,this).classList.toggle("waiting",false);return _context134.a(2);case 5:_classPrivateFieldGet(_imagePlaceholder,this).hidden=true;_assertClassBrand(_SignatureManager_brand,this,_disableButtons).call(this,true);svgFactory=new DOMSVGFactory();path=_classPrivateFieldSet(_imagePath,this,svgFactory.createElement("path"));_classPrivateFieldGet(_imageSVG,this).setAttribute("viewBox",outline.viewBox);_classPrivateFieldGet(_imageSVG,this).setAttribute("preserveAspectRatio","xMidYMid meet");_classPrivateFieldGet(_imageSVG,this).append(path);path.setAttribute("d",outline.toSVGPath());_classPrivateFieldGet(_tabsToAltText,this).get("image")["default"]=file.name;if(_classPrivateFieldGet(_description,this).value===""){_classPrivateFieldGet(_description,this).value=file.name||"";_classPrivateFieldGet(_clearDescription,this).disabled=_classPrivateFieldGet(_description,this).value==="";}_classPrivateFieldGet(_dialog5,this).classList.toggle("waiting",false);case 6:return _context134.a(2);}},_callee133,this,[[0,2]]);}));return _extractSignature2.apply(this,arguments);}function _getOutlineForType(){return _classPrivateFieldGet(_currentEditor3,this).getFromText(_classPrivateFieldGet(_typeInput,this).value,window.getComputedStyle(_classPrivateFieldGet(_typeInput,this)));}function _getOutlineForDraw(){var _classPrivateFieldGet88=_classPrivateFieldGet(_drawSVG,this).getBoundingClientRect(),width=_classPrivateFieldGet88.width,height=_classPrivateFieldGet88.height;return _classPrivateFieldGet(_currentEditor3,this).getDrawnSignature(_classPrivateFieldGet(_drawCurves,this),width,height);}function _reportTelemetry2(data){_classPrivateFieldGet(_eventBus0,this).dispatch("reporttelemetry",{source:this,details:{type:"editing",data:data}});}function _addToolbarButton(signatureData,uuid,description){var _this119=this;var curves=signatureData.curves,areContours=signatureData.areContours,thickness=signatureData.thickness,width=signatureData.width,height=signatureData.height;var maxDim=Math.max(width,height);var outlineData=SignatureExtractor.processDrawnLines({lines:{curves:curves,thickness:thickness,width:width,height:height},pageWidth:maxDim,pageHeight:maxDim,rotation:0,innerMargin:0,mustSmooth:false,areContours:areContours});if(!outlineData){return;}var outline=outlineData.outline;var svgFactory=new DOMSVGFactory();var div=document.createElement("div");var button=document.createElement("button");button.addEventListener("click",function(){_classPrivateFieldGet(_eventBus0,_this119).dispatch("switchannotationeditorparams",{source:_this119,type:AnnotationEditorParamsType.CREATE,value:{signatureData:{lines:{curves:curves,thickness:thickness,width:width,height:height},mustSmooth:false,areContours:areContours,description:description,uuid:uuid,heightInPage:DEFAULT_HEIGHT_IN_PAGE}}});});div.append(button);div.classList.add("toolbarAddSignatureButtonContainer");var svg=svgFactory.create(1,1,true);button.append(svg);var span=document.createElement("span");span.ariaHidden=true;button.append(span);button.classList.add("toolbarAddSignatureButton");button.type="button";span.textContent=description;button.setAttribute("data-l10n-id","pdfjs-editor-add-saved-signature-button");button.setAttribute("data-l10n-args",JSON.stringify({description:description}));button.tabIndex=0;var path=svgFactory.createElement("path");svg.append(path);svg.setAttribute("viewBox",outline.viewBox);svg.setAttribute("preserveAspectRatio","xMidYMid meet");if(areContours){path.classList.add("contours");}path.setAttribute("d",outline.toSVGPath());var deleteButton=document.createElement("button");div.append(deleteButton);deleteButton.classList.add("toolbarButton","deleteButton");deleteButton.setAttribute("data-l10n-id","pdfjs-editor-delete-signature-button1");deleteButton.type="button";deleteButton.tabIndex=0;deleteButton.addEventListener("click",/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee105(){var _t59,_t60,_t61,_t62,_t63;return _regenerator().w(function(_context106){while(1)switch(_context106.n){case 0:_context106.n=1;return _classPrivateFieldGet(_signatureStorage,_this119)["delete"](uuid);case 1:if(!_context106.v){_context106.n=3;break;}div.remove();_t59=_assertClassBrand(_SignatureManager_brand,_this119,_reportTelemetry2);_t60=_this119;_context106.n=2;return _classPrivateFieldGet(_signatureStorage,_this119).size();case 2:_t61=_context106.v;_t62={savedCount:_t61};_t63={type:"signature",action:"pdfjs.signature.delete_saved",data:_t62};_t59.call.call(_t59,_t60,_t63);case 3:return _context106.a(2);}},_callee105);})));var deleteSpan=document.createElement("span");deleteButton.append(deleteSpan);deleteSpan.setAttribute("data-l10n-id","pdfjs-editor-delete-signature-button-label1");_classPrivateFieldGet(_addSignatureToolbarButton,this).before(div);}function _signaturesChanged(){return _signaturesChanged2.apply(this,arguments);}function _signaturesChanged2(){_signaturesChanged2=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee134(){var parent;return _regenerator().w(function(_context135){while(1)switch(_context135.n){case 0:parent=_classPrivateFieldGet(_addSignatureToolbarButton,this).parentElement;while(parent.firstElementChild!==_classPrivateFieldGet(_addSignatureToolbarButton,this)){parent.firstElementChild.remove();}_classPrivateFieldSet(_loadSignaturesPromise,this,null);_context135.n=1;return this.loadSignatures(true);case 1:return _context135.a(2);}},_callee134,this);}));return _signaturesChanged2.apply(this,arguments);}function _cancel3(){_assertClassBrand(_SignatureManager_brand,this,_finish4).call(this);}function _finish4(){_classPrivateFieldGet(_overlayManager4,this).closeIfActive(_classPrivateFieldGet(_dialog5,this));}function _close6(){var _classPrivateFieldGet89,_classPrivateFieldGet90;if(_classPrivateFieldGet(_currentEditor3,this)._drawId===null){_classPrivateFieldGet(_currentEditor3,this).remove();}(_classPrivateFieldGet89=_classPrivateFieldGet(_uiManager4,this))===null||_classPrivateFieldGet89===void 0||_classPrivateFieldGet89.addEditListeners();(_classPrivateFieldGet90=_classPrivateFieldGet(_currentTabAC,this))===null||_classPrivateFieldGet90===void 0||_classPrivateFieldGet90.abort();_classPrivateFieldSet(_currentTabAC,this,null);_classPrivateFieldSet(_uiManager4,this,null);_classPrivateFieldSet(_currentEditor3,this,null);_assertClassBrand(_SignatureManager_brand,this,_resetCommon).call(this);var _iterator72=_createForOfIteratorHelper(_classPrivateFieldGet(_tabButtons,this)),_step72;try{for(_iterator72.s();!(_step72=_iterator72.n()).done;){var _step72$value=_slicedToArray(_step72.value,1),name=_step72$value[0];_assertClassBrand(_SignatureManager_brand,this,_resetTab).call(this,name);}}catch(err){_iterator72.e(err);}finally{_iterator72.f();}_assertClassBrand(_SignatureManager_brand,this,_disableButtons).call(this,false);_classPrivateFieldSet(_currentTab,this,null);_classPrivateFieldSet(_tabsToAltText,this,null);}function _add(){return _add2.apply(this,arguments);}function _add2(){_add2=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee135(){var data,type,uuid,description,_data2,newCurves,areContours,thickness,width,height,signatureData,altText,_t77,_t78,_t79,_t80,_t81,_t82,_t83,_t84,_t85;return _regenerator().w(function(_context136){while(1)switch(_context136.n){case 0:type=_classPrivateFieldGet(_currentTab,this);_t77=type;_context136.n=_t77==="type"?1:_t77==="draw"?2:_t77==="image"?3:4;break;case 1:data=_assertClassBrand(_SignatureManager_brand,this,_getOutlineForType).call(this);return _context136.a(3,4);case 2:data=_assertClassBrand(_SignatureManager_brand,this,_getOutlineForDraw).call(this);return _context136.a(3,4);case 3:data=_classPrivateFieldGet(_extractedSignatureData,this);return _context136.a(3,4);case 4:uuid=null;description=_classPrivateFieldGet(_description,this).value;if(!_classPrivateFieldGet(_saveCheckbox,this).checked){_context136.n=7;break;}_data2=data,newCurves=_data2.newCurves,areContours=_data2.areContours,thickness=_data2.thickness,width=_data2.width,height=_data2.height;_context136.n=5;return SignatureExtractor.compressSignature({outlines:newCurves,areContours:areContours,thickness:thickness,width:width,height:height});case 5:signatureData=_context136.v;_context136.n=6;return _classPrivateFieldGet(_signatureStorage,this).create({description:description,signatureData:signatureData});case 6:uuid=_context136.v;if(uuid){_assertClassBrand(_SignatureManager_brand,this,_addToolbarButton).call(this,{curves:newCurves.map(function(points){return{points:points};}),areContours:areContours,thickness:thickness,width:width,height:height},uuid,description);}else{console.warn("SignatureManager.add: cannot save the signature.");}case 7:altText=_classPrivateFieldGet(_tabsToAltText,this).get(type);_t78=_assertClassBrand(_SignatureManager_brand,this,_reportTelemetry2);_t79=this;_t80=type;_t81=!!uuid;_context136.n=8;return _classPrivateFieldGet(_signatureStorage,this).size();case 8:_t82=_context136.v;_t83=description!==altText["default"];_t84={type:_t80,saved:_t81,savedCount:_t82,descriptionChanged:_t83};_t85={type:"signature",action:"pdfjs.signature.created",data:_t84};_t78.call.call(_t78,_t79,_t85);_classPrivateFieldGet(_currentEditor3,this).addSignature(data,DEFAULT_HEIGHT_IN_PAGE,_classPrivateFieldGet(_description,this).value,uuid);_assertClassBrand(_SignatureManager_brand,this,_finish4).call(this);case 9:return _context136.a(2);}},_callee135,this);}));return _add2.apply(this,arguments);}var _l10nDescription={_:null};var _currentEditor4=/*#__PURE__*/new WeakMap();var _previousDescription=/*#__PURE__*/new WeakMap();var _description3=/*#__PURE__*/new WeakMap();var _dialog6=/*#__PURE__*/new WeakMap();var _overlayManager5=/*#__PURE__*/new WeakMap();var _signatureSVG=/*#__PURE__*/new WeakMap();var _uiManager5=/*#__PURE__*/new WeakMap();var _EditDescriptionDialog_brand=/*#__PURE__*/new WeakSet();var EditDescriptionDialog=/*#__PURE__*/function(){function EditDescriptionDialog(_ref91,overlayManager){var _this67=this;var dialog=_ref91.dialog,description=_ref91.description,cancelButton=_ref91.cancelButton,updateButton=_ref91.updateButton,editSignatureView=_ref91.editSignatureView;_classCallCheck(this,EditDescriptionDialog);_classPrivateMethodInitSpec(this,_EditDescriptionDialog_brand);_classPrivateFieldInitSpec(this,_currentEditor4,void 0);_classPrivateFieldInitSpec(this,_previousDescription,void 0);_classPrivateFieldInitSpec(this,_description3,void 0);_classPrivateFieldInitSpec(this,_dialog6,void 0);_classPrivateFieldInitSpec(this,_overlayManager5,void 0);_classPrivateFieldInitSpec(this,_signatureSVG,void 0);_classPrivateFieldInitSpec(this,_uiManager5,void 0);var descriptionInput=_classPrivateFieldSet(_description3,this,description.firstElementChild);_classPrivateFieldSet(_signatureSVG,this,editSignatureView);_classPrivateFieldSet(_dialog6,this,dialog);_classPrivateFieldSet(_overlayManager5,this,overlayManager);dialog.addEventListener("close",_assertClassBrand(_EditDescriptionDialog_brand,this,_close7).bind(this));dialog.addEventListener("contextmenu",function(e){if(e.target!==_classPrivateFieldGet(_description3,_this67)){e.preventDefault();}});cancelButton.addEventListener("click",_assertClassBrand(_EditDescriptionDialog_brand,this,_cancel4).bind(this));updateButton.addEventListener("click",_assertClassBrand(_EditDescriptionDialog_brand,this,_update).bind(this));var clearDescription=description.lastElementChild;clearDescription.addEventListener("click",function(){descriptionInput.value="";clearDescription.disabled=true;updateButton.disabled=_classPrivateFieldGet(_previousDescription,_this67)==="";});descriptionInput.addEventListener("input",function(){var value=descriptionInput.value;clearDescription.disabled=value==="";updateButton.disabled=value===_classPrivateFieldGet(_previousDescription,_this67);editSignatureView.setAttribute("aria-label",value);},{passive:true});overlayManager.register(dialog);}return _createClass(EditDescriptionDialog,[{key:"open",value:function(){var _open6=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee73(editor){var _editor$getSignatureP,areContours,outline,svgFactory,path;return _regenerator().w(function(_context74){while(1)switch(_context74.n){case 0:_classPrivateFieldSet(_uiManager5,this,editor._uiManager);_classPrivateFieldSet(_currentEditor4,this,editor);_classPrivateFieldSet(_previousDescription,this,_classPrivateFieldGet(_description3,this).value=editor.description);_classPrivateFieldGet(_description3,this).dispatchEvent(new Event("input"));_classPrivateFieldGet(_uiManager5,this).removeEditListeners();_editor$getSignatureP=editor.getSignaturePreview(),areContours=_editor$getSignatureP.areContours,outline=_editor$getSignatureP.outline;svgFactory=new DOMSVGFactory();path=svgFactory.createElement("path");_classPrivateFieldGet(_signatureSVG,this).append(path);_classPrivateFieldGet(_signatureSVG,this).setAttribute("viewBox",outline.viewBox);path.setAttribute("d",outline.toSVGPath());if(areContours){path.classList.add("contours");}_context74.n=1;return _classPrivateFieldGet(_overlayManager5,this).open(_classPrivateFieldGet(_dialog6,this));case 1:return _context74.a(2);}},_callee73,this);}));function open(_x52){return _open6.apply(this,arguments);}return open;}()}]);}();function _update(){return _update2.apply(this,arguments);}function _update2(){_update2=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee136(){return _regenerator().w(function(_context137){while(1)switch(_context137.n){case 0:_classPrivateFieldGet(_currentEditor4,this)._reportTelemetry({action:"pdfjs.signature.edit_description",data:{hasBeenChanged:true}});_classPrivateFieldGet(_currentEditor4,this).description=_classPrivateFieldGet(_description3,this).value;_assertClassBrand(_EditDescriptionDialog_brand,this,_finish5).call(this);case 1:return _context137.a(2);}},_callee136,this);}));return _update2.apply(this,arguments);}function _cancel4(){_classPrivateFieldGet(_currentEditor4,this)._reportTelemetry({action:"pdfjs.signature.edit_description",data:{hasBeenChanged:false}});_assertClassBrand(_EditDescriptionDialog_brand,this,_finish5).call(this);}function _finish5(){_classPrivateFieldGet(_overlayManager5,this).closeIfActive(_classPrivateFieldGet(_dialog6,this));}function _close7(){var _classPrivateFieldGet91;(_classPrivateFieldGet91=_classPrivateFieldGet(_uiManager5,this))===null||_classPrivateFieldGet91===void 0||_classPrivateFieldGet91.addEditListeners();_classPrivateFieldSet(_uiManager5,this,null);_classPrivateFieldSet(_currentEditor4,this,null);_classPrivateFieldGet(_signatureSVG,this).firstElementChild.remove();};// ./web/toolbar.js
var _colorPicker=/*#__PURE__*/new WeakMap();var _opts3=/*#__PURE__*/new WeakMap();var _Toolbar_brand=/*#__PURE__*/new WeakSet();var Toolbar=/*#__PURE__*/function(){function Toolbar(options,_eventBus1){var toolbarDensity=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;_classCallCheck(this,Toolbar);_classPrivateMethodInitSpec(this,_Toolbar_brand);_classPrivateFieldInitSpec(this,_colorPicker,null);_classPrivateFieldInitSpec(this,_opts3,void 0);_classPrivateFieldSet(_opts3,this,options);this.eventBus=_eventBus1;var _buttons2=[{element:options.previous,eventName:"previouspage"},{element:options.next,eventName:"nextpage"},{element:options.zoomIn,eventName:"zoomin"},{element:options.zoomOut,eventName:"zoomout"},{element:options.print,eventName:"print"},{element:options.download,eventName:"download"},{element:options.editorFreeTextButton,eventName:"switchannotationeditormode",eventDetails:{get mode(){var classList=options.editorFreeTextButton.classList;return classList.contains("toggled")?AnnotationEditorType.NONE:AnnotationEditorType.FREETEXT;}}},{element:options.editorHighlightButton,eventName:"switchannotationeditormode",eventDetails:{get mode(){var classList=options.editorHighlightButton.classList;return classList.contains("toggled")?AnnotationEditorType.NONE:AnnotationEditorType.HIGHLIGHT;}}},{element:options.editorInkButton,eventName:"switchannotationeditormode",eventDetails:{get mode(){var classList=options.editorInkButton.classList;return classList.contains("toggled")?AnnotationEditorType.NONE:AnnotationEditorType.INK;}}},{element:options.editorStampButton,eventName:"switchannotationeditormode",eventDetails:{get mode(){var classList=options.editorStampButton.classList;return classList.contains("toggled")?AnnotationEditorType.NONE:AnnotationEditorType.STAMP;}},telemetry:{type:"editing",data:{action:"pdfjs.image.icon_click"}}},{element:options.editorSignatureButton,eventName:"switchannotationeditormode",eventDetails:{get mode(){var classList=options.editorSignatureButton.classList;return classList.contains("toggled")?AnnotationEditorType.NONE:AnnotationEditorType.SIGNATURE;}}}];_assertClassBrand(_Toolbar_brand,this,_bindListeners3).call(this,_buttons2);_assertClassBrand(_Toolbar_brand,this,_updateToolbarDensity).call(this,{value:toolbarDensity});this.reset();}return _createClass(Toolbar,[{key:"setPageNumber",value:function setPageNumber(pageNumber,pageLabel){this.pageNumber=pageNumber;this.pageLabel=pageLabel;_assertClassBrand(_Toolbar_brand,this,_updateUIState4).call(this,false);}},{key:"setPagesCount",value:function setPagesCount(pagesCount,hasPageLabels){this.pagesCount=pagesCount;this.hasPageLabels=hasPageLabels;_assertClassBrand(_Toolbar_brand,this,_updateUIState4).call(this,true);}},{key:"setPageScale",value:function setPageScale(pageScaleValue,pageScale){this.pageScaleValue=(pageScaleValue||pageScale).toString();this.pageScale=pageScale;_assertClassBrand(_Toolbar_brand,this,_updateUIState4).call(this,false);}},{key:"reset",value:function reset(){_classPrivateFieldSet(_colorPicker,this,null);this.pageNumber=0;this.pageLabel=null;this.hasPageLabels=false;this.pagesCount=0;this.pageScaleValue=DEFAULT_SCALE_VALUE;this.pageScale=DEFAULT_SCALE;_assertClassBrand(_Toolbar_brand,this,_updateUIState4).call(this,true);this.updateLoadingIndicatorState();_assertClassBrand(_Toolbar_brand,this,_editorModeChanged).call(this,{mode:AnnotationEditorType.DISABLE});}},{key:"updateLoadingIndicatorState",value:function updateLoadingIndicatorState(){var loading=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var _classPrivateFieldGet42=_classPrivateFieldGet(_opts3,this),pageNumber=_classPrivateFieldGet42.pageNumber;pageNumber.classList.toggle("loading",loading);}}]);}();function _updateToolbarDensity(_ref127){var value=_ref127.value;var name="normal";switch(value){case 1:name="compact";break;case 2:name="touch";break;}document.documentElement.setAttribute("data-toolbar-density",name);}function _bindListeners3(buttons){var _this120=this;var eventBus=this.eventBus;var _classPrivateFieldGet92=_classPrivateFieldGet(_opts3,this),editorHighlightColorPicker=_classPrivateFieldGet92.editorHighlightColorPicker,editorHighlightButton=_classPrivateFieldGet92.editorHighlightButton,pageNumber=_classPrivateFieldGet92.pageNumber,scaleSelect=_classPrivateFieldGet92.scaleSelect;var self=this;var _iterator73=_createForOfIteratorHelper(buttons),_step73;try{var _loop7=function _loop7(){var _step73$value=_step73.value,element=_step73$value.element,eventName=_step73$value.eventName,eventDetails=_step73$value.eventDetails,telemetry=_step73$value.telemetry;element.addEventListener("click",function(evt){if(eventName!==null){eventBus.dispatch(eventName,_objectSpread(_objectSpread({source:_this120},eventDetails),{},{isFromKeyboard:evt.detail===0}));}if(telemetry){eventBus.dispatch("reporttelemetry",{source:_this120,details:telemetry});}});};for(_iterator73.s();!(_step73=_iterator73.n()).done;){_loop7();}}catch(err){_iterator73.e(err);}finally{_iterator73.f();}pageNumber.addEventListener("click",function(){this.select();});pageNumber.addEventListener("change",function(){eventBus.dispatch("pagenumberchanged",{source:self,value:this.value});});scaleSelect.addEventListener("change",function(){if(this.value==="custom"){return;}eventBus.dispatch("scalechanged",{source:self,value:this.value});});scaleSelect.addEventListener("click",function(_ref128){var target=_ref128.target;if(this.value===self.pageScaleValue&&target.tagName.toUpperCase()==="OPTION"){this.blur();}});scaleSelect.oncontextmenu=noContextMenu;eventBus._on("annotationeditormodechanged",_assertClassBrand(_Toolbar_brand,this,_editorModeChanged).bind(this));eventBus._on("showannotationeditorui",function(_ref129){var mode=_ref129.mode;switch(mode){case AnnotationEditorType.HIGHLIGHT:editorHighlightButton.click();break;}});eventBus._on("toolbardensity",_assertClassBrand(_Toolbar_brand,this,_updateToolbarDensity).bind(this));if(editorHighlightColorPicker){eventBus._on("annotationeditoruimanager",function(_ref130){var uiManager=_ref130.uiManager;var cp=_classPrivateFieldSet(_colorPicker,_this120,new ColorPicker({uiManager:uiManager}));uiManager.setMainHighlightColorPicker(cp);editorHighlightColorPicker.append(cp.renderMainDropdown());});eventBus._on("mainhighlightcolorpickerupdatecolor",function(_ref131){var _classPrivateFieldGet93;var value=_ref131.value;(_classPrivateFieldGet93=_classPrivateFieldGet(_colorPicker,_this120))===null||_classPrivateFieldGet93===void 0||_classPrivateFieldGet93.updateColor(value);});}}function _editorModeChanged(_ref132){var mode=_ref132.mode;var _classPrivateFieldGet94=_classPrivateFieldGet(_opts3,this),editorFreeTextButton=_classPrivateFieldGet94.editorFreeTextButton,editorFreeTextParamsToolbar=_classPrivateFieldGet94.editorFreeTextParamsToolbar,editorHighlightButton=_classPrivateFieldGet94.editorHighlightButton,editorHighlightParamsToolbar=_classPrivateFieldGet94.editorHighlightParamsToolbar,editorInkButton=_classPrivateFieldGet94.editorInkButton,editorInkParamsToolbar=_classPrivateFieldGet94.editorInkParamsToolbar,editorStampButton=_classPrivateFieldGet94.editorStampButton,editorStampParamsToolbar=_classPrivateFieldGet94.editorStampParamsToolbar,editorSignatureButton=_classPrivateFieldGet94.editorSignatureButton,editorSignatureParamsToolbar=_classPrivateFieldGet94.editorSignatureParamsToolbar;toggleExpandedBtn(editorFreeTextButton,mode===AnnotationEditorType.FREETEXT,editorFreeTextParamsToolbar);toggleExpandedBtn(editorHighlightButton,mode===AnnotationEditorType.HIGHLIGHT,editorHighlightParamsToolbar);toggleExpandedBtn(editorInkButton,mode===AnnotationEditorType.INK,editorInkParamsToolbar);toggleExpandedBtn(editorStampButton,mode===AnnotationEditorType.STAMP,editorStampParamsToolbar);toggleExpandedBtn(editorSignatureButton,mode===AnnotationEditorType.SIGNATURE,editorSignatureParamsToolbar);var isDisable=mode===AnnotationEditorType.DISABLE;editorFreeTextButton.disabled=isDisable;editorHighlightButton.disabled=isDisable;editorInkButton.disabled=isDisable;editorStampButton.disabled=isDisable;editorSignatureButton.disabled=isDisable;}function _updateUIState4(){var resetNumPages=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var pageNumber=this.pageNumber,pagesCount=this.pagesCount,pageScaleValue=this.pageScaleValue,pageScale=this.pageScale;var opts=_classPrivateFieldGet(_opts3,this);if(resetNumPages){if(this.hasPageLabels){opts.pageNumber.type="text";opts.numPages.setAttribute("data-l10n-id","pdfjs-page-of-pages");}else{opts.pageNumber.type="number";opts.numPages.setAttribute("data-l10n-id","pdfjs-of-pages");opts.numPages.setAttribute("data-l10n-args",JSON.stringify({pagesCount:pagesCount}));}opts.pageNumber.max=pagesCount;}if(this.hasPageLabels){opts.pageNumber.value=this.pageLabel;opts.numPages.setAttribute("data-l10n-args",JSON.stringify({pageNumber:pageNumber,pagesCount:pagesCount}));}else{opts.pageNumber.value=pageNumber;}opts.previous.disabled=pageNumber<=1;opts.next.disabled=pageNumber>=pagesCount;opts.zoomOut.disabled=pageScale<=MIN_SCALE;opts.zoomIn.disabled=pageScale>=MAX_SCALE;var predefinedValueFound=false;var _iterator74=_createForOfIteratorHelper(opts.scaleSelect.options),_step74;try{for(_iterator74.s();!(_step74=_iterator74.n()).done;){var option=_step74.value;if(option.value!==pageScaleValue){option.selected=false;continue;}option.selected=true;predefinedValueFound=true;}}catch(err){_iterator74.e(err);}finally{_iterator74.f();}if(!predefinedValueFound){opts.customScaleOption.selected=true;opts.customScaleOption.setAttribute("data-l10n-args",JSON.stringify({scale:Math.round(pageScale*10000)/100}));}};// ./web/view_history.js
var DEFAULT_VIEW_HISTORY_CACHE_SIZE=20;var ViewHistory=/*#__PURE__*/function(){function ViewHistory(fingerprint){var _this68=this;var cacheSize=arguments.length>1&&arguments[1]!==undefined?arguments[1]:DEFAULT_VIEW_HISTORY_CACHE_SIZE;_classCallCheck(this,ViewHistory);this.fingerprint=fingerprint;this.cacheSize=cacheSize;this._initializedPromise=this._readFromStorage().then(function(databaseStr){var database=JSON.parse(databaseStr||"{}");var index=-1;if(!Array.isArray(database.files)){database.files=[];}else{while(database.files.length>=_this68.cacheSize){database.files.shift();}for(var i=0,ii=database.files.length;i<ii;i++){var branch=database.files[i];if(branch.fingerprint===_this68.fingerprint){index=i;break;}}}if(index===-1){index=database.files.push({fingerprint:_this68.fingerprint})-1;}_this68.file=database.files[index];_this68.database=database;});}return _createClass(ViewHistory,[{key:"_writeToStorage",value:function(){var _writeToStorage4=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee74(){var databaseStr;return _regenerator().w(function(_context75){while(1)switch(_context75.n){case 0:databaseStr=JSON.stringify(this.database);localStorage.setItem("pdfjs.history",databaseStr);case 1:return _context75.a(2);}},_callee74,this);}));function _writeToStorage(){return _writeToStorage4.apply(this,arguments);}return _writeToStorage;}()},{key:"_readFromStorage",value:function(){var _readFromStorage4=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee75(){return _regenerator().w(function(_context76){while(1)switch(_context76.n){case 0:return _context76.a(2,localStorage.getItem("pdfjs.history"));}},_callee75);}));function _readFromStorage(){return _readFromStorage4.apply(this,arguments);}return _readFromStorage;}()},{key:"set",value:function(){var _set3=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee76(name,val){return _regenerator().w(function(_context77){while(1)switch(_context77.n){case 0:_context77.n=1;return this._initializedPromise;case 1:this.file[name]=val;return _context77.a(2,this._writeToStorage());}},_callee76,this);}));function set(_x53,_x54){return _set3.apply(this,arguments);}return set;}()},{key:"setMultiple",value:function(){var _setMultiple=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee77(properties){var name;return _regenerator().w(function(_context78){while(1)switch(_context78.n){case 0:_context78.n=1;return this._initializedPromise;case 1:for(name in properties){this.file[name]=properties[name];}return _context78.a(2,this._writeToStorage());}},_callee77,this);}));function setMultiple(_x55){return _setMultiple.apply(this,arguments);}return setMultiple;}()},{key:"get",value:function(){var _get4=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee78(name,defaultValue){var val;return _regenerator().w(function(_context79){while(1)switch(_context79.n){case 0:_context79.n=1;return this._initializedPromise;case 1:val=this.file[name];return _context79.a(2,val!==undefined?val:defaultValue);}},_callee78,this);}));function get(_x56,_x57){return _get4.apply(this,arguments);}return get;}()},{key:"getMultiple",value:function(){var _getMultiple=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee79(properties){var values,name,val;return _regenerator().w(function(_context80){while(1)switch(_context80.n){case 0:_context80.n=1;return this._initializedPromise;case 1:values=Object.create(null);for(name in properties){val=this.file[name];values[name]=val!==undefined?val:properties[name];}return _context80.a(2,values);}},_callee79,this);}));function getMultiple(_x58){return _getMultiple.apply(this,arguments);}return getMultiple;}()}]);}();;// ./web/app.js
var FORCE_PAGES_LOADED_TIMEOUT=10000;var ViewOnLoad={UNKNOWN:-1,PREVIOUS:0,INITIAL:1};var _PDFViewerApplication={initialBookmark:document.location.hash.substring(1),_initializedCapability:_objectSpread(_objectSpread({},Promise.withResolvers()),{},{settled:false}),appConfig:null,pdfDocument:null,pdfLoadingTask:null,printService:null,pdfViewer:null,pdfThumbnailViewer:null,pdfRenderingQueue:null,pdfPresentationMode:null,pdfDocumentProperties:null,pdfLinkService:null,pdfHistory:null,pdfSidebar:null,pdfOutlineViewer:null,pdfAttachmentViewer:null,pdfLayerViewer:null,pdfCursorTools:null,pdfScriptingManager:null,store:null,downloadManager:null,overlayManager:null,preferences:new Preferences(),toolbar:null,secondaryToolbar:null,eventBus:null,l10n:null,annotationEditorParams:null,imageAltTextSettings:null,isInitialViewSet:false,isViewerEmbedded:window.parent!==window,url:"",baseUrl:"",mlManager:null,_downloadUrl:"",_eventBusAbortController:null,_windowAbortController:null,_globalAbortController:new AbortController(),documentInfo:null,metadata:null,_contentDispositionFilename:null,_contentLength:null,_saveInProgress:false,_wheelUnusedTicks:0,_wheelUnusedFactor:1,_touchManager:null,_touchUnusedTicks:0,_touchUnusedFactor:1,_PDFBug:null,_hasAnnotationEditors:false,_title:document.title,_printAnnotationStoragePromise:null,_isCtrlKeyDown:false,_caretBrowsing:null,_isScrolling:false,editorUndoBar:null,initialize:function initialize(appConfig){var _this69=this;return _asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee80(){var mode,_t31,_t32;return _regenerator().w(function(_context81){while(1)switch(_context81.n){case 0:_this69.appConfig=appConfig;_context81.p=1;_context81.n=2;return _this69.preferences.initializedPromise;case 2:_context81.n=4;break;case 3:_context81.p=3;_t31=_context81.v;console.error("initialize:",_t31);case 4:if(!AppOptions.get("pdfBugEnabled")){_context81.n=5;break;}_context81.n=5;return _this69._parseHashParams();case 5:_t32=AppOptions.get("viewerCssTheme");_context81.n=_t32===1?6:_t32===2?7:8;break;case 6:mode="is-light";return _context81.a(3,8);case 7:mode="is-dark";return _context81.a(3,8);case 8:if(mode){document.documentElement.classList.add(mode);}_context81.n=9;return _this69.externalServices.createL10n();case 9:_this69.l10n=_context81.v;document.getElementsByTagName("html")[0].dir=_this69.l10n.getDirection();_this69.l10n.translate(appConfig.appContainer||document.documentElement);if(_this69.isViewerEmbedded&&AppOptions.get("externalLinkTarget")===LinkTarget.NONE){AppOptions.set("externalLinkTarget",LinkTarget.TOP);}_context81.n=10;return _this69._initializeViewerComponents();case 10:_this69.bindEvents();_this69.bindWindowEvents();_this69._initializedCapability.settled=true;_this69._initializedCapability.resolve();case 11:return _context81.a(2);}},_callee80,null,[[1,3]]);}))();},_parseHashParams:function _parseHashParams(){var _this70=this;return _asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee82(){var hash,_this70$appConfig,mainContainer,viewerContainer,params,loadPDFBug,enabled,opts,name,check,key,_t33,_t34,_t35,_t36;return _regenerator().w(function(_context83){while(1)switch(_context83.n){case 0:hash=document.location.hash.substring(1);if(hash){_context83.n=1;break;}return _context83.a(2);case 1:_this70$appConfig=_this70.appConfig,mainContainer=_this70$appConfig.mainContainer,viewerContainer=_this70$appConfig.viewerContainer,params=parseQueryString(hash);loadPDFBug=/*#__PURE__*/function(){var _ref92=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee81(){var _yield$import,PDFBug;return _regenerator().w(function(_context82){while(1)switch(_context82.n){case 0:if(!_this70._PDFBug){_context82.n=1;break;}return _context82.a(2);case 1:_context82.n=2;return import(/*webpackIgnore: true*//*@vite-ignore*/AppOptions.get("debuggerSrc"));case 2:_yield$import=_context82.v;PDFBug=_yield$import.PDFBug;_this70._PDFBug=PDFBug;case 3:return _context82.a(2);}},_callee81);}));return function loadPDFBug(){return _ref92.apply(this,arguments);};}();if(!(params.get("disableworker")==="true")){_context83.n=5;break;}_context83.p=2;GlobalWorkerOptions.workerSrc||(GlobalWorkerOptions.workerSrc=AppOptions.get("workerSrc"));_context83.n=3;return import(/*webpackIgnore: true*//*@vite-ignore*/PDFWorker.workerSrc);case 3:_context83.n=5;break;case 4:_context83.p=4;_t33=_context83.v;console.error("_parseHashParams:",_t33);case 5:if(!params.has("textlayer")){_context83.n=12;break;}_t34=params.get("textlayer");_context83.n=_t34==="off"?6:_t34==="visible"?7:_t34==="shadow"?7:_t34==="hover"?7:12;break;case 6:AppOptions.set("textLayerMode",TextLayerMode.DISABLE);return _context83.a(3,12);case 7:viewerContainer.classList.add("textLayer-".concat(params.get("textlayer")));_context83.p=8;_context83.n=9;return loadPDFBug();case 9:_this70._PDFBug.loadCSS();_context83.n=11;break;case 10:_context83.p=10;_t35=_context83.v;console.error("_parseHashParams:",_t35);case 11:return _context83.a(3,12);case 12:if(!params.has("pdfbug")){_context83.n=16;break;}AppOptions.setAll({pdfBug:true,fontExtraProperties:true});enabled=params.get("pdfbug").split(",");_context83.p=13;_context83.n=14;return loadPDFBug();case 14:_this70._PDFBug.init(mainContainer,enabled);_context83.n=16;break;case 15:_context83.p=15;_t36=_context83.v;console.error("_parseHashParams:",_t36);case 16:if(params.has("locale")){AppOptions.set("localeProperties",{lang:params.get("locale")});}opts={disableAutoFetch:function disableAutoFetch(x){return x==="true";},disableFontFace:function disableFontFace(x){return x==="true";},disableHistory:function disableHistory(x){return x==="true";},disableRange:function disableRange(x){return x==="true";},disableStream:function disableStream(x){return x==="true";},verbosity:function verbosity(x){return x|0;}};for(name in opts){check=opts[name],key=name.toLowerCase();if(params.has(key)){AppOptions.set(name,check(params.get(key)));}}case 17:return _context83.a(2);}},_callee82,null,[[13,15],[8,10],[2,4]]);}))();},_initializeViewerComponents:function _initializeViewerComponents(){var _this71=this;return _asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee83(){var _appConfig$annotation,_appConfig$sidebar,_appConfig$secondaryT,_appConfig$secondaryT2,_appConfig$secondaryT5,_appConfig$sidebar2,_appConfig$sidebar3,_appConfig$sidebar4;var appConfig,externalServices,l10n,mlManager,abortSignal,eventBus,overlayManager,renderingQueue,linkService,downloadManager,findController,pdfScriptingManager,container,viewer,annotationEditorMode,pageColors,altTextManager,signatureManager,enableHWA,maxCanvasPixels,maxCanvasDim,pdfViewer,_appConfig$toolbar,editorSignatureButton,_i9,_arr2,_document$getElementB2,id,_appConfig$secondaryT3,_appConfig$secondaryT4;return _regenerator().w(function(_context84){while(1)switch(_context84.n){case 0:appConfig=_this71.appConfig,externalServices=_this71.externalServices,l10n=_this71.l10n,mlManager=_this71.mlManager;abortSignal=_this71._globalAbortController.signal;eventBus=new EventBus();_this71.eventBus=AppOptions.eventBus=eventBus;mlManager===null||mlManager===void 0||mlManager.setEventBus(eventBus,abortSignal);overlayManager=_this71.overlayManager=new OverlayManager();renderingQueue=_this71.pdfRenderingQueue=new PDFRenderingQueue();renderingQueue.onIdle=_this71._cleanup.bind(_this71);linkService=_this71.pdfLinkService=new PDFLinkService({eventBus:eventBus,externalLinkTarget:AppOptions.get("externalLinkTarget"),externalLinkRel:AppOptions.get("externalLinkRel"),ignoreDestinationZoom:AppOptions.get("ignoreDestinationZoom")});downloadManager=_this71.downloadManager=new DownloadManager();findController=_this71.findController=new PDFFindController({linkService:linkService,eventBus:eventBus,updateMatchesCountOnProgress:true});pdfScriptingManager=_this71.pdfScriptingManager=new PDFScriptingManager({eventBus:eventBus,externalServices:externalServices,docProperties:_this71._scriptingDocProperties.bind(_this71)});container=appConfig.mainContainer,viewer=appConfig.viewerContainer;annotationEditorMode=AppOptions.get("annotationEditorMode");pageColors=AppOptions.get("forcePageColors")||window.matchMedia("(forced-colors: active)").matches?{background:AppOptions.get("pageColorsBackground"),foreground:AppOptions.get("pageColorsForeground")}:null;if(AppOptions.get("enableUpdatedAddImage")){altTextManager=appConfig.newAltTextDialog?new NewAltTextManager(appConfig.newAltTextDialog,overlayManager,eventBus):null;}else{altTextManager=appConfig.altTextDialog?new AltTextManager(appConfig.altTextDialog,container,overlayManager,eventBus):null;}if(appConfig.editorUndoBar){_this71.editorUndoBar=new EditorUndoBar(appConfig.editorUndoBar,eventBus);}signatureManager=AppOptions.get("enableSignatureEditor")&&appConfig.addSignatureDialog?new SignatureManager(appConfig.addSignatureDialog,appConfig.editSignatureDialog,((_appConfig$annotation=appConfig.annotationEditorParams)===null||_appConfig$annotation===void 0?void 0:_appConfig$annotation.editorSignatureAddSignature)||null,overlayManager,l10n,externalServices.createSignatureStorage(eventBus,abortSignal),eventBus):null;enableHWA=AppOptions.get("enableHWA"),maxCanvasPixels=AppOptions.get("maxCanvasPixels"),maxCanvasDim=AppOptions.get("maxCanvasDim");pdfViewer=_this71.pdfViewer=new PDFViewer({container:container,viewer:viewer,eventBus:eventBus,renderingQueue:renderingQueue,linkService:linkService,downloadManager:downloadManager,altTextManager:altTextManager,signatureManager:signatureManager,editorUndoBar:_this71.editorUndoBar,findController:findController,scriptingManager:AppOptions.get("enableScripting")&&pdfScriptingManager,l10n:l10n,textLayerMode:AppOptions.get("textLayerMode"),annotationMode:AppOptions.get("annotationMode"),annotationEditorMode:annotationEditorMode,annotationEditorHighlightColors:AppOptions.get("highlightEditorColors"),enableHighlightFloatingButton:AppOptions.get("enableHighlightFloatingButton"),enableUpdatedAddImage:AppOptions.get("enableUpdatedAddImage"),enableNewAltTextWhenAddingImage:AppOptions.get("enableNewAltTextWhenAddingImage"),imageResourcesPath:AppOptions.get("imageResourcesPath"),enablePrintAutoRotate:AppOptions.get("enablePrintAutoRotate"),maxCanvasPixels:maxCanvasPixels,maxCanvasDim:maxCanvasDim,enableDetailCanvas:AppOptions.get("enableDetailCanvas"),enablePermissions:AppOptions.get("enablePermissions"),pageColors:pageColors,mlManager:mlManager,abortSignal:abortSignal,enableHWA:enableHWA,supportsPinchToZoom:_this71.supportsPinchToZoom,enableAutoLinking:AppOptions.get("enableAutoLinking")});renderingQueue.setViewer(pdfViewer);linkService.setViewer(pdfViewer);pdfScriptingManager.setViewer(pdfViewer);if((_appConfig$sidebar=appConfig.sidebar)!==null&&_appConfig$sidebar!==void 0&&_appConfig$sidebar.thumbnailView){_this71.pdfThumbnailViewer=new PDFThumbnailViewer({container:appConfig.sidebar.thumbnailView,eventBus:eventBus,renderingQueue:renderingQueue,linkService:linkService,maxCanvasPixels:maxCanvasPixels,maxCanvasDim:maxCanvasDim,pageColors:pageColors,abortSignal:abortSignal,enableHWA:enableHWA});renderingQueue.setThumbnailViewer(_this71.pdfThumbnailViewer);}if(!_this71.isViewerEmbedded&&!AppOptions.get("disableHistory")){_this71.pdfHistory=new PDFHistory({linkService:linkService,eventBus:eventBus});linkService.setHistory(_this71.pdfHistory);}if(!_this71.supportsIntegratedFind&&appConfig.findBar){_this71.findBar=new PDFFindBar(appConfig.findBar,appConfig.principalContainer,eventBus);}if(appConfig.annotationEditorParams){if(annotationEditorMode!==AnnotationEditorType.DISABLE){editorSignatureButton=(_appConfig$toolbar=appConfig.toolbar)===null||_appConfig$toolbar===void 0?void 0:_appConfig$toolbar.editorSignatureButton;if(editorSignatureButton&&AppOptions.get("enableSignatureEditor")){editorSignatureButton.parentElement.hidden=false;}_this71.annotationEditorParams=new AnnotationEditorParams(appConfig.annotationEditorParams,eventBus);}else{for(_i9=0,_arr2=["editorModeButtons","editorModeSeparator"];_i9<_arr2.length;_i9++){id=_arr2[_i9];(_document$getElementB2=document.getElementById(id))===null||_document$getElementB2===void 0||_document$getElementB2.classList.add("hidden");}}}if(mlManager&&(_appConfig$secondaryT=appConfig.secondaryToolbar)!==null&&_appConfig$secondaryT!==void 0&&_appConfig$secondaryT.imageAltTextSettingsButton){_this71.imageAltTextSettings=new ImageAltTextSettings(appConfig.altTextSettingsDialog,overlayManager,eventBus,mlManager);}if(appConfig.documentProperties){_this71.pdfDocumentProperties=new PDFDocumentProperties(appConfig.documentProperties,overlayManager,eventBus,l10n,function(){return _this71._docFilename;});}if((_appConfig$secondaryT2=appConfig.secondaryToolbar)!==null&&_appConfig$secondaryT2!==void 0&&_appConfig$secondaryT2.cursorHandToolButton){_this71.pdfCursorTools=new PDFCursorTools({container:container,eventBus:eventBus,cursorToolOnLoad:AppOptions.get("cursorToolOnLoad")});}if(appConfig.toolbar){_this71.toolbar=new Toolbar(appConfig.toolbar,eventBus,AppOptions.get("toolbarDensity"));}if(appConfig.secondaryToolbar){if(AppOptions.get("enableAltText")){(_appConfig$secondaryT3=appConfig.secondaryToolbar.imageAltTextSettingsButton)===null||_appConfig$secondaryT3===void 0||_appConfig$secondaryT3.classList.remove("hidden");(_appConfig$secondaryT4=appConfig.secondaryToolbar.imageAltTextSettingsSeparator)===null||_appConfig$secondaryT4===void 0||_appConfig$secondaryT4.classList.remove("hidden");}_this71.secondaryToolbar=new SecondaryToolbar(appConfig.secondaryToolbar,eventBus);}if(_this71.supportsFullscreen&&(_appConfig$secondaryT5=appConfig.secondaryToolbar)!==null&&_appConfig$secondaryT5!==void 0&&_appConfig$secondaryT5.presentationModeButton){_this71.pdfPresentationMode=new PDFPresentationMode({container:container,pdfViewer:pdfViewer,eventBus:eventBus});}if(appConfig.passwordOverlay){_this71.passwordPrompt=new PasswordPrompt(appConfig.passwordOverlay,overlayManager,_this71.isViewerEmbedded);}if((_appConfig$sidebar2=appConfig.sidebar)!==null&&_appConfig$sidebar2!==void 0&&_appConfig$sidebar2.outlineView){_this71.pdfOutlineViewer=new PDFOutlineViewer({container:appConfig.sidebar.outlineView,eventBus:eventBus,l10n:l10n,linkService:linkService,downloadManager:downloadManager});}if((_appConfig$sidebar3=appConfig.sidebar)!==null&&_appConfig$sidebar3!==void 0&&_appConfig$sidebar3.attachmentsView){_this71.pdfAttachmentViewer=new PDFAttachmentViewer({container:appConfig.sidebar.attachmentsView,eventBus:eventBus,l10n:l10n,downloadManager:downloadManager});}if((_appConfig$sidebar4=appConfig.sidebar)!==null&&_appConfig$sidebar4!==void 0&&_appConfig$sidebar4.layersView){_this71.pdfLayerViewer=new PDFLayerViewer({container:appConfig.sidebar.layersView,eventBus:eventBus,l10n:l10n});}if(appConfig.sidebar){_this71.pdfSidebar=new PDFSidebar({elements:appConfig.sidebar,eventBus:eventBus,l10n:l10n});_this71.pdfSidebar.onToggled=_this71.forceRendering.bind(_this71);_this71.pdfSidebar.onUpdateThumbnails=function(){var _iterator48=_createForOfIteratorHelper(pdfViewer.getCachedPageViews()),_step48;try{for(_iterator48.s();!(_step48=_iterator48.n()).done;){var pageView=_step48.value;if(pageView.renderingState===RenderingStates.FINISHED){var _this71$pdfThumbnailV;(_this71$pdfThumbnailV=_this71.pdfThumbnailViewer.getThumbnail(pageView.id-1))===null||_this71$pdfThumbnailV===void 0||_this71$pdfThumbnailV.setImage(pageView);}}}catch(err){_iterator48.e(err);}finally{_iterator48.f();}_this71.pdfThumbnailViewer.scrollThumbnailIntoView(pdfViewer.currentPageNumber);};}case 1:return _context84.a(2);}},_callee83);}))();},run:function run(config){var _this72=this;return _asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee84(){var _params$get;var appConfig,eventBus,file,queryString,params,fileInput,_appConfig$toolbar2,_appConfig$secondaryT6,_appConfig$secondaryT7,_appConfig$findBar;return _regenerator().w(function(_context85){while(1)switch(_context85.n){case 0:_context85.n=1;return _this72.initialize(config);case 1:appConfig=_this72.appConfig,eventBus=_this72.eventBus;queryString=document.location.search.substring(1);params=parseQueryString(queryString);file=(_params$get=params.get("file"))!==null&&_params$get!==void 0?_params$get:AppOptions.get("defaultUrl");validateFileURL(file);fileInput=_this72._openFileInput=document.createElement("input");fileInput.id="fileInput";fileInput.hidden=true;fileInput.type="file";fileInput.value=null;document.body.append(fileInput);fileInput.addEventListener("change",function(evt){var files=evt.target.files;if(!files||files.length===0){return;}eventBus.dispatch("fileinputchange",{source:this,fileInput:evt.target});});appConfig.mainContainer.addEventListener("dragover",function(evt){var _iterator49=_createForOfIteratorHelper(evt.dataTransfer.items),_step49;try{for(_iterator49.s();!(_step49=_iterator49.n()).done;){var item=_step49.value;if(item.type==="application/pdf"){evt.dataTransfer.dropEffect=evt.dataTransfer.effectAllowed==="copy"?"copy":"move";stopEvent(evt);return;}}}catch(err){_iterator49.e(err);}finally{_iterator49.f();}});appConfig.mainContainer.addEventListener("drop",function(evt){var _evt$dataTransfer$fil;if(((_evt$dataTransfer$fil=evt.dataTransfer.files)===null||_evt$dataTransfer$fil===void 0?void 0:_evt$dataTransfer$fil[0].type)!=="application/pdf"){return;}stopEvent(evt);eventBus.dispatch("fileinputchange",{source:this,fileInput:evt.dataTransfer});});if(!AppOptions.get("supportsDocumentFonts")){AppOptions.set("disableFontFace",true);_this72.l10n.get("pdfjs-web-fonts-disabled").then(function(msg){console.warn(msg);});}if(!_this72.supportsPrinting){(_appConfig$toolbar2=appConfig.toolbar)===null||_appConfig$toolbar2===void 0||(_appConfig$toolbar2=_appConfig$toolbar2.print)===null||_appConfig$toolbar2===void 0||_appConfig$toolbar2.classList.add("hidden");(_appConfig$secondaryT6=appConfig.secondaryToolbar)===null||_appConfig$secondaryT6===void 0||_appConfig$secondaryT6.printButton.classList.add("hidden");}if(!_this72.supportsFullscreen){(_appConfig$secondaryT7=appConfig.secondaryToolbar)===null||_appConfig$secondaryT7===void 0||_appConfig$secondaryT7.presentationModeButton.classList.add("hidden");}if(_this72.supportsIntegratedFind){(_appConfig$findBar=appConfig.findBar)===null||_appConfig$findBar===void 0||(_appConfig$findBar=_appConfig$findBar.toggleButton)===null||_appConfig$findBar===void 0||_appConfig$findBar.classList.add("hidden");}if(file){_this72.open({url:file});}else{_this72._hideViewBookmark();}case 2:return _context85.a(2);}},_callee84);}))();},get externalServices(){return shadow(this,"externalServices",new ExternalServices());},get initialized(){return this._initializedCapability.settled;},get initializedPromise(){return this._initializedCapability.promise;},updateZoom:function updateZoom(steps,scaleFactor,origin){if(this.pdfViewer.isInPresentationMode){return;}this.pdfViewer.updateScale({drawingDelay:AppOptions.get("defaultZoomDelay"),steps:steps,scaleFactor:scaleFactor,origin:origin});},zoomIn:function zoomIn(){this.updateZoom(1);},zoomOut:function zoomOut(){this.updateZoom(-1);},zoomReset:function zoomReset(){if(this.pdfViewer.isInPresentationMode){return;}this.pdfViewer.currentScaleValue=DEFAULT_SCALE_VALUE;},touchPinchCallback:function touchPinchCallback(origin,prevDistance,distance){if(this.supportsPinchToZoom){var newScaleFactor=this._accumulateFactor(this.pdfViewer.currentScale,distance/prevDistance,"_touchUnusedFactor");this.updateZoom(null,newScaleFactor,origin);}else{var PIXELS_PER_LINE_SCALE=30;var ticks=this._accumulateTicks((distance-prevDistance)/PIXELS_PER_LINE_SCALE,"_touchUnusedTicks");this.updateZoom(ticks,null,origin);}},touchPinchEndCallback:function touchPinchEndCallback(){this._touchUnusedTicks=0;this._touchUnusedFactor=1;},get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0;},get page(){return this.pdfViewer.currentPageNumber;},set page(val){this.pdfViewer.currentPageNumber=val;},get supportsPrinting(){return PDFPrintServiceFactory.supportsPrinting;},get supportsFullscreen(){return shadow(this,"supportsFullscreen",document.fullscreenEnabled);},get supportsPinchToZoom(){return shadow(this,"supportsPinchToZoom",AppOptions.get("supportsPinchToZoom"));},get supportsIntegratedFind(){return shadow(this,"supportsIntegratedFind",AppOptions.get("supportsIntegratedFind"));},get loadingBar(){var barElement=document.getElementById("loadingBar");var bar=barElement?new ProgressBar(barElement):null;return shadow(this,"loadingBar",bar);},get supportsMouseWheelZoomCtrlKey(){return shadow(this,"supportsMouseWheelZoomCtrlKey",AppOptions.get("supportsMouseWheelZoomCtrlKey"));},get supportsMouseWheelZoomMetaKey(){return shadow(this,"supportsMouseWheelZoomMetaKey",AppOptions.get("supportsMouseWheelZoomMetaKey"));},get supportsCaretBrowsingMode(){return AppOptions.get("supportsCaretBrowsingMode");},moveCaret:function moveCaret(isUp,select){var _this$appConfig$toolb;this._caretBrowsing||(this._caretBrowsing=new CaretBrowsingMode(this._globalAbortController.signal,this.appConfig.mainContainer,this.appConfig.viewerContainer,(_this$appConfig$toolb=this.appConfig.toolbar)===null||_this$appConfig$toolb===void 0?void 0:_this$appConfig$toolb.container));this._caretBrowsing.moveCaret(isUp,select);},setTitleUsingUrl:function setTitleUsingUrl(){var url=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";var downloadUrl=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;this.url=url;this.baseUrl=url.split("#",1)[0];if(downloadUrl){this._downloadUrl=downloadUrl===url?this.baseUrl:downloadUrl.split("#",1)[0];}if(isDataScheme(url)){this._hideViewBookmark();}var title=pdfjs_getPdfFilenameFromUrl(url,"");if(!title){try{title=decodeURIComponent(getFilenameFromUrl(url));}catch(_unused6){}}this.setTitle(title||url);},setTitle:function setTitle(){var title=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this._title;this._title=title;if(this.isViewerEmbedded){return;}var editorIndicator=this._hasAnnotationEditors&&!this.pdfRenderingQueue.printing;document.title="".concat(editorIndicator?"* ":"").concat(title);},get _docFilename(){return this._contentDispositionFilename||pdfjs_getPdfFilenameFromUrl(this.url);},_hideViewBookmark:function _hideViewBookmark(){var secondaryToolbar=this.appConfig.secondaryToolbar;secondaryToolbar===null||secondaryToolbar===void 0||secondaryToolbar.viewBookmarkButton.classList.add("hidden");if(secondaryToolbar!==null&&secondaryToolbar!==void 0&&secondaryToolbar.presentationModeButton.classList.contains("hidden")){var _document$getElementB3;(_document$getElementB3=document.getElementById("viewBookmarkSeparator"))===null||_document$getElementB3===void 0||_document$getElementB3.classList.add("hidden");}},close:function close(){var _this73=this;return _asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee85(){var _this73$pdfDocument,_this73$pdfSidebar,_this73$pdfOutlineVie,_this73$pdfAttachment,_this73$pdfLayerViewe,_this73$pdfHistory,_this73$findBar,_this73$toolbar,_this73$secondaryTool,_this73$_PDFBug;var promises,_this73$pdfThumbnailV,_this73$pdfDocumentPr,_t37;return _regenerator().w(function(_context86){while(1)switch(_context86.n){case 0:_this73._unblockDocumentLoadEvent();_this73._hideViewBookmark();if(_this73.pdfLoadingTask){_context86.n=1;break;}return _context86.a(2);case 1:if(!(((_this73$pdfDocument=_this73.pdfDocument)===null||_this73$pdfDocument===void 0?void 0:_this73$pdfDocument.annotationStorage.size)>0&&_this73._annotationStorageModified)){_context86.n=5;break;}_context86.p=2;_context86.n=3;return _this73.save();case 3:_context86.n=5;break;case 4:_context86.p=4;_t37=_context86.v;case 5:promises=[];promises.push(_this73.pdfLoadingTask.destroy());_this73.pdfLoadingTask=null;if(_this73.pdfDocument){_this73.pdfDocument=null;(_this73$pdfThumbnailV=_this73.pdfThumbnailViewer)===null||_this73$pdfThumbnailV===void 0||_this73$pdfThumbnailV.setDocument(null);_this73.pdfViewer.setDocument(null);_this73.pdfLinkService.setDocument(null);(_this73$pdfDocumentPr=_this73.pdfDocumentProperties)===null||_this73$pdfDocumentPr===void 0||_this73$pdfDocumentPr.setDocument(null);}_this73.pdfLinkService.externalLinkEnabled=true;_this73.store=null;_this73.isInitialViewSet=false;_this73.url="";_this73.baseUrl="";_this73._downloadUrl="";_this73.documentInfo=null;_this73.metadata=null;_this73._contentDispositionFilename=null;_this73._contentLength=null;_this73._saveInProgress=false;_this73._hasAnnotationEditors=false;promises.push(_this73.pdfScriptingManager.destroyPromise,_this73.passwordPrompt.close());_this73.setTitle();(_this73$pdfSidebar=_this73.pdfSidebar)===null||_this73$pdfSidebar===void 0||_this73$pdfSidebar.reset();(_this73$pdfOutlineVie=_this73.pdfOutlineViewer)===null||_this73$pdfOutlineVie===void 0||_this73$pdfOutlineVie.reset();(_this73$pdfAttachment=_this73.pdfAttachmentViewer)===null||_this73$pdfAttachment===void 0||_this73$pdfAttachment.reset();(_this73$pdfLayerViewe=_this73.pdfLayerViewer)===null||_this73$pdfLayerViewe===void 0||_this73$pdfLayerViewe.reset();(_this73$pdfHistory=_this73.pdfHistory)===null||_this73$pdfHistory===void 0||_this73$pdfHistory.reset();(_this73$findBar=_this73.findBar)===null||_this73$findBar===void 0||_this73$findBar.reset();(_this73$toolbar=_this73.toolbar)===null||_this73$toolbar===void 0||_this73$toolbar.reset();(_this73$secondaryTool=_this73.secondaryToolbar)===null||_this73$secondaryTool===void 0||_this73$secondaryTool.reset();(_this73$_PDFBug=_this73._PDFBug)===null||_this73$_PDFBug===void 0||_this73$_PDFBug.cleanup();_context86.n=6;return Promise.all(promises);case 6:return _context86.a(2);}},_callee85,null,[[2,4]]);}))();},open:function open(args){var _this74=this;return _asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee86(){var workerParams,apiParams,loadingTask;return _regenerator().w(function(_context87){while(1)switch(_context87.n){case 0:if(!_this74.pdfLoadingTask){_context87.n=1;break;}_context87.n=1;return _this74.close();case 1:workerParams=AppOptions.getAll(OptionKind.WORKER);Object.assign(GlobalWorkerOptions,workerParams);if(args.url){_this74.setTitleUsingUrl(args.originalUrl||args.url,args.url);}apiParams=AppOptions.getAll(OptionKind.API);loadingTask=getDocument(_objectSpread(_objectSpread({},apiParams),args));_this74.pdfLoadingTask=loadingTask;loadingTask.onPassword=function(updateCallback,reason){if(_this74.isViewerEmbedded){_this74._unblockDocumentLoadEvent();}_this74.pdfLinkService.externalLinkEnabled=false;_this74.passwordPrompt.setUpdateCallback(updateCallback,reason);_this74.passwordPrompt.open();};loadingTask.onProgress=function(_ref93){var loaded=_ref93.loaded,total=_ref93.total;_this74.progress(loaded/total);};return _context87.a(2,loadingTask.promise.then(function(pdfDocument){_this74.load(pdfDocument);},function(reason){if(loadingTask!==_this74.pdfLoadingTask){return undefined;}var key="pdfjs-loading-error";if(reason instanceof InvalidPDFException){key="pdfjs-invalid-file-error";}else if(reason instanceof ResponseException){key=reason.missing?"pdfjs-missing-file-error":"pdfjs-unexpected-response-error";}return _this74._documentError(key,{message:reason.message}).then(function(){throw reason;});}));}},_callee86);}))();},download:function download(){var _this75=this;return _asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee87(){var data,_t38;return _regenerator().w(function(_context88){while(1)switch(_context88.n){case 0:_context88.p=0;_context88.n=1;return _this75.pdfDocument?_this75.pdfDocument.getData():_this75.pdfLoadingTask.getData();case 1:data=_context88.v;_context88.n=3;break;case 2:_context88.p=2;_t38=_context88.v;case 3:_this75.downloadManager.download(data,_this75._downloadUrl,_this75._docFilename);case 4:return _context88.a(2);}},_callee87,null,[[0,2]]);}))();},save:function save(){var _this76=this;return _asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee88(){var data,_this76$pdfDocument,_t39;return _regenerator().w(function(_context89){while(1)switch(_context89.n){case 0:if(!_this76._saveInProgress){_context89.n=1;break;}return _context89.a(2);case 1:_this76._saveInProgress=true;_context89.n=2;return _this76.pdfScriptingManager.dispatchWillSave();case 2:_context89.p=2;_context89.n=3;return _this76.pdfDocument.saveDocument();case 3:data=_context89.v;_this76.downloadManager.download(data,_this76._downloadUrl,_this76._docFilename);_context89.n=5;break;case 4:_context89.p=4;_t39=_context89.v;console.error("Error when saving the document:",_t39);_context89.n=5;return _this76.download();case 5:_context89.p=5;_context89.n=6;return _this76.pdfScriptingManager.dispatchDidSave();case 6:_this76._saveInProgress=false;return _context89.f(5);case 7:if(_this76._hasAnnotationEditors){_this76.externalServices.reportTelemetry({type:"editing",data:{type:"save",stats:(_this76$pdfDocument=_this76.pdfDocument)===null||_this76$pdfDocument===void 0?void 0:_this76$pdfDocument.annotationStorage.editorStats}});}case 8:return _context89.a(2);}},_callee88,null,[[2,4,5,7]]);}))();},downloadOrSave:function downloadOrSave(){var _this77=this;return _asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee89(){var _this77$pdfDocument;var classList;return _regenerator().w(function(_context90){while(1)switch(_context90.n){case 0:classList=_this77.appConfig.appContainer.classList;classList.add("wait");_context90.n=1;return((_this77$pdfDocument=_this77.pdfDocument)===null||_this77$pdfDocument===void 0?void 0:_this77$pdfDocument.annotationStorage.size)>0?_this77.save():_this77.download();case 1:classList.remove("wait");case 2:return _context90.a(2);}},_callee89);}))();},_documentError:function _documentError(key){var _arguments=arguments,_this78=this;return _asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee90(){var _moreInfo$message;var moreInfo,message;return _regenerator().w(function(_context91){while(1)switch(_context91.n){case 0:moreInfo=_arguments.length>1&&_arguments[1]!==undefined?_arguments[1]:null;_this78._unblockDocumentLoadEvent();_context91.n=1;return _this78._otherError(key||"pdfjs-loading-error",moreInfo);case 1:message=_context91.v;_this78.eventBus.dispatch("documenterror",{source:_this78,message:message,reason:(_moreInfo$message=moreInfo===null||moreInfo===void 0?void 0:moreInfo.message)!==null&&_moreInfo$message!==void 0?_moreInfo$message:null});case 2:return _context91.a(2);}},_callee90);}))();},_otherError:function _otherError(key){var _arguments2=arguments,_this79=this;return _asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee91(){var moreInfo,message,moreInfoText;return _regenerator().w(function(_context92){while(1)switch(_context92.n){case 0:moreInfo=_arguments2.length>1&&_arguments2[1]!==undefined?_arguments2[1]:null;_context92.n=1;return _this79.l10n.get(key);case 1:message=_context92.v;moreInfoText=["PDF.js v".concat(version||"?"," (build: ").concat(build||"?",")")];if(moreInfo){moreInfoText.push("Message: ".concat(moreInfo.message));if(moreInfo.stack){moreInfoText.push("Stack: ".concat(moreInfo.stack));}else{if(moreInfo.filename){moreInfoText.push("File: ".concat(moreInfo.filename));}if(moreInfo.lineNumber){moreInfoText.push("Line: ".concat(moreInfo.lineNumber));}}}console.error("".concat(message,"\n\n").concat(moreInfoText.join("\n")));return _context92.a(2,message);}},_callee91);}))();},progress:function progress(level){var _this$pdfDocument$loa,_this$pdfDocument;var percent=Math.round(level*100);if(!this.loadingBar||percent<=this.loadingBar.percent){return;}this.loadingBar.percent=percent;if((_this$pdfDocument$loa=(_this$pdfDocument=this.pdfDocument)===null||_this$pdfDocument===void 0?void 0:_this$pdfDocument.loadingParams.disableAutoFetch)!==null&&_this$pdfDocument$loa!==void 0?_this$pdfDocument$loa:AppOptions.get("disableAutoFetch")){this.loadingBar.setDisableAutoFetch();}},load:function load(pdfDocument){var _this80=this,_this$toolbar,_this$secondaryToolba,_this$pdfDocumentProp,_this$pdfThumbnailVie2;this.pdfDocument=pdfDocument;pdfDocument.getDownloadInfo().then(function(_ref94){var _this80$loadingBar;var length=_ref94.length;_this80._contentLength=length;(_this80$loadingBar=_this80.loadingBar)===null||_this80$loadingBar===void 0||_this80$loadingBar.hide();firstPagePromise.then(function(){_this80.eventBus.dispatch("documentloaded",{source:_this80});});});var pageLayoutPromise=pdfDocument.getPageLayout()["catch"](function(){});var pageModePromise=pdfDocument.getPageMode()["catch"](function(){});var openActionPromise=pdfDocument.getOpenAction()["catch"](function(){});(_this$toolbar=this.toolbar)===null||_this$toolbar===void 0||_this$toolbar.setPagesCount(pdfDocument.numPages,false);(_this$secondaryToolba=this.secondaryToolbar)===null||_this$secondaryToolba===void 0||_this$secondaryToolba.setPagesCount(pdfDocument.numPages);this.pdfLinkService.setDocument(pdfDocument);(_this$pdfDocumentProp=this.pdfDocumentProperties)===null||_this$pdfDocumentProp===void 0||_this$pdfDocumentProp.setDocument(pdfDocument);var pdfViewer=this.pdfViewer;pdfViewer.setDocument(pdfDocument);var firstPagePromise=pdfViewer.firstPagePromise,onePageRendered=pdfViewer.onePageRendered,pagesPromise=pdfViewer.pagesPromise;(_this$pdfThumbnailVie2=this.pdfThumbnailViewer)===null||_this$pdfThumbnailVie2===void 0||_this$pdfThumbnailVie2.setDocument(pdfDocument);var storedPromise=(this.store=new ViewHistory(pdfDocument.fingerprints[0])).getMultiple({page:null,zoom:DEFAULT_SCALE_VALUE,scrollLeft:"0",scrollTop:"0",rotation:null,sidebarView:SidebarView.UNKNOWN,scrollMode:ScrollMode.UNKNOWN,spreadMode:SpreadMode.UNKNOWN})["catch"](function(){});firstPagePromise.then(function(pdfPage){var _this80$loadingBar2;(_this80$loadingBar2=_this80.loadingBar)===null||_this80$loadingBar2===void 0||_this80$loadingBar2.setWidth(_this80.appConfig.viewerContainer);_this80._initializeAnnotationStorageCallbacks(pdfDocument);Promise.all([animationStarted,storedPromise,pageLayoutPromise,pageModePromise,openActionPromise]).then(/*#__PURE__*/function(){var _ref96=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee92(_ref95){var _ref97,timeStamp,stored,pageLayout,pageMode,openAction,viewOnLoad,initialBookmark,zoom,hash,rotation,sidebarView,scrollMode,spreadMode,modes;return _regenerator().w(function(_context93){while(1)switch(_context93.n){case 0:_ref97=_slicedToArray(_ref95,5),timeStamp=_ref97[0],stored=_ref97[1],pageLayout=_ref97[2],pageMode=_ref97[3],openAction=_ref97[4];viewOnLoad=AppOptions.get("viewOnLoad");_this80._initializePdfHistory({fingerprint:pdfDocument.fingerprints[0],viewOnLoad:viewOnLoad,initialDest:openAction===null||openAction===void 0?void 0:openAction.dest});initialBookmark=_this80.initialBookmark;zoom=AppOptions.get("defaultZoomValue");hash=zoom?"zoom=".concat(zoom):null;rotation=null;sidebarView=AppOptions.get("sidebarViewOnLoad");scrollMode=AppOptions.get("scrollModeOnLoad");spreadMode=AppOptions.get("spreadModeOnLoad");if(stored!==null&&stored!==void 0&&stored.page&&viewOnLoad!==ViewOnLoad.INITIAL){hash="page=".concat(stored.page,"&zoom=").concat(zoom||stored.zoom,",")+"".concat(stored.scrollLeft,",").concat(stored.scrollTop);rotation=parseInt(stored.rotation,10);if(sidebarView===SidebarView.UNKNOWN){sidebarView=stored.sidebarView|0;}if(scrollMode===ScrollMode.UNKNOWN){scrollMode=stored.scrollMode|0;}if(spreadMode===SpreadMode.UNKNOWN){spreadMode=stored.spreadMode|0;}}if(pageMode&&sidebarView===SidebarView.UNKNOWN){sidebarView=apiPageModeToSidebarView(pageMode);}if(pageLayout&&scrollMode===ScrollMode.UNKNOWN&&spreadMode===SpreadMode.UNKNOWN){modes=apiPageLayoutToViewerModes(pageLayout);spreadMode=modes.spreadMode;}_this80.setInitialView(hash,{rotation:rotation,sidebarView:sidebarView,scrollMode:scrollMode,spreadMode:spreadMode});_this80.eventBus.dispatch("documentinit",{source:_this80});if(!_this80.isViewerEmbedded){pdfViewer.focus();}_context93.n=1;return Promise.race([pagesPromise,new Promise(function(resolve){setTimeout(resolve,FORCE_PAGES_LOADED_TIMEOUT);})]);case 1:if(!(!initialBookmark&&!hash)){_context93.n=2;break;}return _context93.a(2);case 2:if(!pdfViewer.hasEqualPageSizes){_context93.n=3;break;}return _context93.a(2);case 3:_this80.initialBookmark=initialBookmark;pdfViewer.currentScaleValue=pdfViewer.currentScaleValue;_this80.setInitialView(hash);case 4:return _context93.a(2);}},_callee92);}));return function(_x59){return _ref96.apply(this,arguments);};}())["catch"](function(){_this80.setInitialView();}).then(function(){pdfViewer.update();});});pagesPromise.then(function(){_this80._unblockDocumentLoadEvent();_this80._initializeAutoPrint(pdfDocument,openActionPromise);},function(reason){_this80._documentError("pdfjs-loading-error",{message:reason.message});});onePageRendered.then(function(data){_this80.externalServices.reportTelemetry({type:"pageInfo",timestamp:data.timestamp});if(_this80.pdfOutlineViewer){pdfDocument.getOutline().then(function(outline){if(pdfDocument!==_this80.pdfDocument){return;}_this80.pdfOutlineViewer.render({outline:outline,pdfDocument:pdfDocument});});}if(_this80.pdfAttachmentViewer){pdfDocument.getAttachments().then(function(attachments){if(pdfDocument!==_this80.pdfDocument){return;}_this80.pdfAttachmentViewer.render({attachments:attachments});});}if(_this80.pdfLayerViewer){pdfViewer.optionalContentConfigPromise.then(function(optionalContentConfig){if(pdfDocument!==_this80.pdfDocument){return;}_this80.pdfLayerViewer.render({optionalContentConfig:optionalContentConfig,pdfDocument:pdfDocument});});}});this._initializePageLabels(pdfDocument);this._initializeMetadata(pdfDocument);},_scriptingDocProperties:function _scriptingDocProperties(pdfDocument){var _this81=this;return _asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee93(){var _this81$metadata,_this81$metadata2;return _regenerator().w(function(_context94){while(1)switch(_context94.n){case 0:if(_this81.documentInfo){_context94.n=2;break;}_context94.n=1;return new Promise(function(resolve){_this81.eventBus._on("metadataloaded",resolve,{once:true});});case 1:if(!(pdfDocument!==_this81.pdfDocument)){_context94.n=2;break;}return _context94.a(2,null);case 2:if(_this81._contentLength){_context94.n=4;break;}_context94.n=3;return new Promise(function(resolve){_this81.eventBus._on("documentloaded",resolve,{once:true});});case 3:if(!(pdfDocument!==_this81.pdfDocument)){_context94.n=4;break;}return _context94.a(2,null);case 4:return _context94.a(2,_objectSpread(_objectSpread({},_this81.documentInfo),{},{baseURL:_this81.baseUrl,filesize:_this81._contentLength,filename:_this81._docFilename,metadata:(_this81$metadata=_this81.metadata)===null||_this81$metadata===void 0?void 0:_this81$metadata.getRaw(),authors:(_this81$metadata2=_this81.metadata)===null||_this81$metadata2===void 0?void 0:_this81$metadata2.get("dc:creator"),numPages:_this81.pagesCount,URL:_this81.url}));}},_callee93);}))();},_initializeAutoPrint:function _initializeAutoPrint(pdfDocument,openActionPromise){var _this82=this;return _asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee94(){var _yield$Promise$all9,_yield$Promise$all0,openAction,jsActions,triggerAutoPrint,name,_t40,_t41,_t42;return _regenerator().w(function(_context95){while(1)switch(_context95.n){case 0:_context95.n=1;return Promise.all([openActionPromise,_this82.pdfViewer.enableScripting?null:pdfDocument.getJSActions()]);case 1:_yield$Promise$all9=_context95.v;_yield$Promise$all0=_slicedToArray(_yield$Promise$all9,2);openAction=_yield$Promise$all0[0];jsActions=_yield$Promise$all0[1];if(!(pdfDocument!==_this82.pdfDocument)){_context95.n=2;break;}return _context95.a(2);case 2:triggerAutoPrint=(openAction===null||openAction===void 0?void 0:openAction.action)==="Print";if(!jsActions){_context95.n=7;break;}console.warn("Warning: JavaScript support is not enabled");_t40=_regeneratorKeys(jsActions);case 3:if((_t41=_t40()).done){_context95.n=7;break;}name=_t41.value;if(!triggerAutoPrint){_context95.n=4;break;}return _context95.a(3,7);case 4:_t42=name;_context95.n=_t42==="WillClose"?5:_t42==="WillSave"?5:_t42==="DidSave"?5:_t42==="WillPrint"?5:_t42==="DidPrint"?5:6;break;case 5:return _context95.a(3,3);case 6:triggerAutoPrint=jsActions[name].some(function(js){return AutoPrintRegExp.test(js);});_context95.n=3;break;case 7:if(triggerAutoPrint){_this82.triggerPrinting();}case 8:return _context95.a(2);}},_callee94);}))();},_initializeMetadata:function _initializeMetadata(pdfDocument){var _this83=this;return _asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee95(){var _this83$_contentDispo,_this83$_contentLengt;var _yield$pdfDocument$ge,info,metadata,contentDispositionFilename,contentLength,pdfTitle,metadataTitle;return _regenerator().w(function(_context96){while(1)switch(_context96.n){case 0:_context96.n=1;return pdfDocument.getMetadata();case 1:_yield$pdfDocument$ge=_context96.v;info=_yield$pdfDocument$ge.info;metadata=_yield$pdfDocument$ge.metadata;contentDispositionFilename=_yield$pdfDocument$ge.contentDispositionFilename;contentLength=_yield$pdfDocument$ge.contentLength;if(!(pdfDocument!==_this83.pdfDocument)){_context96.n=2;break;}return _context96.a(2);case 2:_this83.documentInfo=info;_this83.metadata=metadata;(_this83$_contentDispo=_this83._contentDispositionFilename)!==null&&_this83$_contentDispo!==void 0?_this83$_contentDispo:_this83._contentDispositionFilename=contentDispositionFilename;(_this83$_contentLengt=_this83._contentLength)!==null&&_this83$_contentLengt!==void 0?_this83$_contentLengt:_this83._contentLength=contentLength;console.log("PDF ".concat(pdfDocument.fingerprints[0]," [").concat(info.PDFFormatVersion," ")+"".concat((info.Producer||"-").trim()," / ").concat((info.Creator||"-").trim(),"] ")+"(PDF.js: ".concat(version||"?"," [").concat(build||"?","])"));pdfTitle=info.Title;metadataTitle=metadata===null||metadata===void 0?void 0:metadata.get("dc:title");if(metadataTitle){if(metadataTitle!=="Untitled"&&!/[\uFFF0-\uFFFF]/g.test(metadataTitle)){pdfTitle=metadataTitle;}}if(pdfTitle){_this83.setTitle("".concat(pdfTitle," - ").concat(_this83._contentDispositionFilename||_this83._title));}else if(_this83._contentDispositionFilename){_this83.setTitle(_this83._contentDispositionFilename);}if(info.IsXFAPresent&&!info.IsAcroFormPresent&&!pdfDocument.isPureXfa){if(pdfDocument.loadingParams.enableXfa){console.warn("Warning: XFA Foreground documents are not supported");}else{console.warn("Warning: XFA support is not enabled");}}else if((info.IsAcroFormPresent||info.IsXFAPresent)&&!_this83.pdfViewer.renderForms){console.warn("Warning: Interactive form support is not enabled");}if(info.IsSignaturesPresent){console.warn("Warning: Digital signatures validation is not supported");}_this83.eventBus.dispatch("metadataloaded",{source:_this83});case 3:return _context96.a(2);}},_callee95);}))();},_initializePageLabels:function _initializePageLabels(pdfDocument){var _this84=this;return _asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee96(){var labels,numLabels,standardLabels,emptyLabels,i,label,pdfViewer,pdfThumbnailViewer,toolbar;return _regenerator().w(function(_context97){while(1)switch(_context97.n){case 0:_context97.n=1;return pdfDocument.getPageLabels();case 1:labels=_context97.v;if(!(pdfDocument!==_this84.pdfDocument)){_context97.n=2;break;}return _context97.a(2);case 2:if(!(!labels||AppOptions.get("disablePageLabels"))){_context97.n=3;break;}return _context97.a(2);case 3:numLabels=labels.length;standardLabels=0,emptyLabels=0;i=0;case 4:if(!(i<numLabels)){_context97.n=8;break;}label=labels[i];if(!(label===(i+1).toString())){_context97.n=5;break;}standardLabels++;_context97.n=7;break;case 5:if(!(label==="")){_context97.n=6;break;}emptyLabels++;_context97.n=7;break;case 6:return _context97.a(3,8);case 7:i++;_context97.n=4;break;case 8:if(!(standardLabels>=numLabels||emptyLabels>=numLabels)){_context97.n=9;break;}return _context97.a(2);case 9:pdfViewer=_this84.pdfViewer,pdfThumbnailViewer=_this84.pdfThumbnailViewer,toolbar=_this84.toolbar;pdfViewer.setPageLabels(labels);pdfThumbnailViewer===null||pdfThumbnailViewer===void 0||pdfThumbnailViewer.setPageLabels(labels);toolbar===null||toolbar===void 0||toolbar.setPagesCount(numLabels,true);toolbar===null||toolbar===void 0||toolbar.setPageNumber(pdfViewer.currentPageNumber,pdfViewer.currentPageLabel);case 10:return _context97.a(2);}},_callee96);}))();},_initializePdfHistory:function _initializePdfHistory(_ref98){var fingerprint=_ref98.fingerprint,viewOnLoad=_ref98.viewOnLoad,_ref98$initialDest=_ref98.initialDest,initialDest=_ref98$initialDest===void 0?null:_ref98$initialDest;if(!this.pdfHistory){return;}this.pdfHistory.initialize({fingerprint:fingerprint,resetHistory:viewOnLoad===ViewOnLoad.INITIAL,updateUrl:AppOptions.get("historyUpdateUrl")});if(this.pdfHistory.initialBookmark){this.initialBookmark=this.pdfHistory.initialBookmark;this.initialRotation=this.pdfHistory.initialRotation;}if(initialDest&&!this.initialBookmark&&viewOnLoad===ViewOnLoad.UNKNOWN){this.initialBookmark=JSON.stringify(initialDest);this.pdfHistory.push({explicitDest:initialDest,pageNumber:null});}},_initializeAnnotationStorageCallbacks:function _initializeAnnotationStorageCallbacks(pdfDocument){var _this85=this;if(pdfDocument!==this.pdfDocument){return;}var annotationStorage=pdfDocument.annotationStorage;annotationStorage.onSetModified=function(){window.addEventListener("beforeunload",beforeUnload);_this85._annotationStorageModified=true;};annotationStorage.onResetModified=function(){window.removeEventListener("beforeunload",beforeUnload);delete _this85._annotationStorageModified;};annotationStorage.onAnnotationEditor=function(typeStr){_this85._hasAnnotationEditors=!!typeStr;_this85.setTitle();};},setInitialView:function setInitialView(storedHash){var _this86=this,_this$pdfSidebar,_this$toolbar2,_this$secondaryToolba2;var _ref99=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{},rotation=_ref99.rotation,sidebarView=_ref99.sidebarView,scrollMode=_ref99.scrollMode,spreadMode=_ref99.spreadMode;var setRotation=function setRotation(angle){if(isValidRotation(angle)){_this86.pdfViewer.pagesRotation=angle;}};var setViewerModes=function setViewerModes(scroll,spread){if(isValidScrollMode(scroll)){_this86.pdfViewer.scrollMode=scroll;}if(isValidSpreadMode(spread)){_this86.pdfViewer.spreadMode=spread;}};this.isInitialViewSet=true;(_this$pdfSidebar=this.pdfSidebar)===null||_this$pdfSidebar===void 0||_this$pdfSidebar.setInitialView(sidebarView);setViewerModes(scrollMode,spreadMode);if(this.initialBookmark){setRotation(this.initialRotation);delete this.initialRotation;this.pdfLinkService.setHash(this.initialBookmark);this.initialBookmark=null;}else if(storedHash){setRotation(rotation);this.pdfLinkService.setHash(storedHash);}(_this$toolbar2=this.toolbar)===null||_this$toolbar2===void 0||_this$toolbar2.setPageNumber(this.pdfViewer.currentPageNumber,this.pdfViewer.currentPageLabel);(_this$secondaryToolba2=this.secondaryToolbar)===null||_this$secondaryToolba2===void 0||_this$secondaryToolba2.setPageNumber(this.pdfViewer.currentPageNumber);if(!this.pdfViewer.currentScaleValue){this.pdfViewer.currentScaleValue=DEFAULT_SCALE_VALUE;}},_cleanup:function _cleanup(){var _this$pdfThumbnailVie3;if(!this.pdfDocument){return;}this.pdfViewer.cleanup();(_this$pdfThumbnailVie3=this.pdfThumbnailViewer)===null||_this$pdfThumbnailVie3===void 0||_this$pdfThumbnailVie3.cleanup();this.pdfDocument.cleanup(AppOptions.get("fontExtraProperties"));},forceRendering:function forceRendering(){var _this$pdfSidebar2;this.pdfRenderingQueue.printing=!!this.printService;this.pdfRenderingQueue.isThumbnailViewEnabled=((_this$pdfSidebar2=this.pdfSidebar)===null||_this$pdfSidebar2===void 0?void 0:_this$pdfSidebar2.visibleView)===SidebarView.THUMBS;this.pdfRenderingQueue.renderHighestPriority();},beforePrint:function beforePrint(){var _this87=this;this._printAnnotationStoragePromise=this.pdfScriptingManager.dispatchWillPrint()["catch"](function(){}).then(function(){var _this87$pdfDocument;return(_this87$pdfDocument=_this87.pdfDocument)===null||_this87$pdfDocument===void 0?void 0:_this87$pdfDocument.annotationStorage.print;});if(this.printService){return;}if(!this.supportsPrinting){this._otherError("pdfjs-printing-not-supported");return;}if(!this.pdfViewer.pageViewsReady){this.l10n.get("pdfjs-printing-not-ready").then(function(msg){window.alert(msg);});return;}this.printService=PDFPrintServiceFactory.createPrintService({pdfDocument:this.pdfDocument,pagesOverview:this.pdfViewer.getPagesOverview(),printContainer:this.appConfig.printContainer,printResolution:AppOptions.get("printResolution"),printAnnotationStoragePromise:this._printAnnotationStoragePromise});this.forceRendering();this.setTitle();this.printService.layout();if(this._hasAnnotationEditors){var _this$pdfDocument2;this.externalServices.reportTelemetry({type:"editing",data:{type:"print",stats:(_this$pdfDocument2=this.pdfDocument)===null||_this$pdfDocument2===void 0?void 0:_this$pdfDocument2.annotationStorage.editorStats}});}},afterPrint:function afterPrint(){var _this88=this;if(this._printAnnotationStoragePromise){this._printAnnotationStoragePromise.then(function(){_this88.pdfScriptingManager.dispatchDidPrint();});this._printAnnotationStoragePromise=null;}if(this.printService){var _this$pdfDocument3;this.printService.destroy();this.printService=null;(_this$pdfDocument3=this.pdfDocument)===null||_this$pdfDocument3===void 0||_this$pdfDocument3.annotationStorage.resetModified();}this.forceRendering();this.setTitle();},rotatePages:function rotatePages(delta){this.pdfViewer.pagesRotation+=delta;},requestPresentationMode:function requestPresentationMode(){var _this$pdfPresentation;(_this$pdfPresentation=this.pdfPresentationMode)===null||_this$pdfPresentation===void 0||_this$pdfPresentation.request();},triggerPrinting:function triggerPrinting(){if(this.supportsPrinting){window.print();}},bindEvents:function bindEvents(){var _this89=this;if(this._eventBusAbortController){return;}var ac=this._eventBusAbortController=new AbortController();var opts={signal:ac.signal};var eventBus=this.eventBus,externalServices=this.externalServices,pdfDocumentProperties=this.pdfDocumentProperties,pdfViewer=this.pdfViewer,preferences=this.preferences;eventBus._on("resize",onResize.bind(this),opts);eventBus._on("hashchange",onHashchange.bind(this),opts);eventBus._on("beforeprint",this.beforePrint.bind(this),opts);eventBus._on("afterprint",this.afterPrint.bind(this),opts);eventBus._on("pagerender",onPageRender.bind(this),opts);eventBus._on("pagerendered",onPageRendered.bind(this),opts);eventBus._on("updateviewarea",onUpdateViewarea.bind(this),opts);eventBus._on("pagechanging",onPageChanging.bind(this),opts);eventBus._on("scalechanging",onScaleChanging.bind(this),opts);eventBus._on("rotationchanging",onRotationChanging.bind(this),opts);eventBus._on("sidebarviewchanged",onSidebarViewChanged.bind(this),opts);eventBus._on("pagemode",onPageMode.bind(this),opts);eventBus._on("namedaction",onNamedAction.bind(this),opts);eventBus._on("presentationmodechanged",function(evt){return pdfViewer.presentationModeState=evt.state;},opts);eventBus._on("presentationmode",this.requestPresentationMode.bind(this),opts);eventBus._on("switchannotationeditormode",function(evt){return pdfViewer.annotationEditorMode=evt;},opts);eventBus._on("print",this.triggerPrinting.bind(this),opts);eventBus._on("download",this.downloadOrSave.bind(this),opts);eventBus._on("firstpage",function(){return _this89.page=1;},opts);eventBus._on("lastpage",function(){return _this89.page=_this89.pagesCount;},opts);eventBus._on("nextpage",function(){return pdfViewer.nextPage();},opts);eventBus._on("previouspage",function(){return pdfViewer.previousPage();},opts);eventBus._on("zoomin",this.zoomIn.bind(this),opts);eventBus._on("zoomout",this.zoomOut.bind(this),opts);eventBus._on("zoomreset",this.zoomReset.bind(this),opts);eventBus._on("pagenumberchanged",onPageNumberChanged.bind(this),opts);eventBus._on("scalechanged",function(evt){return pdfViewer.currentScaleValue=evt.value;},opts);eventBus._on("rotatecw",this.rotatePages.bind(this,90),opts);eventBus._on("rotateccw",this.rotatePages.bind(this,-90),opts);eventBus._on("optionalcontentconfig",function(evt){return pdfViewer.optionalContentConfigPromise=evt.promise;},opts);eventBus._on("switchscrollmode",function(evt){return pdfViewer.scrollMode=evt.mode;},opts);eventBus._on("scrollmodechanged",onViewerModesChanged.bind(this,"scrollMode"),opts);eventBus._on("switchspreadmode",function(evt){return pdfViewer.spreadMode=evt.mode;},opts);eventBus._on("spreadmodechanged",onViewerModesChanged.bind(this,"spreadMode"),opts);eventBus._on("imagealttextsettings",onImageAltTextSettings.bind(this),opts);eventBus._on("documentproperties",function(){return pdfDocumentProperties===null||pdfDocumentProperties===void 0?void 0:pdfDocumentProperties.open();},opts);eventBus._on("findfromurlhash",onFindFromUrlHash.bind(this),opts);eventBus._on("updatefindmatchescount",onUpdateFindMatchesCount.bind(this),opts);eventBus._on("updatefindcontrolstate",onUpdateFindControlState.bind(this),opts);eventBus._on("fileinputchange",onFileInputChange.bind(this),opts);eventBus._on("openfile",onOpenFile.bind(this),opts);},bindWindowEvents:function bindWindowEvents(){var _this90=this;if(this._windowAbortController){return;}this._windowAbortController=new AbortController();var eventBus=this.eventBus,mainContainer=this.appConfig.mainContainer,pdfViewer=this.pdfViewer,signal=this._windowAbortController.signal;this._touchManager=new TouchManager({container:window,isPinchingDisabled:function isPinchingDisabled(){return pdfViewer.isInPresentationMode;},isPinchingStopped:function isPinchingStopped(){var _this90$overlayManage;return(_this90$overlayManage=_this90.overlayManager)===null||_this90$overlayManage===void 0?void 0:_this90$overlayManage.active;},onPinching:this.touchPinchCallback.bind(this),onPinchEnd:this.touchPinchEndCallback.bind(this),signal:signal});function addWindowResolutionChange(){var evt=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;if(evt){pdfViewer.refresh();}var mediaQueryList=window.matchMedia("(resolution: ".concat(OutputScale.pixelRatio,"dppx)"));mediaQueryList.addEventListener("change",addWindowResolutionChange,{once:true,signal:signal});}addWindowResolutionChange();window.addEventListener("wheel",onWheel.bind(this),{passive:false,signal:signal});window.addEventListener("click",onClick.bind(this),{signal:signal});window.addEventListener("keydown",onKeyDown.bind(this),{signal:signal});window.addEventListener("keyup",onKeyUp.bind(this),{signal:signal});window.addEventListener("resize",function(){return eventBus.dispatch("resize",{source:window});},{signal:signal});window.addEventListener("hashchange",function(){eventBus.dispatch("hashchange",{source:window,hash:document.location.hash.substring(1)});},{signal:signal});window.addEventListener("beforeprint",function(){return eventBus.dispatch("beforeprint",{source:window});},{signal:signal});window.addEventListener("afterprint",function(){return eventBus.dispatch("afterprint",{source:window});},{signal:signal});window.addEventListener("updatefromsandbox",function(evt){eventBus.dispatch("updatefromsandbox",{source:window,detail:evt.detail});},{signal:signal});if(!("onscrollend"in document.documentElement)){return;}this._lastScrollTop=mainContainer.scrollTop;this._lastScrollLeft=mainContainer.scrollLeft;var _scrollend=function scrollend(){_this90._lastScrollTop=mainContainer.scrollTop;_this90._lastScrollLeft=mainContainer.scrollLeft;_this90._isScrolling=false;mainContainer.addEventListener("scroll",_scroll,{passive:true,signal:signal});mainContainer.removeEventListener("scrollend",_scrollend);mainContainer.removeEventListener("blur",_scrollend);};var _scroll=function scroll(){if(_this90._isCtrlKeyDown){return;}if(_this90._lastScrollTop===mainContainer.scrollTop&&_this90._lastScrollLeft===mainContainer.scrollLeft){return;}mainContainer.removeEventListener("scroll",_scroll);_this90._isScrolling=true;mainContainer.addEventListener("scrollend",_scrollend,{signal:signal});mainContainer.addEventListener("blur",_scrollend,{signal:signal});};mainContainer.addEventListener("scroll",_scroll,{passive:true,signal:signal});},unbindEvents:function unbindEvents(){var _this$_eventBusAbortC;(_this$_eventBusAbortC=this._eventBusAbortController)===null||_this$_eventBusAbortC===void 0||_this$_eventBusAbortC.abort();this._eventBusAbortController=null;},unbindWindowEvents:function unbindWindowEvents(){var _this$_windowAbortCon;(_this$_windowAbortCon=this._windowAbortController)===null||_this$_windowAbortCon===void 0||_this$_windowAbortCon.abort();this._windowAbortController=null;this._touchManager=null;},testingClose:function testingClose(){var _this91=this;return _asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee97(){var _this91$_globalAbortC,_this91$findBar,_this91$l10n;return _regenerator().w(function(_context98){while(1)switch(_context98.n){case 0:_this91.unbindEvents();_this91.unbindWindowEvents();(_this91$_globalAbortC=_this91._globalAbortController)===null||_this91$_globalAbortC===void 0||_this91$_globalAbortC.abort();_this91._globalAbortController=null;(_this91$findBar=_this91.findBar)===null||_this91$findBar===void 0||_this91$findBar.close();_context98.n=1;return Promise.all([(_this91$l10n=_this91.l10n)===null||_this91$l10n===void 0?void 0:_this91$l10n.destroy(),_this91.close()]);case 1:return _context98.a(2);}},_callee97);}))();},_accumulateTicks:function _accumulateTicks(ticks,prop){if(this[prop]>0&&ticks<0||this[prop]<0&&ticks>0){this[prop]=0;}this[prop]+=ticks;var wholeTicks=Math.trunc(this[prop]);this[prop]-=wholeTicks;return wholeTicks;},_accumulateFactor:function _accumulateFactor(previousScale,factor,prop){if(factor===1){return 1;}if(this[prop]>1&&factor<1||this[prop]<1&&factor>1){this[prop]=1;}var newFactor=Math.floor(previousScale*factor*this[prop]*100)/(100*previousScale);this[prop]=factor/newFactor;return newFactor;},_unblockDocumentLoadEvent:function _unblockDocumentLoadEvent(){var _document$blockUnbloc,_document;(_document$blockUnbloc=(_document=document).blockUnblockOnload)===null||_document$blockUnbloc===void 0||_document$blockUnbloc.call(_document,false);this._unblockDocumentLoadEvent=function(){};},get scriptingReady(){return this.pdfScriptingManager.ready;}};initCom(_PDFViewerApplication);{PDFPrintServiceFactory.initGlobals(_PDFViewerApplication);}{var HOSTED_VIEWER_ORIGINS=new Set(["null","http://mozilla.github.io","https://mozilla.github.io"]);var validateFileURL=function validateFileURL(file){var _URL$parse,_URL$parse2;if(!file){return;}var viewerOrigin=((_URL$parse=URL.parse(window.location))===null||_URL$parse===void 0?void 0:_URL$parse.origin)||"null";if(HOSTED_VIEWER_ORIGINS.has(viewerOrigin)){return;}var fileOrigin=(_URL$parse2=URL.parse(file,window.location))===null||_URL$parse2===void 0?void 0:_URL$parse2.origin;if(fileOrigin===viewerOrigin){return;}var ex=new Error("file origin does not match viewer's");_PDFViewerApplication._documentError("pdfjs-loading-error",{message:ex.message});throw ex;};var onFileInputChange=function onFileInputChange(evt){var _this$pdfViewer;if((_this$pdfViewer=this.pdfViewer)!==null&&_this$pdfViewer!==void 0&&_this$pdfViewer.isInPresentationMode){return;}var file=evt.fileInput.files[0];this.open({url:URL.createObjectURL(file),originalUrl:file.name});};var onOpenFile=function onOpenFile(evt){var _this$_openFileInput;(_this$_openFileInput=this._openFileInput)===null||_this$_openFileInput===void 0||_this$_openFileInput.click();};}function onPageRender(_ref100){var pageNumber=_ref100.pageNumber;if(pageNumber===this.page){var _this$toolbar3;(_this$toolbar3=this.toolbar)===null||_this$toolbar3===void 0||_this$toolbar3.updateLoadingIndicatorState(true);}}function onPageRendered(_ref101){var _this$pdfSidebar3;var pageNumber=_ref101.pageNumber,isDetailView=_ref101.isDetailView,error=_ref101.error;if(pageNumber===this.page){var _this$toolbar4;(_this$toolbar4=this.toolbar)===null||_this$toolbar4===void 0||_this$toolbar4.updateLoadingIndicatorState(false);}if(!isDetailView&&((_this$pdfSidebar3=this.pdfSidebar)===null||_this$pdfSidebar3===void 0?void 0:_this$pdfSidebar3.visibleView)===SidebarView.THUMBS){var _this$pdfThumbnailVie4;var pageView=this.pdfViewer.getPageView(pageNumber-1);var thumbnailView=(_this$pdfThumbnailVie4=this.pdfThumbnailViewer)===null||_this$pdfThumbnailVie4===void 0?void 0:_this$pdfThumbnailVie4.getThumbnail(pageNumber-1);if(pageView){thumbnailView===null||thumbnailView===void 0||thumbnailView.setImage(pageView);}}if(error){this._otherError("pdfjs-rendering-error",error);}}function onPageMode(_ref102){var _this$pdfSidebar4;var mode=_ref102.mode;var view;switch(mode){case"thumbs":view=SidebarView.THUMBS;break;case"bookmarks":case"outline":view=SidebarView.OUTLINE;break;case"attachments":view=SidebarView.ATTACHMENTS;break;case"layers":view=SidebarView.LAYERS;break;case"none":view=SidebarView.NONE;break;default:console.error('Invalid "pagemode" hash parameter: '+mode);return;}(_this$pdfSidebar4=this.pdfSidebar)===null||_this$pdfSidebar4===void 0||_this$pdfSidebar4.switchView(view,true);}function onNamedAction(evt){var _this$appConfig$toolb2;switch(evt.action){case"GoToPage":(_this$appConfig$toolb2=this.appConfig.toolbar)===null||_this$appConfig$toolb2===void 0||_this$appConfig$toolb2.pageNumber.select();break;case"Find":if(!this.supportsIntegratedFind){var _this$findBar;(_this$findBar=this.findBar)===null||_this$findBar===void 0||_this$findBar.toggle();}break;case"Print":this.triggerPrinting();break;case"SaveAs":this.downloadOrSave();break;}}function onSidebarViewChanged(_ref103){var view=_ref103.view;this.pdfRenderingQueue.isThumbnailViewEnabled=view===SidebarView.THUMBS;if(this.isInitialViewSet){var _this$store;(_this$store=this.store)===null||_this$store===void 0||_this$store.set("sidebarView",view)["catch"](function(){});}}function onUpdateViewarea(_ref104){var location=_ref104.location;if(this.isInitialViewSet){var _this$store2;(_this$store2=this.store)===null||_this$store2===void 0||_this$store2.setMultiple({page:location.pageNumber,zoom:location.scale,scrollLeft:location.left,scrollTop:location.top,rotation:location.rotation})["catch"](function(){});}if(this.appConfig.secondaryToolbar){this.appConfig.secondaryToolbar.viewBookmarkButton.href=this.pdfLinkService.getAnchorUrl(location.pdfOpenParams);}}function onViewerModesChanged(name,evt){if(this.isInitialViewSet&&!this.pdfViewer.isInPresentationMode){var _this$store3;(_this$store3=this.store)===null||_this$store3===void 0||_this$store3.set(name,evt.mode)["catch"](function(){});}}function onResize(){var pdfDocument=this.pdfDocument,pdfViewer=this.pdfViewer,pdfRenderingQueue=this.pdfRenderingQueue;if(pdfRenderingQueue.printing&&window.matchMedia("print").matches){return;}if(!pdfDocument){return;}var currentScaleValue=pdfViewer.currentScaleValue;if(currentScaleValue==="auto"||currentScaleValue==="page-fit"||currentScaleValue==="page-width"){pdfViewer.currentScaleValue=currentScaleValue;}pdfViewer.update();}function onHashchange(evt){var _this$pdfHistory3;var hash=evt.hash;if(!hash){return;}if(!this.isInitialViewSet){this.initialBookmark=hash;}else if(!((_this$pdfHistory3=this.pdfHistory)!==null&&_this$pdfHistory3!==void 0&&_this$pdfHistory3.popStateInProgress)){this.pdfLinkService.setHash(hash);}}function onPageNumberChanged(evt){var pdfViewer=this.pdfViewer;if(evt.value!==""){this.pdfLinkService.goToPage(evt.value);}if(evt.value!==pdfViewer.currentPageNumber.toString()&&evt.value!==pdfViewer.currentPageLabel){var _this$toolbar5;(_this$toolbar5=this.toolbar)===null||_this$toolbar5===void 0||_this$toolbar5.setPageNumber(pdfViewer.currentPageNumber,pdfViewer.currentPageLabel);}}function onImageAltTextSettings(){var _this$imageAltTextSet;(_this$imageAltTextSet=this.imageAltTextSettings)===null||_this$imageAltTextSet===void 0||_this$imageAltTextSet.open({enableGuessAltText:AppOptions.get("enableGuessAltText"),enableNewAltTextWhenAddingImage:AppOptions.get("enableNewAltTextWhenAddingImage")});}function onFindFromUrlHash(evt){this.eventBus.dispatch("find",{source:evt.source,type:"",query:evt.query,caseSensitive:false,entireWord:false,highlightAll:true,findPrevious:false,matchDiacritics:true});}function onUpdateFindMatchesCount(_ref105){var matchesCount=_ref105.matchesCount;if(this.supportsIntegratedFind){this.externalServices.updateFindMatchesCount(matchesCount);}else{var _this$findBar2;(_this$findBar2=this.findBar)===null||_this$findBar2===void 0||_this$findBar2.updateResultsCount(matchesCount);}}function onUpdateFindControlState(_ref106){var state=_ref106.state,previous=_ref106.previous,entireWord=_ref106.entireWord,matchesCount=_ref106.matchesCount,rawQuery=_ref106.rawQuery;if(this.supportsIntegratedFind){this.externalServices.updateFindControlState({result:state,findPrevious:previous,entireWord:entireWord,matchesCount:matchesCount,rawQuery:rawQuery});}else{var _this$findBar3;(_this$findBar3=this.findBar)===null||_this$findBar3===void 0||_this$findBar3.updateUIState(state,previous,matchesCount);}}function onScaleChanging(evt){var _this$toolbar6;(_this$toolbar6=this.toolbar)===null||_this$toolbar6===void 0||_this$toolbar6.setPageScale(evt.presetValue,evt.scale);this.pdfViewer.update();}function onRotationChanging(evt){if(this.pdfThumbnailViewer){this.pdfThumbnailViewer.pagesRotation=evt.pagesRotation;}this.forceRendering();this.pdfViewer.currentPageNumber=evt.pageNumber;}function onPageChanging(_ref107){var _this$toolbar7,_this$secondaryToolba3,_this$pdfSidebar5,_this$toolbar8;var pageNumber=_ref107.pageNumber,pageLabel=_ref107.pageLabel;(_this$toolbar7=this.toolbar)===null||_this$toolbar7===void 0||_this$toolbar7.setPageNumber(pageNumber,pageLabel);(_this$secondaryToolba3=this.secondaryToolbar)===null||_this$secondaryToolba3===void 0||_this$secondaryToolba3.setPageNumber(pageNumber);if(((_this$pdfSidebar5=this.pdfSidebar)===null||_this$pdfSidebar5===void 0?void 0:_this$pdfSidebar5.visibleView)===SidebarView.THUMBS){var _this$pdfThumbnailVie5;(_this$pdfThumbnailVie5=this.pdfThumbnailViewer)===null||_this$pdfThumbnailVie5===void 0||_this$pdfThumbnailVie5.scrollThumbnailIntoView(pageNumber);}var currentPage=this.pdfViewer.getPageView(pageNumber-1);(_this$toolbar8=this.toolbar)===null||_this$toolbar8===void 0||_this$toolbar8.updateLoadingIndicatorState((currentPage===null||currentPage===void 0?void 0:currentPage.renderingState)===RenderingStates.RUNNING);}function onWheel(evt){var pdfViewer=this.pdfViewer,supportsMouseWheelZoomCtrlKey=this.supportsMouseWheelZoomCtrlKey,supportsMouseWheelZoomMetaKey=this.supportsMouseWheelZoomMetaKey,supportsPinchToZoom=this.supportsPinchToZoom;if(pdfViewer.isInPresentationMode){return;}var deltaMode=evt.deltaMode;var scaleFactor=Math.exp(-evt.deltaY/100);var isBuiltInMac=false;var isPinchToZoom=evt.ctrlKey&&!this._isCtrlKeyDown&&deltaMode===WheelEvent.DOM_DELTA_PIXEL&&evt.deltaX===0&&(Math.abs(scaleFactor-1)<0.05||isBuiltInMac)&&evt.deltaZ===0;var origin=[evt.clientX,evt.clientY];if(isPinchToZoom||evt.ctrlKey&&supportsMouseWheelZoomCtrlKey||evt.metaKey&&supportsMouseWheelZoomMetaKey){evt.preventDefault();if(this._isScrolling||document.visibilityState==="hidden"||this.overlayManager.active){return;}if(isPinchToZoom&&supportsPinchToZoom){scaleFactor=this._accumulateFactor(pdfViewer.currentScale,scaleFactor,"_wheelUnusedFactor");this.updateZoom(null,scaleFactor,origin);}else{var delta=normalizeWheelEventDirection(evt);var ticks=0;if(deltaMode===WheelEvent.DOM_DELTA_LINE||deltaMode===WheelEvent.DOM_DELTA_PAGE){ticks=Math.abs(delta)>=1?Math.sign(delta):this._accumulateTicks(delta,"_wheelUnusedTicks");}else{var PIXELS_PER_LINE_SCALE=30;ticks=this._accumulateTicks(delta/PIXELS_PER_LINE_SCALE,"_wheelUnusedTicks");}this.updateZoom(ticks,null,origin);}}}function closeSecondaryToolbar(_ref108){var _this$secondaryToolba4;var target=_ref108.target;if(!((_this$secondaryToolba4=this.secondaryToolbar)!==null&&_this$secondaryToolba4!==void 0&&_this$secondaryToolba4.isOpen)){return;}var _this$appConfig=this.appConfig,toolbar=_this$appConfig.toolbar,secondaryToolbar=_this$appConfig.secondaryToolbar;if(this.pdfViewer.containsElement(target)||toolbar!==null&&toolbar!==void 0&&toolbar.container.contains(target)&&!(secondaryToolbar!==null&&secondaryToolbar!==void 0&&secondaryToolbar.toolbar.contains(target))&&!(secondaryToolbar!==null&&secondaryToolbar!==void 0&&secondaryToolbar.toggleButton.contains(target))){this.secondaryToolbar.close();}}function closeEditorUndoBar(evt){var _this$editorUndoBar,_this$appConfig$secon;if(!((_this$editorUndoBar=this.editorUndoBar)!==null&&_this$editorUndoBar!==void 0&&_this$editorUndoBar.isOpen)){return;}if((_this$appConfig$secon=this.appConfig.secondaryToolbar)!==null&&_this$appConfig$secon!==void 0&&_this$appConfig$secon.toolbar.contains(evt.target)){this.editorUndoBar.hide();}}function onClick(evt){closeSecondaryToolbar.call(this,evt);closeEditorUndoBar.call(this,evt);}function onKeyUp(evt){if(evt.key==="Control"){this._isCtrlKeyDown=false;}}function onKeyDown(evt){var _this$editorUndoBar2,_this92=this,_this$secondaryToolba5,_this$findBar5,_this$pdfCursorTools,_this$pdfCursorTools2,_this$pdfSidebar6;this._isCtrlKeyDown=evt.key==="Control";if((_this$editorUndoBar2=this.editorUndoBar)!==null&&_this$editorUndoBar2!==void 0&&_this$editorUndoBar2.isOpen&&evt.keyCode!==9&&evt.keyCode!==16&&!((evt.keyCode===13||evt.keyCode===32)&&getActiveOrFocusedElement()===this.appConfig.editorUndoBar.undoButton)){this.editorUndoBar.hide();}if(this.overlayManager.active){return;}var eventBus=this.eventBus,pdfViewer=this.pdfViewer;var isViewerInPresentationMode=pdfViewer.isInPresentationMode;var handled=false,ensureViewerFocused=false;var cmd=(evt.ctrlKey?1:0)|(evt.altKey?2:0)|(evt.shiftKey?4:0)|(evt.metaKey?8:0);if(cmd===1||cmd===8||cmd===5||cmd===12){switch(evt.keyCode){case 70:if(!this.supportsIntegratedFind&&!evt.shiftKey){var _this$findBar4;(_this$findBar4=this.findBar)===null||_this$findBar4===void 0||_this$findBar4.open();handled=true;}break;case 71:if(!this.supportsIntegratedFind){var state=this.findController.state;if(state){var newState={source:window,type:"again",findPrevious:cmd===5||cmd===12};eventBus.dispatch("find",_objectSpread(_objectSpread({},state),newState));}handled=true;}break;case 61:case 107:case 187:case 171:this.zoomIn();handled=true;break;case 173:case 109:case 189:this.zoomOut();handled=true;break;case 48:case 96:if(!isViewerInPresentationMode){setTimeout(function(){_this92.zoomReset();});handled=false;}break;case 38:if(isViewerInPresentationMode||this.page>1){this.page=1;handled=true;ensureViewerFocused=true;}break;case 40:if(isViewerInPresentationMode||this.page<this.pagesCount){this.page=this.pagesCount;handled=true;ensureViewerFocused=true;}break;}}if(cmd===1||cmd===8){switch(evt.keyCode){case 83:eventBus.dispatch("download",{source:window});handled=true;break;case 79:{eventBus.dispatch("openfile",{source:window});handled=true;}break;}}if(cmd===3||cmd===10){switch(evt.keyCode){case 80:this.requestPresentationMode();handled=true;this.externalServices.reportTelemetry({type:"buttons",data:{id:"presentationModeKeyboard"}});break;case 71:if(this.appConfig.toolbar){this.appConfig.toolbar.pageNumber.select();handled=true;}break;}}if(handled){if(ensureViewerFocused&&!isViewerInPresentationMode){pdfViewer.focus();}evt.preventDefault();return;}var curElement=getActiveOrFocusedElement();var curElementTagName=curElement===null||curElement===void 0?void 0:curElement.tagName.toUpperCase();if(curElementTagName==="INPUT"||curElementTagName==="TEXTAREA"||curElementTagName==="SELECT"||curElementTagName==="BUTTON"&&(evt.keyCode===13||evt.keyCode===32)||curElement!==null&&curElement!==void 0&&curElement.isContentEditable){if(evt.keyCode!==27){return;}}if(cmd===0){var turnPage=0,turnOnlyIfPageFit=false;switch(evt.keyCode){case 38:if(this.supportsCaretBrowsingMode){this.moveCaret(true,false);handled=true;break;}case 33:if(pdfViewer.isVerticalScrollbarEnabled){turnOnlyIfPageFit=true;}turnPage=-1;break;case 8:if(!isViewerInPresentationMode){turnOnlyIfPageFit=true;}turnPage=-1;break;case 37:if(this.supportsCaretBrowsingMode){return;}if(pdfViewer.isHorizontalScrollbarEnabled){turnOnlyIfPageFit=true;}case 75:case 80:turnPage=-1;break;case 27:if((_this$secondaryToolba5=this.secondaryToolbar)!==null&&_this$secondaryToolba5!==void 0&&_this$secondaryToolba5.isOpen){this.secondaryToolbar.close();handled=true;}if(!this.supportsIntegratedFind&&(_this$findBar5=this.findBar)!==null&&_this$findBar5!==void 0&&_this$findBar5.opened){this.findBar.close();handled=true;}break;case 40:if(this.supportsCaretBrowsingMode){this.moveCaret(false,false);handled=true;break;}case 34:if(pdfViewer.isVerticalScrollbarEnabled){turnOnlyIfPageFit=true;}turnPage=1;break;case 13:case 32:if(!isViewerInPresentationMode){turnOnlyIfPageFit=true;}turnPage=1;break;case 39:if(this.supportsCaretBrowsingMode){return;}if(pdfViewer.isHorizontalScrollbarEnabled){turnOnlyIfPageFit=true;}case 74:case 78:turnPage=1;break;case 36:if(isViewerInPresentationMode||this.page>1){this.page=1;handled=true;ensureViewerFocused=true;}break;case 35:if(isViewerInPresentationMode||this.page<this.pagesCount){this.page=this.pagesCount;handled=true;ensureViewerFocused=true;}break;case 83:(_this$pdfCursorTools=this.pdfCursorTools)===null||_this$pdfCursorTools===void 0||_this$pdfCursorTools.switchTool(CursorTool.SELECT);break;case 72:(_this$pdfCursorTools2=this.pdfCursorTools)===null||_this$pdfCursorTools2===void 0||_this$pdfCursorTools2.switchTool(CursorTool.HAND);break;case 82:this.rotatePages(90);break;case 115:(_this$pdfSidebar6=this.pdfSidebar)===null||_this$pdfSidebar6===void 0||_this$pdfSidebar6.toggle();break;}if(turnPage!==0&&(!turnOnlyIfPageFit||pdfViewer.currentScaleValue==="page-fit")){if(turnPage>0){pdfViewer.nextPage();}else{pdfViewer.previousPage();}handled=true;}}if(cmd===4){switch(evt.keyCode){case 13:case 32:if(!isViewerInPresentationMode&&pdfViewer.currentScaleValue!=="page-fit"){break;}pdfViewer.previousPage();handled=true;break;case 38:this.moveCaret(true,true);handled=true;break;case 40:this.moveCaret(false,true);handled=true;break;case 82:this.rotatePages(-90);break;}}if(!handled&&!isViewerInPresentationMode){if(evt.keyCode>=33&&evt.keyCode<=40||evt.keyCode===32&&curElementTagName!=="BUTTON"){ensureViewerFocused=true;}}if(ensureViewerFocused&&!pdfViewer.containsElement(curElement)){pdfViewer.focus();}if(handled){evt.preventDefault();}}function beforeUnload(evt){evt.preventDefault();evt.returnValue="";return false;};// ./web/viewer.js
var pdfjsVersion="5.1.91";var pdfjsBuild="45cbe8bb0";var AppConstants={LinkTarget:LinkTarget,RenderingStates:RenderingStates,ScrollMode:ScrollMode,SpreadMode:SpreadMode};window.PDFViewerApplication=_PDFViewerApplication;window.PDFViewerApplicationConstants=AppConstants;window.PDFViewerApplicationOptions=AppOptions;function getViewerConfiguration(){return{appContainer:document.body,principalContainer:document.getElementById("mainContainer"),mainContainer:document.getElementById("viewerContainer"),viewerContainer:document.getElementById("viewer"),toolbar:{container:document.getElementById("toolbarContainer"),numPages:document.getElementById("numPages"),pageNumber:document.getElementById("pageNumber"),scaleSelect:document.getElementById("scaleSelect"),customScaleOption:document.getElementById("customScaleOption"),previous:document.getElementById("previous"),next:document.getElementById("next"),zoomIn:document.getElementById("zoomInButton"),zoomOut:document.getElementById("zoomOutButton"),print:document.getElementById("printButton"),editorFreeTextButton:document.getElementById("editorFreeTextButton"),editorFreeTextParamsToolbar:document.getElementById("editorFreeTextParamsToolbar"),editorHighlightButton:document.getElementById("editorHighlightButton"),editorHighlightParamsToolbar:document.getElementById("editorHighlightParamsToolbar"),editorHighlightColorPicker:document.getElementById("editorHighlightColorPicker"),editorInkButton:document.getElementById("editorInkButton"),editorInkParamsToolbar:document.getElementById("editorInkParamsToolbar"),editorStampButton:document.getElementById("editorStampButton"),editorStampParamsToolbar:document.getElementById("editorStampParamsToolbar"),editorSignatureButton:document.getElementById("editorSignatureButton"),editorSignatureParamsToolbar:document.getElementById("editorSignatureParamsToolbar"),download:document.getElementById("downloadButton")},secondaryToolbar:{toolbar:document.getElementById("secondaryToolbar"),toggleButton:document.getElementById("secondaryToolbarToggleButton"),presentationModeButton:document.getElementById("presentationMode"),openFileButton:document.getElementById("secondaryOpenFile"),printButton:document.getElementById("secondaryPrint"),downloadButton:document.getElementById("secondaryDownload"),viewBookmarkButton:document.getElementById("viewBookmark"),firstPageButton:document.getElementById("firstPage"),lastPageButton:document.getElementById("lastPage"),pageRotateCwButton:document.getElementById("pageRotateCw"),pageRotateCcwButton:document.getElementById("pageRotateCcw"),cursorSelectToolButton:document.getElementById("cursorSelectTool"),cursorHandToolButton:document.getElementById("cursorHandTool"),scrollPageButton:document.getElementById("scrollPage"),scrollVerticalButton:document.getElementById("scrollVertical"),scrollHorizontalButton:document.getElementById("scrollHorizontal"),scrollWrappedButton:document.getElementById("scrollWrapped"),spreadNoneButton:document.getElementById("spreadNone"),spreadOddButton:document.getElementById("spreadOdd"),spreadEvenButton:document.getElementById("spreadEven"),imageAltTextSettingsButton:document.getElementById("imageAltTextSettings"),imageAltTextSettingsSeparator:document.getElementById("imageAltTextSettingsSeparator"),documentPropertiesButton:document.getElementById("documentProperties")},sidebar:{outerContainer:document.getElementById("outerContainer"),sidebarContainer:document.getElementById("sidebarContainer"),toggleButton:document.getElementById("sidebarToggleButton"),resizer:document.getElementById("sidebarResizer"),thumbnailButton:document.getElementById("viewThumbnail"),outlineButton:document.getElementById("viewOutline"),attachmentsButton:document.getElementById("viewAttachments"),layersButton:document.getElementById("viewLayers"),thumbnailView:document.getElementById("thumbnailView"),outlineView:document.getElementById("outlineView"),attachmentsView:document.getElementById("attachmentsView"),layersView:document.getElementById("layersView"),currentOutlineItemButton:document.getElementById("currentOutlineItem")},findBar:{bar:document.getElementById("findbar"),toggleButton:document.getElementById("viewFindButton"),findField:document.getElementById("findInput"),highlightAllCheckbox:document.getElementById("findHighlightAll"),caseSensitiveCheckbox:document.getElementById("findMatchCase"),matchDiacriticsCheckbox:document.getElementById("findMatchDiacritics"),entireWordCheckbox:document.getElementById("findEntireWord"),findMsg:document.getElementById("findMsg"),findResultsCount:document.getElementById("findResultsCount"),findPreviousButton:document.getElementById("findPreviousButton"),findNextButton:document.getElementById("findNextButton")},passwordOverlay:{dialog:document.getElementById("passwordDialog"),label:document.getElementById("passwordText"),input:document.getElementById("password"),submitButton:document.getElementById("passwordSubmit"),cancelButton:document.getElementById("passwordCancel")},documentProperties:{dialog:document.getElementById("documentPropertiesDialog"),closeButton:document.getElementById("documentPropertiesClose"),fields:{fileName:document.getElementById("fileNameField"),fileSize:document.getElementById("fileSizeField"),title:document.getElementById("titleField"),author:document.getElementById("authorField"),subject:document.getElementById("subjectField"),keywords:document.getElementById("keywordsField"),creationDate:document.getElementById("creationDateField"),modificationDate:document.getElementById("modificationDateField"),creator:document.getElementById("creatorField"),producer:document.getElementById("producerField"),version:document.getElementById("versionField"),pageCount:document.getElementById("pageCountField"),pageSize:document.getElementById("pageSizeField"),linearized:document.getElementById("linearizedField")}},altTextDialog:{dialog:document.getElementById("altTextDialog"),optionDescription:document.getElementById("descriptionButton"),optionDecorative:document.getElementById("decorativeButton"),textarea:document.getElementById("descriptionTextarea"),cancelButton:document.getElementById("altTextCancel"),saveButton:document.getElementById("altTextSave")},newAltTextDialog:{dialog:document.getElementById("newAltTextDialog"),title:document.getElementById("newAltTextTitle"),descriptionContainer:document.getElementById("newAltTextDescriptionContainer"),textarea:document.getElementById("newAltTextDescriptionTextarea"),disclaimer:document.getElementById("newAltTextDisclaimer"),learnMore:document.getElementById("newAltTextLearnMore"),imagePreview:document.getElementById("newAltTextImagePreview"),createAutomatically:document.getElementById("newAltTextCreateAutomatically"),createAutomaticallyButton:document.getElementById("newAltTextCreateAutomaticallyButton"),downloadModel:document.getElementById("newAltTextDownloadModel"),downloadModelDescription:document.getElementById("newAltTextDownloadModelDescription"),error:document.getElementById("newAltTextError"),errorCloseButton:document.getElementById("newAltTextCloseButton"),cancelButton:document.getElementById("newAltTextCancel"),notNowButton:document.getElementById("newAltTextNotNow"),saveButton:document.getElementById("newAltTextSave")},altTextSettingsDialog:{dialog:document.getElementById("altTextSettingsDialog"),createModelButton:document.getElementById("createModelButton"),aiModelSettings:document.getElementById("aiModelSettings"),learnMore:document.getElementById("altTextSettingsLearnMore"),deleteModelButton:document.getElementById("deleteModelButton"),downloadModelButton:document.getElementById("downloadModelButton"),showAltTextDialogButton:document.getElementById("showAltTextDialogButton"),altTextSettingsCloseButton:document.getElementById("altTextSettingsCloseButton"),closeButton:document.getElementById("altTextSettingsCloseButton")},addSignatureDialog:{dialog:document.getElementById("addSignatureDialog"),panels:document.getElementById("addSignatureActionContainer"),typeButton:document.getElementById("addSignatureTypeButton"),typeInput:document.getElementById("addSignatureTypeInput"),drawButton:document.getElementById("addSignatureDrawButton"),drawSVG:document.getElementById("addSignatureDraw"),drawPlaceholder:document.getElementById("addSignatureDrawPlaceholder"),drawThickness:document.getElementById("addSignatureDrawThickness"),imageButton:document.getElementById("addSignatureImageButton"),imageSVG:document.getElementById("addSignatureImage"),imagePlaceholder:document.getElementById("addSignatureImagePlaceholder"),imagePicker:document.getElementById("addSignatureFilePicker"),imagePickerLink:document.getElementById("addSignatureImageBrowse"),description:document.getElementById("addSignatureDescription"),clearButton:document.getElementById("clearSignatureButton"),saveContainer:document.getElementById("addSignatureSaveContainer"),saveCheckbox:document.getElementById("addSignatureSaveCheckbox"),errorBar:document.getElementById("addSignatureError"),errorCloseButton:document.getElementById("addSignatureErrorCloseButton"),cancelButton:document.getElementById("addSignatureCancelButton"),addButton:document.getElementById("addSignatureAddButton")},editSignatureDialog:{dialog:document.getElementById("editSignatureDescriptionDialog"),description:document.getElementById("editSignatureDescription"),editSignatureView:document.getElementById("editSignatureView"),cancelButton:document.getElementById("editSignatureCancelButton"),updateButton:document.getElementById("editSignatureUpdateButton")},annotationEditorParams:{editorFreeTextFontSize:document.getElementById("editorFreeTextFontSize"),editorFreeTextColor:document.getElementById("editorFreeTextColor"),editorInkColor:document.getElementById("editorInkColor"),editorInkThickness:document.getElementById("editorInkThickness"),editorInkOpacity:document.getElementById("editorInkOpacity"),editorStampAddImage:document.getElementById("editorStampAddImage"),editorSignatureAddSignature:document.getElementById("editorSignatureAddSignature"),editorFreeHighlightThickness:document.getElementById("editorFreeHighlightThickness"),editorHighlightShowAll:document.getElementById("editorHighlightShowAll")},printContainer:document.getElementById("printContainer"),editorUndoBar:{container:document.getElementById("editorUndoBar"),message:document.getElementById("editorUndoBarMessage"),undoButton:document.getElementById("editorUndoBarUndoButton"),closeButton:document.getElementById("editorUndoBarCloseButton")}};}function webViewerLoad(){var config=getViewerConfiguration();var event=new CustomEvent("webviewerloaded",{bubbles:true,cancelable:true,detail:{source:window}});try{parent.document.dispatchEvent(event);}catch(ex){console.error("webviewerloaded:",ex);document.dispatchEvent(event);}_PDFViewerApplication.run(config);}(_document$blockUnbloc2=(_document2=document).blockUnblockOnload)===null||_document$blockUnbloc2===void 0||_document$blockUnbloc2.call(_document2,true);if(document.readyState==="interactive"||document.readyState==="complete"){webViewerLoad();}else{document.addEventListener("DOMContentLoaded",webViewerLoad,true);}var __webpack_exports__PDFViewerApplication=__webpack_exports__.PDFViewerApplication;var __webpack_exports__PDFViewerApplicationConstants=__webpack_exports__.PDFViewerApplicationConstants;var __webpack_exports__PDFViewerApplicationOptions=__webpack_exports__.PDFViewerApplicationOptions;export{__webpack_exports__PDFViewerApplication as PDFViewerApplication,__webpack_exports__PDFViewerApplicationConstants as PDFViewerApplicationConstants,__webpack_exports__PDFViewerApplicationOptions as PDFViewerApplicationOptions};